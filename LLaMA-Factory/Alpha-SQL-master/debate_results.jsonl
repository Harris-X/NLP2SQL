{"question_id": "sql_111", "final_sql": "WITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC", "history": [{"model": "A", "verdict": "first_pass", "plan_steps": ["步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。", "步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。", "步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。", "步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。", "步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。", "步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。", "步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。", "步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。"], "analysis_plan": "步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。", "issues": [{"segment": "SwiftMorphInfo 坐标提取", "reason": "LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。"}, {"segment": "所有MorphInfo字段提取逻辑一致", "reason": "SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。"}, {"segment": "ROUND(CAST(... AS DECIMAL(10,1)),1)", "reason": "DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。"}, {"segment": "WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''", "reason": "应统一添加TRIM()防止空格干扰判断，确保字段真正有效。"}, {"segment": "最终SELECT字段别名", "reason": "中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。"}], "reason": "SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。", "round": 0}, {"model": "B", "verdict": "first_pass", "plan_steps": ["步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。", "步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。", "步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。", "步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。", "步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。", "步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。", "步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。", "步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。"], "analysis_plan": "步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。", "issues": [{"segment": "SwiftMorphInfo 坐标提取", "reason": "LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。"}, {"segment": "所有MorphInfo字段提取逻辑一致", "reason": "SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。"}, {"segment": "ROUND(CAST(... AS DECIMAL(10,1)),1)", "reason": "DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。"}, {"segment": "WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''", "reason": "应统一添加TRIM()防止空格干扰判断，确保字段真正有效。"}, {"segment": "最终SELECT字段别名", "reason": "中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。"}], "reason": "SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。", "round": 0}, {"model": "A", "verdict": "second_pass", "plan_steps": ["步骤1: 理清用户需求，目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。", "步骤2: 明确筛选条件：限定日期为20220425，且只关注7种变身类型对应的字段非空记录。", "步骤3: 核对每类战士的坐标来源字段是否匹配（如SwiftMorphInfo对应速行战士等）。", "步骤4: 检查字符串解析逻辑能否从各MorphInfo字段中准确提取第3、4、5个'+'之间的坐标值。", "步骤5: 验证坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否正确保留一位小数。", "步骤6: 确认UNION ALL结构完整覆盖全部七种类型，没有遗漏或重复。", "步骤7: 检查最终聚合GROUP BY是否包含统计日期、类型、x、y、z，并统计COUNT(*)作为次数。", "步骤8: 审核查找结果排序是否合理：按统计日期、类型、次数降序排列。"], "analysis_plan": "步骤1: 理清用户需求，目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 明确筛选条件：限定日期为20220425，且只关注7种变身类型对应的字段非空记录。; 步骤3: 核对每类战士的坐标来源字段是否匹配（如SwiftMorphInfo对应速行战士等）。; 步骤4: 检查字符串解析逻辑能否从各MorphInfo字段中准确提取第3、4、5个'+'之间的坐标值。; 步骤5: 验证坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否正确保留一位小数。; 步骤6: 确认UNION ALL结构完整覆盖全部七种类型，没有遗漏或重复。; 步骤7: 检查最终聚合GROUP BY是否包含统计日期、类型、x、y、z，并统计COUNT(*)作为次数。; 步骤8: 审核查找结果排序是否合理：按统计日期、类型、次数降序排列。", "issues": [{"segment": "SwiftMorphInfo 坐标提取逻辑", "reason": "LOCATE嵌套层数过多，容易导致索引偏移错误，建议使用REGEXP_SUBSTR或其他稳定方式提取。"}, {"segment": "所有MorphInfo字段提取一致性", "reason": "多处重复SUBSTRING+LOCATE写法增加维护难度和出错概率，建议封装成表达式或UDF。"}, {"segment": "ROUND(CAST(... AS DECIMAL(10,1)),1)", "reason": "DECIMAL(10,1)可能无法容纳大范围坐标值，应评估实际坐标数值区间后调整精度。"}, {"segment": "WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''", "reason": "未使用TRIM()处理前后空格可能导致无效数据被误判为有效，影响准确性。"}, {"segment": "最终SELECT字段别名", "reason": "使用中文别名在部分系统上可能存在兼容性问题，建议改用英文命名规范。"}], "reason": "SQL整体结构满足业务需求但字符串解析逻辑过于复杂，存在潜在错误风险，建议重构提取方法提高鲁棒性。", "round": 0}, {"model": "B", "verdict": "second_pass", "plan_steps": ["步骤1: 对照用户需求与 schema，确认仅能使用 dwd_jordass_vsteaminfectlog_hi 及其字段，梳理出日期、类型、坐标、次数四类信息来源。", "步骤2: 核查日期过滤与分组字段，确认是否应以 dteventtime（游戏事件时间）而非 tdbank_imp_date 作为“20220425按天分布”的依据，并给出修复建议。", "步骤3: 检查 7 种类型与各自 MorphInfo 字段映射是否正确，并验证每个分支都限制本类型字段非空。", "步骤4: 逐分支推导 SUBSTRING + LOCATE 提取 x/y/z 的位置计算是否真的取到“第3/4/5段”坐标，指出潜在格式变化风险及可行改写方式。", "步骤5: 审核 CAST 为 DECIMAL(10,1) 再 ROUND(...,1) 的必要性与兼容性，判断是否存在精度溢出或重复运算问题。", "步骤6: 核查 UNION ALL 是否完整覆盖 7 个类型、无遗漏和条件写错，且最终 GROUP BY/ORDER BY 是否满足“统计日期、类型、x,y,z,次数”的输出要求。", "步骤7: 结合以上检查，对模型A/B 先前的 issues 逐条确认哪些是风格建议、哪些是确有逻辑风险，补充它们遗漏的关键风险点（如日期字段选择、模式过滤）。"], "analysis_plan": "步骤1: 对照用户需求与 schema，确认仅能使用 dwd_jordass_vsteaminfectlog_hi 及其字段，梳理出日期、类型、坐标、次数四类信息来源。; 步骤2: 核查日期过滤与分组字段，确认是否应以 dteventtime（游戏事件时间）而非 tdbank_imp_date 作为“20220425按天分布”的依据，并给出修复建议。; 步骤3: 检查 7 种类型与各自 MorphInfo 字段映射是否正确，并验证每个分支都限制本类型字段非空。; 步骤4: 逐分支推导 SUBSTRING + LOCATE 提取 x/y/z 的位置计算是否真的取到“第3/4/5段”坐标，指出潜在格式变化风险及可行改写方式。; 步骤5: 审核 CAST 为 DECIMAL(10,1) 再 ROUND(...,1) 的必要性与兼容性，判断是否存在精度溢出或重复运算问题。; 步骤6: 核查 UNION ALL 是否完整覆盖 7 个类型、无遗漏和条件写错，且最终 GROUP BY/ORDER BY 是否满足“统计日期、类型、x,y,z,次数”的输出要求。; 步骤7: 结合以上检查，对模型A/B 先前的 issues 逐条确认哪些是风格建议、哪些是确有逻辑风险，补充它们遗漏的关键风险点（如日期字段选择、模式过滤）。", "issues": [{"segment": "WHERE tdbank_imp_date LIKE '20220425%' 与 LEFT(tdbank_imp_date, 8) AS 统计日期", "reason": "用户要按“局内数据”且日期语义更贴近 dteventtime（游戏事件时间），但当前用的是无注释的 tdbank_imp_date。若该字段是导入日期而非对局日期，会导致 20220425 当天局内行为被漏算或错算。可落地修复建议：改为用 dteventtime 过滤和截取日期，例如 WHERE dteventtime >= '2022-04-25 00:00:00' AND dteventtime < '2022-04-26 00:00:00'，并使用 DATE_FORMAT(dteventtime,'%Y%m%d') 作为统计日期。"}, {"segment": "未对“突变组竞2.0”模式做过滤", "reason": "需求限定在“突变组竞2.0局内数据”，但 schema 中找不到明显的模式字段（如 mode_id）。当前 SQL 默认整表数据都属于该模式，若该表混有其他玩法数据则无法按需过滤。此为需求与 schema 信息不对齐的风险，需在业务侧确认是否应补充模式字段或额外过滤条件。"}, {"segment": "LOCATE/SUBSTRING 坐标提取整体逻辑", "reason": "逐个推导可知：对单条格式为“时间+类型+坐标x+坐标y+坐标z”的字符串时，x 使用第2/3个“+”间的子串、y 用第3/4个“+”，z 用第4个“+”后全串，现有写法在索引和长度计算上是自洽的，比模型A/B 之前“可能偏移”评价更悲观。真正的风险在于：若 MorphInfo 中存在多次变身被追加（例如再加分号或多段“时间+类型+坐标…”），该写法只会取第一段的坐标，需求是否要统计全部变身点尚未明确。如需覆盖所有变身点，需要业务方确认字段真实格式后调整为拆分多段。"}, {"segment": "每个分支 WHERE xxxMorphInfo IS NOT NULL AND xxxMorphInfo != ''", "reason": "这一点是符合“每个类型都要限制各自字段不为空”的业务要求的，模型A/B 将其视为需要统一 TRIM() 更多是风格建议而非必修逻辑。确实存在仅空格的极小概率脏数据风险，若要可落地收敛，可改为 WHERE TRIM(xxxMorphInfo) <> ''。"}, {"segment": "ROUND(CAST(... AS DECIMAL(10,1)), 1)", "reason": "DECIMAL(10,1) 本身就限制为一位小数，再调用 ROUND(...,1) 属于重复操作，但通常不会引入精度问题。模型A/B 提到“位宽可能不足”属于假设性风险，就 schema 看坐标一般不至于超过 8 位整数+1位小数，真实风险较低。可落地优化建议：直接 CAST(... AS DECIMAL(10,1)) 或 ROUND(CAST(... AS DECIMAL(10,3)), 1) 以保留到一位但用更宽中间精度。"}, {"segment": "中文别名 统计日期 / 类型 / 次数", "reason": "在 MySQL 中使用中文别名是合法的，不影响查询正确性。模型A/B 关于“兼容性问题”的担忧更多是跨系统导出/脚本书写的风格考虑，而非当前 SQL 的必修 bug。只有在后续被下游系统强约束英文命名时才需要调整。"}, {"segment": "SwiftMorphInfo 等 7 个分支整体结构", "reason": "7 个 UNION ALL 分支均满足：选择对应 MorphInfo 字段、限制字段不为空、从中解析 x/y/z 并同样按坐标聚合。模型A/B 指出的“结构可能不完整”“存在重复风险”在本 SQL 中并未发生，真正规则层面的缺口主要集中在日期字段选择、模式过滤以及是否需要支持多段变身记录，这些是更高优先级的风险点。"}], "reason": "SQL 在 MorphInfo 映射与坐标解析上整体符合 schema，但模型A/B 忽略了更关键的日期字段选择和玩法模式过滤风险，建议优先改用 dteventtime 按天统计，并确认是否需区分突变组竞2.0及多次变身记录。", "round": 0}, {"model": "C", "verdict": "decision", "plan_steps": [], "analysis_plan": "", "regenerate": false, "reason": "", "fixed_sql": "", "round": 0}], "dialogues": [{"model": "A", "verdict": "first_pass", "prompt": "你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型A首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n(empty)\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。", "history_snapshot": null, "response_raw": "```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```", "parsed": {"plan_steps": ["步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。", "步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。", "步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。", "步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。", "步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。", "步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。", "步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。", "步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。"], "analysis_plan": "步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。", "issues": [{"segment": "SwiftMorphInfo 坐标提取", "reason": "LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。"}, {"segment": "所有MorphInfo字段提取逻辑一致", "reason": "SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。"}, {"segment": "ROUND(CAST(... AS DECIMAL(10,1)),1)", "reason": "DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。"}, {"segment": "WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''", "reason": "应统一添加TRIM()防止空格干扰判断，确保字段真正有效。"}, {"segment": "最终SELECT字段别名", "reason": "中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。"}], "reason": "SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。"}}, {"model": "B", "verdict": "first_pass", "prompt": "你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型B首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n[1] model=A verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型A首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n(empty)\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。", "history_snapshot": null, "response_raw": "```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```", "parsed": {"plan_steps": ["步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。", "步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。", "步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。", "步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。", "步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。", "步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。", "步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。", "步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。"], "analysis_plan": "步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。", "issues": [{"segment": "SwiftMorphInfo 坐标提取", "reason": "LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。"}, {"segment": "所有MorphInfo字段提取逻辑一致", "reason": "SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。"}, {"segment": "ROUND(CAST(... AS DECIMAL(10,1)),1)", "reason": "DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。"}, {"segment": "WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''", "reason": "应统一添加TRIM()防止空格干扰判断，确保字段真正有效。"}, {"segment": "最终SELECT字段别名", "reason": "中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。"}], "reason": "SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。"}}, {"model": "A", "verdict": "second_pass", "prompt": "你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型A复盘纠错：聚焦 模型B 上一轮列出的 plan_steps 与 issues，逐项确认、纠正或补充，特别标记可落地的修复建议，并指出对方遗漏的风险。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n[1] model=A verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型A首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n(empty)\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n[2] model=B verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型B首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n[1] model=A verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型A首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n(empty)\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。", "history_snapshot": null, "response_raw": "```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理清用户需求，目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 明确筛选条件：限定日期为20220425，且只关注7种变身类型对应的字段非空记录。\",\n    \"步骤3: 核对每类战士的坐标来源字段是否匹配（如SwiftMorphInfo对应速行战士等）。\",\n    \"步骤4: 检查字符串解析逻辑能否从各MorphInfo字段中准确提取第3、4、5个'+'之间的坐标值。\",\n    \"步骤5: 验证坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否正确保留一位小数。\",\n    \"步骤6: 确认UNION ALL结构完整覆盖全部七种类型，没有遗漏或重复。\",\n    \"步骤7: 检查最终聚合GROUP BY是否包含统计日期、类型、x、y、z，并统计COUNT(*)作为次数。\",\n    \"步骤8: 审核查找结果排序是否合理：按统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取逻辑\",\n      \"reason\": \"LOCATE嵌套层数过多，容易导致索引偏移错误，建议使用REGEXP_SUBSTR或其他稳定方式提取。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取一致性\",\n      \"reason\": \"多处重复SUBSTRING+LOCATE写法增加维护难度和出错概率，建议封装成表达式或UDF。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL(10,1)可能无法容纳大范围坐标值，应评估实际坐标数值区间后调整精度。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"未使用TRIM()处理前后空格可能导致无效数据被误判为有效，影响准确性。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"使用中文别名在部分系统上可能存在兼容性问题，建议改用英文命名规范。\"\n    }\n  ],\n  \"reason\": \"SQL整体结构满足业务需求但字符串解析逻辑过于复杂，存在潜在错误风险，建议重构提取方法提高鲁棒性。\"\n}\n```", "parsed": {"plan_steps": ["步骤1: 理清用户需求，目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。", "步骤2: 明确筛选条件：限定日期为20220425，且只关注7种变身类型对应的字段非空记录。", "步骤3: 核对每类战士的坐标来源字段是否匹配（如SwiftMorphInfo对应速行战士等）。", "步骤4: 检查字符串解析逻辑能否从各MorphInfo字段中准确提取第3、4、5个'+'之间的坐标值。", "步骤5: 验证坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否正确保留一位小数。", "步骤6: 确认UNION ALL结构完整覆盖全部七种类型，没有遗漏或重复。", "步骤7: 检查最终聚合GROUP BY是否包含统计日期、类型、x、y、z，并统计COUNT(*)作为次数。", "步骤8: 审核查找结果排序是否合理：按统计日期、类型、次数降序排列。"], "analysis_plan": "步骤1: 理清用户需求，目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 明确筛选条件：限定日期为20220425，且只关注7种变身类型对应的字段非空记录。; 步骤3: 核对每类战士的坐标来源字段是否匹配（如SwiftMorphInfo对应速行战士等）。; 步骤4: 检查字符串解析逻辑能否从各MorphInfo字段中准确提取第3、4、5个'+'之间的坐标值。; 步骤5: 验证坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否正确保留一位小数。; 步骤6: 确认UNION ALL结构完整覆盖全部七种类型，没有遗漏或重复。; 步骤7: 检查最终聚合GROUP BY是否包含统计日期、类型、x、y、z，并统计COUNT(*)作为次数。; 步骤8: 审核查找结果排序是否合理：按统计日期、类型、次数降序排列。", "issues": [{"segment": "SwiftMorphInfo 坐标提取逻辑", "reason": "LOCATE嵌套层数过多，容易导致索引偏移错误，建议使用REGEXP_SUBSTR或其他稳定方式提取。"}, {"segment": "所有MorphInfo字段提取一致性", "reason": "多处重复SUBSTRING+LOCATE写法增加维护难度和出错概率，建议封装成表达式或UDF。"}, {"segment": "ROUND(CAST(... AS DECIMAL(10,1)),1)", "reason": "DECIMAL(10,1)可能无法容纳大范围坐标值，应评估实际坐标数值区间后调整精度。"}, {"segment": "WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''", "reason": "未使用TRIM()处理前后空格可能导致无效数据被误判为有效，影响准确性。"}, {"segment": "最终SELECT字段别名", "reason": "使用中文别名在部分系统上可能存在兼容性问题，建议改用英文命名规范。"}], "reason": "SQL整体结构满足业务需求但字符串解析逻辑过于复杂，存在潜在错误风险，建议重构提取方法提高鲁棒性。"}}, {"model": "B", "verdict": "second_pass", "prompt": "你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型B复盘纠错：聚焦 模型A 上一轮列出的 plan_steps 与 issues，逐项确认、纠正或补充，特别标记可落地的修复建议，并指出对方遗漏的风险。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n[1] model=A verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型A首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n(empty)\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n[2] model=B verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型B首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n[1] model=A verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型A首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n(empty)\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n[3] model=A verdict=second_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型A复盘纠错：聚焦 模型B 上一轮列出的 plan_steps 与 issues，逐项确认、纠正或补充，特别标记可落地的修复建议，并指出对方遗漏的风险。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n[1] model=A verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型A首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n(empty)\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n[2] model=B verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型B首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n[1] model=A verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型A首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n(empty)\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理清用户需求，目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 明确筛选条件：限定日期为20220425，且只关注7种变身类型对应的字段非空记录。\",\n    \"步骤3: 核对每类战士的坐标来源字段是否匹配（如SwiftMorphInfo对应速行战士等）。\",\n    \"步骤4: 检查字符串解析逻辑能否从各MorphInfo字段中准确提取第3、4、5个'+'之间的坐标值。\",\n    \"步骤5: 验证坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否正确保留一位小数。\",\n    \"步骤6: 确认UNION ALL结构完整覆盖全部七种类型，没有遗漏或重复。\",\n    \"步骤7: 检查最终聚合GROUP BY是否包含统计日期、类型、x、y、z，并统计COUNT(*)作为次数。\",\n    \"步骤8: 审核查找结果排序是否合理：按统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取逻辑\",\n      \"reason\": \"LOCATE嵌套层数过多，容易导致索引偏移错误，建议使用REGEXP_SUBSTR或其他稳定方式提取。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取一致性\",\n      \"reason\": \"多处重复SUBSTRING+LOCATE写法增加维护难度和出错概率，建议封装成表达式或UDF。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL(10,1)可能无法容纳大范围坐标值，应评估实际坐标数值区间后调整精度。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"未使用TRIM()处理前后空格可能导致无效数据被误判为有效，影响准确性。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"使用中文别名在部分系统上可能存在兼容性问题，建议改用英文命名规范。\"\n    }\n  ],\n  \"reason\": \"SQL整体结构满足业务需求但字符串解析逻辑过于复杂，存在潜在错误风险，建议重构提取方法提高鲁棒性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理清用户需求，目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 明确筛选条件：限定日期为20220425，且只关注7种变身类型对应的字段非空记录。\", \"步骤3: 核对每类战士的坐标来源字段是否匹配（如SwiftMorphInfo对应速行战士等）。\", \"步骤4: 检查字符串解析逻辑能否从各MorphInfo字段中准确提取第3、4、5个'+'之间的坐标值。\", \"步骤5: 验证坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否正确保留一位小数。\", \"步骤6: 确认UNION ALL结构完整覆盖全部七种类型，没有遗漏或重复。\", \"步骤7: 检查最终聚合GROUP BY是否包含统计日期、类型、x、y、z，并统计COUNT(*)作为次数。\", \"步骤8: 审核查找结果排序是否合理：按统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理清用户需求，目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 明确筛选条件：限定日期为20220425，且只关注7种变身类型对应的字段非空记录。; 步骤3: 核对每类战士的坐标来源字段是否匹配（如SwiftMorphInfo对应速行战士等）。; 步骤4: 检查字符串解析逻辑能否从各MorphInfo字段中准确提取第3、4、5个'+'之间的坐标值。; 步骤5: 验证坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否正确保留一位小数。; 步骤6: 确认UNION ALL结构完整覆盖全部七种类型，没有遗漏或重复。; 步骤7: 检查最终聚合GROUP BY是否包含统计日期、类型、x、y、z，并统计COUNT(*)作为次数。; 步骤8: 审核查找结果排序是否合理：按统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取逻辑\", \"reason\": \"LOCATE嵌套层数过多，容易导致索引偏移错误，建议使用REGEXP_SUBSTR或其他稳定方式提取。\"}, {\"segment\": \"所有MorphInfo字段提取一致性\", \"reason\": \"多处重复SUBSTRING+LOCATE写法增加维护难度和出错概率，建议封装成表达式或UDF。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL(10,1)可能无法容纳大范围坐标值，应评估实际坐标数值区间后调整精度。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"未使用TRIM()处理前后空格可能导致无效数据被误判为有效，影响准确性。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"使用中文别名在部分系统上可能存在兼容性问题，建议改用英文命名规范。\"}], \"reason\": \"SQL整体结构满足业务需求但字符串解析逻辑过于复杂，存在潜在错误风险，建议重构提取方法提高鲁棒性。\"}\n\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。", "history_snapshot": null, "response_raw": "\n> **Re-evaluating model plans and identifying issues**\n> Okay, so I'm checking model A’s output, focusing on the first pass because the second pass for A is truncated. A's first pass is identical to B’s first pass, so I’ll treat it as the last available plan. Now, I need to dive deeper into SQL, re-evaluate more thoroughly, and write up a new set of plan steps and issues in JSON.> \n\n> **Re-evaluating query requirements and focusing on transformation stats**\n> I need to get transformation stats for a specific date, but the schema doesn't include \"mode,\" which is fine. I'll focus on the seven transformation types mapped to the MorphInfo fields. Since each MorphInfo string includes time, type, and coordinates, I'll extract those details and output them along with the count. The required fields need to be not null.> \n\n> **Parsing transformation records from strings**\n> It looks like each transformation is a string with values separated by plus signs. The reference suggests that coordinates are at indexes 3-5 in the string. We also need to consider multiple transformations, even though the field description implies there’s usually just one event per string. For parsing the coordinates (x, y, z), I will use string functions to extract them.> \n\n> **Extracting coordinate and type data from the string**\n> To extract the transformation data, I’m using the `LOCATE` function to identify where each plus sign is in the string. Based on their positions, I can progressively use `SUBSTRING` to isolate the transformation type, and coordinates (x, y, z). The SQL uses nested `LOCATE` functions to determine the correct starting positions and lengths for each chunk.> \n\n> **Decoding the nested LOCATE structure**\n> I’m breaking down the nested `LOCATE` logic to extract the proper substrings for the transformation fields. For each `+` separator, I'm identifying its position step by step. The logic used in the SQL query helps to calculate the correct start and end positions for each value (type, x, y, z). It ensures that I can properly extract each coordinate and transformation type from the string.> \n\n> **Evaluating positional logic and conversion**\n> I'm breaking down the positional calculation logic to make sure the coordinates are deducted correctly—each step aligns with the expected positions for x, y, and z. The conversion works, but I noticed some redundancy with the decimal assignment. Some potential issues include the lack of trimming and the filtering based on the date. The logic seems mostly fine though!> \n\n> **Reviewing potential issues with the schema**\n> There’s a bit of confusion around the date filtering using \"按天分布\" and whether it needs to cover multiple days. The lack of a mode flag also means we can’t restrict based on that data. A couple of risks: missing conceptual details like handling multiple coordinates from a field or invalid data formats could cause issues during parsing.> \n\n> **Checking alignment of coordinates with indexes**\n> I'm trying to confirm whether the indexing aligns correctly with what the spec says, especially since there's ambiguity about whether the indexing is 0-based or 1-based. The comment suggests \"3,4,5\" should correspond to x, y, z, but this seems off with how the segments actually split. There might be an extra field or different arrangement.> \n\n> **Validating segment indexing and filtering concerns**\n> They seem to treat \"x\" as the third segment, which is consistent with the spec if considering 1-based indexing. Regarding data filtering, it’s mostly correct, but missing trimming, and exclusion of placeholders like \"0\" hasn’t been specified. There's also a potential issue with incorrectly using the ingestion date instead of the event date for filtering.> \n\n> **Addressing filtering, date concerns, and transformation risks**\n> Filtering should rely on `dteventtime` for date comparison, not `tdbank_imp_date`, since `tdbank_imp_date` is unspecified. A robust approach would include filtering by `dteventtime` using exact matches, rather than string-based comparisons. Additionally, there's a risk with missing restrictions for specific transformation types, which may need more clarification.\n> *Thought for 1m 8s*\n\n{\n  \"plan_steps\": [\n    \"步骤1: 对照用户需求与 schema，确认仅能使用 dwd_jordass_vsteaminfectlog_hi 及其字段，梳理出日期、类型、坐标、次数四类信息来源。\",\n    \"步骤2: 核查日期过滤与分组字段，确认是否应以 dteventtime（游戏事件时间）而非 tdbank_imp_date 作为“20220425按天分布”的依据，并给出修复建议。\",\n    \"步骤3: 检查 7 种类型与各自 MorphInfo 字段映射是否正确，并验证每个分支都限制本类型字段非空。\",\n    \"步骤4: 逐分支推导 SUBSTRING + LOCATE 提取 x/y/z 的位置计算是否真的取到“第3/4/5段”坐标，指出潜在格式变化风险及可行改写方式。\",\n    \"步骤5: 审核 CAST 为 DECIMAL(10,1) 再 ROUND(...,1) 的必要性与兼容性，判断是否存在精度溢出或重复运算问题。\",\n    \"步骤6: 核查 UNION ALL 是否完整覆盖 7 个类型、无遗漏和条件写错，且最终 GROUP BY/ORDER BY 是否满足“统计日期、类型、x,y,z,次数”的输出要求。\",\n    \"步骤7: 结合以上检查，对模型A/B 先前的 issues 逐条确认哪些是风格建议、哪些是确有逻辑风险，补充它们遗漏的关键风险点（如日期字段选择、模式过滤）。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"WHERE tdbank_imp_date LIKE '20220425%' 与 LEFT(tdbank_imp_date, 8) AS 统计日期\",\n      \"reason\": \"用户要按“局内数据”且日期语义更贴近 dteventtime（游戏事件时间），但当前用的是无注释的 tdbank_imp_date。若该字段是导入日期而非对局日期，会导致 20220425 当天局内行为被漏算或错算。可落地修复建议：改为用 dteventtime 过滤和截取日期，例如 WHERE dteventtime >= '2022-04-25 00:00:00' AND dteventtime < '2022-04-26 00:00:00'，并使用 DATE_FORMAT(dteventtime,'%Y%m%d') 作为统计日期。\"\n    },\n    {\n      \"segment\": \"未对“突变组竞2.0”模式做过滤\",\n      \"reason\": \"需求限定在“突变组竞2.0局内数据”，但 schema 中找不到明显的模式字段（如 mode_id）。当前 SQL 默认整表数据都属于该模式，若该表混有其他玩法数据则无法按需过滤。此为需求与 schema 信息不对齐的风险，需在业务侧确认是否应补充模式字段或额外过滤条件。\"\n    },\n    {\n      \"segment\": \"LOCATE/SUBSTRING 坐标提取整体逻辑\",\n      \"reason\": \"逐个推导可知：对单条格式为“时间+类型+坐标x+坐标y+坐标z”的字符串时，x 使用第2/3个“+”间的子串、y 用第3/4个“+”，z 用第4个“+”后全串，现有写法在索引和长度计算上是自洽的，比模型A/B 之前“可能偏移”评价更悲观。真正的风险在于：若 MorphInfo 中存在多次变身被追加（例如再加分号或多段“时间+类型+坐标…”），该写法只会取第一段的坐标，需求是否要统计全部变身点尚未明确。如需覆盖所有变身点，需要业务方确认字段真实格式后调整为拆分多段。\"\n    },\n    {\n      \"segment\": \"每个分支 WHERE xxxMorphInfo IS NOT NULL AND xxxMorphInfo != ''\",\n      \"reason\": \"这一点是符合“每个类型都要限制各自字段不为空”的业务要求的，模型A/B 将其视为需要统一 TRIM() 更多是风格建议而非必修逻辑。确实存在仅空格的极小概率脏数据风险，若要可落地收敛，可改为 WHERE TRIM(xxxMorphInfo) <> ''。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)), 1)\",\n      \"reason\": \"DECIMAL(10,1) 本身就限制为一位小数，再调用 ROUND(...,1) 属于重复操作，但通常不会引入精度问题。模型A/B 提到“位宽可能不足”属于假设性风险，就 schema 看坐标一般不至于超过 8 位整数+1位小数，真实风险较低。可落地优化建议：直接 CAST(... AS DECIMAL(10,1)) 或 ROUND(CAST(... AS DECIMAL(10,3)), 1) 以保留到一位但用更宽中间精度。\"\n    },\n    {\n      \"segment\": \"中文别名 统计日期 / 类型 / 次数\",\n      \"reason\": \"在 MySQL 中使用中文别名是合法的，不影响查询正确性。模型A/B 关于“兼容性问题”的担忧更多是跨系统导出/脚本书写的风格考虑，而非当前 SQL 的必修 bug。只有在后续被下游系统强约束英文命名时才需要调整。\"\n    },\n    {\n      \"segment\": \"SwiftMorphInfo 等 7 个分支整体结构\",\n      \"reason\": \"7 个 UNION ALL 分支均满足：选择对应 MorphInfo 字段、限制字段不为空、从中解析 x/y/z 并同样按坐标聚合。模型A/B 指出的“结构可能不完整”“存在重复风险”在本 SQL 中并未发生，真正规则层面的缺口主要集中在日期字段选择、模式过滤以及是否需要支持多段变身记录，这些是更高优先级的风险点。\"\n    }\n  ],\n  \"reason\": \"SQL 在 MorphInfo 映射与坐标解析上整体符合 schema，但模型A/B 忽略了更关键的日期字段选择和玩法模式过滤风险，建议优先改用 dteventtime 按天统计，并确认是否需区分突变组竞2.0及多次变身记录。\"\n}", "parsed": {"plan_steps": ["步骤1: 对照用户需求与 schema，确认仅能使用 dwd_jordass_vsteaminfectlog_hi 及其字段，梳理出日期、类型、坐标、次数四类信息来源。", "步骤2: 核查日期过滤与分组字段，确认是否应以 dteventtime（游戏事件时间）而非 tdbank_imp_date 作为“20220425按天分布”的依据，并给出修复建议。", "步骤3: 检查 7 种类型与各自 MorphInfo 字段映射是否正确，并验证每个分支都限制本类型字段非空。", "步骤4: 逐分支推导 SUBSTRING + LOCATE 提取 x/y/z 的位置计算是否真的取到“第3/4/5段”坐标，指出潜在格式变化风险及可行改写方式。", "步骤5: 审核 CAST 为 DECIMAL(10,1) 再 ROUND(...,1) 的必要性与兼容性，判断是否存在精度溢出或重复运算问题。", "步骤6: 核查 UNION ALL 是否完整覆盖 7 个类型、无遗漏和条件写错，且最终 GROUP BY/ORDER BY 是否满足“统计日期、类型、x,y,z,次数”的输出要求。", "步骤7: 结合以上检查，对模型A/B 先前的 issues 逐条确认哪些是风格建议、哪些是确有逻辑风险，补充它们遗漏的关键风险点（如日期字段选择、模式过滤）。"], "analysis_plan": "步骤1: 对照用户需求与 schema，确认仅能使用 dwd_jordass_vsteaminfectlog_hi 及其字段，梳理出日期、类型、坐标、次数四类信息来源。; 步骤2: 核查日期过滤与分组字段，确认是否应以 dteventtime（游戏事件时间）而非 tdbank_imp_date 作为“20220425按天分布”的依据，并给出修复建议。; 步骤3: 检查 7 种类型与各自 MorphInfo 字段映射是否正确，并验证每个分支都限制本类型字段非空。; 步骤4: 逐分支推导 SUBSTRING + LOCATE 提取 x/y/z 的位置计算是否真的取到“第3/4/5段”坐标，指出潜在格式变化风险及可行改写方式。; 步骤5: 审核 CAST 为 DECIMAL(10,1) 再 ROUND(...,1) 的必要性与兼容性，判断是否存在精度溢出或重复运算问题。; 步骤6: 核查 UNION ALL 是否完整覆盖 7 个类型、无遗漏和条件写错，且最终 GROUP BY/ORDER BY 是否满足“统计日期、类型、x,y,z,次数”的输出要求。; 步骤7: 结合以上检查，对模型A/B 先前的 issues 逐条确认哪些是风格建议、哪些是确有逻辑风险，补充它们遗漏的关键风险点（如日期字段选择、模式过滤）。", "issues": [{"segment": "WHERE tdbank_imp_date LIKE '20220425%' 与 LEFT(tdbank_imp_date, 8) AS 统计日期", "reason": "用户要按“局内数据”且日期语义更贴近 dteventtime（游戏事件时间），但当前用的是无注释的 tdbank_imp_date。若该字段是导入日期而非对局日期，会导致 20220425 当天局内行为被漏算或错算。可落地修复建议：改为用 dteventtime 过滤和截取日期，例如 WHERE dteventtime >= '2022-04-25 00:00:00' AND dteventtime < '2022-04-26 00:00:00'，并使用 DATE_FORMAT(dteventtime,'%Y%m%d') 作为统计日期。"}, {"segment": "未对“突变组竞2.0”模式做过滤", "reason": "需求限定在“突变组竞2.0局内数据”，但 schema 中找不到明显的模式字段（如 mode_id）。当前 SQL 默认整表数据都属于该模式，若该表混有其他玩法数据则无法按需过滤。此为需求与 schema 信息不对齐的风险，需在业务侧确认是否应补充模式字段或额外过滤条件。"}, {"segment": "LOCATE/SUBSTRING 坐标提取整体逻辑", "reason": "逐个推导可知：对单条格式为“时间+类型+坐标x+坐标y+坐标z”的字符串时，x 使用第2/3个“+”间的子串、y 用第3/4个“+”，z 用第4个“+”后全串，现有写法在索引和长度计算上是自洽的，比模型A/B 之前“可能偏移”评价更悲观。真正的风险在于：若 MorphInfo 中存在多次变身被追加（例如再加分号或多段“时间+类型+坐标…”），该写法只会取第一段的坐标，需求是否要统计全部变身点尚未明确。如需覆盖所有变身点，需要业务方确认字段真实格式后调整为拆分多段。"}, {"segment": "每个分支 WHERE xxxMorphInfo IS NOT NULL AND xxxMorphInfo != ''", "reason": "这一点是符合“每个类型都要限制各自字段不为空”的业务要求的，模型A/B 将其视为需要统一 TRIM() 更多是风格建议而非必修逻辑。确实存在仅空格的极小概率脏数据风险，若要可落地收敛，可改为 WHERE TRIM(xxxMorphInfo) <> ''。"}, {"segment": "ROUND(CAST(... AS DECIMAL(10,1)), 1)", "reason": "DECIMAL(10,1) 本身就限制为一位小数，再调用 ROUND(...,1) 属于重复操作，但通常不会引入精度问题。模型A/B 提到“位宽可能不足”属于假设性风险，就 schema 看坐标一般不至于超过 8 位整数+1位小数，真实风险较低。可落地优化建议：直接 CAST(... AS DECIMAL(10,1)) 或 ROUND(CAST(... AS DECIMAL(10,3)), 1) 以保留到一位但用更宽中间精度。"}, {"segment": "中文别名 统计日期 / 类型 / 次数", "reason": "在 MySQL 中使用中文别名是合法的，不影响查询正确性。模型A/B 关于“兼容性问题”的担忧更多是跨系统导出/脚本书写的风格考虑，而非当前 SQL 的必修 bug。只有在后续被下游系统强约束英文命名时才需要调整。"}, {"segment": "SwiftMorphInfo 等 7 个分支整体结构", "reason": "7 个 UNION ALL 分支均满足：选择对应 MorphInfo 字段、限制字段不为空、从中解析 x/y/z 并同样按坐标聚合。模型A/B 指出的“结构可能不完整”“存在重复风险”在本 SQL 中并未发生，真正规则层面的缺口主要集中在日期字段选择、模式过滤以及是否需要支持多段变身记录，这些是更高优先级的风险点。"}], "reason": "SQL 在 MorphInfo 映射与坐标解析上整体符合 schema，但模型A/B 忽略了更关键的日期字段选择和玩法模式过滤风险，建议优先改用 dteventtime 按天统计，并确认是否需区分突变组竞2.0及多次变身记录。"}}, {"model": "C", "verdict": "decision", "prompt": "你是裁判模型，需判断是否要重新生成 SQL 并给出修正版。务必仅依据 schema 中存在的字段与表；如用户需求与 schema 不符，先在 plan 中说明纠正。\n流程：先根据上下文与共享对话给出 多个 plan_steps（覆盖判定与修复），再做最终裁定。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含所有评审对话）】\n[1] model=A verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型A首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n(empty)\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n[2] model=B verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型B首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n[1] model=A verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型A首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n(empty)\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n[3] model=A verdict=second_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型A复盘纠错：聚焦 模型B 上一轮列出的 plan_steps 与 issues，逐项确认、纠正或补充，特别标记可落地的修复建议，并指出对方遗漏的风险。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n[1] model=A verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型A首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n(empty)\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n[2] model=B verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型B首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n[1] model=A verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型A首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n(empty)\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理清用户需求，目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 明确筛选条件：限定日期为20220425，且只关注7种变身类型对应的字段非空记录。\",\n    \"步骤3: 核对每类战士的坐标来源字段是否匹配（如SwiftMorphInfo对应速行战士等）。\",\n    \"步骤4: 检查字符串解析逻辑能否从各MorphInfo字段中准确提取第3、4、5个'+'之间的坐标值。\",\n    \"步骤5: 验证坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否正确保留一位小数。\",\n    \"步骤6: 确认UNION ALL结构完整覆盖全部七种类型，没有遗漏或重复。\",\n    \"步骤7: 检查最终聚合GROUP BY是否包含统计日期、类型、x、y、z，并统计COUNT(*)作为次数。\",\n    \"步骤8: 审核查找结果排序是否合理：按统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取逻辑\",\n      \"reason\": \"LOCATE嵌套层数过多，容易导致索引偏移错误，建议使用REGEXP_SUBSTR或其他稳定方式提取。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取一致性\",\n      \"reason\": \"多处重复SUBSTRING+LOCATE写法增加维护难度和出错概率，建议封装成表达式或UDF。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL(10,1)可能无法容纳大范围坐标值，应评估实际坐标数值区间后调整精度。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"未使用TRIM()处理前后空格可能导致无效数据被误判为有效，影响准确性。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"使用中文别名在部分系统上可能存在兼容性问题，建议改用英文命名规范。\"\n    }\n  ],\n  \"reason\": \"SQL整体结构满足业务需求但字符串解析逻辑过于复杂，存在潜在错误风险，建议重构提取方法提高鲁棒性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理清用户需求，目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 明确筛选条件：限定日期为20220425，且只关注7种变身类型对应的字段非空记录。\", \"步骤3: 核对每类战士的坐标来源字段是否匹配（如SwiftMorphInfo对应速行战士等）。\", \"步骤4: 检查字符串解析逻辑能否从各MorphInfo字段中准确提取第3、4、5个'+'之间的坐标值。\", \"步骤5: 验证坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否正确保留一位小数。\", \"步骤6: 确认UNION ALL结构完整覆盖全部七种类型，没有遗漏或重复。\", \"步骤7: 检查最终聚合GROUP BY是否包含统计日期、类型、x、y、z，并统计COUNT(*)作为次数。\", \"步骤8: 审核查找结果排序是否合理：按统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理清用户需求，目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 明确筛选条件：限定日期为20220425，且只关注7种变身类型对应的字段非空记录。; 步骤3: 核对每类战士的坐标来源字段是否匹配（如SwiftMorphInfo对应速行战士等）。; 步骤4: 检查字符串解析逻辑能否从各MorphInfo字段中准确提取第3、4、5个'+'之间的坐标值。; 步骤5: 验证坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否正确保留一位小数。; 步骤6: 确认UNION ALL结构完整覆盖全部七种类型，没有遗漏或重复。; 步骤7: 检查最终聚合GROUP BY是否包含统计日期、类型、x、y、z，并统计COUNT(*)作为次数。; 步骤8: 审核查找结果排序是否合理：按统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取逻辑\", \"reason\": \"LOCATE嵌套层数过多，容易导致索引偏移错误，建议使用REGEXP_SUBSTR或其他稳定方式提取。\"}, {\"segment\": \"所有MorphInfo字段提取一致性\", \"reason\": \"多处重复SUBSTRING+LOCATE写法增加维护难度和出错概率，建议封装成表达式或UDF。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL(10,1)可能无法容纳大范围坐标值，应评估实际坐标数值区间后调整精度。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"未使用TRIM()处理前后空格可能导致无效数据被误判为有效，影响准确性。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"使用中文别名在部分系统上可能存在兼容性问题，建议改用英文命名规范。\"}], \"reason\": \"SQL整体结构满足业务需求但字符串解析逻辑过于复杂，存在潜在错误风险，建议重构提取方法提高鲁棒性。\"}\n\n[4] model=B verdict=second_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型B复盘纠错：聚焦 模型A 上一轮列出的 plan_steps 与 issues，逐项确认、纠正或补充，特别标记可落地的修复建议，并指出对方遗漏的风险。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n[1] model=A verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型A首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n(empty)\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n[2] model=B verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型B首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n[1] model=A verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型A首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n(empty)\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n[3] model=A verdict=second_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型A复盘纠错：聚焦 模型B 上一轮列出的 plan_steps 与 issues，逐项确认、纠正或补充，特别标记可落地的修复建议，并指出对方遗漏的风险。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n[1] model=A verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型A首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n(empty)\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n[2] model=B verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型B首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n[1] model=A verdict=first_pass\nPROMPT:\n你是严格的 SQL 评审员。所有判断必须以 schema 中存在的字段/表为唯一依据，若用户问题与 schema 不符需先纠正。\n流程要求：\n1) 深入理解任务逻辑：先梳理用户需求→过滤条件→关联路径→输出字段。\n2) 审核共享对话（含当前轮），吸收其他模型观点。\n3) 产出多个 plan_steps，逐步覆盖检查、比对、纠正。\n4) 按计划依次验证并列出 issues。\n5) 汇总 reason（20~60 字）。\n【当前角色指引】\n模型A首轮：先用 plan_steps 明确任务逻辑（需求→过滤→关联→输出），再全面审查 SQL 是否严格遵守 schema，并补足缺失校验。\n【问题上下文】\n【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n\n【共享对话记录（含当前轮）】\n(empty)\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\",\n    \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\",\n    \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\",\n    \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\",\n    \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\",\n    \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\",\n    \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取\",\n      \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取逻辑一致\",\n      \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"\n    }\n  ],\n  \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。\", \"步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。\", \"步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。\", \"步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。\", \"步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。\", \"步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。\", \"步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理解用户需求，明确目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 分析需要提取的字段及条件：限定日期为20220425，限定7种变身类型对应的字段不为空。; 步骤3: 检查每类战士的数据来源字段是否正确映射（如SwiftMorphInfo用于速行战士等）。; 步骤4: 验证字符串解析逻辑是否准确从各MorphInfo中提取x/y/z坐标（下标3/4/5）。; 步骤5: 核实坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否符合要求保留一位小数。; 步骤6: 检查UNION ALL结构是否完整覆盖全部七种类型且无重复或遗漏。; 步骤7: 最终聚合GROUP BY是否包含统计日期、类型、x、y、z并计算COUNT(*)作为次数。; 步骤8: 输出排序是否合理按照统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取\", \"reason\": \"LOCATE嵌套复杂易错，建议使用更稳定的JSON或正则方式提取坐标值。\"}, {\"segment\": \"所有MorphInfo字段提取逻辑一致\", \"reason\": \"SUBSTRING+LOCATE方法在多处重复出现，存在潜在偏移错误风险。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL精度可能不足以容纳原始坐标范围，应核实最大位宽是否足够。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"应统一添加TRIM()防止空格干扰判断，确保字段真正有效。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"中文别名可能导致兼容性问题，推荐使用英文命名如 stat_date, type, count_num。\"}], \"reason\": \"SQL基本满足功能需求但实现方式较脆弱，建议优化字符串解析逻辑提升稳定性。\"}\n\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n```json\n{\n  \"plan_steps\": [\n    \"步骤1: 理清用户需求，目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\",\n    \"步骤2: 明确筛选条件：限定日期为20220425，且只关注7种变身类型对应的字段非空记录。\",\n    \"步骤3: 核对每类战士的坐标来源字段是否匹配（如SwiftMorphInfo对应速行战士等）。\",\n    \"步骤4: 检查字符串解析逻辑能否从各MorphInfo字段中准确提取第3、4、5个'+'之间的坐标值。\",\n    \"步骤5: 验证坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否正确保留一位小数。\",\n    \"步骤6: 确认UNION ALL结构完整覆盖全部七种类型，没有遗漏或重复。\",\n    \"步骤7: 检查最终聚合GROUP BY是否包含统计日期、类型、x、y、z，并统计COUNT(*)作为次数。\",\n    \"步骤8: 审核查找结果排序是否合理：按统计日期、类型、次数降序排列。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"SwiftMorphInfo 坐标提取逻辑\",\n      \"reason\": \"LOCATE嵌套层数过多，容易导致索引偏移错误，建议使用REGEXP_SUBSTR或其他稳定方式提取。\"\n    },\n    {\n      \"segment\": \"所有MorphInfo字段提取一致性\",\n      \"reason\": \"多处重复SUBSTRING+LOCATE写法增加维护难度和出错概率，建议封装成表达式或UDF。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\",\n      \"reason\": \"DECIMAL(10,1)可能无法容纳大范围坐标值，应评估实际坐标数值区间后调整精度。\"\n    },\n    {\n      \"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\",\n      \"reason\": \"未使用TRIM()处理前后空格可能导致无效数据被误判为有效，影响准确性。\"\n    },\n    {\n      \"segment\": \"最终SELECT字段别名\",\n      \"reason\": \"使用中文别名在部分系统上可能存在兼容性问题，建议改用英文命名规范。\"\n    }\n  ],\n  \"reason\": \"SQL整体结构满足业务需求但字符串解析逻辑过于复杂，存在潜在错误风险，建议重构提取方法提高鲁棒性。\"\n}\n```\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 理清用户需求，目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。\", \"步骤2: 明确筛选条件：限定日期为20220425，且只关注7种变身类型对应的字段非空记录。\", \"步骤3: 核对每类战士的坐标来源字段是否匹配（如SwiftMorphInfo对应速行战士等）。\", \"步骤4: 检查字符串解析逻辑能否从各MorphInfo字段中准确提取第3、4、5个'+'之间的坐标值。\", \"步骤5: 验证坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否正确保留一位小数。\", \"步骤6: 确认UNION ALL结构完整覆盖全部七种类型，没有遗漏或重复。\", \"步骤7: 检查最终聚合GROUP BY是否包含统计日期、类型、x、y、z，并统计COUNT(*)作为次数。\", \"步骤8: 审核查找结果排序是否合理：按统计日期、类型、次数降序排列。\"], \"analysis_plan\": \"步骤1: 理清用户需求，目标是统计2022年4月25日突变组竞2.0局内感染人类坐标的热区分布。; 步骤2: 明确筛选条件：限定日期为20220425，且只关注7种变身类型对应的字段非空记录。; 步骤3: 核对每类战士的坐标来源字段是否匹配（如SwiftMorphInfo对应速行战士等）。; 步骤4: 检查字符串解析逻辑能否从各MorphInfo字段中准确提取第3、4、5个'+'之间的坐标值。; 步骤5: 验证坐标处理函数ROUND(CAST(... AS DECIMAL(10,1)),1)是否正确保留一位小数。; 步骤6: 确认UNION ALL结构完整覆盖全部七种类型，没有遗漏或重复。; 步骤7: 检查最终聚合GROUP BY是否包含统计日期、类型、x、y、z，并统计COUNT(*)作为次数。; 步骤8: 审核查找结果排序是否合理：按统计日期、类型、次数降序排列。\", \"issues\": [{\"segment\": \"SwiftMorphInfo 坐标提取逻辑\", \"reason\": \"LOCATE嵌套层数过多，容易导致索引偏移错误，建议使用REGEXP_SUBSTR或其他稳定方式提取。\"}, {\"segment\": \"所有MorphInfo字段提取一致性\", \"reason\": \"多处重复SUBSTRING+LOCATE写法增加维护难度和出错概率，建议封装成表达式或UDF。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)),1)\", \"reason\": \"DECIMAL(10,1)可能无法容纳大范围坐标值，应评估实际坐标数值区间后调整精度。\"}, {\"segment\": \"WHERE条件 SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\", \"reason\": \"未使用TRIM()处理前后空格可能导致无效数据被误判为有效，影响准确性。\"}, {\"segment\": \"最终SELECT字段别名\", \"reason\": \"使用中文别名在部分系统上可能存在兼容性问题，建议改用英文命名规范。\"}], \"reason\": \"SQL整体结构满足业务需求但字符串解析逻辑过于复杂，存在潜在错误风险，建议重构提取方法提高鲁棒性。\"}\n\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", \"步骤2: ...\" ],\n  \"issues\": [ {\"segment\": \"...\", \"reason\": \"...\"}, ... ],\n  \"reason\": \"总体结论，若信息不足请说明\"\n}\n要求：plan_steps 必须可执行且按顺序覆盖检查路径；issues 仅列疑似错误或缺漏，并引用 SQL/规则点；如缺信息需在 issues 中记录。\n\nRESPONSE:\n> **Re-evaluating model plans and identifying issues**\n> Okay, so I'm checking model A’s output, focusing on the first pass because the second pass for A is truncated. A's first pass is identical to B’s first pass, so I’ll treat it as the last available plan. Now, I need to dive deeper into SQL, re-evaluate more thoroughly, and write up a new set of plan steps and issues in JSON.> \n\n> **Re-evaluating query requirements and focusing on transformation stats**\n> I need to get transformation stats for a specific date, but the schema doesn't include \"mode,\" which is fine. I'll focus on the seven transformation types mapped to the MorphInfo fields. Since each MorphInfo string includes time, type, and coordinates, I'll extract those details and output them along with the count. The required fields need to be not null.> \n\n> **Parsing transformation records from strings**\n> It looks like each transformation is a string with values separated by plus signs. The reference suggests that coordinates are at indexes 3-5 in the string. We also need to consider multiple transformations, even though the field description implies there’s usually just one event per string. For parsing the coordinates (x, y, z), I will use string functions to extract them.> \n\n> **Extracting coordinate and type data from the string**\n> To extract the transformation data, I’m using the `LOCATE` function to identify where each plus sign is in the string. Based on their positions, I can progressively use `SUBSTRING` to isolate the transformation type, and coordinates (x, y, z). The SQL uses nested `LOCATE` functions to determine the correct starting positions and lengths for each chunk.> \n\n> **Decoding the nested LOCATE structure**\n> I’m breaking down the nested `LOCATE` logic to extract the proper substrings for the transformation fields. For each `+` separator, I'm identifying its position step by step. The logic used in the SQL query helps to calculate the correct start and end positions for each value (type, x, y, z). It ensures that I can properly extract each coordinate and transformation type from the string.> \n\n> **Evaluating positional logic and conversion**\n> I'm breaking down the positional calculation logic to make sure the coordinates are deducted correctly—each step aligns with the expected positions for x, y, and z. The conversion works, but I noticed some redundancy with the decimal assignment. Some potential issues include the lack of trimming and the filtering based on the date. The logic seems mostly fine though!> \n\n> **Reviewing potential issues with the schema**\n> There’s a bit of confusion around the date filtering using \"按天分布\" and whether it needs to cover multiple days. The lack of a mode flag also means we can’t restrict based on that data. A couple of risks: missing conceptual details like handling multiple coordinates from a field or invalid data formats could cause issues during parsing.> \n\n> **Checking alignment of coordinates with indexes**\n> I'm trying to confirm whether the indexing aligns correctly with what the spec says, especially since there's ambiguity about whether the indexing is 0-based or 1-based. The comment suggests \"3,4,5\" should correspond to x, y, z, but this seems off with how the segments actually split. There might be an extra field or different arrangement.> \n\n> **Validating segment indexing and filtering concerns**\n> They seem to treat \"x\" as the third segment, which is consistent with the spec if considering 1-based indexing. Regarding data filtering, it’s mostly correct, but missing trimming, and exclusion of placeholders like \"0\" hasn’t been specified. There's also a potential issue with incorrectly using the ingestion date instead of the event date for filtering.> \n\n> **Addressing filtering, date concerns, and transformation risks**\n> Filtering should rely on `dteventtime` for date comparison, not `tdbank_imp_date`, since `tdbank_imp_date` is unspecified. A robust approach would include filtering by `dteventtime` using exact matches, rather than string-based comparisons. Additionally, there's a risk with missing restrictions for specific transformation types, which may need more clarification.\n> *Thought for 1m 8s*\n\n{\n  \"plan_steps\": [\n    \"步骤1: 对照用户需求与 schema，确认仅能使用 dwd_jordass_vsteaminfectlog_hi 及其字段，梳理出日期、类型、坐标、次数四类信息来源。\",\n    \"步骤2: 核查日期过滤与分组字段，确认是否应以 dteventtime（游戏事件时间）而非 tdbank_imp_date 作为“20220425按天分布”的依据，并给出修复建议。\",\n    \"步骤3: 检查 7 种类型与各自 MorphInfo 字段映射是否正确，并验证每个分支都限制本类型字段非空。\",\n    \"步骤4: 逐分支推导 SUBSTRING + LOCATE 提取 x/y/z 的位置计算是否真的取到“第3/4/5段”坐标，指出潜在格式变化风险及可行改写方式。\",\n    \"步骤5: 审核 CAST 为 DECIMAL(10,1) 再 ROUND(...,1) 的必要性与兼容性，判断是否存在精度溢出或重复运算问题。\",\n    \"步骤6: 核查 UNION ALL 是否完整覆盖 7 个类型、无遗漏和条件写错，且最终 GROUP BY/ORDER BY 是否满足“统计日期、类型、x,y,z,次数”的输出要求。\",\n    \"步骤7: 结合以上检查，对模型A/B 先前的 issues 逐条确认哪些是风格建议、哪些是确有逻辑风险，补充它们遗漏的关键风险点（如日期字段选择、模式过滤）。\"\n  ],\n  \"issues\": [\n    {\n      \"segment\": \"WHERE tdbank_imp_date LIKE '20220425%' 与 LEFT(tdbank_imp_date, 8) AS 统计日期\",\n      \"reason\": \"用户要按“局内数据”且日期语义更贴近 dteventtime（游戏事件时间），但当前用的是无注释的 tdbank_imp_date。若该字段是导入日期而非对局日期，会导致 20220425 当天局内行为被漏算或错算。可落地修复建议：改为用 dteventtime 过滤和截取日期，例如 WHERE dteventtime >= '2022-04-25 00:00:00' AND dteventtime < '2022-04-26 00:00:00'，并使用 DATE_FORMAT(dteventtime,'%Y%m%d') 作为统计日期。\"\n    },\n    {\n      \"segment\": \"未对“突变组竞2.0”模式做过滤\",\n      \"reason\": \"需求限定在“突变组竞2.0局内数据”，但 schema 中找不到明显的模式字段（如 mode_id）。当前 SQL 默认整表数据都属于该模式，若该表混有其他玩法数据则无法按需过滤。此为需求与 schema 信息不对齐的风险，需在业务侧确认是否应补充模式字段或额外过滤条件。\"\n    },\n    {\n      \"segment\": \"LOCATE/SUBSTRING 坐标提取整体逻辑\",\n      \"reason\": \"逐个推导可知：对单条格式为“时间+类型+坐标x+坐标y+坐标z”的字符串时，x 使用第2/3个“+”间的子串、y 用第3/4个“+”，z 用第4个“+”后全串，现有写法在索引和长度计算上是自洽的，比模型A/B 之前“可能偏移”评价更悲观。真正的风险在于：若 MorphInfo 中存在多次变身被追加（例如再加分号或多段“时间+类型+坐标…”），该写法只会取第一段的坐标，需求是否要统计全部变身点尚未明确。如需覆盖所有变身点，需要业务方确认字段真实格式后调整为拆分多段。\"\n    },\n    {\n      \"segment\": \"每个分支 WHERE xxxMorphInfo IS NOT NULL AND xxxMorphInfo != ''\",\n      \"reason\": \"这一点是符合“每个类型都要限制各自字段不为空”的业务要求的，模型A/B 将其视为需要统一 TRIM() 更多是风格建议而非必修逻辑。确实存在仅空格的极小概率脏数据风险，若要可落地收敛，可改为 WHERE TRIM(xxxMorphInfo) <> ''。\"\n    },\n    {\n      \"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)), 1)\",\n      \"reason\": \"DECIMAL(10,1) 本身就限制为一位小数，再调用 ROUND(...,1) 属于重复操作，但通常不会引入精度问题。模型A/B 提到“位宽可能不足”属于假设性风险，就 schema 看坐标一般不至于超过 8 位整数+1位小数，真实风险较低。可落地优化建议：直接 CAST(... AS DECIMAL(10,1)) 或 ROUND(CAST(... AS DECIMAL(10,3)), 1) 以保留到一位但用更宽中间精度。\"\n    },\n    {\n      \"segment\": \"中文别名 统计日期 / 类型 / 次数\",\n      \"reason\": \"在 MySQL 中使用中文别名是合法的，不影响查询正确性。模型A/B 关于“兼容性问题”的担忧更多是跨系统导出/脚本书写的风格考虑，而非当前 SQL 的必修 bug。只有在后续被下游系统强约束英文命名时才需要调整。\"\n    },\n    {\n      \"segment\": \"SwiftMorphInfo 等 7 个分支整体结构\",\n      \"reason\": \"7 个 UNION ALL 分支均满足：选择对应 MorphInfo 字段、限制字段不为空、从中解析 x/y/z 并同样按坐标聚合。模型A/B 指出的“结构可能不完整”“存在重复风险”在本 SQL 中并未发生，真正规则层面的缺口主要集中在日期字段选择、模式过滤以及是否需要支持多段变身记录，这些是更高优先级的风险点。\"\n    }\n  ],\n  \"reason\": \"SQL 在 MorphInfo 映射与坐标解析上整体符合 schema，但模型A/B 忽略了更关键的日期字段选择和玩法模式过滤风险，建议优先改用 dteventtime 按天统计，并确认是否需区分突变组竞2.0及多次变身记录。\"\n}\n\nPARSED:\n{\"plan_steps\": [\"步骤1: 对照用户需求与 schema，确认仅能使用 dwd_jordass_vsteaminfectlog_hi 及其字段，梳理出日期、类型、坐标、次数四类信息来源。\", \"步骤2: 核查日期过滤与分组字段，确认是否应以 dteventtime（游戏事件时间）而非 tdbank_imp_date 作为“20220425按天分布”的依据，并给出修复建议。\", \"步骤3: 检查 7 种类型与各自 MorphInfo 字段映射是否正确，并验证每个分支都限制本类型字段非空。\", \"步骤4: 逐分支推导 SUBSTRING + LOCATE 提取 x/y/z 的位置计算是否真的取到“第3/4/5段”坐标，指出潜在格式变化风险及可行改写方式。\", \"步骤5: 审核 CAST 为 DECIMAL(10,1) 再 ROUND(...,1) 的必要性与兼容性，判断是否存在精度溢出或重复运算问题。\", \"步骤6: 核查 UNION ALL 是否完整覆盖 7 个类型、无遗漏和条件写错，且最终 GROUP BY/ORDER BY 是否满足“统计日期、类型、x,y,z,次数”的输出要求。\", \"步骤7: 结合以上检查，对模型A/B 先前的 issues 逐条确认哪些是风格建议、哪些是确有逻辑风险，补充它们遗漏的关键风险点（如日期字段选择、模式过滤）。\"], \"analysis_plan\": \"步骤1: 对照用户需求与 schema，确认仅能使用 dwd_jordass_vsteaminfectlog_hi 及其字段，梳理出日期、类型、坐标、次数四类信息来源。; 步骤2: 核查日期过滤与分组字段，确认是否应以 dteventtime（游戏事件时间）而非 tdbank_imp_date 作为“20220425按天分布”的依据，并给出修复建议。; 步骤3: 检查 7 种类型与各自 MorphInfo 字段映射是否正确，并验证每个分支都限制本类型字段非空。; 步骤4: 逐分支推导 SUBSTRING + LOCATE 提取 x/y/z 的位置计算是否真的取到“第3/4/5段”坐标，指出潜在格式变化风险及可行改写方式。; 步骤5: 审核 CAST 为 DECIMAL(10,1) 再 ROUND(...,1) 的必要性与兼容性，判断是否存在精度溢出或重复运算问题。; 步骤6: 核查 UNION ALL 是否完整覆盖 7 个类型、无遗漏和条件写错，且最终 GROUP BY/ORDER BY 是否满足“统计日期、类型、x,y,z,次数”的输出要求。; 步骤7: 结合以上检查，对模型A/B 先前的 issues 逐条确认哪些是风格建议、哪些是确有逻辑风险，补充它们遗漏的关键风险点（如日期字段选择、模式过滤）。\", \"issues\": [{\"segment\": \"WHERE tdbank_imp_date LIKE '20220425%' 与 LEFT(tdbank_imp_date, 8) AS 统计日期\", \"reason\": \"用户要按“局内数据”且日期语义更贴近 dteventtime（游戏事件时间），但当前用的是无注释的 tdbank_imp_date。若该字段是导入日期而非对局日期，会导致 20220425 当天局内行为被漏算或错算。可落地修复建议：改为用 dteventtime 过滤和截取日期，例如 WHERE dteventtime >= '2022-04-25 00:00:00' AND dteventtime < '2022-04-26 00:00:00'，并使用 DATE_FORMAT(dteventtime,'%Y%m%d') 作为统计日期。\"}, {\"segment\": \"未对“突变组竞2.0”模式做过滤\", \"reason\": \"需求限定在“突变组竞2.0局内数据”，但 schema 中找不到明显的模式字段（如 mode_id）。当前 SQL 默认整表数据都属于该模式，若该表混有其他玩法数据则无法按需过滤。此为需求与 schema 信息不对齐的风险，需在业务侧确认是否应补充模式字段或额外过滤条件。\"}, {\"segment\": \"LOCATE/SUBSTRING 坐标提取整体逻辑\", \"reason\": \"逐个推导可知：对单条格式为“时间+类型+坐标x+坐标y+坐标z”的字符串时，x 使用第2/3个“+”间的子串、y 用第3/4个“+”，z 用第4个“+”后全串，现有写法在索引和长度计算上是自洽的，比模型A/B 之前“可能偏移”评价更悲观。真正的风险在于：若 MorphInfo 中存在多次变身被追加（例如再加分号或多段“时间+类型+坐标…”），该写法只会取第一段的坐标，需求是否要统计全部变身点尚未明确。如需覆盖所有变身点，需要业务方确认字段真实格式后调整为拆分多段。\"}, {\"segment\": \"每个分支 WHERE xxxMorphInfo IS NOT NULL AND xxxMorphInfo != ''\", \"reason\": \"这一点是符合“每个类型都要限制各自字段不为空”的业务要求的，模型A/B 将其视为需要统一 TRIM() 更多是风格建议而非必修逻辑。确实存在仅空格的极小概率脏数据风险，若要可落地收敛，可改为 WHERE TRIM(xxxMorphInfo) <> ''。\"}, {\"segment\": \"ROUND(CAST(... AS DECIMAL(10,1)), 1)\", \"reason\": \"DECIMAL(10,1) 本身就限制为一位小数，再调用 ROUND(...,1) 属于重复操作，但通常不会引入精度问题。模型A/B 提到“位宽可能不足”属于假设性风险，就 schema 看坐标一般不至于超过 8 位整数+1位小数，真实风险较低。可落地优化建议：直接 CAST(... AS DECIMAL(10,1)) 或 ROUND(CAST(... AS DECIMAL(10,3)), 1) 以保留到一位但用更宽中间精度。\"}, {\"segment\": \"中文别名 统计日期 / 类型 / 次数\", \"reason\": \"在 MySQL 中使用中文别名是合法的，不影响查询正确性。模型A/B 关于“兼容性问题”的担忧更多是跨系统导出/脚本书写的风格考虑，而非当前 SQL 的必修 bug。只有在后续被下游系统强约束英文命名时才需要调整。\"}, {\"segment\": \"SwiftMorphInfo 等 7 个分支整体结构\", \"reason\": \"7 个 UNION ALL 分支均满足：选择对应 MorphInfo 字段、限制字段不为空、从中解析 x/y/z 并同样按坐标聚合。模型A/B 指出的“结构可能不完整”“存在重复风险”在本 SQL 中并未发生，真正规则层面的缺口主要集中在日期字段选择、模式过滤以及是否需要支持多段变身记录，这些是更高优先级的风险点。\"}], \"reason\": \"SQL 在 MorphInfo 映射与坐标解析上整体符合 schema，但模型A/B 忽略了更关键的日期字段选择和玩法模式过滤风险，建议优先改用 dteventtime 按天统计，并确认是否需区分突变组竞2.0及多次变身记录。\"}\n\n【输出格式（仅 JSON）】\n{\n  \"plan_steps\": [ \"步骤1: ...\", ... ],\n  \"regenerate\": true/false,\n  \"reason\": \"是否重生成的依据，20~60 字\",\n  \"fixed_sql\": \"当 regenerate=true 时给出新的 SQL，需 MySQL 语法且仅查询；否则留空\"\n}\n若重生成，请确保吸收历史反馈并修正错误；如无法改进，保持 regenerate=false。", "history_snapshot": null, "response_raw": "```json\n{\n  \"plan_steps\": [\n    \"步骤1: 综合历史评审，确认主要风险点：日期字段选择（tdbank_imp_date vs dteventtime）、模式过滤缺失、坐标提取逻辑。\",\n    \"步骤2: 判断日期字段：用户需求为\"局内数据按天分布\"，dteventtime 注释明确为\"游戏事件的时间\"，语义更贴合需求，应改用 dteventtime 过滤和分组。\",\n    \"步骤3: 判断模式过滤：schema 无模式字段，表名 vsteaminfectlog 暗示为突变组竞专用表，暂不补充过滤条件。\",\n    \"步骤4: 验证坐标提取：SUBSTRING+LOCATE 对\"时间+类型+x+y+z\"格式可正确提取第3/4/5段，逻辑自洽，保留原写法。\",\n    \"步骤5: 保留 7 种类型 UNION ALL 结构、各分支非空过滤、GROUP BY/ORDER BY 输出格式均符合需求，仅修正日期字段。\",\n    \"步骤6: 输出修正后 SQL，使用 DATE(dteventtime) 过滤并以 DATE_FORMAT 生成统计日期。\"\n  ],\n  \"regenerate\": true,\n  \"reason\": \"当前 SQL 使用 tdbank_imp_date 过滤，语义不明；应改用 dteventtime（游戏事件时间）更准确匹配\"局内数据按天分布\"需求。\",\n  \"fixed_sql\": \"WITH all_data AS (\\n    SELECT \\n        DATE_FORMAT(dteventtime, '%Y%m%d') AS 统计日期,\\n        '变身速行战士' AS 类型,\\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \\n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\\n        ) AS DECIMAL(10,1)), 1) AS x,\\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \\n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\\n        ) AS DECIMAL(10,1)), 1) AS y,\\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\\n        ) AS DECIMAL(10,1)), 1) AS z\\n    FROM dwd_jordass_vsteaminfectlog_hi\\n    WHERE DATE(dteventtime) = '2022-04-25'\\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\\n\\n    UNION ALL\\n\\n    SELECT \\n        DATE_FORMAT(dteventtime, '%Y%m%d') AS 统计日期,\\n        '变身隐形战士' AS 类型,\\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \\n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\\n        ) AS DECIMAL(10,1)), 1) AS x,\\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \\n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\\n        ) AS DECIMAL(10,1)), 1) AS y,\\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\\n        ) AS DECIMAL(10,1)), 1) AS z\\n    FROM dwd_jordass_vsteaminfectlog_hi\\n    WHERE DATE(dteventtime) = '2022-04-25'\\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\\n\\n    UNION ALL\\n\\n    SELECT \\n        DATE_FORMAT(dteventtime, '%Y%m%d') AS 统计日期,\\n        '变身钩链战士' AS 类型,\\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \\n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\\n        ) AS DECIMAL(10,1)), 1) AS x,\\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \\n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\\n        ) AS DECIMAL(10,1)), 1) AS y,\\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\\n        ) AS DECIMAL(10,1)), 1) AS z\\n    FROM dwd_jordass_vsteaminfectlog_hi\\n    WHERE DATE(dteventtime) = '2022-04-25'\\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\\n\\n    UNION ALL\\n\\n    SELECT \\n        DATE_FORMAT(dteventtime, '%Y%m%d') AS 统计日期,\\n        '变身强能猎手' AS 类型,\\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \\n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\\n        ) AS DECIMAL(10,1)), 1) AS x,\\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \\n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\\n        ) AS DECIMAL(10,1)), 1) AS y,\\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\\n        ) AS DECIMAL(10,1)), 1) AS z\\n    FROM dwd_jordass_vsteaminfectlog_hi\\n    WHERE DATE(dteventtime) = '2022-04-25'\\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\\n\\n    UNION ALL\\n\\n    SELECT \\n        DATE_FORMAT(dteventtime, '%Y%m%d') AS 统计日期,\\n        '变身冰霜领主' AS 类型,\\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \\n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\\n        ) AS DECIMAL(10,1)), 1) AS x,\\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \\n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\\n        ) AS DECIMAL(10,1)), 1) AS y,\\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\\n        ) AS DECIMAL(10,1)), 1) AS z\\n    FROM dwd_jordass_vsteaminfectlog_hi\\n    WHERE DATE(dteventtime) = '2022-04-25'\\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\\n\\n    UNION ALL\\n\\n    SELECT \\n        DATE_FORMAT(dteventtime, '%Y%m%d') AS 统计日期,\\n        '变身强化战士' AS 类型,\\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \\n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\\n        ) AS DECIMAL(10,1)), 1) AS x,\\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \\n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\\n        ) AS DECIMAL(10,1)), 1) AS y,\\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\\n        ) AS DECIMAL(10,1)), 1) AS z\\n    FROM dwd_jordass_vsteaminfectlog_hi\\n    WHERE DATE(dteventtime) = '2022-04-25'\\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\\n\\n    UNION ALL\\n\\n    SELECT \\n        DATE_FORMAT(dteventtime, '%Y%m%d') AS 统计日期,\\n        '变身龙焰猎手' AS 类型,\\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \\n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\\n        ) AS DECIMAL(10,1)), 1) AS x,\\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \\n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\\n        ) AS DECIMAL(10,1)), 1) AS y,\\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\\n        ) AS DECIMAL(10,1)), 1) AS z\\n    FROM dwd_jordass_vsteaminfectlog_hi\\n    WHERE DATE(dteventtime) = '2022-04-25'\\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\\n)\\nSELECT \\n    统计日期,\\n    类型,\\n    x,\\n    y,\\n    z,\\n    COUNT(*) AS 次数\\nFROM all_data\\nGROUP BY 统计日期, 类型, x, y, z\\nORDER BY 统计日期, 类型, 次数 DESC\"\n}\n```", "parsed": {"plan_steps": [], "analysis_plan": "", "regenerate": false, "reason": "", "fixed_sql": ""}}], "prompt": "【任务指引】请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。\n【问题分类】[活跃分布] 问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\n【用户问题】\n。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n【数据库schema（仅能使用以下字段与表）】\n描述，以及可能用到的\n【参考信息】\n，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n【待评审SQL】\nWITH all_data AS (\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身速行战士' AS 类型,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(SwiftMorphInfo, \n            LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, LOCATE('+', SwiftMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND SwiftMorphInfo IS NOT NULL AND SwiftMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身隐形战士' AS 类型,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(StealthMorphInfo, \n            LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, LOCATE('+', StealthMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND StealthMorphInfo IS NOT NULL AND StealthMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身钩链战士' AS 类型,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(GrappleMorphInfo, \n            LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, LOCATE('+', GrappleMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND GrappleMorphInfo IS NOT NULL AND GrappleMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强能猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(HeroMorphInfo, \n            LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, LOCATE('+', HeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND HeroMorphInfo IS NOT NULL AND HeroMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身冰霜领主' AS 类型,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(IceAdvMorphInfo, \n            LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, LOCATE('+', IceAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND IceAdvMorphInfo IS NOT NULL AND IceAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身强化战士' AS 类型,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(PowerAdvMorphInfo, \n            LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, LOCATE('+', PowerAdvMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND PowerAdvMorphInfo IS NOT NULL AND PowerAdvMorphInfo != ''\n\n    UNION ALL\n\n    SELECT \n        LEFT(tdbank_imp_date, 8) AS 统计日期,\n        '变身龙焰猎手' AS 类型,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS x,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1,\n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) \n            - LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) - 1\n        ) AS DECIMAL(10,1)), 1) AS y,\n        ROUND(CAST(SUBSTRING(DragonHeroMorphInfo, \n            LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, LOCATE('+', DragonHeroMorphInfo, 1) + 1) + 1) + 1) + 1\n        ) AS DECIMAL(10,1)), 1) AS z\n    FROM dwd_jordass_vsteaminfectlog_hi\n    WHERE tdbank_imp_date LIKE '20220425%'\n      AND DragonHeroMorphInfo IS NOT NULL AND DragonHeroMorphInfo != ''\n)\nSELECT \n    统计日期,\n    类型,\n    x,\n    y,\n    z,\n    COUNT(*) AS 次数\nFROM all_data\nGROUP BY 统计日期, 类型, x, y, z\nORDER BY 统计日期, 类型, 次数 DESC\n"}
