[
  {
    "question_id": "sql_1",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2025.07.24的手游全量用户且标签为其他，在竞品业务下2025.05.30-2025.07.24的在线时长。\n输出：suserid、sgamecode、ionlinetime\n\n【数据库schema】\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT '统计日期YYYYMMDD',\n  `saccounttype` TEXT COMMENT '帐号类型:QQ号或者微信',\n  `suserid` TEXT COMMENT '帐号',\n  `suseridtype` TEXT COMMENT '帐号类型:qq wxid playerid',\n  `sgamecode` TEXT COMMENT '业务',\n  `splattype` TEXT COMMENT '平台类型(大平台)。枚举值为Android/ iOS，取汇总时取-100',\n  `splat` TEXT COMMENT '平台(小平台)。备注：写死的-100',\n  `sgameparam` TEXT COMMENT '场次',\n  `schannel` TEXT COMMENT '不可用字段，用户可以忽略',\n  `sip` TEXT COMMENT '实际上是当日登录的最小时间戳，即最早登录时间',\n  `sclientver` TEXT COMMENT '客户端版本',\n  `ilevel` BIGINT COMMENT '用户等级。不可用',\n  `iviplevel` BIGINT COMMENT 'Vip等级。不可用',\n  `itimes` BIGINT COMMENT '活跃总次数。备注：该字段表示用户在T日的当日活跃总次数',\n  `ionlinetime` BIGINT COMMENT '活跃总时间。备注：该字段表示用户在T日的当日活跃总时间'\n);\nCREATE TABLE `dim_vplayerid_vies_df` (\n  `dtstatdate` TEXT COMMENT '统计日期',\n  `vgameappid` TEXT COMMENT '系统',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suserid类型',\n  `itag` TEXT COMMENT '用户分层标签',\n  `is_reg` BIGINT COMMENT '是否当日新进',\n  `is_actv` BIGINT COMMENT '是否当日活跃',\n  `is_neibu` BIGINT COMMENT '是否内部玩家',\n  `is_lowfps` BIGINT COMMENT '是否新进低帧率',\n  `cbitmap` TEXT COMMENT '活跃位图最左最新活跃',\n  `gender` TEXT COMMENT '性别',\n  `province` TEXT COMMENT '省份',\n  `city` TEXT COMMENT '城市',\n  `city_level` TEXT COMMENT '城市等级',\n  `iregdate` TEXT COMMENT '注册日期',\n  `iregdate_agamek6` TEXT COMMENT '注册日期_端游',\n  `lastdate` TEXT COMMENT '最后活跃日期',\n  `lastdate_agamek6` TEXT COMMENT '最后活跃日期_端游',\n  `lastdays` BIGINT COMMENT '当日距离最后活跃的天数',\n  `lastdays_agamek6` BIGINT COMMENT '当日距离最后活跃的天数_未注册为-1_当日活跃为1_上日活跃为2',\n  `lastdays_fps` BIGINT COMMENT 'FPS手游',\n  `lastdays_vie1` BIGINT COMMENT '战役先锋手游 esports',\n  `lastdays_vie2` BIGINT COMMENT '突出重围 mobile_live',\n  `lastdays_vie3` BIGINT COMMENT '枪火争锋手游 allianceforce',\n  `lastdays_vie4` BIGINT COMMENT '豪杰对决 strategy',\n  `lastdays_vie5` BIGINT COMMENT '砺刃使者 jordass',\n  `lastdays_vie6` BIGINT COMMENT '天弈 su',\n  `lastdays_vie7` BIGINT COMMENT '勇士召唤手游 playzone',\n  `lastdays_vie8` BIGINT COMMENT '峡谷手游活跃 initiatived',\n  `lastdays_vie9` BIGINT COMMENT '峡谷全量活跃 initiatived',\n  `lastdays_vie10` BIGINT COMMENT '峡谷端游活跃 initiatived',\n  `lastdays_vie11` BIGINT COMMENT '预留',\n  `lastdays_vie12` BIGINT COMMENT '预留',\n  `lastdays_vie13` BIGINT COMMENT '预留',\n  `lastdays_vie14` BIGINT COMMENT '预留',\n  `lastdays_vie15` BIGINT COMMENT '预留',\n  `vtemp1` TEXT COMMENT '预留',\n  `vtemp2` TEXT COMMENT '预留',\n  `vtemp3` TEXT COMMENT '预留',\n  `itemp1` BIGINT COMMENT '预留',\n  `itemp2` BIGINT COMMENT '预留',\n  `itemp3` BIGINT COMMENT '预留'\n);\n\n【参考信息】\n竞品业务：\nsgamecode in (\"initiatived\",\"jordass\",\"esports\",\"allianceforce\",\"strategy\",\"playzone\",\"su\")\nsaccounttype = \"-100\" -- 账号体系，取-100表示汇总\nand suseridtype in (\"qq\",\"wxid\") -- 用户类型\nand splattype = \"-100\" -- 平台类型\nand splat = \"-100\" -- 平台，写死为-100\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是特定时间段内用户的在线时长，属于用户活跃度的分布分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是特定时间段内用户的在线时长，属于用户活跃度的分布分析。\"\n}"
  },
  {
    "question_id": "sql_2",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n提取1个抽样号码包，2025.7.17-2025.7.23期间付费且不包含721号码包内的用户全量\n输出:gplayerid。\n\n【数据库schema】\nCREATE TABLE `dim_extract_311381_conf` (\n  `vplayerid` TEXT\n);\nCREATE TABLE `dws_argothek_ce1_login_di` (\n  `dtstatdate` TEXT COMMENT '统计日期',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT '0 ios,1 android, 255 所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `FriendCount` BIGINT COMMENT '好友数量',\n  `clientversion` TEXT COMMENT '客户端版本',\n  `channel` BIGINT COMMENT '渠道',\n  `uuid` TEXT COMMENT '唯一标识',\n  `deviceid` TEXT COMMENT '设备ID',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间'\n);\nCREATE TABLE `dws_argothek_ce1_cbt2_vplayerid_suserid_di` (\n  `dtstatdate` TEXT COMMENT '统计日期',\n  `vgameappid` TEXT COMMENT '无汇总',\n  `platid` BIGINT COMMENT '0 - Android,1,255',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suserid的类型',\n  `iregdate` TEXT COMMENT '注册日期',\n  `iregway` TEXT COMMENT '注册渠道-不区分platid',\n  `iloginway` TEXT COMMENT '活跃渠道',\n  `sourcename` TEXT COMMENT '开白渠道',\n  `itag` TEXT COMMENT '用户分层标签',\n  `ilevel` BIGINT COMMENT '最新等级',\n  `ionlinetime` TEXT COMMENT '在线时长秒',\n  `iroundtime` TEXT COMMENT '游戏时长秒',\n  `iroundcnt` TEXT COMMENT '对局次数',\n  `fps_avg` TEXT COMMENT '当日平均帧率-gplayerid维度',\n  `is_reg` TEXT COMMENT '是否当日新进',\n  `is_lowfps` TEXT COMMENT '是否低帧率-新进首日平均帧率不高于40且没有帧率数据的用户不计入',\n  `is_match` TEXT COMMENT '是否当日对局',\n  `vtemp1` TEXT COMMENT '预留',\n  `vtemp2` TEXT COMMENT '预留',\n  `vtemp3` TEXT COMMENT '预留',\n  `itemp1` BIGINT COMMENT '预留',\n  `itemp2` BIGINT COMMENT '预留',\n  `itemp3` BIGINT COMMENT '预留'\n);\n\n【参考信息】\n\n\n",
    "output": "",
    "category": "用户分群",
    "category_reason": "该需求旨在从特定时间段内筛选出符合付费条件且排除特定号码包的用户群体，属于用户分群操作。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"用户分群\",\n  \"rationale\": \"该需求旨在从特定时间段内筛选出符合付费条件且排除特定号码包的用户群体，属于用户分群操作。\"\n}"
  },
  {
    "question_id": "sql_3",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2025年1月勇者盟约端游活跃玩家交叉峡谷端游及手游活跃玩家\n输出：玩家gplayerid\n\n【数据库schema】\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT '统计时间',\n  `iuserid` TEXT COMMENT '用户ID',\n  `ilogintime` BIGINT COMMENT '登录时间',\n  `ionlinetime` BIGINT COMMENT '在线时长',\n  `ilevel` BIGINT COMMENT '玩家等级',\n  `iplaytime` BIGINT COMMENT '游戏时长',\n  `iloginway` BIGINT COMMENT '登录渠道',\n  `ilogincount` BIGINT COMMENT '登录次数'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT '日期',\n  `vGameAppid` TEXT COMMENT '平台',\n  `iAreaID` TEXT COMMENT '大区',\n  `iuserid` TEXT COMMENT '用户id',\n  `vRoleID` TEXT COMMENT '角色id',\n  `iVersion` TEXT COMMENT '服务器',\n  `cBitmap` TEXT COMMENT '活跃位图',\n  `iregdate` TEXT COMMENT '注册日期',\n  `swxid_type` TEXT COMMENT 'wx或qq类型',\n  `suserid` TEXT COMMENT '存储qq/wxid如果微信和qq有绑定关系优先qq',\n  `sqq` TEXT COMMENT '该字段为废弃字段，使用转qq时使用suserid',\n  `swxid` TEXT COMMENT '该字段为废弃字段，使用转qq时使用wxid',\n  `itemp1` BIGINT COMMENT '预留字段1',\n  `itemp2` BIGINT COMMENT '预留字段2',\n  `itemp3` BIGINT COMMENT '预留字段3',\n  `itemp4` BIGINT COMMENT '预留字段4',\n  `vtemp1` TEXT COMMENT '预留字段5',\n  `vtemp2` TEXT COMMENT '预留字段6',\n  `vtemp3` TEXT COMMENT '预留字段7',\n  `vtemp4` TEXT COMMENT '预留字段8',\n  `vtemp5` TEXT COMMENT '预留字段9'\n);\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT '统计日期YYYYMMDD',\n  `saccounttype` TEXT COMMENT '帐号类型:QQ号或者微信',\n  `suserid` TEXT COMMENT '帐号',\n  `suseridtype` TEXT COMMENT '帐号类型:qq wxid playerid',\n  `sgamecode` TEXT COMMENT '业务',\n  `splattype` TEXT COMMENT '平台类型(大平台)。枚举值为Android/ iOS，取汇总时取-100',\n  `splat` TEXT COMMENT '平台(小平台)。备注：写死的-100',\n  `sgameparam` TEXT COMMENT '场次',\n  `schannel` TEXT COMMENT '不可用字段，用户可以忽略',\n  `sip` TEXT COMMENT '实际上是当日登录的最小时间戳，即最早登录时间',\n  `sclientver` TEXT COMMENT '客户端版本',\n  `ilevel` BIGINT COMMENT '用户等级。不可用',\n  `iviplevel` BIGINT COMMENT 'Vip等级。不可用',\n  `itimes` BIGINT COMMENT '活跃总次数。备注：该字段表示用户在T日的当日活跃总次数',\n  `ionlinetime` BIGINT COMMENT '活跃总时间。备注：该字段表示用户在T日的当日活跃总时间'\n);\n\n【参考信息】\n峡谷筛选逻辑:\nsgamecode = \"initiatived\" -- 筛选峡谷游戏\nand saccounttype = \"-100\" -- 账号体系，取-100表示汇总\nand suseridtype in (\"qq\", \"wxid\") -- 账号类型，取qq或wxid\nand splattype in (\"-100\", \"PC\") -- 峡谷手游玩家及PC端玩家\nand splat = \"-100\" -- 写死为-100\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是特定时间段内不同游戏的活跃玩家交叉情况，属于跨产品活跃度分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是特定时间段内不同游戏的活跃玩家交叉情况，属于跨产品活跃度分析。\"\n}"
  },
  {
    "question_id": "sql_4",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计开服至今使用频率最高的用户昵称\n2023.07.1200 - 2025071523\n输出：昵称（唯一）、人数\n\n【数据库schema】\nCREATE TABLE `dwd_argothek_playerlogin_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'partition fields',\n  `dteventtime` TEXT COMMENT '事件时间 - YYYY-MM-DD HH:MM:SS',\n  `ieventid` TEXT COMMENT '事件 ID',\n  `vgamesvrid` TEXT COMMENT '服务器 ID - fill 1 if only one server',\n  `vgameappid` TEXT COMMENT 'appid - 无则填0',\n  `iareaid` TEXT COMMENT '大区 ID - if no fill 0',\n  `iuserid` TEXT COMMENT 'Open ID',\n  `vroleid` TEXT COMMENT '角色ID',\n  `ilevel` BIGINT COMMENT '账户等级',\n  `iloginway` BIGINT COMMENT '玩家登录渠道',\n  `iversion` TEXT COMMENT '客户端版本',\n  `vrolename` TEXT COMMENT '玩家名字',\n  `inetbarlevel` TEXT COMMENT '网吧等级 - 0: No netbar information. 1: Gold netbar. 2: Silver netbar. 3: Bronze netbar.',\n  `iseasonid` TEXT COMMENT '赛季ID',\n  `iaccountexp` BIGINT COMMENT '账户经验',\n  `ibpid` TEXT COMMENT 'battlepass ID',\n  `ibplevel` BIGINT COMMENT 'battlepass等级',\n  `ibpexp` BIGINT COMMENT 'battlepass总经验',\n  `iacid` TEXT COMMENT '角色契约 ID',\n  `iaclevel` BIGINT COMMENT '角色契约等级',\n  `iacexp` BIGINT COMMENT '角色契约总经验',\n  `ivpoint` BIGINT COMMENT '玩家拥有VP',\n  `irpoint` BIGINT COMMENT '玩家拥有RP',\n  `icampuslevel` TEXT COMMENT '校园特权等级'\n);\n\n【参考信息】\n昵称筛选逻辑：\nnickname按照#进行划分，取#前半部分的作为nickname\n示例：多喝热水#131234 -> 昵称：多喝热水\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是用户登录频率的统计，属于用户活跃度的分布分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是用户登录频率的统计，属于用户活跃度的分布分析。\"\n}"
  },
  {
    "question_id": "sql_6",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2025.6.12-2025.7.14号手游T2活跃用户在20250529之前端游注册的号码包。\n输出：vplayerid\n\n【数据库schema】\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT '日期',\n  `vGameAppid` TEXT COMMENT '平台',\n  `iAreaID` TEXT COMMENT '大区',\n  `iuserid` TEXT COMMENT '用户id',\n  `vRoleID` TEXT COMMENT '角色id',\n  `iVersion` TEXT COMMENT '服务器',\n  `cBitmap` TEXT COMMENT '活跃位图',\n  `iregdate` TEXT COMMENT '注册日期',\n  `swxid_type` TEXT COMMENT 'wx或qq类型',\n  `suserid` TEXT COMMENT '存储qq/wxid如果微信和qq有绑定关系优先qq',\n  `sqq` TEXT COMMENT '该字段为废弃字段，使用转qq时使用suserid',\n  `swxid` TEXT COMMENT '该字段为废弃字段，使用转qq时使用wxid',\n  `itemp1` BIGINT COMMENT '预留字段1',\n  `itemp2` BIGINT COMMENT '预留字段2',\n  `itemp3` BIGINT COMMENT '预留字段3',\n  `itemp4` BIGINT COMMENT '预留字段4',\n  `vtemp1` TEXT COMMENT '预留字段5',\n  `vtemp2` TEXT COMMENT '预留字段6',\n  `vtemp3` TEXT COMMENT '预留字段7',\n  `vtemp4` TEXT COMMENT '预留字段8',\n  `vtemp5` TEXT COMMENT '预留字段9'\n);\nCREATE TABLE `dws_argothek_ce1_cbt2_vplayerid_suserid_di` (\n  `dtstatdate` TEXT COMMENT '统计日期',\n  `vgameappid` TEXT COMMENT '无汇总',\n  `platid` BIGINT COMMENT '0 - Android,1,255',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suserid的类型',\n  `iregdate` TEXT COMMENT '注册日期',\n  `iregway` TEXT COMMENT '注册渠道-不区分platid',\n  `iloginway` TEXT COMMENT '活跃渠道',\n  `sourcename` TEXT COMMENT '开白渠道',\n  `itag` TEXT COMMENT '用户分层标签',\n  `ilevel` BIGINT COMMENT '最新等级',\n  `ionlinetime` TEXT COMMENT '在线时长秒',\n  `iroundtime` TEXT COMMENT '游戏时长秒',\n  `iroundcnt` TEXT COMMENT '对局次数',\n  `fps_avg` TEXT COMMENT '当日平均帧率-gplayerid维度',\n  `is_reg` TEXT COMMENT '是否当日新进',\n  `is_lowfps` TEXT COMMENT '是否低帧率-新进首日平均帧率不高于40且没有帧率数据的用户不计入',\n  `is_match` TEXT COMMENT '是否当日对局',\n  `vtemp1` TEXT COMMENT '预留',\n  `vtemp2` TEXT COMMENT '预留',\n  `vtemp3` TEXT COMMENT '预留',\n  `itemp1` BIGINT COMMENT '预留',\n  `itemp2` BIGINT COMMENT '预留',\n  `itemp3` BIGINT COMMENT '预留'\n);\n\n【参考信息】\n用户活跃用户筛选条件：\nitag=\"T2\"\n\n",
    "output": "",
    "category": "用户分群",
    "category_reason": "问题关注的是根据注册时间划分特定时间段内的活跃用户群体。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"用户分群\",\n  \"rationale\": \"问题关注的是根据注册时间划分特定时间段内的活跃用户群体。\"\n}"
  },
  {
    "question_id": "sql_7",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2025.7.3-2025.7.6 开白渠道非内部体验和买量测试，排除全平台\n注册渠道为以下，分别的新进用户数\n89903934\n89903933\n89903932\n89902725\n89902724\n89902723\n89900960\n89900961\n89900962\n输出：日期（20250703、...、20250706）、注册渠道、新进用户数\n\n【数据库schema】\nCREATE TABLE `dws_argothek_ce1_cbt2_vplayerid_suserid_di` (\n  `dtstatdate` TEXT COMMENT '统计日期',\n  `vgameappid` TEXT COMMENT '无汇总',\n  `platid` BIGINT COMMENT '0 - Android,1,255',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suserid的类型',\n  `iregdate` TEXT COMMENT '注册日期',\n  `iregway` TEXT COMMENT '注册渠道-不区分platid',\n  `iloginway` TEXT COMMENT '活跃渠道',\n  `sourcename` TEXT COMMENT '开白渠道',\n  `itag` TEXT COMMENT '用户分层标签',\n  `ilevel` BIGINT COMMENT '最新等级',\n  `ionlinetime` TEXT COMMENT '在线时长秒',\n  `iroundtime` TEXT COMMENT '游戏时长秒',\n  `iroundcnt` TEXT COMMENT '对局次数',\n  `fps_avg` TEXT COMMENT '当日平均帧率-gplayerid维度',\n  `is_reg` TEXT COMMENT '是否当日新进',\n  `is_lowfps` TEXT COMMENT '是否低帧率-新进首日平均帧率不高于40且没有帧率数据的用户不计入',\n  `is_match` TEXT COMMENT '是否当日对局',\n  `vtemp1` TEXT COMMENT '预留',\n  `vtemp2` TEXT COMMENT '预留',\n  `vtemp3` TEXT COMMENT '预留',\n  `itemp1` BIGINT COMMENT '预留',\n  `itemp2` BIGINT COMMENT '预留',\n  `itemp3` BIGINT COMMENT '预留'\n);\nCREATE TABLE `dwd_argothek_cbt2kaibai_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'partition fields',\n  `dteventtime` TEXT COMMENT 'dtEventTime',\n  `gplayerid` TEXT COMMENT 'gplayerid',\n  `playerid` TEXT COMMENT 'playerid',\n  `source` TEXT COMMENT 'source',\n  `sourcename` TEXT COMMENT 'sourceName',\n  `acctype` TEXT COMMENT 'acctype',\n  `platid` TEXT COMMENT 'platid',\n  `ext1` TEXT COMMENT 'ext1',\n  `ext2` TEXT COMMENT 'ext2',\n  `ext3` TEXT COMMENT 'ext3',\n  `ext4` TEXT COMMENT 'ext4',\n  `ext5` TEXT COMMENT 'ext5'\n);\n\n【参考信息】\n非内部体验和买量测试：通过sourcename区分\n指定注册渠道:\niregway in (\"89903934\", \"89903933\", \"89903932\", \"89902725\", \"89902724\", \"89902723\", \"89900960\", \"89900961\", \"89900962\")\n\n",
    "output": "",
    "category": "用户分群",
    "category_reason": "问题关注特定渠道的新进用户数统计，属于按渠道划分的用户群体分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"用户分群\",\n  \"rationale\": \"问题关注特定渠道的新进用户数统计，属于按渠道划分的用户群体分析。\"\n}"
  },
  {
    "question_id": "sql_8",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计25年4月到25年6月，按月输出gamePodId的峰值数据与游戏对局数。\n输出：\n月份(2025-04、2025-05、2025-06)\n服务器节点\n峰值时间\n总游戏结束数\n排位结束数\n普通结束数\n极速结束数\n\n【数据库schema】\nCREATE TABLE `dwd_argothek_matchdetails_hi` (\n  `tdbank_imp_date` TEXT COMMENT '分区字段',\n  `dteventtime` TEXT COMMENT 'AP 事件时间: YYYY-MM-DD HH:MM:SS',\n  `apeventid` TEXT COMMENT 'AP 事件标识符',\n  `matchid` TEXT COMMENT 'Ares 匹配 ID - Ares 匹配的 ID 字符串',\n  `mapid` TEXT COMMENT 'Ares 地图 ID - 服务代码中使用的 Ares 地图 ID',\n  `provisioningflowid` TEXT COMMENT '配置流程 ID - 已配置的游戏类型。例如：技能测试、匹配等',\n  `gamepodid` TEXT COMMENT '游戏节点 ID - 游戏节点的字符串表示',\n  `gamelengthmillis` DOUBLE COMMENT '毫秒 - 千分之一秒的单位',\n  `gamestartmillis` DOUBLE COMMENT '毫秒 - 千分之一秒的单位',\n  `gameversion` TEXT COMMENT 'Ares 构建版本 - Ares 二进制文件的完整构建版本',\n  `iscompleted` BIGINT COMMENT '比赛完成标志 - 如果比赛正常结束并有比赛结果，则为 True',\n  `customgamename` TEXT COMMENT 'Ares 自定义游戏名称 - 自定义游戏的名称',\n  `module` TEXT COMMENT 'Ares 射击场模块 - 可以在射击场中游玩的模块',\n  `forcepostprocessing` BIGINT COMMENT '强制后处理标志 - 对于需要启用调试的比赛，该值为 True。',\n  `queueid` TEXT COMMENT 'Ares 队列 ID - Ares 队列的 ID 字符串',\n  `seasonid` TEXT COMMENT '赛季 ID - 赛季的 uuid',\n  `completionstate` TEXT COMMENT 'Ares 完成状态 - 比赛如何完成的字符串值。例如：Completed（完成）, All_Disconnected（全部断开连接）',\n  `ismatchsampled` BIGINT COMMENT '比赛是否被采样标志 - 指示该比赛是否被采样用于遥测',\n  `players` TEXT COMMENT 'AP 子标识符，指向子结构：apMatchDetails_players',\n  `teams` TEXT COMMENT 'AP 子标识符，指向子结构：apMatchDetails_teams',\n  `roundresults` TEXT COMMENT 'AP 子标识符，指向子结构：apMatchDetails_roundResults',\n  `platforminfoplatformtype` TEXT COMMENT '客户端平台类型 - 此事件来源的客户端平台（例如：Mobile 或 PC）',\n  `platforminfoplatformos` TEXT COMMENT '客户端平台操作系统 - 此事件来源的客户端操作系统',\n  `aplogtotal` BIGINT COMMENT '由此 AP 事件生成的日志总数',\n  `platformtype` TEXT COMMENT '客户端平台类型 - 此事件来源的客户端平台（例如：Mobile 或 PC）',\n  `apschemaversion` TEXT COMMENT 'apSchemaVersion'\n);\n\n【参考信息】\n比赛状态逻辑:\nlower(completionState) in (\"completed\", \"surrendered\")\n限定模式（极速模式、排位模式、普通模式）对应逻辑:\nqueueId in (\"swiftplay\", \"competitive\", \"unrated\")\ncount(distinct matchId) 代表比赛场次，峰值时间取每月不同模式最高的dtEventTime\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注游戏对局数在不同月份和服务器节点的分布情况，属于活跃度的时间与维度分布分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注游戏对局数在不同月份和服务器节点的分布情况，属于活跃度的时间与维度分布分析。\"\n}"
  },
  {
    "question_id": "sql_9",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20250702手游fps最后活跃日期为近半年的用户的城市等级分布。\n输出：城市等级，用户人数\n\n【数据库schema】\nCREATE TABLE `dim_mgamejp_account_allinfo_nf` (\n  `dtstatdate` BIGINT COMMENT '统计日期YYYYMMDD',\n  `saccounttype` TEXT COMMENT '帐号类型。0-分游戏的playerid，及汇总的qq，且这些qq都是playerid对应的1-分游戏的playerid，及汇总的wxid，且这些wxid都是playerid对应的-100-汇总',\n  `suserid` TEXT COMMENT '帐号。当存储的是playerid账号类型时，对于新游存储的是gplayerid，对于老游戏存储的是playerid',\n  `suseridtype` TEXT COMMENT '帐号类型。取值为qq/wxid/playerid，没有-100',\n  `sgamecode` TEXT COMMENT '游戏id。取值为-100时表示汇总，其它取值为各单业务的游戏id，例如取值为strategy时表示豪杰对决',\n  `splattype` TEXT COMMENT '平台类型(大平台)。取值为-100时表示汇总，取值为Android时表示安卓平台，取值为iOS时表示苹果平台',\n  `splat` TEXT COMMENT '平台(小平台)。备注：写死的-100',\n  `iregdate` BIGINT COMMENT '注册日期YYYYMMDD',\n  `ilastactdate` BIGINT COMMENT '最后活跃日期YYYYMMDD',\n  `sdayacti` TEXT COMMENT '最近65天每天活跃情况。以二进制位图形式存储，每一位表示一天的活跃情况，1表示活跃，0表示未活跃。最左的一位表示T日，以此类推',\n  `sweekacti` TEXT COMMENT '最近60周活跃情况。用法同上',\n  `smonthacti` TEXT COMMENT '最近60月活跃情况。用法同上',\n  `sgroup` TEXT COMMENT '用来标识用户是否付费用户，是否包月用户等等备注：该字段实际上表示注册的时间戳，2018-04之前以YYYYMMDD格式，2018-04之后以YYYYMMDDHHMMSS格式',\n  `ilevel` BIGINT COMMENT '用户等级。废弃字段',\n  `iviplevel` BIGINT COMMENT 'Vip等级。废弃字段',\n  `itimes` BIGINT COMMENT '活跃总次数备注：该字段表示用户从注册到T日的累计活跃总次数，注意是累计值',\n  `ionlinetime` BIGINT COMMENT '活跃总时间备注：该字段表示用户从注册到T日的累计活跃总时间，注意是累计值，单位为秒；存在负数，使用时需要剔除'\n);\nCREATE TABLE `dim_uf_player_gameinfo_mf` (\n  `kp_imp_date` TEXT COMMENT '分区字段格式YYYYMM',\n  `id_type` TEXT COMMENT '账号类型：qq/wx',\n  `userid` TEXT COMMENT '账号',\n  `gender` BIGINT COMMENT '性别（1男2女）',\n  `city` TEXT COMMENT '城市',\n  `province` TEXT COMMENT '省份',\n  `city_level` TEXT COMMENT '城市等级'\n);\n\n【参考信息】\n用户固定筛选逻辑:\nand saccounttype = \"-100\" -- 账户类型为-100\nand suseridtype in (\"qq\",\"wxid\") -- 用户类型为qq或wxid\nand sgamecode in (\"esports\",\"mobile_live\",\"initiatived\",\"allianceforce\",\"strategy\",\"jordass\",\"su\",\"playzone\",\"battlezone\",\"battlearena\",\"weapon\",\"playhub\",\"manager\",\"apgame\") -- 游戏代码为指定的手游fps\nand splattype = \"-100\" -- 平台类型为-100\n活跃日期逻辑:\n基于当前统计时间20250702向前计算6个月的登陆日期，即ilastactdate >= \"20250104\"\n城市等级分布：\n当前时间为20250702，城市等级分布的相关表是月表，所以需要取kp_imp_date = \"202506\"的数据作为关联数据\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是特定时间范围内活跃用户的地理分布情况。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是特定时间范围内活跃用户的地理分布情况。\"\n}"
  },
  {
    "question_id": "sql_10",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2023.7.12-2025.6.15，赛季bp道具皮肤的使用情况。\n输出：道具id、赛季名称、当前赛季使用人数、当前赛季购买人数\n\n【数据库schema】\nCREATE TABLE `dwd_argothek_playerloadout_expressions_hi` (\n  `tdbank_imp_date` TEXT COMMENT '分区字段',\n  `dteventtime` TEXT COMMENT 'AP 事件时间',\n  `apeventid` TEXT COMMENT 'AP 事件标识符',\n  `apchildid` TEXT COMMENT 'AP 子标识符',\n  `apchildindex` BIGINT COMMENT 'AP 子索引',\n  `expressionassetid` TEXT COMMENT '表情资源 ID',\n  `expressiontypeid` TEXT COMMENT '表情类型 ID'\n);\nCREATE TABLE `dwd_argothek_playerloadout_hi` (\n  `tdbank_imp_date` TEXT COMMENT '分区字段',\n  `dteventtime` TEXT COMMENT 'AP 事件时间: YYYY-MM-DD HH:MM:SS',\n  `apeventid` TEXT COMMENT 'AP 事件标识符',\n  `subject` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO 玩家 ID: Riot 玩家的全局唯一 ID',\n  `matchinfoversion` TEXT COMMENT 'Ares 构建版本 - Ares 二进制文件的完整构建版本',\n  `matchinfogamemode` TEXT COMMENT 'Ares 游戏模式 - 正在进行的比赛类型',\n  `matchinfomapid` TEXT COMMENT 'Ares 地图 - Ares 地图的名称',\n  `matchinfomatchid` TEXT COMMENT 'Ares 匹配 ID - Ares 匹配的 ID 字符串',\n  `matchinfoqueueid` TEXT COMMENT 'Ares 队列 ID - Ares 队列的 ID 字符串',\n  `matchinfoisranked` BIGINT COMMENT '布尔值 - 一个布尔值',\n  `matchinfoprvflowid` TEXT COMMENT '配置流程 ID - 已配置的游戏类型。例如：技能测试、匹配等',\n  `equippables` TEXT COMMENT 'AP 子标识符，指向子结构：apPlayerLoadout_equippables',\n  `sprayslots` TEXT COMMENT 'AP 子标识符，指向子结构：apPlayerLoadout_spraySlots',\n  `playercardid` TEXT COMMENT '玩家卡片 ID - 玩家卡片的标识符',\n  `playertitleid` TEXT COMMENT '玩家称号 ID - 玩家称号的标识符',\n  `characterid` TEXT COMMENT '角色 ID - 角色的标识符。',\n  `scopeenvironment` TEXT COMMENT 'RFC 190-2 环境 - 按运营商划分的用于共同目的（游戏）服务的逻辑分组',\n  `scopedatacenter` TEXT COMMENT 'RFC 190-2 数据中心 - 使用标准数据中心代码的服务物理位置',\n  `scopedeployment` TEXT COMMENT 'RFC 190-2 部署 - 服务的逻辑分组，允许同一数据中心和环境中相同应用程序的独立分组',\n  `scopeproduct` TEXT COMMENT 'RFC 190-2 产品 - 一套或多套共同开发、交付和运营的相关服务',\n  `scopecomponent` TEXT COMMENT 'RFC 190-2 组件 - 实施产品部分工作的特定（子）组件',\n  `aplogtotal` BIGINT COMMENT '由此 AP 事件生成的日志总数',\n  `clientplatformdetailsplatformtype` TEXT COMMENT 'clientPlatformDetailsPlatformType',\n  `clientplatformdetailsplatformmetadata` TEXT COMMENT 'clientPlatformDetailsPlatformMetadata',\n  `apschemaversion` TEXT COMMENT 'apSchemaVersion'\n);\nCREATE TABLE `dwd_argothek_playerloadout_sprayslots_hi` (\n  `tdbank_imp_date` TEXT COMMENT '分区字段',\n  `dteventtime` TEXT COMMENT 'AP 事件时间: YYYY-MM-DD HH:MM:SS',\n  `apeventid` TEXT COMMENT 'AP 事件标识符，由 TLIS 生成',\n  `apchildid` TEXT COMMENT 'AP 子标识符，由 TLIS 生成，并在主条目 apPlayerLoadout.spraySlots 中引用',\n  `apchildindex` BIGINT COMMENT 'AP 子索引，由 TLIS 生成',\n  `sprayslotid` TEXT COMMENT '喷漆槽位 ID - 喷漆槽位标识符',\n  `sprayid` TEXT COMMENT '喷漆 ID - 喷漆标识符',\n  `spraylevelid` TEXT COMMENT '喷漆等级 ID - 喷漆等级标识符',\n  `subject` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO 玩家 ID: Riot 玩家的全局唯一 ID',\n  `matchinfoversion` TEXT COMMENT 'Ares 构建版本 - Ares 二进制文件的完整构建版本',\n  `matchinfomatchid` TEXT COMMENT 'Ares 匹配 ID - Ares 匹配的 ID 字符串',\n  `matchinfogamemode` TEXT COMMENT 'Ares 游戏模式 - 正在进行的比赛类型',\n  `matchinfomapid` TEXT COMMENT 'Ares 地图 - Ares 地图的名称',\n  `matchinfoqueueid` TEXT COMMENT 'Ares 队列 ID - Ares 队列的 ID 字符串',\n  `matchinfoisranked` BIGINT COMMENT '布尔值 - 一个布尔值',\n  `matchinfoprvflowid` TEXT COMMENT '配置流程 ID - 已配置的游戏类型。例如：技能测试、匹配等'\n);\nCREATE TABLE `dwd_argothek_commercialization_gearid_df` (\n  `dtstatdate` TEXT COMMENT '日期',\n  `idate` TEXT COMMENT '道具购买日期',\n  `purchaseSource` TEXT COMMENT '购买来源',\n  `purchasedItemId` TEXT COMMENT '道具id',\n  `itemtype` TEXT COMMENT '道具类型',\n  `itemAmount` DOUBLE COMMENT '道具数量',\n  `currencyType` TEXT COMMENT '购买道具消耗货币类型',\n  `currencySpent` DOUBLE COMMENT '购买道具消耗货币金额',\n  `itemp1` BIGINT COMMENT '预留字段1',\n  `itemp2` BIGINT COMMENT '预留字段2',\n  `itemp3` BIGINT COMMENT '预留字段3',\n  `itemp4` BIGINT COMMENT '预留字段4',\n  `vtemp1` TEXT COMMENT '预留字段5',\n  `vtemp2` TEXT COMMENT '预留字段6',\n  `vtemp3` TEXT COMMENT '预留字段7',\n  `vtemp4` TEXT COMMENT '预留字段8',\n  `vtemp5` TEXT COMMENT '预留字段9'\n);\nCREATE TABLE `dim_argothek_seasondate_df` (\n  `dtstatdate` TEXT COMMENT '数据日期',\n  `idate` TEXT COMMENT '赛季日期',\n  `seasonid` TEXT COMMENT '赛季ID',\n  `seasonidname` TEXT COMMENT '赛季名称',\n  `itemp1` BIGINT COMMENT 'itemp1',\n  `itemp2` BIGINT COMMENT 'itemp2',\n  `vtemp1` TEXT COMMENT 'vtemp1',\n  `vtemp2` TEXT COMMENT 'vtemp2'\n);\n\n【参考信息】\nbp枪皮购买逻辑:\nand purchaseSource = \"BATTLEPASS_PROGRESS\" -- 筛选来源为BATTLEPASS_PROGRESS\nand itemtype = \"d5f120f8-ff8c-4aac-92ea-f2b5acbe9475\" -- 筛选itemtype为指定值\n枪皮使用逻辑：\nexpressionassetid is not null and expressiontypeid = \"d5f120f8-ff8c-4aac-92ea-f2b5acbe9475\"\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "统计特定时间段内赛季bp道具皮肤的使用情况，属于对用户行为在时间维度上的分布分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"统计特定时间段内赛季bp道具皮肤的使用情况，属于对用户行为在时间维度上的分布分析。\"\n}"
  },
  {
    "question_id": "sql_11",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计近30天活跃玩家数，近30天活跃且同时拥有奖池所有道具玩家数\n输出：近30天活跃玩家数、近30天活跃且同时拥有奖池所有道具玩家数\n补充说明：\n当前日期时间：'20250617'\n其中奖池道具id为：\n71d260ca-4bad-81f2-0298-44860341a7a6\n48601754-442d-98cb-2109-3fb2075500ec\na9126263-439c-7be6-d668-52a6c0c0a36f\n34ecc788-4034-71d2-a0ac-c398b8ecb2ae\n56f98991-43f8-dcc8-189e-08b7ae6c42ad\n8453f8ef-4c0b-46e2-8768-3e9e45c67a2c\n06d90274-435f-3e32-9d57-26bc228ae2e5\n8196dea4-4229-c951-13a9-088fb13b3512\n3abc330f-444a-6dfd-5863-81856ba62624\n041a43a4-46fe-dab7-c974-36bf91eab33d\n5b863cb9-4e41-ec89-69ee-49a223d05ff1\n\n【数据库schema】\nCREATE TABLE `dwd_argothek_gearrecord_df` (\n  `dtstatdate` TEXT COMMENT '统计日期',\n  `vgameappid` TEXT COMMENT 'appid',\n  `iareaid` TEXT COMMENT '大区ID',\n  `iuserid` TEXT COMMENT 'iuserid',\n  `vRoleID` TEXT COMMENT 'vRoleID',\n  `iGoodsType` TEXT COMMENT '道具类型',\n  `iGoodsId` TEXT COMMENT '道具ID',\n  `iCount` BIGINT COMMENT '道具数量',\n  `iCount1` BIGINT COMMENT '道具数量且订单id不为空',\n  `vtemp1` TEXT COMMENT '预留',\n  `vtemp2` TEXT COMMENT '预留',\n  `vtemp3` TEXT COMMENT '预留',\n  `itemp1` BIGINT COMMENT '预留',\n  `itemp2` BIGINT COMMENT '预留',\n  `itemp3` BIGINT COMMENT '预留'\n);\nCREATE TABLE `dws_argothek_oss_useractivity_df` (\n  `statis_date` BIGINT COMMENT '统计日期',\n  `iworldid` BIGINT COMMENT '大区ID',\n  `iuserid` TEXT COMMENT '用户ID',\n  `ilevel` BIGINT COMMENT '玩家等级',\n  `igroup` BIGINT COMMENT '是否付费',\n  `iactivity` TEXT COMMENT '玩家登陆位图,首位为0,最长100位,1表示当天活跃,0表示当天未活跃',\n  `iregdate` BIGINT COMMENT '注册日期,这里的注册日期是首次活跃日期,如果注册数据有单独日志表,则忽略此字段',\n  `iloginway` BIGINT COMMENT '登录渠道',\n  `iregway` BIGINT COMMENT '注册渠道',\n  `vlastlogindate` TEXT COMMENT '最后登录日期'\n);\n\n【参考信息】\n这张表的iworldid = 255代表玩家粒度， 奖池道具筛选逻辑：\niGoodsId in (\n\"71d260ca-4bad-81f2-0298-44860341a7a6\",\n\"48601754-442d-98cb-2109-3fb2075500ec\",\n\"a9126263-439c-7be6-d668-52a6c0c0a36f\",\n\"34ecc788-4034-71d2-a0ac-c398b8ecb2ae\",\n\"56f98991-43f8-dcc8-189e-08b7ae6c42ad\",\n\"8453f8ef-4c0b-46e2-8768-3e9e45c67a2c\",\n\"06d90274-435f-3e32-9d57-26bc228ae2e5\",\n\"8196dea4-4229-c951-13a9-088fb13b3512\",\n\"3abc330f-444a-6dfd-5863-81856ba62624\",\n\"041a43a4-46fe-dab7-c974-36bf91eab33d\",\n\"5b863cb9-4e41-ec89-69ee-49a223d05ff1\"\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注近30天活跃玩家的统计及特定道具持有情况，属于活跃用户在时间维度上的分布与特征分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注近30天活跃玩家的统计及特定道具持有情况，属于活跃用户在时间维度上的分布与特征分析。\"\n}"
  },
  {
    "question_id": "sql_13",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20230712以来，历史累计活跃30天以上，但3月12日及以后未活跃过的用户且剔除掉历史充值 1500 元以上的用户后的玩家wxid\n输出：玩家wxid\n时间统计范围:20230712-20250612\n\n【数据库schema】\nCREATE TABLE `dim_mgamejp_tbplayerid2wxid_nf` (\n  `dtstatdate` BIGINT COMMENT '统计日期YYYYMMDD',\n  `sappid` TEXT COMMENT '游戏id',\n  `splayerid` TEXT COMMENT 'playerid',\n  `swxid` TEXT COMMENT '帐号'\n);\nCREATE TABLE `dws_argothek_oss_portaltransaction_di` (\n  `statis_date` TEXT COMMENT '统计时间',\n  `iworldid` BIGINT COMMENT 'portal一般获取不到大区ID,建议不要使用此数据做分大区统计',\n  `iuserid` TEXT COMMENT '用户ID',\n  `vspoaid` TEXT COMMENT '支付业务代码',\n  `ftrantime` TEXT COMMENT '支付发生时间',\n  `ftranplat` TEXT COMMENT '支付平台',\n  `ftransource` TEXT COMMENT '支付渠道,非业务侧定义的用户渠道',\n  `ftranrealamt` BIGINT COMMENT '折前支付金额',\n  `ftranamt` BIGINT COMMENT '折后支付金额',\n  `vpf` TEXT COMMENT '支付PF字段',\n  `ext_str1` TEXT COMMENT '支付信息字段',\n  `vusertype` TEXT COMMENT '用户类型,qq或wx',\n  `extcol1` BIGINT COMMENT '玩家等级',\n  `vextcol1` TEXT COMMENT '游戏时长',\n  `offerid` TEXT COMMENT 'offerid'\n);\nCREATE TABLE `dim_mgamejp_idconversion_wxid_qq_nf` (\n  `dtstatdate` BIGINT COMMENT '统计日期YYYYMMDD',\n  `swxid` TEXT COMMENT '微信wxid',\n  `iqq` BIGINT COMMENT 'QQ号'\n);\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT '统计时间',\n  `iuserid` TEXT COMMENT '用户ID',\n  `ilogintime` BIGINT COMMENT '登录时间',\n  `ionlinetime` BIGINT COMMENT '在线时长',\n  `ilevel` BIGINT COMMENT '玩家等级',\n  `iplaytime` BIGINT COMMENT '游戏时长',\n  `iloginway` BIGINT COMMENT '登录渠道',\n  `ilogincount` BIGINT COMMENT '登录次数'\n);\nCREATE TABLE `dim_mgamejp_tbplayerid2qq_nf` (\n  `dtstatdate` BIGINT COMMENT '统计日期YYYYMMDD',\n  `sappid` TEXT COMMENT '游戏id',\n  `splayerid` TEXT COMMENT 'playerid',\n  `iqq` BIGINT COMMENT 'QQ帐号'\n);\n\n【参考信息】\n历史充值1500以上的用户：\nsum(ftranamt)/100 > 1500\n限制sappid in (\"qq\",\"wx\")\n\n",
    "output": "",
    "category": "用户分群",
    "category_reason": "该需求旨在识别特定活跃行为与付费特征的用户群体，属于用户分群分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"用户分群\",\n  \"rationale\": \"该需求旨在识别特定活跃行为与付费特征的用户群体，属于用户分群分析。\"\n}"
  },
  {
    "question_id": "sql_14",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2025年5月份活跃但2025年6月未活跃的qq号码包\n输出:用户suserid\n\n【数据库schema】\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT '统计时间',\n  `iuserid` TEXT COMMENT '用户ID',\n  `ilogintime` BIGINT COMMENT '登录时间',\n  `ionlinetime` BIGINT COMMENT '在线时长',\n  `ilevel` BIGINT COMMENT '玩家等级',\n  `iplaytime` BIGINT COMMENT '游戏时长',\n  `iloginway` BIGINT COMMENT '登录渠道',\n  `ilogincount` BIGINT COMMENT '登录次数'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT '日期',\n  `vGameAppid` TEXT COMMENT '平台',\n  `iAreaID` TEXT COMMENT '大区',\n  `iuserid` TEXT COMMENT '用户id',\n  `vRoleID` TEXT COMMENT '角色id',\n  `iVersion` TEXT COMMENT '服务器',\n  `cBitmap` TEXT COMMENT '活跃位图',\n  `iregdate` TEXT COMMENT '注册日期',\n  `swxid_type` TEXT COMMENT 'wx或qq类型',\n  `suserid` TEXT COMMENT '存储qq/wxid如果微信和qq有绑定关系优先qq',\n  `sqq` TEXT COMMENT '该字段为废弃字段，使用转qq时使用suserid',\n  `swxid` TEXT COMMENT '该字段为废弃字段，使用转qq时使用wxid',\n  `itemp1` BIGINT COMMENT '预留字段1',\n  `itemp2` BIGINT COMMENT '预留字段2',\n  `itemp3` BIGINT COMMENT '预留字段3',\n  `itemp4` BIGINT COMMENT '预留字段4',\n  `vtemp1` TEXT COMMENT '预留字段5',\n  `vtemp2` TEXT COMMENT '预留字段6',\n  `vtemp3` TEXT COMMENT '预留字段7',\n  `vtemp4` TEXT COMMENT '预留字段8',\n  `vtemp5` TEXT COMMENT '预留字段9'\n);\n\n【参考信息】\n限定dim_argothek_gplayerid2qqwxid_df的日期为\"20250610\"\n\n",
    "output": "",
    "category": "留存类",
    "category_reason": "问题关注的是5月活跃用户在6月是否流失，属于典型的留存与流失分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注的是5月活跃用户在6月是否流失，属于典型的留存与流失分析。\"\n}"
  },
  {
    "question_id": "sql_15",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2025年5月勇者盟约流失用户中，流向峡谷PC的玩家gplayerid\n输出：玩家gplayerid\n\n【数据库schema】\nCREATE TABLE `dws_argothek_oss_useractivity_df` (\n  `statis_date` BIGINT COMMENT '统计日期',\n  `iworldid` BIGINT COMMENT '大区ID',\n  `iuserid` TEXT COMMENT '用户ID',\n  `ilevel` BIGINT COMMENT '玩家等级',\n  `igroup` BIGINT COMMENT '是否付费',\n  `iactivity` TEXT COMMENT '玩家登陆位图,首位为0,最长100位,1表示当天活跃,0表示当天未活跃',\n  `iregdate` BIGINT COMMENT '注册日期,这里的注册日期是首次活跃日期,如果注册数据有单独日志表,则忽略此字段',\n  `iloginway` BIGINT COMMENT '登录渠道',\n  `iregway` BIGINT COMMENT '注册渠道',\n  `vlastlogindate` TEXT COMMENT '最后登录日期'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT '日期',\n  `vGameAppid` TEXT COMMENT '平台',\n  `iAreaID` TEXT COMMENT '大区',\n  `iuserid` TEXT COMMENT '用户id',\n  `vRoleID` TEXT COMMENT '角色id',\n  `iVersion` TEXT COMMENT '服务器',\n  `cBitmap` TEXT COMMENT '活跃位图',\n  `iregdate` TEXT COMMENT '注册日期',\n  `swxid_type` TEXT COMMENT 'wx或qq类型',\n  `suserid` TEXT COMMENT '存储qq/wxid如果微信和qq有绑定关系优先qq',\n  `sqq` TEXT COMMENT '该字段为废弃字段，使用转qq时使用suserid',\n  `swxid` TEXT COMMENT '该字段为废弃字段，使用转qq时使用wxid',\n  `itemp1` BIGINT COMMENT '预留字段1',\n  `itemp2` BIGINT COMMENT '预留字段2',\n  `itemp3` BIGINT COMMENT '预留字段3',\n  `itemp4` BIGINT COMMENT '预留字段4',\n  `vtemp1` TEXT COMMENT '预留字段5',\n  `vtemp2` TEXT COMMENT '预留字段6',\n  `vtemp3` TEXT COMMENT '预留字段7',\n  `vtemp4` TEXT COMMENT '预留字段8',\n  `vtemp5` TEXT COMMENT '预留字段9'\n);\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT '统计日期YYYYMMDD',\n  `saccounttype` TEXT COMMENT '帐号类型:QQ号或者微信',\n  `suserid` TEXT COMMENT '帐号',\n  `suseridtype` TEXT COMMENT '帐号类型:qq wxid playerid',\n  `sgamecode` TEXT COMMENT '业务',\n  `splattype` TEXT COMMENT '平台类型(大平台)。枚举值为Android/ iOS，取汇总时取-100',\n  `splat` TEXT COMMENT '平台(小平台)。备注：写死的-100',\n  `sgameparam` TEXT COMMENT '场次',\n  `schannel` TEXT COMMENT '不可用字段，用户可以忽略',\n  `sip` TEXT COMMENT '实际上是当日登录的最小时间戳，即最早登录时间',\n  `sclientver` TEXT COMMENT '客户端版本',\n  `ilevel` BIGINT COMMENT '用户等级。不可用',\n  `iviplevel` BIGINT COMMENT 'Vip等级。不可用',\n  `itimes` BIGINT COMMENT '活跃总次数。备注：该字段表示用户在T日的当日活跃总次数',\n  `ionlinetime` BIGINT COMMENT '活跃总时间。备注：该字段表示用户在T日的当日活跃总时间'\n);\n\n【参考信息】\nsgamecode = \"initiatived\" -- 筛选峡谷游戏\nand itimes >= 1 -- 活跃用户条件\nand saccounttype = \"-100\" -- 账号体系，取-100表示汇总\nand suseridtype in (\"qq\", \"wxid\") -- 账号类型，取qq或wxid\nand splattype = \"PC\" -- 峡谷端游玩家\nand splat = \"-100\" -- 写死为-100\n5月流失：限定INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),1,31),'1') = 0 AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),32,31),'1') > 0\n取20250608的数据做账号转换\n\n",
    "output": "",
    "category": "留存类",
    "category_reason": "问题关注勇者盟约流失用户流向其他游戏的行为，属于用户流失与回流分析范畴。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注勇者盟约流失用户流向其他游戏的行为，属于用户流失与回流分析范畴。\"\n}"
  },
  {
    "question_id": "sql_16",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计：近一年（2023/7/12-2025/5/31）按段位统计所有竞技模式对局中，排除掉投降的对局情况。\n输出：日期（20230712-20250531）、段位（黑铁、...、无段位、全量段位）当日竞技模式非投降局对局数、当日竞技模式投降局对局数、当日竞技模式非投降局中 双方胜利回合差>=6和双方胜利回合差>=8的对局数\n\n【数据库schema】\nCREATE TABLE `dwd_argothek_playermatchstats_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'partition fields',\n  `dteventtime` TEXT COMMENT '事件时间 - YYYY-MM-DD HH:MM:SS',\n  `ieventid` TEXT COMMENT '事件 ID',\n  `matchid` TEXT COMMENT '对局 ID - 查询对局的key',\n  `vroleid` TEXT COMMENT '当前日志所代表的玩家的角色 ID',\n  `wonmatch` BIGINT COMMENT '是否获胜',\n  `mapid` TEXT COMMENT '地图ID',\n  `seasonid` TEXT COMMENT '赛季ID',\n  `queueid` TEXT COMMENT '模式ID',\n  `gamestartmillis` DOUBLE COMMENT '比赛开始时间(毫秒)',\n  `gamelengthmillis` DOUBLE COMMENT '对局时长',\n  `teamid` TEXT COMMENT '队伍 ID，Blue、Red',\n  `partyid` TEXT COMMENT '组队房间 ID',\n  `ismatchmvp` BIGINT COMMENT '是否全局MVP',\n  `isteammvp` BIGINT COMMENT '是否队伍MVP',\n  `totalscore` DOUBLE COMMENT '本场比赛总得分',\n  `istopdamage` BIGINT COMMENT '是否伤害最高',\n  `istopplant` BIGINT COMMENT '是否下包最多',\n  `istopdefuse` BIGINT COMMENT '是否拆除次数最多',\n  `istopkill` BIGINT COMMENT '是否击杀数最多',\n  `istopassist` BIGINT COMMENT '是否助攻数最多',\n  `totalspent` BIGINT COMMENT '总消费',\n  `economyscore` BIGINT COMMENT '本场经济得分',\n  `killscount` DOUBLE COMMENT '击杀数',\n  `deathscount` DOUBLE COMMENT '死亡数',\n  `assistscount` DOUBLE COMMENT '助攻数',\n  `clutchcount` BIGINT COMMENT '力克千钧次数',\n  `acecount` BIGINT COMMENT '王牌精锐次数',\n  `teamacecount` BIGINT COMMENT '王牌小队次数',\n  `thriftycount` BIGINT COMMENT '高效火力次数',\n  `flawlesscount` BIGINT COMMENT '完美团灭次数',\n  `triplekillcount` BIGINT COMMENT '本场比赛个人完成3杀的次数',\n  `quadrakillcount` BIGINT COMMENT '本场比赛个人完成4杀的次数',\n  `pentakillcount` BIGINT COMMENT '本场比赛个人完成5杀的次数',\n  `sixkillcount` BIGINT COMMENT '本场比赛个人完成6杀(及以上)的次数',\n  `plantcount` BIGINT COMMENT '下包次数',\n  `defusecount` BIGINT COMMENT '拆包次数',\n  `firstkillcount` BIGINT COMMENT '获得首杀的回合次数',\n  `completionstate` TEXT COMMENT '比赛完成情况',\n  `roundsplayed` BIGINT COMMENT '实际游玩回合数',\n  `roundswon` BIGINT COMMENT '获胜回合数',\n  `characterid` TEXT COMMENT '英雄ID',\n  `totaldamage` DOUBLE COMMENT '本场比赛个人造成的总伤害值',\n  `competitivetier` BIGINT COMMENT '排位等级',\n  `isplayercompleted` BIGINT COMMENT '玩家是否完成比赛，任何掉线、挂机会视为未完成',\n  `ismatchcompleted` BIGINT COMMENT '比赛是否完成',\n  `totalheadshots` DOUBLE COMMENT '头部命中总次数',\n  `totalbodyshots` DOUBLE COMMENT '身体命中总次数',\n  `totallegshots` DOUBLE COMMENT '手部命中总次数',\n  `abilitydefaultcasts` BIGINT COMMENT '默认技能使用总次数',\n  `ability1casts` BIGINT COMMENT '技能Q使用总次数',\n  `ability2casts` BIGINT COMMENT '技能C使用总次数',\n  `ultimatecasts` BIGINT COMMENT '大招使用总次数',\n  `provisioningflowid` TEXT COMMENT 'provisioningFlowId'\n);\n\n【参考信息】\n段位筛选逻辑：\ncase\nwhen competitiveTier in (3, 4, 5) then \"黑铁\"\nwhen competitiveTier in (6, 7, 8) then \"黄铜\"\nwhen competitiveTier in (9, 10, 11) then \"白银\"\nwhen competitiveTier in (12, 13, 14) then \"黄金\"\nwhen competitiveTier in (15, 16, 17) then \"白金\"\nwhen competitiveTier in (18, 19, 20) then \"钻石\"\nwhen competitiveTier in (21, 22, 23) then \"超凡\"\nwhen competitiveTier >= 24 then \"神话及以上\"\nelse \"无段位\"\n竞技模式：模式id等于\"competitive\"\n对局筛选逻辑:\n使用completion_state筛选投降与非投降对局；使用roundsdiff筛选双方胜利回合差\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是在特定时间段内，不同段位玩家在竞技模式中的对局分布情况，属于活跃度的维度分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是在特定时间段内，不同段位玩家在竞技模式中的对局分布情况，属于活跃度的维度分析。\"\n}"
  },
  {
    "question_id": "sql_18",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20250506-20250512期间每日的指定网吧渠道内每个渠道活跃人数\n输出：日期（20250506、...、20250512）、渠道、玩家数\n其中：网吧渠道：iloginway in (1,10,11,12,35,20,28,29,30,31,32,33,34,36)\n\n【数据库schema】\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT '统计时间',\n  `iuserid` TEXT COMMENT '用户ID',\n  `ilogintime` BIGINT COMMENT '登录时间',\n  `ionlinetime` BIGINT COMMENT '在线时长',\n  `ilevel` BIGINT COMMENT '玩家等级',\n  `iplaytime` BIGINT COMMENT '游戏时长',\n  `iloginway` BIGINT COMMENT '登录渠道',\n  `ilogincount` BIGINT COMMENT '登录次数'\n);\n\n【参考信息】\n\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注指定网吧渠道内每日活跃人数统计，属于按渠道和时间维度的活跃度分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注指定网吧渠道内每日活跃人数统计，属于按渠道和时间维度的活跃度分析。\"\n}"
  },
  {
    "question_id": "sql_19",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2024年5月02日-2024年5月02日，日活跃用户的周边休闲模式情况。\n\n活跃日期区间：\"20250426-20250502\"\n\n输出：\n日活跃中仅玩QuickMatch模式的玩家数\n日活跃中仅玩RushMode模式的玩家数\n日活跃中仅玩CombatArena模式的玩家数\n日活跃中仅玩以上三个模式不玩其他模式的玩家数\n日活跃中仅玩以上三个模式不玩其他模式的玩家周活跃频次\n\n【数据库schema】\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT '统计时间',\n  `iuserid` TEXT COMMENT '用户ID',\n  `ilogintime` BIGINT COMMENT '登录时间',\n  `ionlinetime` BIGINT COMMENT '在线时长',\n  `ilevel` BIGINT COMMENT '玩家等级',\n  `iplaytime` BIGINT COMMENT '游戏时长',\n  `iloginway` BIGINT COMMENT '登录渠道',\n  `ilogincount` BIGINT COMMENT '登录次数'\n);\nCREATE TABLE `dwd_argothek_playermatchstats_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'partition fields',\n  `dteventtime` TEXT COMMENT '事件时间 - YYYY-MM-DD HH:MM:SS',\n  `ieventid` TEXT COMMENT '事件 ID',\n  `matchid` TEXT COMMENT '对局 ID - 查询对局的key',\n  `vroleid` TEXT COMMENT '当前日志所代表的玩家的角色 ID',\n  `wonmatch` BIGINT COMMENT '是否获胜',\n  `mapid` TEXT COMMENT '地图ID',\n  `seasonid` TEXT COMMENT '赛季ID',\n  `queueid` TEXT COMMENT '模式ID',\n  `gamestartmillis` DOUBLE COMMENT '比赛开始时间(毫秒)',\n  `gamelengthmillis` DOUBLE COMMENT '对局时长',\n  `teamid` TEXT COMMENT '队伍 ID，Blue、Red',\n  `partyid` TEXT COMMENT '组队房间 ID',\n  `ismatchmvp` BIGINT COMMENT '是否全局MVP',\n  `isteammvp` BIGINT COMMENT '是否队伍MVP',\n  `totalscore` DOUBLE COMMENT '本场比赛总得分',\n  `istopdamage` BIGINT COMMENT '是否伤害最高',\n  `istopplant` BIGINT COMMENT '是否下包最多',\n  `istopdefuse` BIGINT COMMENT '是否拆除次数最多',\n  `istopkill` BIGINT COMMENT '是否击杀数最多',\n  `istopassist` BIGINT COMMENT '是否助攻数最多',\n  `totalspent` BIGINT COMMENT '总消费',\n  `economyscore` BIGINT COMMENT '本场经济得分',\n  `killscount` DOUBLE COMMENT '击杀数',\n  `deathscount` DOUBLE COMMENT '死亡数',\n  `assistscount` DOUBLE COMMENT '助攻数',\n  `clutchcount` BIGINT COMMENT '力克千钧次数',\n  `acecount` BIGINT COMMENT '王牌精锐次数',\n  `teamacecount` BIGINT COMMENT '王牌小队次数',\n  `thriftycount` BIGINT COMMENT '高效火力次数',\n  `flawlesscount` BIGINT COMMENT '完美团灭次数',\n  `triplekillcount` BIGINT COMMENT '本场比赛个人完成3杀的次数',\n  `quadrakillcount` BIGINT COMMENT '本场比赛个人完成4杀的次数',\n  `pentakillcount` BIGINT COMMENT '本场比赛个人完成5杀的次数',\n  `sixkillcount` BIGINT COMMENT '本场比赛个人完成6杀(及以上)的次数',\n  `plantcount` BIGINT COMMENT '下包次数',\n  `defusecount` BIGINT COMMENT '拆包次数',\n  `firstkillcount` BIGINT COMMENT '获得首杀的回合次数',\n  `completionstate` TEXT COMMENT '比赛完成情况',\n  `roundsplayed` BIGINT COMMENT '实际游玩回合数',\n  `roundswon` BIGINT COMMENT '获胜回合数',\n  `characterid` TEXT COMMENT '英雄ID',\n  `totaldamage` DOUBLE COMMENT '本场比赛个人造成的总伤害值',\n  `competitivetier` BIGINT COMMENT '排位等级',\n  `isplayercompleted` BIGINT COMMENT '玩家是否完成比赛，任何掉线、挂机会视为未完成',\n  `ismatchcompleted` BIGINT COMMENT '比赛是否完成',\n  `totalheadshots` DOUBLE COMMENT '头部命中总次数',\n  `totalbodyshots` DOUBLE COMMENT '身体命中总次数',\n  `totallegshots` DOUBLE COMMENT '手部命中总次数',\n  `abilitydefaultcasts` BIGINT COMMENT '默认技能使用总次数',\n  `ability1casts` BIGINT COMMENT '技能Q使用总次数',\n  `ability2casts` BIGINT COMMENT '技能C使用总次数',\n  `ultimatecasts` BIGINT COMMENT '大招使用总次数',\n  `provisioningflowid` TEXT COMMENT 'provisioningFlowId'\n);\nCREATE TABLE `dim_argothek_gplayerid_vroleid_df` (\n  `dtstatdate` TEXT COMMENT '日期',\n  `vGameSvrId` TEXT COMMENT '服务器',\n  `vGameAppid` TEXT COMMENT 'appid',\n  `iAreaID` TEXT COMMENT '大区',\n  `iuserid` TEXT COMMENT 'playerid',\n  `vRoleID` TEXT COMMENT '角色id',\n  `iVersion` TEXT COMMENT '版本',\n  `cBitmap` TEXT COMMENT '位图',\n  `itemp1` BIGINT COMMENT '预留字段1',\n  `itemp2` BIGINT COMMENT '预留字段2',\n  `vtemp1` TEXT COMMENT '预留字段3',\n  `vtemp2` TEXT COMMENT '预留字段4'\n);\n\n【参考信息】\n仅玩单一模式逻辑：\nhaving count(distinct queueid) = 1 -- 只玩一个模式\nand max(queueid) = \"xxx\" -- 模式ID为RushMode\n用户角色映射逻辑：\niareaid = \"101\"\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是特定日期范围内，日活跃用户在不同游戏模式下的分布情况。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是特定日期范围内，日活跃用户在不同游戏模式下的分布情况。\"\n}"
  },
  {
    "question_id": "sql_20",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20240101-20240430，网吧特权用户的指标数据。\n输出：\n月份（按月：202401、202402、202403、202404）\n人均对局时长（小时）\n网吧时间占当月游戏时间比例\n有对局的天数\n排位模式时长（小时）\n排位模式组队率\n月付费率\n月ARPA\n月ARPPA\n高校特权激活率\n\n【数据库schema】\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT '统计时间',\n  `iuserid` TEXT COMMENT '用户ID',\n  `ilogintime` BIGINT COMMENT '登录时间',\n  `ionlinetime` BIGINT COMMENT '在线时长',\n  `ilevel` BIGINT COMMENT '玩家等级',\n  `iplaytime` BIGINT COMMENT '游戏时长',\n  `iloginway` BIGINT COMMENT '登录渠道',\n  `ilogincount` BIGINT COMMENT '登录次数'\n);\nCREATE TABLE `dwd_argothek_playerlogout_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'partition fields',\n  `dteventtime` TEXT COMMENT '事件时间 - YYYY-MM-DD HH:MM:SS',\n  `ieventid` TEXT COMMENT '事件 ID',\n  `vgamesvrid` TEXT COMMENT '服务器 ID - fill 1 if only one server',\n  `vgameappid` TEXT COMMENT 'appid - 无则填0',\n  `iareaid` TEXT COMMENT '大区 ID - if no fill 0',\n  `iuserid` TEXT COMMENT 'Open ID',\n  `vroleid` TEXT COMMENT '角色ID',\n  `ilevel` BIGINT COMMENT '账户等级',\n  `ionlinetime` BIGINT COMMENT '本次在线时长',\n  `iplaytime` BIGINT COMMENT '总战斗时长',\n  `iloginway` BIGINT COMMENT '玩家登录渠道',\n  `iversion` TEXT COMMENT '客户端版本',\n  `vrolename` TEXT COMMENT '玩家名字',\n  `iaccountexp` BIGINT COMMENT '账户经验',\n  `inetbarlevel` TEXT COMMENT '网吧等级 - 0: No netbar information. 1: Gold netbar. 2: Silver netbar. 3: Bronze netbar.',\n  `iseasonid` TEXT COMMENT '赛季ID',\n  `ilogoutreason` BIGINT COMMENT '登出=1，掉线=2，crash=3，封禁=4，其他=5 - 研发可自定义规则同步TC',\n  `ibanned` BIGINT COMMENT '是否封号，no=0,yes=1',\n  `ibannedtime` BIGINT COMMENT '封禁时长（hour），未封禁=null',\n  `ibpid` TEXT COMMENT 'battlepass ID',\n  `ibplevel` BIGINT COMMENT 'battlepass等级',\n  `ibpexp` BIGINT COMMENT 'battlepass总经验',\n  `iacid` TEXT COMMENT '角色契约 ID',\n  `iaclevel` BIGINT COMMENT '角色契约等级',\n  `iacexp` BIGINT COMMENT '角色契约总经验',\n  `ivpoint` BIGINT COMMENT '玩家拥有VP',\n  `irpoint` BIGINT COMMENT '玩家拥有RP',\n  `itotalonlinetime` BIGINT COMMENT '历史总在线时长',\n  `vlogoutreason` TEXT COMMENT '登出原因，用以代替iLogoutReason字段',\n  `icampuslevel` TEXT COMMENT '校园特权等级'\n);\nCREATE TABLE `dws_argothek_oss_portaltransaction_di` (\n  `statis_date` TEXT COMMENT '统计时间',\n  `iworldid` BIGINT COMMENT 'portal一般获取不到大区ID,建议不要使用此数据做分大区统计',\n  `iuserid` TEXT COMMENT '用户ID',\n  `vspoaid` TEXT COMMENT '支付业务代码',\n  `ftrantime` TEXT COMMENT '支付发生时间',\n  `ftranplat` TEXT COMMENT '支付平台',\n  `ftransource` TEXT COMMENT '支付渠道,非业务侧定义的用户渠道',\n  `ftranrealamt` BIGINT COMMENT '折前支付金额',\n  `ftranamt` BIGINT COMMENT '折后支付金额',\n  `vpf` TEXT COMMENT '支付PF字段',\n  `ext_str1` TEXT COMMENT '支付信息字段',\n  `vusertype` TEXT COMMENT '用户类型,qq或wx',\n  `extcol1` BIGINT COMMENT '玩家等级',\n  `vextcol1` TEXT COMMENT '游戏时长',\n  `offerid` TEXT COMMENT 'offerid'\n);\nCREATE TABLE `dwd_argothek_playermatchstats_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'partition fields',\n  `dteventtime` TEXT COMMENT '事件时间 - YYYY-MM-DD HH:MM:SS',\n  `ieventid` TEXT COMMENT '事件 ID',\n  `matchid` TEXT COMMENT '对局 ID - 查询对局的key',\n  `vroleid` TEXT COMMENT '当前日志所代表的玩家的角色 ID',\n  `wonmatch` BIGINT COMMENT '是否获胜',\n  `mapid` TEXT COMMENT '地图ID',\n  `seasonid` TEXT COMMENT '赛季ID',\n  `queueid` TEXT COMMENT '模式ID',\n  `gamestartmillis` DOUBLE COMMENT '比赛开始时间(毫秒)',\n  `gamelengthmillis` DOUBLE COMMENT '对局时长',\n  `teamid` TEXT COMMENT '队伍 ID，Blue、Red',\n  `partyid` TEXT COMMENT '组队房间 ID',\n  `ismatchmvp` BIGINT COMMENT '是否全局MVP',\n  `isteammvp` BIGINT COMMENT '是否队伍MVP',\n  `totalscore` DOUBLE COMMENT '本场比赛总得分',\n  `istopdamage` BIGINT COMMENT '是否伤害最高',\n  `istopplant` BIGINT COMMENT '是否下包最多',\n  `istopdefuse` BIGINT COMMENT '是否拆除次数最多',\n  `istopkill` BIGINT COMMENT '是否击杀数最多',\n  `istopassist` BIGINT COMMENT '是否助攻数最多',\n  `totalspent` BIGINT COMMENT '总消费',\n  `economyscore` BIGINT COMMENT '本场经济得分',\n  `killscount` DOUBLE COMMENT '击杀数',\n  `deathscount` DOUBLE COMMENT '死亡数',\n  `assistscount` DOUBLE COMMENT '助攻数',\n  `clutchcount` BIGINT COMMENT '力克千钧次数',\n  `acecount` BIGINT COMMENT '王牌精锐次数',\n  `teamacecount` BIGINT COMMENT '王牌小队次数',\n  `thriftycount` BIGINT COMMENT '高效火力次数',\n  `flawlesscount` BIGINT COMMENT '完美团灭次数',\n  `triplekillcount` BIGINT COMMENT '本场比赛个人完成3杀的次数',\n  `quadrakillcount` BIGINT COMMENT '本场比赛个人完成4杀的次数',\n  `pentakillcount` BIGINT COMMENT '本场比赛个人完成5杀的次数',\n  `sixkillcount` BIGINT COMMENT '本场比赛个人完成6杀(及以上)的次数',\n  `plantcount` BIGINT COMMENT '下包次数',\n  `defusecount` BIGINT COMMENT '拆包次数',\n  `firstkillcount` BIGINT COMMENT '获得首杀的回合次数',\n  `completionstate` TEXT COMMENT '比赛完成情况',\n  `roundsplayed` BIGINT COMMENT '实际游玩回合数',\n  `roundswon` BIGINT COMMENT '获胜回合数',\n  `characterid` TEXT COMMENT '英雄ID',\n  `totaldamage` DOUBLE COMMENT '本场比赛个人造成的总伤害值',\n  `competitivetier` BIGINT COMMENT '排位等级',\n  `isplayercompleted` BIGINT COMMENT '玩家是否完成比赛，任何掉线、挂机会视为未完成',\n  `ismatchcompleted` BIGINT COMMENT '比赛是否完成',\n  `totalheadshots` DOUBLE COMMENT '头部命中总次数',\n  `totalbodyshots` DOUBLE COMMENT '身体命中总次数',\n  `totallegshots` DOUBLE COMMENT '手部命中总次数',\n  `abilitydefaultcasts` BIGINT COMMENT '默认技能使用总次数',\n  `ability1casts` BIGINT COMMENT '技能Q使用总次数',\n  `ability2casts` BIGINT COMMENT '技能C使用总次数',\n  `ultimatecasts` BIGINT COMMENT '大招使用总次数',\n  `provisioningflowid` TEXT COMMENT 'provisioningFlowId'\n);\n\n【参考信息】\n排位模式：queueId=\"competitive\"\n网吧特权：inetbarlevel = 2\n高校特权：icampuslevel > 0\n网吧在线时长先筛选网吧渠道\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注网吧特权用户在特定时间段内的多种行为指标，如游戏时长、付费率等，属于多维度活跃度分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注网吧特权用户在特定时间段内的多种行为指标，如游戏时长、付费率等，属于多维度活跃度分析。\"\n}"
  },
  {
    "question_id": "sql_22",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计：近30天用户在渠道登录的天数为5到8天，取最多天数的用户，并将用户ID转为qq\n输出：QQ\n统计日期：20250330-20250428\n\n【数据库schema】\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT '统计时间',\n  `iuserid` TEXT COMMENT '用户ID',\n  `ilogintime` BIGINT COMMENT '登录时间',\n  `ionlinetime` BIGINT COMMENT '在线时长',\n  `ilevel` BIGINT COMMENT '玩家等级',\n  `iplaytime` BIGINT COMMENT '游戏时长',\n  `iloginway` BIGINT COMMENT '登录渠道',\n  `ilogincount` BIGINT COMMENT '登录次数'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT '日期',\n  `vGameAppid` TEXT COMMENT '平台',\n  `iAreaID` TEXT COMMENT '大区',\n  `iuserid` TEXT COMMENT '用户id',\n  `vRoleID` TEXT COMMENT '角色id',\n  `iVersion` TEXT COMMENT '服务器',\n  `cBitmap` TEXT COMMENT '活跃位图',\n  `iregdate` TEXT COMMENT '注册日期',\n  `swxid_type` TEXT COMMENT 'wx或qq类型',\n  `suserid` TEXT COMMENT '存储qq/wxid如果微信和qq有绑定关系优先qq',\n  `sqq` TEXT COMMENT '该字段为废弃字段，使用转qq时使用suserid',\n  `swxid` TEXT COMMENT '该字段为废弃字段，使用转qq时使用wxid',\n  `itemp1` BIGINT COMMENT '预留字段1',\n  `itemp2` BIGINT COMMENT '预留字段2',\n  `itemp3` BIGINT COMMENT '预留字段3',\n  `itemp4` BIGINT COMMENT '预留字段4',\n  `vtemp1` TEXT COMMENT '预留字段5',\n  `vtemp2` TEXT COMMENT '预留字段6',\n  `vtemp3` TEXT COMMENT '预留字段7',\n  `vtemp4` TEXT COMMENT '预留字段8',\n  `vtemp5` TEXT COMMENT '预留字段9'\n);\n\n【参考信息】\n渠道筛选条件：iloginway = 3\n用户ID筛选swxid_type = \"qq\" -- 筛选swxid_type为\"qq\"\ndim_argothek_gplayerid2qqwxid_df限定20250428\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注用户在特定时间段内的登录天数分布情况，属于活跃度分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注用户在特定时间段内的登录天数分布情况，属于活跃度分析。\"\n}"
  },
  {
    "question_id": "sql_23",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2025年3月24日至2025年3月30日，至少完成过一场对局，且渠道登录的用户qq\n输出:qq\n\n【数据库schema】\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT '统计时间',\n  `iuserid` TEXT COMMENT '用户ID',\n  `ilogintime` BIGINT COMMENT '登录时间',\n  `ionlinetime` BIGINT COMMENT '在线时长',\n  `ilevel` BIGINT COMMENT '玩家等级',\n  `iplaytime` BIGINT COMMENT '游戏时长',\n  `iloginway` BIGINT COMMENT '登录渠道',\n  `ilogincount` BIGINT COMMENT '登录次数'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT '日期',\n  `vGameAppid` TEXT COMMENT '平台',\n  `iAreaID` TEXT COMMENT '大区',\n  `iuserid` TEXT COMMENT '用户id',\n  `vRoleID` TEXT COMMENT '角色id',\n  `iVersion` TEXT COMMENT '服务器',\n  `cBitmap` TEXT COMMENT '活跃位图',\n  `iregdate` TEXT COMMENT '注册日期',\n  `swxid_type` TEXT COMMENT 'wx或qq类型',\n  `suserid` TEXT COMMENT '存储qq/wxid如果微信和qq有绑定关系优先qq',\n  `sqq` TEXT COMMENT '该字段为废弃字段，使用转qq时使用suserid',\n  `swxid` TEXT COMMENT '该字段为废弃字段，使用转qq时使用wxid',\n  `itemp1` BIGINT COMMENT '预留字段1',\n  `itemp2` BIGINT COMMENT '预留字段2',\n  `itemp3` BIGINT COMMENT '预留字段3',\n  `itemp4` BIGINT COMMENT '预留字段4',\n  `vtemp1` TEXT COMMENT '预留字段5',\n  `vtemp2` TEXT COMMENT '预留字段6',\n  `vtemp3` TEXT COMMENT '预留字段7',\n  `vtemp4` TEXT COMMENT '预留字段8',\n  `vtemp5` TEXT COMMENT '预留字段9'\n);\nCREATE TABLE `dwd_argothek_playermatchstats_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'partition fields',\n  `dteventtime` TEXT COMMENT '事件时间 - YYYY-MM-DD HH:MM:SS',\n  `ieventid` TEXT COMMENT '事件 ID',\n  `matchid` TEXT COMMENT '对局 ID - 查询对局的key',\n  `vroleid` TEXT COMMENT '当前日志所代表的玩家的角色 ID',\n  `wonmatch` BIGINT COMMENT '是否获胜',\n  `mapid` TEXT COMMENT '地图ID',\n  `seasonid` TEXT COMMENT '赛季ID',\n  `queueid` TEXT COMMENT '模式ID',\n  `gamestartmillis` DOUBLE COMMENT '比赛开始时间(毫秒)',\n  `gamelengthmillis` DOUBLE COMMENT '对局时长',\n  `teamid` TEXT COMMENT '队伍 ID，Blue、Red',\n  `partyid` TEXT COMMENT '组队房间 ID',\n  `ismatchmvp` BIGINT COMMENT '是否全局MVP',\n  `isteammvp` BIGINT COMMENT '是否队伍MVP',\n  `totalscore` DOUBLE COMMENT '本场比赛总得分',\n  `istopdamage` BIGINT COMMENT '是否伤害最高',\n  `istopplant` BIGINT COMMENT '是否下包最多',\n  `istopdefuse` BIGINT COMMENT '是否拆除次数最多',\n  `istopkill` BIGINT COMMENT '是否击杀数最多',\n  `istopassist` BIGINT COMMENT '是否助攻数最多',\n  `totalspent` BIGINT COMMENT '总消费',\n  `economyscore` BIGINT COMMENT '本场经济得分',\n  `killscount` DOUBLE COMMENT '击杀数',\n  `deathscount` DOUBLE COMMENT '死亡数',\n  `assistscount` DOUBLE COMMENT '助攻数',\n  `clutchcount` BIGINT COMMENT '力克千钧次数',\n  `acecount` BIGINT COMMENT '王牌精锐次数',\n  `teamacecount` BIGINT COMMENT '王牌小队次数',\n  `thriftycount` BIGINT COMMENT '高效火力次数',\n  `flawlesscount` BIGINT COMMENT '完美团灭次数',\n  `triplekillcount` BIGINT COMMENT '本场比赛个人完成3杀的次数',\n  `quadrakillcount` BIGINT COMMENT '本场比赛个人完成4杀的次数',\n  `pentakillcount` BIGINT COMMENT '本场比赛个人完成5杀的次数',\n  `sixkillcount` BIGINT COMMENT '本场比赛个人完成6杀(及以上)的次数',\n  `plantcount` BIGINT COMMENT '下包次数',\n  `defusecount` BIGINT COMMENT '拆包次数',\n  `firstkillcount` BIGINT COMMENT '获得首杀的回合次数',\n  `completionstate` TEXT COMMENT '比赛完成情况',\n  `roundsplayed` BIGINT COMMENT '实际游玩回合数',\n  `roundswon` BIGINT COMMENT '获胜回合数',\n  `characterid` TEXT COMMENT '英雄ID',\n  `totaldamage` DOUBLE COMMENT '本场比赛个人造成的总伤害值',\n  `competitivetier` BIGINT COMMENT '排位等级',\n  `isplayercompleted` BIGINT COMMENT '玩家是否完成比赛，任何掉线、挂机会视为未完成',\n  `ismatchcompleted` BIGINT COMMENT '比赛是否完成',\n  `totalheadshots` DOUBLE COMMENT '头部命中总次数',\n  `totalbodyshots` DOUBLE COMMENT '身体命中总次数',\n  `totallegshots` DOUBLE COMMENT '手部命中总次数',\n  `abilitydefaultcasts` BIGINT COMMENT '默认技能使用总次数',\n  `ability1casts` BIGINT COMMENT '技能Q使用总次数',\n  `ability2casts` BIGINT COMMENT '技能C使用总次数',\n  `ultimatecasts` BIGINT COMMENT '大招使用总次数',\n  `provisioningflowid` TEXT COMMENT 'provisioningFlowId'\n);\nCREATE TABLE `dim_argothek_gplayerid_vroleid_df` (\n  `dtstatdate` TEXT COMMENT '日期',\n  `vGameSvrId` TEXT COMMENT '服务器',\n  `vGameAppid` TEXT COMMENT 'appid',\n  `iAreaID` TEXT COMMENT '大区',\n  `iuserid` TEXT COMMENT 'playerid',\n  `vRoleID` TEXT COMMENT '角色id',\n  `iVersion` TEXT COMMENT '版本',\n  `cBitmap` TEXT COMMENT '位图',\n  `itemp1` BIGINT COMMENT '预留字段1',\n  `itemp2` BIGINT COMMENT '预留字段2',\n  `vtemp1` TEXT COMMENT '预留字段3',\n  `vtemp2` TEXT COMMENT '预留字段4'\n);\n\n【参考信息】\n渠道筛选条件：iloginway = 3\n用户ID筛选swxid_type = \"qq\" -- 筛选swxid_type为\"qq\"\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是特定时间段内完成对局且通过渠道登录的用户QQ号，属于基于行为和渠道维度的活跃用户筛选。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是特定时间段内完成对局且通过渠道登录的用户QQ号，属于基于行为和渠道维度的活跃用户筛选。\"\n}"
  },
  {
    "question_id": "sql_24",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计下列英雄和对应上线日期，新英雄上线首周的持续选择情况。限定除自定义模式，新手、训练场外所有模式\n输出：英雄id、首周选择新英雄次数超过3次的玩家、首周选择新英雄次数超过10次的玩家、首周选择过新英雄的玩家、超过3次的玩家占比、超过10次的玩家占比\n\n【数据库schema】\nCREATE TABLE `dwd_argothek_playermatchdetail_hi` (\n  `tdbank_imp_date` TEXT COMMENT '分区字段',\n  `dteventtime` TEXT COMMENT 'AP 事件时间: YYYY-MM-DD HH:MM:SS',\n  `apeventid` TEXT COMMENT 'AP 事件标识符，由 TLIS 生成',\n  `apchildid` TEXT COMMENT 'AP 子标识符，由 TLIS 生成，并在主条目 apMatchDetails.players 中引用',\n  `apchildindex` BIGINT COMMENT 'AP 子索引，由 TLIS 生成',\n  `subject` TEXT COMMENT '玩家 ID - 玩家标识符。',\n  `name` TEXT COMMENT 'Ares 玩家名称 - Ares 玩家的名称（不一定是召唤师名称）',\n  `teamid` TEXT COMMENT 'Ares 队伍 ID - Ares 队伍 ID',\n  `partyid` TEXT COMMENT '组队 ID - 组队标识符。',\n  `characterid` TEXT COMMENT '角色 ID - 角色标识符。',\n  `competitivetier` BIGINT COMMENT '竞技等级 - 竞技等级的整数值。从 1 开始，0 表示隐藏',\n  `statsscore` DOUBLE COMMENT 'Ares 玩家得分 - 玩家得分的点数数量。',\n  `statsroundsplayed` BIGINT COMMENT '回合编号 - Ares 匹配的回合编号',\n  `statskills` DOUBLE COMMENT '数量 - 一个数值度量',\n  `statsdeaths` DOUBLE COMMENT '数量 - 一个数值度量',\n  `statsassists` DOUBLE COMMENT '数量 - 一个数值度量',\n  `statsplaytimemillis` DOUBLE COMMENT '毫秒 - 千分之一秒的单位',\n  `newexpr` TEXT COMMENT 'AP 子标识符，指向子结构：apMatchDetails_players_newExpr',\n  `matchid` TEXT COMMENT 'Ares 匹配 ID - Ares 匹配的 ID 字符串',\n  `mapid` TEXT COMMENT 'Ares 地图 ID - 服务代码中使用的 Ares 地图 ID',\n  `provisioningflowid` TEXT COMMENT '配置流程 ID - 已配置的游戏类型。例如：技能测试、匹配等',\n  `gamepodid` TEXT COMMENT '游戏节点 ID - 游戏节点的字符串表示',\n  `gamelengthmillis` DOUBLE COMMENT '毫秒 - 千分之一秒的单位',\n  `gamestartmillis` DOUBLE COMMENT '毫秒 - 千分之一秒的单位',\n  `gameversion` TEXT COMMENT 'Ares 构建版本 - Ares 二进制文件的完整构建版本',\n  `iscompleted` BIGINT COMMENT '比赛完成标志 - 如果比赛正常结束并有比赛结果，则为 True',\n  `customgamename` TEXT COMMENT 'Ares 自定义游戏名称 - 自定义游戏的名称',\n  `module` TEXT COMMENT 'Ares 射击场模块 - 可以在射击场中游玩的模块',\n  `forcepostprocessing` BIGINT COMMENT '强制后处理标志 - 对于需要启用调试的比赛，该值为 True。',\n  `queueid` TEXT COMMENT 'Ares 队列 ID - Ares 队列的 ID 字符串',\n  `seasonid` TEXT COMMENT '赛季 ID - 赛季的 uuid',\n  `completionstate` TEXT COMMENT 'Ares 完成状态 - 比赛如何完成的字符串值。例如：Completed（完成）, All_Disconnected（全部断开连接）',\n  `ismatchsampled` BIGINT COMMENT '比赛是否被采样标志 - 指示该比赛是否被采样用于遥测',\n  `statsabilitycastsgrenadecasts` BIGINT COMMENT '技能施放次数 - 技能已施放的次数',\n  `statsabilitycastsability1casts` BIGINT COMMENT '技能施放次数 - 技能已施放的次数',\n  `statsabilitycastsability2casts` BIGINT COMMENT '技能施放次数 - 技能已施放的次数',\n  `statsabilitycastsultimatecasts` BIGINT COMMENT '技能施放次数 - 技能已施放的次数',\n  `clientplatformdetailsplatformtype` TEXT COMMENT '客户端平台类型 - 此事件来源的客户端平台（例如：Mobile 或 PC）',\n  `newexprv2missions` TEXT COMMENT 'newExprV2Missions',\n  `newexprv2settingstatusissensitivitydefault` BIGINT COMMENT 'newExprV2SettingStatusIsSensitivityDefault',\n  `newexprv2settingstatusiscrosshairdefault` BIGINT COMMENT 'newExprV2SettingStatusIsCrosshairDefault'\n);\n\n【参考信息】\n英雄筛选逻辑：\n英雄1上线日期：2023/07/26\n英雄2上线日期：2023/11/01\n英雄3上线日期：2024/03/27\n英雄4上线日期：2024/08/29\n英雄5上线日期：2025/01/09\n英雄6上线日期：2025/03/06\n英雄1对应id:\"e370fa57-4757-3604-3648-499e1f642d3f\",\"cc8b64c8-4b25-4ff9-6e7f-37b4da43d235\"\n英雄2对应id:\"0e38b510-41a8-5780-5e8f-568b2a4f2d6c\"\n英雄3对应id:\"1dbf2edd-4729-0984-3115-daa5eed44993\"\n英雄4对应id:\"efba5359-4016-a1e5-7626-b1ae76895940\"\n英雄5对应id:\"b444168c-4e35-8076-db47-ef9bf368f384\"\n英雄6对应id:\"df1cb487-4902-002e-5c17-d28e83e78588\"\n\n对局筛选逻辑：\nprovisioningflowid = \"Matchmaking\" -- 除自定义模式、新手、训练场外所有模式\n\n",
    "output": "",
    "category": "留存类",
    "category_reason": "问题关注新英雄上线后首周的持续选择情况，属于对特定群体（新英雄用户）的行为追踪与留存分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注新英雄上线后首周的持续选择情况，属于对特定群体（新英雄用户）的行为追踪与留存分析。\"\n}"
  },
  {
    "question_id": "sql_26",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计：2024-01-01到2024-12-16，闪了敌人x次、闪了队友x次，除自定义模式、新手、训练场外所有模式。\n输出：闪了敌人x次、闪了队友x次\n\n【数据库schema】\nCREATE TABLE `dwd_argothek_matchdetails_hi` (\n  `tdbank_imp_date` TEXT COMMENT '分区字段',\n  `dteventtime` TEXT COMMENT 'AP 事件时间: YYYY-MM-DD HH:MM:SS',\n  `apeventid` TEXT COMMENT 'AP 事件标识符',\n  `matchid` TEXT COMMENT 'Ares 匹配 ID - Ares 匹配的 ID 字符串',\n  `mapid` TEXT COMMENT 'Ares 地图 ID - 服务代码中使用的 Ares 地图 ID',\n  `provisioningflowid` TEXT COMMENT '配置流程 ID - 已配置的游戏类型。例如：技能测试、匹配等',\n  `gamepodid` TEXT COMMENT '游戏节点 ID - 游戏节点的字符串表示',\n  `gamelengthmillis` DOUBLE COMMENT '毫秒 - 千分之一秒的单位',\n  `gamestartmillis` DOUBLE COMMENT '毫秒 - 千分之一秒的单位',\n  `gameversion` TEXT COMMENT 'Ares 构建版本 - Ares 二进制文件的完整构建版本',\n  `iscompleted` BIGINT COMMENT '比赛完成标志 - 如果比赛正常结束并有比赛结果，则为 True',\n  `customgamename` TEXT COMMENT 'Ares 自定义游戏名称 - 自定义游戏的名称',\n  `module` TEXT COMMENT 'Ares 射击场模块 - 可以在射击场中游玩的模块',\n  `forcepostprocessing` BIGINT COMMENT '强制后处理标志 - 对于需要启用调试的比赛，该值为 True。',\n  `queueid` TEXT COMMENT 'Ares 队列 ID - Ares 队列的 ID 字符串',\n  `seasonid` TEXT COMMENT '赛季 ID - 赛季的 uuid',\n  `completionstate` TEXT COMMENT 'Ares 完成状态 - 比赛如何完成的字符串值。例如：Completed（完成）, All_Disconnected（全部断开连接）',\n  `ismatchsampled` BIGINT COMMENT '比赛是否被采样标志 - 指示该比赛是否被采样用于遥测',\n  `players` TEXT COMMENT 'AP 子标识符，指向子结构：apMatchDetails_players',\n  `teams` TEXT COMMENT 'AP 子标识符，指向子结构：apMatchDetails_teams',\n  `roundresults` TEXT COMMENT 'AP 子标识符，指向子结构：apMatchDetails_roundResults',\n  `platforminfoplatformtype` TEXT COMMENT '客户端平台类型 - 此事件来源的客户端平台（例如：Mobile 或 PC）',\n  `platforminfoplatformos` TEXT COMMENT '客户端平台操作系统 - 此事件来源的客户端操作系统',\n  `aplogtotal` BIGINT COMMENT '由此 AP 事件生成的日志总数',\n  `platformtype` TEXT COMMENT '客户端平台类型 - 此事件来源的客户端平台（例如：Mobile 或 PC）',\n  `apschemaversion` TEXT COMMENT 'apSchemaVersion'\n);\nCREATE TABLE `dwd_argothek_abilityinfo_effects_hi` (\n  `tdbank_imp_date` TEXT COMMENT '分区字段',\n  `dteventtime` TEXT COMMENT 'AP 事件时间: YYYY-MM-DD HH:MM:SS',\n  `apeventid` TEXT COMMENT 'AP 事件标识符，由 TLIS 生成',\n  `apchildid` TEXT COMMENT 'AP 子标识符，由 TLIS 生成，并在主条目 apAbilityUseEvent.AbilityInfoAbilityEffects 中引用',\n  `apchildindex` BIGINT COMMENT 'AP 子索引，由 TLIS 生成',\n  `tag` TEXT COMMENT '技能效果标签 - 技能效果的标签',\n  `amount` DOUBLE COMMENT '效果计数 - 技能效果的总值',\n  `allianceforcefectedtargets` TEXT COMMENT 'AP 子标识符，指向子结构：apAbilityUseEvent_AbilityInfoAbilityEffects_AffectedTargets',\n  `matchinfomatchid` TEXT COMMENT 'Ares 匹配 ID - Ares 匹配的 ID 字符串',\n  `playerinfosubject` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO 玩家 ID: Riot 玩家的全局唯一 ID',\n  `roundinforoundnumber` BIGINT COMMENT '回合编号 - Ares 匹配的回合编号',\n  `playerinfoteamid` TEXT COMMENT 'Ares 队伍 ID - Ares 队伍 ID'\n);\n\n【参考信息】\nprovisioningflowid = \"Matchmaking\" -- 除自定义模式、新手、训练场外所有模式\n\n闪光弹区分逻辑：\n闪到敌人：tag = \"EnemiesBlinded\"\n闪到队友：tag = \"AlliesBlinded\"\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是特定时间段内玩家在不同模式下的行为次数统计，属于活动/行为的分布情况。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是特定时间段内玩家在不同模式下的行为次数统计，属于活动/行为的分布情况。\"\n}"
  },
  {
    "question_id": "sql_27",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计：2024-01-01到2024-12-16，购买阶段出现了x次武器代买，除自定义模式、新手、训练场外所有模式。\n输出：武器代买次数\n\n【数据库schema】\nCREATE TABLE `dwd_argothek_matchdetails_hi` (\n  `tdbank_imp_date` TEXT COMMENT '分区字段',\n  `dteventtime` TEXT COMMENT 'AP 事件时间: YYYY-MM-DD HH:MM:SS',\n  `apeventid` TEXT COMMENT 'AP 事件标识符',\n  `matchid` TEXT COMMENT 'Ares 匹配 ID - Ares 匹配的 ID 字符串',\n  `mapid` TEXT COMMENT 'Ares 地图 ID - 服务代码中使用的 Ares 地图 ID',\n  `provisioningflowid` TEXT COMMENT '配置流程 ID - 已配置的游戏类型。例如：技能测试、匹配等',\n  `gamepodid` TEXT COMMENT '游戏节点 ID - 游戏节点的字符串表示',\n  `gamelengthmillis` DOUBLE COMMENT '毫秒 - 千分之一秒的单位',\n  `gamestartmillis` DOUBLE COMMENT '毫秒 - 千分之一秒的单位',\n  `gameversion` TEXT COMMENT 'Ares 构建版本 - Ares 二进制文件的完整构建版本',\n  `iscompleted` BIGINT COMMENT '比赛完成标志 - 如果比赛正常结束并有比赛结果，则为 True',\n  `customgamename` TEXT COMMENT 'Ares 自定义游戏名称 - 自定义游戏的名称',\n  `module` TEXT COMMENT 'Ares 射击场模块 - 可以在射击场中游玩的模块',\n  `forcepostprocessing` BIGINT COMMENT '强制后处理标志 - 对于需要启用调试的比赛，该值为 True。',\n  `queueid` TEXT COMMENT 'Ares 队列 ID - Ares 队列的 ID 字符串',\n  `seasonid` TEXT COMMENT '赛季 ID - 赛季的 uuid',\n  `completionstate` TEXT COMMENT 'Ares 完成状态 - 比赛如何完成的字符串值。例如：Completed（完成）, All_Disconnected（全部断开连接）',\n  `ismatchsampled` BIGINT COMMENT '比赛是否被采样标志 - 指示该比赛是否被采样用于遥测',\n  `players` TEXT COMMENT 'AP 子标识符，指向子结构：apMatchDetails_players',\n  `teams` TEXT COMMENT 'AP 子标识符，指向子结构：apMatchDetails_teams',\n  `roundresults` TEXT COMMENT 'AP 子标识符，指向子结构：apMatchDetails_roundResults',\n  `platforminfoplatformtype` TEXT COMMENT '客户端平台类型 - 此事件来源的客户端平台（例如：Mobile 或 PC）',\n  `platforminfoplatformos` TEXT COMMENT '客户端平台操作系统 - 此事件来源的客户端操作系统',\n  `aplogtotal` BIGINT COMMENT '由此 AP 事件生成的日志总数',\n  `platformtype` TEXT COMMENT '客户端平台类型 - 此事件来源的客户端平台（例如：Mobile 或 PC）',\n  `apschemaversion` TEXT COMMENT 'apSchemaVersion'\n);\nCREATE TABLE `dwd_argothek_apinventorymovementlog_hi` (\n  `tdbank_imp_date` TEXT COMMENT '分区字段',\n  `dteventtime` TEXT COMMENT 'AP 事件时间: YYYY-MM-DD HH:MM:SS',\n  `apeventid` TEXT COMMENT 'AP 事件标识符',\n  `matchinfobranch` TEXT COMMENT 'Ares Perforce 分支 - 此构建版本的来源分支',\n  `matchinfochangelist` TEXT COMMENT 'Perforce 变更列表 - Perforce 变更列表编号',\n  `matchinfogameid` BIGINT COMMENT 'Ares 游戏 ID - Ares 匹配的 ID 号（基于平台时间戳之前）',\n  `matchinfogamemode` TEXT COMMENT 'Ares 游戏模式 - 正在进行的比赛类型',\n  `matchinfomap` TEXT COMMENT 'Ares 地图 - Ares 地图的名称',\n  `matchinfomatchid` TEXT COMMENT 'Ares 匹配 ID - Ares 匹配的 ID 字符串',\n  `matchinfoversion` TEXT COMMENT 'Ares 构建版本 - Ares 二进制文件的完整构建版本',\n  `roundinfoattackerscore` BIGINT COMMENT '回合得分 - Ares 匹配的回合得分',\n  `roundinfodefenderscore` BIGINT COMMENT '回合得分 - Ares 匹配的回合得分',\n  `roundinfomatchtime` BIGINT COMMENT '比赛时间 - 当前比赛已进行的时间，单位为毫秒',\n  `roundinforoundnumber` BIGINT COMMENT '回合编号 - Ares 匹配的回合编号',\n  `roundinforoundphase` TEXT COMMENT 'Ares 回合阶段 - Ares 游戏回合的游戏阶段 - 值：BetweenRounds（回合之间）, GameEnded（游戏结束）, GameStarted（游戏开始）, InRound（回合中）, NotStarted（未开始）, RoundEnding（回合结束中）, RoundStarting（回合开始中）, SwitchingTeams（交换队伍）, Invalid（无效）',\n  `roundinforoundtime` DOUBLE COMMENT '回合时间 - 当前回合已进行的时间，单位为秒',\n  `playerinfocharacter` TEXT COMMENT 'Ares 角色 - Ares 角色的名称',\n  `playerinfoname` TEXT COMMENT 'Ares 玩家名称 - Ares 玩家的名称（不一定是召唤师名称）',\n  `playerinfosubject` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO 玩家 ID: Riot 玩家的全局唯一 ID',\n  `playerinfoteamid` TEXT COMMENT 'Ares 队伍 ID - Ares 队伍 ID',\n  `playerinfoside` TEXT COMMENT 'Ares 游戏模式的阵营 - 当前炸弹游戏模式中的 Ares 阵营。这曾是 Ares 队伍，但我们希望转移到能够跨服务引用队伍为红/蓝。注意：此类型也被用于表示队伍角色的属性。因此有额外的支持其他角色的值（即 None/Any/FreeForAll） - 值：Attacker（进攻方）, Defender（防守方）, Neutral（中立）, Unknown（未知）, None（无）, Any（任意）, FreeForAll（混战）',\n  `playerinfoteamrole` TEXT COMMENT 'Ares 游戏模式的队伍角色 - 当前炸弹游戏模式中的 Ares 阵营。这曾是 Ares 队伍，但我们希望转移到能够跨服务引用队伍为红/蓝。注意：此类型也被用于表示队伍角色的属性。因此有额外的支持其他角色的值（即 None/Any/FreeForAll） - 值：Attacker（进攻方）, Defender（防守方）, Neutral（中立）, Unknown（未知）, None（无）, Any（任意）, FreeForAll（混战）',\n  `pretransactionmoney` BIGINT COMMENT 'Ares 游戏货币 - Ares 游戏内货币的数量',\n  `pretransactionmoneyreceiver` BIGINT COMMENT 'Ares 游戏货币 - Ares 游戏内货币的数量',\n  `pretransactionmoneysender` BIGINT COMMENT 'Ares 游戏货币 - Ares 游戏内货币的数量',\n  `itemcost` BIGINT COMMENT 'Ares 游戏货币 - Ares 游戏内货币的数量',\n  `startinvpriweaponid` TEXT COMMENT '物品 ID - 物品标识符',\n  `startinvpriweaponname` TEXT COMMENT '物品名称 - 物品名称',\n  `startinvpriweapontype` TEXT COMMENT '物品类型 - 物品的类型',\n  `startinvpriweaponavaamt` DOUBLE COMMENT 'Ares 资源数量 - 技能的充能次数、武器的子弹数和护甲的生命值',\n  `startinvsecweaponid` TEXT COMMENT '物品 ID - 物品标识符',\n  `startinvsecweaponname` TEXT COMMENT '物品名称 - 物品名称',\n  `startinvsecweapontype` TEXT COMMENT '物品类型 - 物品的类型',\n  `startinvsecweaponavaamt` DOUBLE COMMENT 'Ares 资源数量 - 技能的充能次数、武器的子弹数和护甲的生命值',\n  `startinvmeleeid` TEXT COMMENT '物品 ID - 物品标识符',\n  `startinvmeleename` TEXT COMMENT '物品名称 - 物品名称',\n  `startinvmeleetype` TEXT COMMENT '物品类型 - 物品的类型',\n  `startinvmeleeavaamt` DOUBLE COMMENT 'Ares 资源数量 - 技能的充能次数、武器的子弹数和护甲的生命值',\n  `startinvarmorid` TEXT COMMENT '物品 ID - 物品标识符',\n  `startinvarmorname` TEXT COMMENT '物品名称 - 物品名称',\n  `startinvarmortype` TEXT COMMENT '物品类型 - 物品的类型',\n  `startinvarmoravaamt` DOUBLE COMMENT 'Ares 资源数量 - 技能的充能次数、武器的子弹数和护甲的生命值',\n  `startinvabilities` TEXT COMMENT 'AP 子标识符，指向子结构：apInventoryChangeEvent_StartInvAbilities',\n  `startinvbackpackitems` TEXT COMMENT 'AP 子标识符，指向子结构：apInventoryChangeEvent_StartInvBackpackItems',\n  `startinvpassives` TEXT COMMENT 'AP 子标识符，指向子结构：apInventoryChangeEvent_StartInvPassives',\n  `startinvcurequippedid` TEXT COMMENT '物品 ID - 物品标识符',\n  `startinvcurequippedname` TEXT COMMENT '物品名称 - 物品名称',\n  `startinvcurequippedtype` TEXT COMMENT '物品类型 - 物品的类型',\n  `startinvcurequippedavaamt` DOUBLE COMMENT 'Ares 资源数量 - 技能的充能次数、武器的子弹数和护甲的生命值',\n  `endinvpriweaponid` TEXT COMMENT '物品 ID - 物品标识符',\n  `endinvpriweaponname` TEXT COMMENT '物品名称 - 物品名称',\n  `endinvpriweapontype` TEXT COMMENT '物品类型 - 物品的类型',\n  `endinvpriweaponavaamt` DOUBLE COMMENT 'Ares 资源数量 - 技能的充能次数、武器的子弹数和护甲的生命值',\n  `endinvsecweaponid` TEXT COMMENT '物品 ID - 物品标识符',\n  `endinvsecweaponname` TEXT COMMENT '物品名称 - 物品名称',\n  `endinvsecweapontype` TEXT COMMENT '物品类型 - 物品的类型',\n  `endinvsecweaponavaamt` DOUBLE COMMENT 'Ares 资源数量 - 技能的充能次数、武器的子弹数和护甲的生命值',\n  `endinvmeleeid` TEXT COMMENT '物品 ID - 物品标识符',\n  `endinvmeleename` TEXT COMMENT '物品名称 - 物品名称',\n  `endinvmeleetype` TEXT COMMENT '物品类型 - 物品的类型',\n  `endinvmeleeavaamt` DOUBLE COMMENT 'Ares 资源数量 - 技能的充能次数、武器的子弹数和护甲的生命值',\n  `endinvarmorid` TEXT COMMENT '物品 ID - 物品标识符',\n  `endinvarmorname` TEXT COMMENT '物品名称 - 物品名称',\n  `endinvarmortype` TEXT COMMENT '物品类型 - 物品的类型',\n  `endinvarmoravaamt` DOUBLE COMMENT 'Ares 资源数量 - 技能的充能次数、武器的子弹数和护甲的生命值',\n  `endinvabilities` TEXT COMMENT 'AP 子标识符，指向子结构：apInventoryChangeEvent_EndInvAbilities',\n  `endinvbackpackitems` TEXT COMMENT 'AP 子标识符，指向子结构：apInventoryChangeEvent_EndInvBackpackItems',\n  `endinvpassives` TEXT COMMENT 'AP 子标识符，指向子结构：apInventoryChangeEvent_EndInvPassives',\n  `endinvcurequippedid` TEXT COMMENT '物品 ID - 物品标识符',\n  `endinvcurequippedname` TEXT COMMENT '物品名称 - 物品名称',\n  `endinvcurequippedtype` TEXT COMMENT '物品类型 - 物品的类型',\n  `endinvcurequippedavaamt` DOUBLE COMMENT 'Ares 资源数量 - 技能的充能次数、武器的子弹数和护甲的生命值',\n  `itemname` TEXT COMMENT '物品名称 - 物品名称',\n  `itemid` TEXT COMMENT '物品 ID - 物品标识符',\n  `receiverid` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO 玩家 ID: Riot 玩家的全局唯一 ID',\n  `senderid` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO 玩家 ID: Riot 玩家的全局唯一 ID',\n  `transactiontype` TEXT COMMENT '交易类型 - 可选值：[Purchase（购买）, PickUp（拾取）, FulfillRequest（满足请求）, Drop（丢弃）, Sell（出售）, Transfer（转移）, Default（默认）, Other（其他）]',\n  `aplogtotal` BIGINT COMMENT '由此 AP 事件生成的日志总数',\n  `clientplatformdetailsplatformtype` TEXT COMMENT 'clientPlatformDetailsPlatformType',\n  `clientplatformdetailsplatformmetadata` TEXT COMMENT 'clientPlatformDetailsPlatformMetadata',\n  `platformtype` TEXT COMMENT 'platformType',\n  `apschemaversion` TEXT COMMENT 'apSchemaVersion'\n);\n\n【参考信息】\nprovisioningflowid = \"Matchmaking\" -- 除自定义模式、新手、训练场外所有模式\n\n对局代买筛选逻辑：\nTransactionType = \"FulfillRequest\"\n\n",
    "output": "",
    "category": "行为链条",
    "category_reason": "问题关注特定条件下购买行为的统计，属于用户行为路径分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"行为链条\",\n  \"rationale\": \"问题关注特定条件下购买行为的统计，属于用户行为路径分析。\"\n}"
  },
  {
    "question_id": "sql_28",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计各个玩法上线首周留存情况\n输出：玩法、上线首周首次玩的日期、第几天留存（0,1,2...7)、玩法留存用户数\n\n各玩法首周上线日期：\n\"广域战场\": \"20240723\",\n\"消灭战\": \"20230804\",\n\"幻想混战\": \"20241115\",\n\"荒野传说\": \"20240903\",\n\"策略载具\": \"20241010\",\n\"炎夏混战\": \"20240625\",\n\"单人装备\": \"20240517\",\n\"交叉堡垒\": \"20240412\"\n\n【数据库schema】\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT '统计日期格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `mode` BIGINT COMMENT '模式ID',\n  `modename` TEXT COMMENT '模式名称',\n  `submode` BIGINT COMMENT '子模式ID',\n  `submodename` TEXT COMMENT '子模式名称',\n  `map` BIGINT COMMENT '地图ID',\n  `mapname` TEXT COMMENT '地图名称',\n  `seasonid` BIGINT COMMENT '赛季ID',\n  `seasonname` TEXT COMMENT '赛季名称',\n  `roundcnt` BIGINT COMMENT '当日对局数',\n  `roundtime` BIGINT COMMENT '当日对局时长(秒)',\n  `survivaltime` BIGINT COMMENT '当日存活时长(秒)',\n  `firstroundtime` TEXT COMMENT '当日首次对局时间',\n  `device_type` BIGINT COMMENT '设备类型'\n);\n\n【参考信息】\n说明：\n广域战场 （2024/7/23）submodename= '广域战场模式'，\n消灭战（2023/8/4） modename='组队竞技' and submodename like '%消灭战模式%'，\n幻想混战（2024/11/15）modename='创意创作间' and submodename='幻想混战'，\n荒野传说（2024-09-03）modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')，\n策略载具（2024-10-10）modename='休闲模式' and submodename like '%策略载具%'，\n炎夏混战（2024-06-25）modename='创意创作间' and submodename like '%炎夏混战%'，\n单人装备（2024.5.17）modename='组队竞技' and submodename like '%单人装备%'，\n交叉堡垒（2024.4.12） modename='组队竞技' and submodename like '%交叉堡垒%'\n\n第几天留存：0表示当天参与、1表示当天参与在第2天也参与、2表示当天参与在第3天也参与，依此类推\n\n",
    "output": "select  a.itype,\n        a.dtstatdate,\n        datediff(b.dtstatdate,a.dtstatdate) as idaynum,\n        count(distinct a.vplayerid)           as iusernum\nfrom (                      \n    select\n        itype,\n        min(dtstatdate) as dtstatdate,\n        vplayerid\n    from  (\n        select '广域战场'      as itype,\n                min(dtstatdate) as dtstatdate,\n                vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240723' and dtstatdate <= date_add('20240723',6)\n        and submodename = '广域战场模式'\n        group by vplayerid\n\n        union all\n        select '消灭战', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20230804' and dtstatdate <= date_add('20230804',6)\n        and modename='组队竞技' and submodename like '%消灭战模式%'\n        group by vplayerid\n\n        union all\n        select '幻想混战', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20241115' and dtstatdate <= date_add('20241115',6)\n        and modename='创意创作间' and submodename='幻想混战'\n        group by vplayerid\n\n        union all\n        select '荒野传说', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240903' and dtstatdate <= date_add('20240903',6)\n        and modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')\n        group by vplayerid\n\n        union all\n        select '策略载具', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20241010' and dtstatdate <= date_add('20241010',6)\n        and modename='休闲模式' and submodename like '%策略载具%'\n        group by vplayerid\n\n        union all\n        select '炎夏混战', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240625' and dtstatdate <= date_add('20240625',6)\n        and modename='创意创作间' and submodename like '%炎夏混战%'\n        group by vplayerid\n\n        union all\n        select '单人装备', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240517' and dtstatdate <= date_add('20240517',6)\n        and modename='组队竞技' and submodename like '%单人装备%'\n        group by vplayerid\n\n        union all\n        select '交叉堡垒', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240412' and dtstatdate <= date_add('20240412',6)\n        and modename='组队竞技' and submodename like '%交叉堡垒%'\n        group by vplayerid\n    ) t\n    group by itype, vplayerid\n) a\nleft join (\n        select '广域战场' as itype, dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240723' and dtstatdate <= date_add('20240723',13)\n          and submodename = '广域战场模式'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '消灭战', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20230804' and dtstatdate <= date_add('20230804',13)\n          and modename='组队竞技' and submodename like '%消灭战模式%'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '幻想混战', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20241115' and dtstatdate <= date_add('20241115',13)\n          and modename='创意创作间' and submodename='幻想混战'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '荒野传说', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240903' and dtstatdate <= date_add('20240903',13)\n          and modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')\n        group by dtstatdate, vplayerid\n\n        union all\n        select '策略载具', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20241010' and dtstatdate <= date_add('20241010',13)\n          and modename='休闲模式' and submodename like '%策略载具%'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '炎夏混战', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240625' and dtstatdate <= date_add('20240625',13)\n          and modename='创意创作间' and submodename like '%炎夏混战%'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '单人装备', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240517' and dtstatdate <= date_add('20240517',13)\n          and modename='组队竞技' and submodename like '%单人装备%'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '交叉堡垒', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240412' and dtstatdate <= date_add('20240412',13)\n          and modename='组队竞技' and submodename like '%交叉堡垒%'\n        group by dtstatdate, vplayerid\n) b\n  on  a.itype      = b.itype\nand  a.vplayerid    = b.vplayerid\nwhere datediff(b.dtstatdate,a.dtstatdate) between 0 and 7\ngroup by a.itype, a.dtstatdate, datediff(b.dtstatdate,a.dtstatdate);",
    "category": "留存类",
    "category_reason": "问题关注各玩法上线首周的用户留存情况，属于典型的留存分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注各玩法上线首周的用户留存情况，属于典型的留存分析。\"\n}"
  },
  {
    "question_id": "sql_29",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计周期：2024.6.18至2025年3月30日\n输出：自然周（20240617、20240624、...、20250324），玩法名称，周平均日均参与用户数，周平均日均参与率，周平均日均参与场次\n\n参与率：玩法参与用户数 / 活跃用户数\n周平均日均参与场次：每天不同玩法平均对局数再按周求平均\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT '统计日期格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `mode` BIGINT COMMENT '模式ID',\n  `modename` TEXT COMMENT '模式名称',\n  `submode` BIGINT COMMENT '子模式ID',\n  `submodename` TEXT COMMENT '子模式名称',\n  `map` BIGINT COMMENT '地图ID',\n  `mapname` TEXT COMMENT '地图名称',\n  `seasonid` BIGINT COMMENT '赛季ID',\n  `seasonname` TEXT COMMENT '赛季名称',\n  `roundcnt` BIGINT COMMENT '当日对局数',\n  `roundtime` BIGINT COMMENT '当日对局时长(秒)',\n  `survivaltime` BIGINT COMMENT '当日存活时长(秒)',\n  `firstroundtime` TEXT COMMENT '当日首次对局时间',\n  `device_type` BIGINT COMMENT '设备类型'\n);\n\n【参考信息】\n自然周指周一到周日的完整周期，通常以周一作为起始日\n\n玩法：从上往下匹配，如果满足任一条件则返回对应的玩法名称，否则返回“其他模式”。\n如果模式为“传统模式”，且子模式名称以“CG”开头，且地图为“群屿”，则返回“主题群屿”；\n如果模式为“传统模式”且地图为“群屿”，则返回“传统群屿”；\n如果模式为“传统模式”且地图为“假日群岛”，则返回“假日群岛”；\n如果模式为“传统模式”且地图为“荣耀之城”，则返回“荣耀之城”；\n如果子模式是“广域战场模式”，则返回“广域战场”；\n如果子模式是“极能形态模式”，则返回“极能形态”；\n如果模式是“组队竞技”，则返回“组竞”；\n如果模式是“休闲模式”，则返回“休闲”；\n如果模式是“乐园”，则返回“乐园”；\n如果模式是“领地”，则返回“领地”；\n如果模式是“广阔天地”，则返回“广阔天地”\n如果模式是“生存模式”，则返回“隧道”。\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注玩法参与用户数与活跃用户数的比例及对局频次，属于用户活跃度和行为频率的分布分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注玩法参与用户数与活跃用户数的比例及对局频次，属于用户活跃度和行为频率的分布分析。\"\n}"
  },
  {
    "question_id": "sql_30",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2019.5.8至2025.3.30 分月的玩法主玩情况\n输出：月份(201905、201906、...、202503)、主玩玩法、主玩人数、总参与人数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_playerexitgamerecord_hi` (\n  `tdbank_imp_date` TEXT,\n  `gamesvrid` TEXT COMMENT '登录的游戏服务器编号',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `gameid` TEXT COMMENT '本局游戏ID',\n  `exitreason` TEXT COMMENT '退出原因',\n  `isallianceforceeescape` BIGINT COMMENT '逃跑时是否安全的 否:0/是:1',\n  `escapebantype` BIGINT COMMENT '本次退出是否触发禁赛限制，0=没有触发；1=触发限制一；2=触发限制二；3=触发限制三',\n  `gamestate` TEXT COMMENT '退出时对局状态：Active是在出生岛之前，Ready是在出生岛，Fighting是包括4人集结、上飞机、跳伞战斗这些阶段，Finish 死亡/胜利结束',\n  `submodegroup` BIGINT COMMENT '模式组ID',\n  `lobbyexitreason` TEXT COMMENT '大厅记录的退出原因',\n  `mode` BIGINT COMMENT '模式ID',\n  `submode` BIGINT COMMENT '子模式ID',\n  `roundtime` BIGINT COMMENT '对局时长'\n);\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT '统计日期格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `mode` BIGINT COMMENT '模式ID',\n  `modename` TEXT COMMENT '模式名称',\n  `submode` BIGINT COMMENT '子模式ID',\n  `submodename` TEXT COMMENT '子模式名称',\n  `map` BIGINT COMMENT '地图ID',\n  `mapname` TEXT COMMENT '地图名称',\n  `seasonid` BIGINT COMMENT '赛季ID',\n  `seasonname` TEXT COMMENT '赛季名称',\n  `roundcnt` BIGINT COMMENT '当日对局数',\n  `roundtime` BIGINT COMMENT '当日对局时长(秒)',\n  `survivaltime` BIGINT COMMENT '当日存活时长(秒)',\n  `firstroundtime` TEXT COMMENT '当日首次对局时间',\n  `device_type` BIGINT COMMENT '设备类型'\n);\n\n【参考信息】\n主玩定义：用户累计对局时长最多的玩法；\n\n玩法：从dws_jordass_mode_roundrecord_di取\n从上往下匹配，如果满足以下任一条件，则返回对应的名称，否则返回“其他模式”。\n如果模式为“传统模式”，且子模式名称以“CG”开头，且地图为“群屿”，则返回“主题群屿”；\n如果模式为“传统模式”且地图为“群屿”，则返回“传统群屿”；\n如果模式为“传统模式”且地图为“假日群岛”，则返回“假日群岛”；\n如果模式为“传统模式”且地图为“荣耀之城”，则返回“荣耀之城”；\n如果子模式是“广域战场模式”，则返回“广域战场”；\n如果子模式是“极能形态模式”，则返回“极能形态”；\n如果模式是“组队竞技”，则返回“组竞”；\n如果模式是“休闲模式”，则返回“休闲”；\n如果模式是“乐园”，则返回“乐园”；\n如果模式是“领地”，则返回“领地”；\n如果模式是“广阔天地”，则返回“广阔天地”\n\n注意，参与隧道模式的用户数据从dwd_jordass_playerexitgamerecord_hi取，时间限制 2024.6.18-2025.3.30，mode in (3001, 3002, 3003)\n\n",
    "output": "with main_user as (\n    select substr(dtstatdate, 1, 6) mons,\n        case\n            when modename = '传统模式' and submodename like 'CG%' and mapname = '群屿' then '主题群屿'\n            when modename = '传统模式' and mapname = '群屿' then '传统群屿'\n            when modename = '传统模式' and mapname = '假日群岛' then '假日群岛'\n            when modename = '传统模式' and mapname = '荣耀之城' then '荣耀之城'\n            when submodename = '广域战场模式' then '广域战场'\n            when submodename = '极能形态模式' then '极能形态'\n            when modename = '组队竞技' then '组竞'\n            when modename = '乐园' then '乐园'\n            when modename = '领地' then '领地'\n            when modename = '广阔天地' then '广阔天地'\n            else '其他模式'\n        end imodename,\n        vplayerid,\n        sum(roundtime) / 60 roundtime,\n        sum(roundcnt) roundcnt\n   from dws_jordass_mode_roundrecord_di\n   where dtstatdate between '20190508' and '20250330'\n   group by vplayerid, substr(dtstatdate, 1, 6),\n        case\n            when modename = '传统模式' and submodename like 'CG%' and mapname = '群屿' then '主题群屿'\n            when modename = '传统模式' and mapname = '群屿' then '传统群屿'\n            when modename = '传统模式' and mapname = '假日群岛' then '假日群岛'\n            when modename = '传统模式' and mapname = '荣耀之城' then '荣耀之城'\n            when submodename = '广域战场模式' then '广域战场'\n            when submodename = '极能形态模式' then '极能形态'\n            when modename = '组队竞技' then '组竞'\n            when modename = '乐园' then '乐园'\n            when modename = '领地' then '领地'\n            when modename = '广阔天地' then '广阔天地'\n            else '其他模式'\n        end\n\n   union all\n   \n   select substr (tdbank_imp_date, 1, 6) mons,\n        '隧道' as modename,\n        vplayerid,\n        sum(roundtime) / 60 roundtime,\n        count(distinct gameid) roundcnt\n   from dwd_jordass_playerexitgamerecord_hi\n   where tdbank_imp_date between '2024061800' and '2025033023'\n     and mode in (3001, 3002, 3003)\n   group by substr (tdbank_imp_date, 1, 6), vplayerid\n)\n\nselect a.mons,\n       a.imodename,\n       a.iusernum,\n       b.iusernumall\nfrom (\n    select mons,\n          imodename,\n          count(vplayerid) iusernum\n    from (\n        select mons, vplayerid, imodename\n        from (\n            select mons,\n                vplayerid,\n                imodename,\n                roundtime,\n                row_number() over (partition by mons, vplayerid order by roundtime desc) as rn\n            from main_user\n        )ff1\n        where rn = 1\n    )f1\n   group by mons, imodename\n) a\nleft join (\n    select mons,\n        imodename,\n        count(vplayerid) iusernumall\n   from main_user\n   group by mons, imodename\n) b \non a.imodename = b.imodename and a.mons = b.mons\norder by a.mons, a.imodename\n;",
    "category": "活跃分布",
    "category_reason": "问题关注不同月份下用户在各玩法模式中的参与情况，属于按时间与玩法维度分析用户活跃度分布。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注不同月份下用户在各玩法模式中的参与情况，属于按时间与玩法维度分析用户活跃度分布。\"\n}"
  },
  {
    "question_id": "sql_31",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20250217-20250318协作平台活跃但是没有在协作玩法活跃用户的主玩玩法分布\n输出：主玩玩法（传统模式、休闲模式、...、生存模式）、人数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_matchlog_stat_di` (\n  `dtstatdate` TEXT COMMENT '分区，参与乐园日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `imode` BIGINT COMMENT '乐园子玩法：\t255-所有玩法，用户问题未提到明确的子玩法时，默认为所有玩法\t1282371711108385024-跑酷：成神之路\t1281086178576044544-传媒群岛\t1305619333337074432-狂热派对\t1251206313870885120-砺刃运动会5.0\t1313754433693158656-手球特攻（原足球游戏）\t1296730563346958080-盔仔泡泡小队\t1294279575841283072-夺宝行动\t1310822585431254784-桥梁争夺\t1278160113246405632-砺刃大亨\t1313047366167692288-逆转平底锅\t1298874468735655936-战车突袭\t1278948391311645952-能量争夺战\t1295942084687041792-趣味飞盘\t1282101477461985024-盔仔总动员\t1278144466094392064-黑五模拟器\t1313046652157690624-盔仔斗魔王（原盔仔大乱斗）\t1289446028099979264-佣兵阵线\t1309453077449826304-星星争夺战（原名：金币大作战）\t1298445174154728192-停车大作战\t1294211358396518400-特技大乱斗\t1280302176000803840-卧底行动\t1307095884553538304-\"超级隐匿（原广阔天地隐匿模式）\"\t1297394991875754752-守卫生命线\t1278170390282112000-星球守护者\t1287652322611036928-拼图狂欢\t1273928195100380928-特种兵训练\t1300845150154531840-星之继承者\t1302344773925865984-彩色争夺战\t1296062239742105856-抱团冲冲冲\t1281781308570207232-狙击精英',\n  `teamnum` BIGINT COMMENT '组队人数',\n  `icnt` BIGINT COMMENT '对局次数',\n  `itemp1` BIGINT COMMENT '对局时长',\n  `itemp2` BIGINT COMMENT 'itemp2',\n  `vtemp1` TEXT COMMENT 'vtemp1',\n  `vtemp2` TEXT COMMENT 'vtemp2'\n);\nCREATE TABLE `dwd_jordass_buttonpress_pre_di` (\n  `dtstatdate` TEXT COMMENT '日期',\n  `dteventtime` TEXT,\n  `vgameappid` TEXT,\n  `platid` BIGINT COMMENT '游戏APPID',\n  `izoneareaid` BIGINT COMMENT 'ios 0/android 1',\n  `vplayerid` TEXT,\n  `uid` TEXT COMMENT '角色UID',\n  `buttontype` TEXT COMMENT '按钮代号以分号分隔',\n  `param1` TEXT COMMENT '附加参数1以分号分隔',\n  `param2` TEXT COMMENT '附加参数2以分号分隔',\n  `param3` TEXT COMMENT '附加参数3以分号分隔',\n  `param4` TEXT COMMENT '附加参数4以分号分隔',\n  `param5` TEXT COMMENT '附加参数5以分号分隔',\n  `param6` TEXT COMMENT '附加参数6以分号分隔',\n  `unixtime` TEXT,\n  `ugcmarea` TEXT\n);\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT '统计日期格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `mode` BIGINT COMMENT '模式ID',\n  `modename` TEXT COMMENT '模式名称',\n  `submode` BIGINT COMMENT '子模式ID',\n  `submodename` TEXT COMMENT '子模式名称',\n  `map` BIGINT COMMENT '地图ID',\n  `mapname` TEXT COMMENT '地图名称',\n  `seasonid` BIGINT COMMENT '赛季ID',\n  `seasonname` TEXT COMMENT '赛季名称',\n  `roundcnt` BIGINT COMMENT '当日对局数',\n  `roundtime` BIGINT COMMENT '当日对局时长(秒)',\n  `survivaltime` BIGINT COMMENT '当日存活时长(秒)',\n  `firstroundtime` TEXT COMMENT '当日首次对局时间',\n  `device_type` BIGINT COMMENT '设备类型'\n);\n\n【参考信息】\n主玩定义：用户累计对局时长最多的玩法；\n玩法取 modename in ('传统模式','休闲模式','组队竞技','领地','乐园','广阔天地','创意创作间','生存模式')\n协作平台活跃：ugcmbuttonclick中的玩家；\n协作玩法活跃：vtemp1='协作'  的玩法记录\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是特定时间段内用户在不同玩法中的活跃分布情况。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是特定时间段内用户在不同玩法中的活跃分布情况。\"\n}"
  },
  {
    "question_id": "sql_32",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2023/1/14-2023/1/28\n2024/2/2-2024/2/16\n2025/1/21-2025/2/4\n每天所有玩法的参与人数，总时长\n输出：日期（20230101、20230102、...、20230128、20240202、...、20250204），参与人数，时长（分钟）\n\n【数据库schema】\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT '统计日期格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `mode` BIGINT COMMENT '模式ID',\n  `modename` TEXT COMMENT '模式名称',\n  `submode` BIGINT COMMENT '子模式ID',\n  `submodename` TEXT COMMENT '子模式名称',\n  `map` BIGINT COMMENT '地图ID',\n  `mapname` TEXT COMMENT '地图名称',\n  `seasonid` BIGINT COMMENT '赛季ID',\n  `seasonname` TEXT COMMENT '赛季名称',\n  `roundcnt` BIGINT COMMENT '当日对局数',\n  `roundtime` BIGINT COMMENT '当日对局时长(秒)',\n  `survivaltime` BIGINT COMMENT '当日存活时长(秒)',\n  `firstroundtime` TEXT COMMENT '当日首次对局时间',\n  `device_type` BIGINT COMMENT '设备类型'\n);\n\n【参考信息】\n\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注不同时间段内各玩法的参与人数与总时长，属于时间维度上的活跃度分布。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注不同时间段内各玩法的参与人数与总时长，属于时间维度上的活跃度分布。\"\n}"
  },
  {
    "question_id": "sql_33",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2024年12月14日-2024年12月20日参与建筑争夺玩法的玩家人数（去重）有多少，其中多少人是12月13日及以前有参与过建筑争夺的老玩家，有多少是新玩家\n输出: 玩家人数、老玩家人数、新玩家人数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_playermatchrecord_stat_df` (\n  `dtstatdate` TEXT COMMENT '分区，参与乐园日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `imode` BIGINT COMMENT '乐园模式',\n  `cbitmap` TEXT COMMENT '登录位图',\n  `dregdate` TEXT COMMENT '注册日期',\n  `ljicnt` BIGINT COMMENT '累计对局数',\n  `icnt` BIGINT COMMENT '当日对局数',\n  `teamnum` BIGINT COMMENT '组队人数',\n  `itemp1` BIGINT COMMENT 'itemp1',\n  `itemp2` BIGINT COMMENT 'itemp2',\n  `vtemp1` TEXT COMMENT 'vtemp1',\n  `vtemp2` TEXT COMMENT 'vtemp2'\n);\nCREATE TABLE `dws_jordass_matchlog_stat_di` (\n  `dtstatdate` TEXT COMMENT '分区，参与乐园日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `imode` BIGINT COMMENT '乐园子玩法：\t255-所有玩法，用户问题未提到明确的子玩法时，默认为所有玩法\t1282371711108385024-跑酷：成神之路\t1281086178576044544-传媒群岛\t1305619333337074432-狂热派对\t1251206313870885120-砺刃运动会5.0\t1313754433693158656-手球特攻（原足球游戏）\t1296730563346958080-盔仔泡泡小队\t1294279575841283072-夺宝行动\t1310822585431254784-桥梁争夺\t1278160113246405632-砺刃大亨\t1313047366167692288-逆转平底锅\t1298874468735655936-战车突袭\t1278948391311645952-能量争夺战\t1295942084687041792-趣味飞盘\t1282101477461985024-盔仔总动员\t1278144466094392064-黑五模拟器\t1313046652157690624-盔仔斗魔王（原盔仔大乱斗）\t1289446028099979264-佣兵阵线\t1309453077449826304-星星争夺战（原名：金币大作战）\t1298445174154728192-停车大作战\t1294211358396518400-特技大乱斗\t1280302176000803840-卧底行动\t1307095884553538304-\"超级隐匿（原广阔天地隐匿模式）\"\t1297394991875754752-守卫生命线\t1278170390282112000-星球守护者\t1287652322611036928-拼图狂欢\t1273928195100380928-特种兵训练\t1300845150154531840-星之继承者\t1302344773925865984-彩色争夺战\t1296062239742105856-抱团冲冲冲\t1281781308570207232-狙击精英',\n  `teamnum` BIGINT COMMENT '组队人数',\n  `icnt` BIGINT COMMENT '对局次数',\n  `itemp1` BIGINT COMMENT '对局时长',\n  `itemp2` BIGINT COMMENT 'itemp2',\n  `vtemp1` TEXT COMMENT 'vtemp1',\n  `vtemp2` TEXT COMMENT 'vtemp2'\n);\n\n【参考信息】\n建筑争夺玩法对应的imode为1344338933661592832\n\n",
    "output": "select\n    count(distinct a.vplayerid) as total_players,\n    count(distinct case when b.vplayerid is not null then a.vplayerid end) as existing_players,\n    count(distinct case when b.vplayerid is null then a.vplayerid end) as new_players\nfrom (\n    select vplayerid\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate between '20241214' and '20241220'\n    and imode = 1344338933661592832\n    and platid = 255\n    group by vplayerid\n) a\nleft join (\n    select vplayerid\n    from dws_jordass_playermatchrecord_stat_df\n    where dtstatdate = '20241213'\n    and imode = 1344338933661592832\n    and platid = 255\n    group by vplayerid\n) b\non a.vplayerid = b.vplayerid\n;",
    "category": "用户分群",
    "category_reason": "问题核心是区分新老玩家群体并统计各群体人数，属于用户分群分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"用户分群\",\n  \"rationale\": \"问题核心是区分新老玩家群体并统计各群体人数，属于用户分群分析。\"\n}"
  },
  {
    "question_id": "sql_34",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2024.9.17-2024.9.23 和 2024.10.8-2024.10.14    每天点击按钮后加入玩法，再之后点击确认的人数，以及这些人加入玩法的次数                                                       \n输出：日期(20240917、...、20240923、20241008、...、20241014)，人数，人次\n\n【数据库schema】\nCREATE TABLE `dws_jordass_buttonpress_pre_di` (\n  `dtstatdate` TEXT COMMENT '统计日期，格式YYYYMMDD',\n  `dteventtime` TEXT COMMENT '事件时间,格式YYYY-MM-DDHH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` TEXT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` TEXT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `clientversion` TEXT COMMENT 'clientversion',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `uid` TEXT COMMENT '角色ID',\n  `buttontype` TEXT COMMENT '按钮代号',\n  `ireason` TEXT COMMENT '额外参数',\n  `extarg1` TEXT COMMENT '附加参数1',\n  `extarg2` TEXT COMMENT '附加参数2'\n);\n\n【参考信息】\nbuttontype为411111代表点击按钮，411120代表加入玩法，411123代表确认\n\n",
    "output": "select\n    ds,\n    count(distinct vplayerid) as user_cnt,\n    count(distinct vplayerid, irank) as user_times\nfrom (\n    select\n        s2.ds,\n        s2.vplayerid,\n        s2.irank\n    from (\n        -- 获取411111事件（点击按钮）\n        select\n            dtstatdate as ds,\n            vplayerid,\n            dteventtime\n        from dws_jordass_buttonpress_pre_di\n        where buttontype = 411111\n        and  ((dtstatdate between '20240917' and '20240923') or (dtstatdate between '20241008' and '20241014'))\n    ) s1\n    join (\n        -- 获取411120事件（加入玩法）并编号\n        select\n            dtstatdate as ds,\n            vplayerid,\n            dteventtime,\n            row_number() over (partition by vplayerid order by dteventtime) as irank\n        from dws_jordass_buttonpress_pre_di\n        where buttontype = 411120\n        and ((dtstatdate between '20240917' and '20240923') or (dtstatdate between '20241008' and '20241014'))\n    ) s2 on s1.vplayerid = s2.vplayerid and s1.ds = s2.ds and s2.dteventtime > s1.dteventtime\n    join (\n        -- 获取411123事件（确认动作）\n        select\n            dtstatdate as ds,\n            vplayerid,\n            dteventtime\n        from dws_jordass_buttonpress_pre_di\n        where buttontype = 411123\n        and ((dtstatdate between '20240917' and '20240923') or (dtstatdate between '20241008' and '20241014'))\n    ) s3 on s2.vplayerid = s3.vplayerid and s2.ds = s3.ds and s3.dteventtime > s2.dteventtime\n)f \ngroup by ds\n;",
    "category": "行为链条",
    "category_reason": "问题关注用户从点击按钮到加入玩法再到确认的多步骤行为路径分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"行为链条\",\n  \"rationale\": \"问题关注用户从点击按钮到加入玩法再到确认的多步骤行为路径分析。\"\n}"
  },
  {
    "question_id": "sql_35",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2024年3月26日~4月3日\n2024年5月28日~6月5日\n不同对局类型的游戏和玩法留存情况\n输出：统计日期(20240326、...、20240403、20240528、...、20240605)、对局类型（第一人称、单排、双排、四排），每日对局人数、次数、对局总时长(秒)、游戏次留人数、游戏7留人数，玩法次留人数、玩法7留人数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT '统计日期格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `mode` BIGINT COMMENT '模式ID',\n  `modename` TEXT COMMENT '模式名称',\n  `submode` BIGINT COMMENT '子模式ID',\n  `submodename` TEXT COMMENT '子模式名称',\n  `map` BIGINT COMMENT '地图ID',\n  `mapname` TEXT COMMENT '地图名称',\n  `seasonid` BIGINT COMMENT '赛季ID',\n  `seasonname` TEXT COMMENT '赛季名称',\n  `roundcnt` BIGINT COMMENT '当日对局数',\n  `roundtime` BIGINT COMMENT '当日对局时长(秒)',\n  `survivaltime` BIGINT COMMENT '当日存活时长(秒)',\n  `firstroundtime` TEXT COMMENT '当日首次对局时间',\n  `device_type` BIGINT COMMENT '设备类型'\n);\n\n【参考信息】\n第一人称：mode 的取值在 401、402 或 403；\n单排： mode 等于 101；\n双排： mode 等于 102；\n四排： mode 等于 103 或 603。\n\n玩法次留：当天参与玩法且第二天同样参与玩法\n游戏次留：当天在游戏活跃且第2天也在游戏活跃\n\n",
    "output": "with round_user as (\n    select dtstatdate,\n        case \n            when mode in (401,402,403) then '第一人称'\n            when mode =101 then '单排'\n            when mode =102 then '双排'\n            when mode in (103,603) then '四排'\n        end modename,\n        vplayerid,\n        sum(roundcnt) roundcnt,\n        sum(roundtime) roundtime\n    from dws_jordass_mode_roundrecord_di\n    where ((dtstatdate between '20240326' and '20240409')\n    or (dtstatdate between '20240528' and '20240611'))\n    and mode in (401,402,403,101,102,103,603)\n    group by dtstatdate,\n    case when mode in (401,402,403) then '第一人称'\n        when mode =101 then '单排'\n        when mode =102 then '双排'\n        when mode in (103,603) then '四排'\n    end,\n    vplayerid\n)\n\nselect \n    a.dtstatdate,\n    a.modename,\n    count(distinct a.vplayerid) iusernum,\n    sum(a.roundcnt) roundcnt,\n    sum(a.roundtime) roundtime,\n    count(distinct b1.vplayerid) stay2,\n    count(distinct b2.vplayerid) stay7,\n    count(distinct c1.vplayerid) playstay2,\n    count(distinct c2.vplayerid) playstay7\nfrom (\n    select * from round_user \n    where((dtstatdate between '20240326' and '20240403') or (dtstatdate between '20240528' and '20240605'))\n) a\nleft join (\n    select dtstatdate,vplayerid \n    from dws_jordass_login_di\n    where ((dtstatdate between '20240326' and '20240404') or (dtstatdate between '20240528' and '20240606')) \n    and platid =255\n    group by dtstatdate,vplayerid\n) b1 \non a.vplayerid = b1.vplayerid and date_add(a.dtstatdate,1) = b1.dtstatdate\nleft join (\n    select dtstatdate,vplayerid \n    from dws_jordass_login_di\n    where ((dtstatdate between '20240326' and '20240409') or (dtstatdate between '20240528' and '20240611')) and platid =255\n    group by dtstatdate,vplayerid\n) b2 \non a.vplayerid = b2.vplayerid and date_add(a.dtstatdate,6) = b2.dtstatdate\nleft join round_user c1 \non a.vplayerid = c1.vplayerid and date_add(a.dtstatdate,1) = c1.dtstatdate and a.modename= c1.modename\nleft join round_user c2 \non a.vplayerid = c2.vplayerid and date_add(a.dtstatdate,6) = c2.dtstatdate and a.modename= c2.modename\ngroup by a.dtstatdate,a.modename\n;",
    "category": "留存类",
    "category_reason": "问题关注不同对局类型下用户的留存情况，属于典型的留存分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注不同对局类型下用户的留存情况，属于典型的留存分析。\"\n}"
  },
  {
    "question_id": "sql_37",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计注册日期在2025.4.1-2025.5.30的模拟器新进用户在用户类型（模拟器、手机端、整体砺刃游戏内），次留、三留、七留、14留、30留情况\n输出:日期(20250401、...、20250530)、人数、用户类型（模拟器、手机端、游戏内、未知）、次留人数、三留人数、七留人数、14留人数、30留人数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_device_login_di` (\n  `dtstatdate` TEXT COMMENT '统计日期',\n  `vgameappid` TEXT COMMENT 'qq/wx',\n  `platid` BIGINT COMMENT 'ios0/android1',\n  `vplayerid` TEXT COMMENT 'vplayerid',\n  `device_type` BIGINT COMMENT '登录端',\n  `loginchannel` BIGINT COMMENT '登录渠道',\n  `ionlinetime` BIGINT COMMENT '在线时长',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `vtemp1` TEXT COMMENT '预留字段1',\n  `vtemp2` TEXT COMMENT '预留字段2',\n  `vtemp3` TEXT COMMENT '预留字段3',\n  `itemp1` BIGINT COMMENT '预留字段4',\n  `itemp2` BIGINT COMMENT '预留字段5',\n  `itemp3` BIGINT COMMENT '预留字段6',\n  `seasonmaxsegment` BIGINT COMMENT '当前赛季最高段位'\n);\nCREATE TABLE `dws_jordass_emulator_df` (\n  `dtstatdate` TEXT COMMENT '日期',\n  `vgameappid` TEXT COMMENT 'vgameappid',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT 'playerid',\n  `dregdate` TEXT COMMENT '首次使用模拟器日期',\n  `itemp1` BIGINT COMMENT '预留数字1',\n  `itemp2` BIGINT COMMENT '预留数字2',\n  `vtemp1` TEXT COMMENT '预留字符1',\n  `vtemp2` TEXT COMMENT '预留字符2'\n);\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\n\n【参考信息】\n模拟器新进用户从dws_jordass_emulator_df取，限制统计日期为20251001\n模拟器：device_type in (1,5)；\n手机端：device_type=0\n\n",
    "output": "select \n    s1.ds as `ds`, -- 日期\n    count(distinct s1.vplayerid) as `user_cnt`, -- 人数\n    coalesce(user_type, '未知') as `user_type`, -- 用户类型\n    count(distinct case when s2.ds = date_add(s1.ds, 1) then s1.vplayerid else null end) as `next_day_retention`, -- 次留人数\n    count(distinct case when s2.ds = date_add(s1.ds, 2) then s1.vplayerid else null end) as `three_day_retention`, -- 三留人数\n    count(distinct case when s2.ds = date_add(s1.ds, 6) then s1.vplayerid else null end) as `seven_day_retention`, -- 七留人数\n    count(distinct case when s2.ds = date_add(s1.ds, 13) then s1.vplayerid else null end) as `fourteen_day_retention`, -- 14留人数\n    count(distinct case when s2.ds = date_add(s1.ds, 29) then s1.vplayerid else null end) as `thirty_day_retention` -- 30留人数\nfrom (\n    select \n        f1.dregdate as ds,  -- 日期\n        f1.vplayerid as vplayerid  -- 用户id\n    from  dws_jordass_emulator_df f1\n    where   f1.dtstatdate = '20251001'  \n        and f1.dregdate >= '20250401'  \n        and f1.dregdate <= '20250530'  \n        and f1.platid = 255  \n) s1\nleft join (\n    select \n        f1.dtstatdate as ds, -- 统计日期\n        f1.vplayerid as vplayerid, -- 手机端登录用户id\n        '手机端' as user_type\n    from  dws_jordass_device_login_di f1\n    where  f1.device_type=0 -- 手机端\n    and f1.dtstatdate >= '20250401' and f1.dtstatdate <= date_add('20250530', 29)\n\n    union all\n\n    select \n        f1.dtstatdate as ds, -- 统计日期\n        f1.vplayerid as vplayerid, -- 手机端登录用户id\n        '模拟器' as user_type\n    from  dws_jordass_device_login_di f1\n    where  f1.device_type in (1,5) -- 模拟器\n    and f1.dtstatdate >= '20250401' and f1.dtstatdate <= date_add('20250530', 29)\n\n    union all\n\n    select \n        f1.dtstatdate as ds,  -- 日期\n        f1.vplayerid as vplayerid,  -- 整体游戏内登录用户id\n        '游戏内' as user_type\n    from   dws_jordass_login_di f1  \n    where  f1.dtstatdate >= '20250401' and f1.dtstatdate <= date_add('20250530', 29)\n    and f1.platid = 255  -- 不区分系统平台\n) s2 \n    on   s1.vplayerid = s2.vplayerid\n    group by   s1.ds, user_type\n;",
    "category": "留存类",
    "category_reason": "问题关注新进用户在不同时间点的留存情况，属于典型的留存分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注新进用户在不同时间点的留存情况，属于典型的留存分析。\"\n}"
  },
  {
    "question_id": "sql_38",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计不同玩法不同用户类型的参与情况\n\n输出：玩法、用户类型（砺刃新增、砺刃回流（流失60天以上）、砺刃回流（流失21-59天）、砺刃回流（流失14-20天）、砺刃回流（流失7-13天）、砺刃留存、平台盘内、平台盘外）、上线后3天参与用户数、上线后3天总用户数\n\n各玩法上线日期：\n\"广域战场\": \"20240723\",\n\"消灭战\": \"20230804\",\n\"幻想混战\": \"20241115\",\n\"荒野传说\": \"20240903\",\n\"策略载具\": \"20241010\",\n\"炎夏混战\": \"20240625\",\n\"单人装备\": \"20240517\",\n\"交叉堡垒\": \"20240412\"\n\n【数据库schema】\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT '统计日期YYYYMMDD',\n  `saccounttype` TEXT COMMENT '帐号类型:QQ号或者微信',\n  `suserid` TEXT COMMENT '帐号',\n  `suseridtype` TEXT COMMENT '帐号类型:qq wxid playerid',\n  `sgamecode` TEXT COMMENT '业务',\n  `splattype` TEXT COMMENT '平台类型(大平台)。枚举值为Android/ iOS，取汇总时取-100',\n  `splat` TEXT COMMENT '平台(小平台)。备注：写死的-100',\n  `sgameparam` TEXT COMMENT '场次',\n  `schannel` TEXT COMMENT '不可用字段，用户可以忽略',\n  `sip` TEXT COMMENT '实际上是当日登录的最小时间戳，即最早登录时间',\n  `sclientver` TEXT COMMENT '客户端版本',\n  `ilevel` BIGINT COMMENT '用户等级。不可用',\n  `iviplevel` BIGINT COMMENT 'Vip等级。不可用',\n  `itimes` BIGINT COMMENT '活跃总次数。备注：该字段表示用户在T日的当日活跃总次数',\n  `ionlinetime` BIGINT COMMENT '活跃总时间。备注：该字段表示用户在T日的当日活跃总时间'\n);\nCREATE TABLE `dws_jordass_login_df` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:不区分平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '登录位图',\n  `dregdate` TEXT COMMENT '注册日期，格式YYYYMMDD',\n  `ilevel` BIGINT COMMENT '等级',\n  `friendcount` BIGINT COMMENT '好友数量'\n);\nCREATE TABLE `dim_jordass_playerid2suserid_nf` (\n  `vplayerid` TEXT COMMENT 'vplayerid',\n  `suserid` TEXT COMMENT 'suserid'\n);\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT '统计日期格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `mode` BIGINT COMMENT '模式ID',\n  `modename` TEXT COMMENT '模式名称',\n  `submode` BIGINT COMMENT '子模式ID',\n  `submodename` TEXT COMMENT '子模式名称',\n  `map` BIGINT COMMENT '地图ID',\n  `mapname` TEXT COMMENT '地图名称',\n  `seasonid` BIGINT COMMENT '赛季ID',\n  `seasonname` TEXT COMMENT '赛季名称',\n  `roundcnt` BIGINT COMMENT '当日对局数',\n  `roundtime` BIGINT COMMENT '当日对局时长(秒)',\n  `survivaltime` BIGINT COMMENT '当日存活时长(秒)',\n  `firstroundtime` TEXT COMMENT '当日首次对局时间',\n  `device_type` BIGINT COMMENT '设备类型'\n);\n\n【参考信息】\n从平台大盘表取数据固定逻辑：\nsAccountType ='-100' and sgamecode <>'-100' and splattype = '-100' and splat = '-100'\n\n- 用户类型的定义：\n砺刃新增：上线后3天(包含上线当天)砺刃新增用户，并且参与了玩法的用户\n砺刃留存：上线前一周在砺刃活跃过，并且在上线后3天参与了玩法的用户\n砺刃回流：上线前一周没有在砺刃活跃过，但是之前在砺刃注册过，并且上线后3天参与了玩法的用户，然后按上线日期前N天连续未活跃时长区分：流失(7-13]天，流失[14-20]天，流失[21-59]天，流失60天及以上\n平台盘内：上线前一周在平台大盘活跃过，并且没有在砺刃活跃过，并且上线后3天参与了玩法的用户\n平台盘外：上线前一周没有在平台大盘内活跃过的，并且上线后3天参与了玩法的用户；\n\n广域战场 （2024/7/23）submodename= '广域战场模式'，\n消灭战（2023/8/4） modename='组队竞技' and submodename like '%消灭战模式%'，\n幻想混战（2024/11/15）modename='创意创作间' and submodename='幻想混战'，\n荒野传说（2024-09-03）modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')，\n策略载具（2024-10-10）modename='休闲模式' and submodename like '%策略载具%'，\n炎夏混战（2024-06-25）modename='创意创作间' and submodename like '%炎夏混战%'，\n单人装备（2024.5.17）modename='组队竞技' and submodename like '%单人装备%'，\n交叉堡垒（2024.4.12） modename='组队竞技' and submodename like '%交叉堡垒%'\n\n\n注意：suserid 和 vplayerid是两套用户账号体系；平台大盘代表所有游戏的数据，sgamecode='jordass'代表砺刃使者\n\n",
    "output": "with usertype as (\n    select '广域战场' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20240723',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '消灭战' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20230804',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '幻想混战' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20241115',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '荒野传说' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20240903',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '策略载具' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20241010',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '炎夏混战' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20240625',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '单人装备' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20240517',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '交叉堡垒' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20240412',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n),\ndapan as (\n    select '广域战场' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate >= cast(date_format(date_sub('20240723',7), '%Y%m%d') as bigint) and dtstatdate <= cast(date_format(date_sub('20240723',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '消灭战' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate >= cast(date_format(date_sub('20230804',7), '%Y%m%d') as bigint) and dtstatdate <= cast(date_format(date_sub('20230804',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '幻想混战' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate between cast(date_format(date_sub('20241115',7), '%Y%m%d') as bigint) and cast(date_format(date_sub('20241115',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '荒野传说' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate between cast(date_format(date_sub('20240903',7), '%Y%m%d') as bigint) and cast(date_format(date_sub('20240903',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '策略载具' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate between cast(date_format(date_sub('20241010',7), '%Y%m%d') as bigint) and cast(date_format(date_sub('20241010',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '炎夏混战' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate between cast(date_format(date_sub('20240625',7), '%Y%m%d') as bigint) and cast(date_format(date_sub('20240625',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '单人装备' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate between cast(date_format(date_sub('20240517',7), '%Y%m%d') as bigint) and cast(date_format(date_sub('20240517',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '交叉堡垒' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate between cast(date_format(date_sub('20240412',7), '%Y%m%d') as bigint) and cast(date_format(date_sub('20240412',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n),\ndapan2jordass as (\n    select distinct itype, b.vplayerid, flag1\n    from dapan a\n    join (\n        select vplayerid,suserid from dim_jordass_playerid2suserid_nf\n    ) b on a.suserid = b.suserid\n),\nplayuser as (\n    select '广域战场' itype, min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240723' and dtstatdate <= date_add('20240723',2) and submodename= '广域战场模式'\n    group by vplayerid\n    union all\n    select '消灭战' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20230804' and dtstatdate <= date_add('20230804',2) and modename='组队竞技' and submodename like '%消灭战模式%'\n    group by vplayerid\n    union all\n    select '幻想混战' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20241115' and dtstatdate <= date_add('20241115',2) and modename='创意创作间' and submodename='幻想混战'\n    group by vplayerid\n    union all\n    select '荒野传说' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240903' and dtstatdate <= date_add('20240903',2) and modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')\n    group by vplayerid\n    union all\n    select '策略载具' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20241010' and dtstatdate <= date_add('20241010',2) and modename='休闲模式' and submodename like '%策略载具%'\n    group by vplayerid\n    union all\n    select '炎夏混战' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240625' and dtstatdate <= date_add('20240625',2) and modename='创意创作间' and submodename like '%炎夏混战%'\n    group by vplayerid\n    union all\n    select '单人装备' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240517' and dtstatdate <= date_add('20240517',2) and modename='组队竞技' and submodename like '%单人装备%'\n    group by vplayerid\n    union all\n    select '交叉堡垒' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240412' and dtstatdate <= date_add('20240412',2) and modename='组队竞技' and submodename like '%交叉堡垒%'\n    group by vplayerid\n)\n\nselect \n    t.itype,\n    t.user_type,\n    t.iusernum1,\n    p.iusernum2\nfrom (\n    select \n        a.itype,\n        b.user_type,\n        count(distinct a.vplayerid) iusernum1\n    from playuser a\n    join (\n        select \n            itype, vplayerid,\n            case \n                when datediff(dtstatdate,dregdate)<=2 then '砺刃新增'\n                when instr(substr(cbitmap,4),'1')=0 or instr(substr(cbitmap,4),'1')>=60 then '砺刃回流（流失60天以上）'\n                when instr(substr(cbitmap,4),'1')>=21 then '砺刃回流（流失21-59天）'\n                when instr(substr(cbitmap,4),'1')>=14 then '砺刃回流（流失14-20天）'\n                when instr(substr(cbitmap,4),'1')>7 then '砺刃回流（流失7-13天）'\n                when instr(substr(cbitmap,4),'1')<=7 then '砺刃留存' \n            end user_type\n        from usertype\n    ) b on a.itype = b.itype and a.vplayerid = b.vplayerid\n    group by a.itype,b.user_type\n\n    union all\n    \n    select \n        a.itype, \n        case \n            when flag1=0 then '平台盘内' \n            when b.vplayerid is null then '平台盘外' \n        end user_type, \n    count(distinct a.vplayerid) iusernum1\n    from playuser a\n    left join dapan2jordass b \n    on a.itype = b.itype and a.vplayerid = b.vplayerid\n    where flag1=0 or b.vplayerid is null\n    group by a.itype, case when flag1=0 then '平台盘内' when b.vplayerid is null then '平台盘外' end\n) t\nleft join (\n    select itype,\n        case \n            when datediff(dtstatdate,dregdate)<=2 then '砺刃新增'\n            when instr(substr(cbitmap,4),'1')=0 or instr(substr(cbitmap,4),'1')>=60 then '砺刃回流（流失60天以上）'\n            when instr(substr(cbitmap,4),'1')>=21 then '砺刃回流（流失21-59天）'\n            when instr(substr(cbitmap,4),'1')>=14 then '砺刃回流（流失14-20天）'\n            when instr(substr(cbitmap,4),'1')>7 then '砺刃回流（流失7-13天）'\n            when instr(substr(cbitmap,4),'1')<=7 then '砺刃留存' \n        end user_type,\n        count(distinct vplayerid) iusernum2\n    from usertype\n    group by itype,\n        case \n            when datediff(dtstatdate,dregdate)<=2 then '砺刃新增'\n            when instr(substr(cbitmap,4),'1')=0 or instr(substr(cbitmap,4),'1')>=60 then '砺刃回流（流失60天以上）'\n            when instr(substr(cbitmap,4),'1')>=21 then '砺刃回流（流失21-59天）'\n            when instr(substr(cbitmap,4),'1')>=14 then '砺刃回流（流失14-20天）'\n            when instr(substr(cbitmap,4),'1')>7 then '砺刃回流（流失7-13天）'\n            when instr(substr(cbitmap,4),'1')<=7 then '砺刃留存' \n        end\n\n    union all\n\n    select itype,'平台盘内',count(distinct vplayerid) \n    from dapan2jordass \n    group by itype\n) p on t.itype=p.itype and t.user_type=p.user_type\n;",
    "category": "活跃分布",
    "category_reason": "问题关注不同玩法下各类用户的参与情况，属于按玩法和用户类型划分的活跃度分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注不同玩法下各类用户的参与情况，属于按玩法和用户类型划分的活跃度分析。\"\n}"
  },
  {
    "question_id": "sql_39",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计各个玩法参与用户其他玩法流入和双栖情况\n\n输出：流入玩法、流出玩法、上线后3天流入玩法参与用户数、上线后3天流出用户数、上线后3天双栖用户数、上线前一周流出玩法总参与用户数、流出占比、上线后3天流出玩法总参与用户数、双栖占比\n\n【数据库schema】\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT '统计日期格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `mode` BIGINT COMMENT '模式ID',\n  `modename` TEXT COMMENT '模式名称',\n  `submode` BIGINT COMMENT '子模式ID',\n  `submodename` TEXT COMMENT '子模式名称',\n  `map` BIGINT COMMENT '地图ID',\n  `mapname` TEXT COMMENT '地图名称',\n  `seasonid` BIGINT COMMENT '赛季ID',\n  `seasonname` TEXT COMMENT '赛季名称',\n  `roundcnt` BIGINT COMMENT '当日对局数',\n  `roundtime` BIGINT COMMENT '当日对局时长(秒)',\n  `survivaltime` BIGINT COMMENT '当日存活时长(秒)',\n  `firstroundtime` TEXT COMMENT '当日首次对局时间',\n  `device_type` BIGINT COMMENT '设备类型'\n);\n\n【参考信息】\n流入玩法上线日期和取数逻辑：\n广域战场 （2024/7/23）submodename= '广域战场模式'，\n消灭战（2023/8/4） modename='组队竞技' and submodename like '%消灭战模式%'，\n幻想混战（2024/11/15）modename='创意创作间' and submodename='幻想混战'，\n荒野传说（2024-09-03）modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')，\n策略载具（2024-10-10）modename='休闲模式' and submodename like '%策略载具%'，\n炎夏混战（2024-06-25）modename='创意创作间' and submodename like '%炎夏混战%'，\n单人装备（2024.5.17）modename='组队竞技' and submodename like '%单人装备%'，\n交叉堡垒（2024.4.12） modename='组队竞技' and submodename like '%交叉堡垒%'，\n庆典混战（2024/4/26）submode in (2611)，\nCG28战场进化（2024/9/3） modename='传统模式' and submodename ='CG28-动物丛林'，\nCG29流浪地球（2024/11/5） modename='传统模式' and submodename ='CG29-流浪地球'\n\n流出玩法：从上往下匹配，如果满足任一条件则返回对应的玩法名称，否则返回“其他子模式”。\n主题群屿：modename='传统模式' and submodename like 'CG%' and mapname='群屿'\n传统群屿：modename='传统模式' and mapname='群屿'\n假日群岛：modename='传统模式' and mapname='假日群岛'\n山峦：modename='传统模式' and mapname='山峦'\n极能形态模式：submodename='极能形态模式'\n隧道：modename='生存模式'\n广域战场：submodename='广域战场模式'\n休闲模式：modename='休闲模式'\n乐园：modename='乐园'\n领地：modename='领地'\n广阔天地：modename='广阔天地'\n组队竞技：modename='组队竞技'\n\n用户定义：\n流出用户：流入玩法上线前一周玩了流出玩法，并且流入玩法上线后3天没有玩流出玩法，但是有玩流入玩法\n双栖用户：流入玩法上线前一周 和 上线后3天都玩了流出玩法\n流出占比：流出用户除以上线前一周流出玩法总参与\n双栖占比：双栖用户除以上线首周流出玩法总参与\n\n",
    "output": "with playuser as (\n    select '广域战场' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate= '20240723'  and  date_add('20240723',2) and submodename= '广域战场模式'\n    group by 1,2,3\n    union all\n    select '消灭战' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20230804'  and  date_add('20230804',2) and modename='组队竞技' and submodename like '%消灭战模式%'\n    group by 1,2,3\n    union all\n    select '幻想混战' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20241115' and  date_add('20241115',2) and modename='创意创作间' and submodename='幻想混战'\n    group by 1,2,3\n    union all\n    select '荒野传说' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20240903'  and  date_add('20240903',2) and modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')\n    group by 1,2,3\n    union all\n    select '策略载具' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20241010'   and  date_add('20241010',2) and modename='休闲模式' and submodename like '%策略载具%'\n    group by 1,2,3\n    union all\n    select '炎夏混战' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20240625'   and  date_add('20240625',2) and modename='创意创作间' and submodename like '%炎夏混战%'\n    group by 1,2,3\n    union all\n    select '单人装备' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20240517'   and  date_add('20240517',2) and modename='组队竞技' and submodename like '%单人装备%'\n    group by 1,2,3\n    union all\n    select '交叉堡垒' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20240412'   and  date_add('20240412',2) and modename='组队竞技' and submodename like '%交叉堡垒%'\n    group by 1,2,3\n    union all\n    select '庆典混战' as itype,dtstatdate,vplayerid\n    from  dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20240426'  and  date_add('20240426',2) and submode in (2611)\n    group by dtstatdate,vplayerid\n    union all\n    select 'CG29-流浪地球' as itype,dtstatdate,vplayerid\n    from  dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20240903' and  date_add('20240903',2)and submodename = 'CG29-流浪地球'\n    group by dtstatdate,vplayerid\n    union all\n    select 'CG28-动物丛林' as itype,dtstatdate,vplayerid\n    from  dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20241105' and  date_add('20241105',2)and submodename = 'CG28-动物丛林'\n    group by dtstatdate,vplayerid\n),\nallplayuser as (\n    select '广域战场' itype,\n        case \n            when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n        end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240723' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240723' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240723',7) and dtstatdate <= date_add('20240723',2)  \n    group by \n        case \n            when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n        end ,\n        vplayerid\n    union all\n    select '消灭战' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20230804' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20230804' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20230804',7) and dtstatdate <= date_add('20230804',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '幻想混战' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20241115' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20241115' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20241115',7) and dtstatdate <= date_add('20241115',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '荒野传说' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240903' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240903' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240903',7) and dtstatdate <= date_add('20240903',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '策略载具' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20241010' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20241010' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20241010',7) and dtstatdate <= date_add('20241010',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '炎夏混战' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240625' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240625' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240625',7) and dtstatdate <= date_add('20240625',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '单人装备' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240517' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240517' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240517',7) and dtstatdate <= date_add('20240517',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '交叉堡垒' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240412' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240412' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240412',7) and dtstatdate <= date_add('20240412',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '庆典混战' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240426' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240426' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240426',7) and dtstatdate <= date_add('20240426',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select 'CG28-动物丛林' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240903' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240903' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240903',7) and dtstatdate <= date_add('20240903',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select 'CG29-流浪地球' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20241105' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20241105' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20241105',7) and dtstatdate <= date_add('20241105',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n)\n\nselect  \n    t.itype, \n    t.playclass1, \n    iusernum1, -- 流入玩法参与用户数\n    iusernum2, -- 流出用户数\n    iusernum3, -- 双栖用户数\n    iusernum4, -- 前一周流出玩法用户数\n    coalesce(round(iusernum2/iusernum4, 2), 0) as ratio1, -- 流出占比\n    iusernum5, -- 后3天流出玩法用户数\n    coalesce(round(iusernum3/iusernum5, 2), 0) as ratio2 -- 双栖占比\nfrom (\n    select itype,count(distinct vplayerid) iusernum1 from playuser group by itype\n)p\nleft join (\n    select \n        a.itype,\n        b.playclass1,\n        count(distinct case when islast=1 and isthis =0 then a.vplayerid end) iusernum2,\n        count(distinct case when islast=1 and isthis =1 then a.vplayerid end) iusernum3\n    from playuser a\n    left join allplayuser b \n    on a.itype =b.itype and a.vplayerid = b.vplayerid\n    group by a.itype,b.playclass1\n)t on p.itype = t.itype\nleft join (\n    select \n        itype, \n        playclass1,\n        count(distinct case when islast=1 then vplayerid end) iusernum4,\n        count(distinct case when isthis=1 then vplayerid end) iusernum5\n    from allplayuser\n    group by itype,playclass1\n) m on t.playclass1=m.playclass1 and t.itype=m.itype\n;",
    "category": "行为链条",
    "category_reason": "问题关注用户在不同玩法间的流动和双栖行为，属于多步骤行为路径分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"行为链条\",\n  \"rationale\": \"问题关注用户在不同玩法间的流动和双栖行为，属于多步骤行为路径分析。\"\n}"
  },
  {
    "question_id": "sql_40",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\nsql_40时间段2024.3.1-2024.6.30分月看用户当月在砺刃的 新进、回流、轻度留存、中度留存、重度留存\n\n输出：月份(202403、...、202406)、新进人数、回流人数、轻度留存人数、中度留存人数、重度留存人数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\nCREATE TABLE `dws_jordass_login_df` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:不区分平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '登录位图',\n  `dregdate` TEXT COMMENT '注册日期，格式YYYYMMDD',\n  `ilevel` BIGINT COMMENT '等级',\n  `friendcount` BIGINT COMMENT '好友数量'\n);\n\n【参考信息】\n新进：当月新进 \n回流：上个月未活跃的历史注册用户，在当月活跃\n轻度留存：留存用户（上个月活跃，本月也活跃的用户）在本月的活跃度1-4天\n中度留存：留存用户（上个月活跃，本月也活跃的用户）在本月的活跃度5-15天\n重度留存：留存用户（上个月活跃，本月也活跃的用户）在本月的活跃度16天及以上\n\n",
    "output": "",
    "category": "留存类",
    "category_reason": "问题关注用户在不同时间段的留存状态（新进、回流、轻度到重度留存），属于典型的留存分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注用户在不同时间段的留存状态（新进、回流、轻度到重度留存），属于典型的留存分析。\"\n}"
  },
  {
    "question_id": "sql_41",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2024.1.1～1.3，每天活跃玩家数\n输出：统计日期(20240101、20240102、20240103)、玩家数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\n\n【参考信息】\n\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是特定日期范围内每日活跃玩家数的统计，属于活跃度在时间维度上的分布情况。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是特定日期范围内每日活跃玩家数的统计，属于活跃度在时间维度上的分布情况。\"\n}"
  },
  {
    "question_id": "sql_42",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2021.11.1-2021.11.30每天按extarg2中用\"_\"分割的第2位的值包含(8,16,17)看点击情况\n输出：日期，按extarg2中用\"_\"分割的第2位，人数，次数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_buttonpress_pre_di` (\n  `dtstatdate` TEXT COMMENT '统计日期，格式YYYYMMDD',\n  `dteventtime` TEXT COMMENT '事件时间,格式YYYY-MM-DDHH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` TEXT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` TEXT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `clientversion` TEXT COMMENT 'clientversion',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `uid` TEXT COMMENT '角色ID',\n  `buttontype` TEXT COMMENT '按钮代号',\n  `ireason` TEXT COMMENT '额外参数',\n  `extarg1` TEXT COMMENT '附加参数1',\n  `extarg2` TEXT COMMENT '附加参数2'\n);\n\n【参考信息】\n\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是特定条件下用户的点击行为分布情况。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是特定条件下用户的点击行为分布情况。\"\n}"
  },
  {
    "question_id": "sql_43",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2025.1.1-2025.1.31期间活跃度分布\n输出：活跃度（轻度、中度、重度）、玩家数\n\n活跃度：轻度1-5天，中度6-15天，重度大于16天\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\n\n【参考信息】\n\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注用户在特定时间段内的活跃天数分布情况，属于典型的活跃度分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注用户在特定时间段内的活跃天数分布情况，属于典型的活跃度分析。\"\n}"
  },
  {
    "question_id": "sql_44",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2024.01.01-2024.12.31期间，付费用户的付费区间对应的付费人数和付费金额\n输出：付费区间(小R、中R、大R、超R、未知)、付费人数、付费金额（元）\n\n付费区间：小R小于等于12，中R(12,60]，大R(60,180]，超R(180+)\n\n【数据库schema】\nCREATE TABLE `dws_jordass_water_di` (\n  `dtstatdate` TEXT COMMENT '分区，付费日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android,255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `iamount` BIGINT COMMENT '代币金额(Q分)',\n  `itimes` BIGINT COMMENT '流水次数',\n  `imoney` DOUBLE COMMENT '除100为实际支付人民币金额'\n);\n\n【参考信息】\n\n\n",
    "output": "",
    "category": "用户分群",
    "category_reason": "根据付费金额将用户划分为不同群体，统计各群体人数与金额，属于用户分群分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"用户分群\",\n  \"rationale\": \"根据付费金额将用户划分为不同群体，统计各群体人数与金额，属于用户分群分析。\"\n}"
  },
  {
    "question_id": "sql_45",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2024.01.01-2024.01.07参与乐园子玩法拼图狂欢在202401.08-2024.01.14没玩乐园子玩法拼图狂欢在2024.01.15-2024.01.21又玩了乐园子玩法拼图狂欢的用户\n输出：玩家数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_matchlog_stat_di` (\n  `dtstatdate` TEXT COMMENT '分区，参与乐园日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `imode` BIGINT COMMENT '乐园子玩法：\t255-所有玩法，用户问题未提到明确的子玩法时，默认为所有玩法\t1282371711108385024-跑酷：成神之路\t1281086178576044544-传媒群岛\t1305619333337074432-狂热派对\t1251206313870885120-砺刃运动会5.0\t1313754433693158656-手球特攻（原足球游戏）\t1296730563346958080-盔仔泡泡小队\t1294279575841283072-夺宝行动\t1310822585431254784-桥梁争夺\t1278160113246405632-砺刃大亨\t1313047366167692288-逆转平底锅\t1298874468735655936-战车突袭\t1278948391311645952-能量争夺战\t1295942084687041792-趣味飞盘\t1282101477461985024-盔仔总动员\t1278144466094392064-黑五模拟器\t1313046652157690624-盔仔斗魔王（原盔仔大乱斗）\t1289446028099979264-佣兵阵线\t1309453077449826304-星星争夺战（原名：金币大作战）\t1298445174154728192-停车大作战\t1294211358396518400-特技大乱斗\t1280302176000803840-卧底行动\t1307095884553538304-\"超级隐匿（原广阔天地隐匿模式）\"\t1297394991875754752-守卫生命线\t1278170390282112000-星球守护者\t1287652322611036928-拼图狂欢\t1273928195100380928-特种兵训练\t1300845150154531840-星之继承者\t1302344773925865984-彩色争夺战\t1296062239742105856-抱团冲冲冲\t1281781308570207232-狙击精英',\n  `teamnum` BIGINT COMMENT '组队人数',\n  `icnt` BIGINT COMMENT '对局次数',\n  `itemp1` BIGINT COMMENT '对局时长',\n  `itemp2` BIGINT COMMENT 'itemp2',\n  `vtemp1` TEXT COMMENT 'vtemp1',\n  `vtemp2` TEXT COMMENT 'vtemp2'\n);\n\n【参考信息】\nimode为1287652322611036928代表乐园子玩法拼图狂欢\n\n",
    "output": "select count(distinct a.vplayerid) as player_num\nfrom (\n    select distinct vplayerid\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate between '20240101' and '20240107'\n    and imode = 1287652322611036928\n) a\nleft join (\n    select distinct vplayerid\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate between '20240108' and '20240114'\n    and imode = 1287652322611036928\n) b on a.vplayerid = b.vplayerid\njoin (\n    select distinct vplayerid\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate between '20240115' and '20240121'\n    and imode = 1287652322611036928\n) c on a.vplayerid = c.vplayerid\nwhere b.vplayerid is null;",
    "category": "留存类",
    "category_reason": "该问题关注的是特定时间段内用户参与某玩法后，在后续时间段内的流失与回流情况，属于典型的留存与回流分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"该问题关注的是特定时间段内用户参与某玩法后，在后续时间段内的流失与回流情况，属于典型的留存与回流分析。\"\n}"
  },
  {
    "question_id": "sql_46",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2024.1.1-2024.2.2期间，每个自然周不同周活跃天数玩家数\n输出：统计周(1、2、3...、5)、周活跃天数、玩家数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\n\n【参考信息】\n\n\n",
    "output": "select\n    week, -- 统计周\n    active_days, -- 活跃天数\n    count(distinct vplayerid) as user_num -- 玩家数\nfrom (\n    select\n        vplayerid, -- 玩家playerid\n        weekofyear(dtstatdate) as week, -- 统计周\n        count(distinct dtstatdate) as active_days -- 活跃天数\n    from dws_jordass_login_di\n    where dtstatdate >= '20240101' and dtstatdate <= '20240202' and platid=255\n    group by\n        vplayerid,\n        weekofyear(dtstatdate)\n)f\ngroup by\n    week,\n    active_days",
    "category": "活跃分布",
    "category_reason": "问题关注玩家在自然周内的活跃天数分布情况，属于时间维度上的活跃度分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注玩家在自然周内的活跃天数分布情况，属于时间维度上的活跃度分析。\"\n}"
  },
  {
    "question_id": "sql_47",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2023.07.01-08.31期间，每天微信活跃用户在2023.09.1-09.21期间流失并且是2023.07.01-08.31有付费的用户\n输出：人数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_water_di` (\n  `dtstatdate` TEXT COMMENT '分区，付费日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android,255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `iamount` BIGINT COMMENT '代币金额(Q分)',\n  `itimes` BIGINT COMMENT '流水次数',\n  `imoney` DOUBLE COMMENT '除100为实际支付人民币金额'\n);\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\n\n【参考信息】\n\n\n",
    "output": "",
    "category": "留存类",
    "category_reason": "问题关注的是特定时间段内活跃用户的流失情况，属于留存与流失分析范畴。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注的是特定时间段内活跃用户的流失情况，属于留存与流失分析范畴。\"\n}"
  },
  {
    "question_id": "sql_48",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2023.12.1流失7天的回流用户数和流失30天的回流用户数\n输出：流失7天的回流用户数，流失30天的回流用户数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_df` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:不区分平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '登录位图',\n  `dregdate` TEXT COMMENT '注册日期，格式YYYYMMDD',\n  `ilevel` BIGINT COMMENT '等级',\n  `friendcount` BIGINT COMMENT '好友数量'\n);\n\n【参考信息】\n\n\n",
    "output": "select\n    count(distinct case when is_backflow_7 then vplayerid end) as backflow_7_user,\n    count(distinct case when is_backflow_30 then vplayerid end) as backflow_30_user\nfrom (\n    select\n        vplayerid,\n        -- 检查是否满足流失7天回流条件\n        (dregdate <> dtstatdate) and\n        (instr(substr(cbitmap, 1, 1), '1') > 0) and\n        (instr(substr(cbitmap, 2, 7), '1') = 0) as is_backflow_7,\n        \n        -- 检查是否满足流失30天回流条件\n        (dregdate <> dtstatdate) and\n        (instr(substr(cbitmap, 1, 1), '1') > 0) and\n        (instr(substr(cbitmap, 2, 30), '1') = 0) as is_backflow_30\n    from\n        dws_jordass_login_df\n    where\n        dtstatdate = '20231201'\n        and platid = 255\n) as user_flags;",
    "category": "留存类",
    "category_reason": "问题关注的是流失后回流用户的统计，属于留存分析中的回流用户识别。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注的是流失后回流用户的统计，属于留存分析中的回流用户识别。\"\n}"
  },
  {
    "question_id": "sql_49",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n2024年10月1-2024年10月7 用周期开始时间判断玩法上线时间在7天及以上，周期结束时间判断玩法上线时间在90天及以内的玩法，统计周期内这些玩法的参与和留存情况\n输出：周期(20241001-20241007)，日期(20241001、...、20241007)，参与人数，次留人数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_matchlog_stat_di` (\n  `dtstatdate` TEXT COMMENT '分区，参与乐园日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `imode` BIGINT COMMENT '乐园子玩法：\t255-所有玩法，用户问题未提到明确的子玩法时，默认为所有玩法\t1282371711108385024-跑酷：成神之路\t1281086178576044544-传媒群岛\t1305619333337074432-狂热派对\t1251206313870885120-砺刃运动会5.0\t1313754433693158656-手球特攻（原足球游戏）\t1296730563346958080-盔仔泡泡小队\t1294279575841283072-夺宝行动\t1310822585431254784-桥梁争夺\t1278160113246405632-砺刃大亨\t1313047366167692288-逆转平底锅\t1298874468735655936-战车突袭\t1278948391311645952-能量争夺战\t1295942084687041792-趣味飞盘\t1282101477461985024-盔仔总动员\t1278144466094392064-黑五模拟器\t1313046652157690624-盔仔斗魔王（原盔仔大乱斗）\t1289446028099979264-佣兵阵线\t1309453077449826304-星星争夺战（原名：金币大作战）\t1298445174154728192-停车大作战\t1294211358396518400-特技大乱斗\t1280302176000803840-卧底行动\t1307095884553538304-\"超级隐匿（原广阔天地隐匿模式）\"\t1297394991875754752-守卫生命线\t1278170390282112000-星球守护者\t1287652322611036928-拼图狂欢\t1273928195100380928-特种兵训练\t1300845150154531840-星之继承者\t1302344773925865984-彩色争夺战\t1296062239742105856-抱团冲冲冲\t1281781308570207232-狙击精英',\n  `teamnum` BIGINT COMMENT '组队人数',\n  `icnt` BIGINT COMMENT '对局次数',\n  `itemp1` BIGINT COMMENT '对局时长',\n  `itemp2` BIGINT COMMENT 'itemp2',\n  `vtemp1` TEXT COMMENT 'vtemp1',\n  `vtemp2` TEXT COMMENT 'vtemp2'\n);\nCREATE TABLE `dim_jordass_submodeonline_nf` (\n  `matchsubmodegroup` BIGINT COMMENT '子玩法',\n  `matchsubmodegroupname` TEXT COMMENT '子玩法名',\n  `onlinedate` TEXT COMMENT '上线日期',\n  `itemp1` BIGINT COMMENT '预留数字1',\n  `itemp2` BIGINT COMMENT '预留数字2',\n  `vtemp1` TEXT COMMENT '预留字符1',\n  `vtemp2` TEXT COMMENT '预留字符2'\n);\n\n【参考信息】\n\n\n",
    "output": "with play_user as (\n    select distinct\n        p.dtstatdate as ds, --日期\n        p.vplayerid    --玩家id\n    from\n        dws_jordass_matchlog_stat_di p\n    join\n        dim_jordass_submodeonline_nf c\n    on\n        p.imode = c.matchsubmodegroup\n    where\n        p.dtstatdate between '20241001' and '20241008'\n        and datediff('20241001', c.onlinedate) >= 7\n        and datediff('20241007', c.onlinedate) <= 90\n)\nselect\n    '20241001-20241007' as period, --周期\n    a.ds,\n    count(distinct a.vplayerid) as play_user_num, --参与人数\n    count(distinct b.vplayerid) as retention_user_num --次留人数\nfrom\n    play_user a\nleft join\n    play_user b\non\n    a.vplayerid = b.vplayerid\n    and b.ds = date_add(a.ds, 1)  -- 次日留存条件\nwhere\n    a.ds between '20241001' and '20241007'\ngroup by\n    a.ds\norder by\n    a.ds;",
    "category": "留存类",
    "category_reason": "问题关注特定时间段内新上线玩法的用户参与及次日留存情况，属于新增留存分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注特定时间段内新上线玩法的用户参与及次日留存情况，属于新增留存分析。\"\n}"
  },
  {
    "question_id": "sql_50",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2024.10.1-2024.10.31期间点击400211，点击400212，点击400211及400212的重合用户作为用户类型，看不同性别、砺刃活跃度和乐园活跃度情况\n\n输出：用户类型（400211、400212、400211&400212、other），游戏角色性别（male、female、other）、乐园活跃度（light、medium、heavy、other）、砺刃活跃度（light、medium、heavy、other），人数\n\n乐园跟砺刃的活跃度： 轻度1-4天；中度5-15天；重度>=16天\n\n【数据库schema】\nCREATE TABLE `dws_jordass_matchlog_stat_di` (\n  `dtstatdate` TEXT COMMENT '分区，参与乐园日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `imode` BIGINT COMMENT '乐园子玩法：\t255-所有玩法，用户问题未提到明确的子玩法时，默认为所有玩法\t1282371711108385024-跑酷：成神之路\t1281086178576044544-传媒群岛\t1305619333337074432-狂热派对\t1251206313870885120-砺刃运动会5.0\t1313754433693158656-手球特攻（原足球游戏）\t1296730563346958080-盔仔泡泡小队\t1294279575841283072-夺宝行动\t1310822585431254784-桥梁争夺\t1278160113246405632-砺刃大亨\t1313047366167692288-逆转平底锅\t1298874468735655936-战车突袭\t1278948391311645952-能量争夺战\t1295942084687041792-趣味飞盘\t1282101477461985024-盔仔总动员\t1278144466094392064-黑五模拟器\t1313046652157690624-盔仔斗魔王（原盔仔大乱斗）\t1289446028099979264-佣兵阵线\t1309453077449826304-星星争夺战（原名：金币大作战）\t1298445174154728192-停车大作战\t1294211358396518400-特技大乱斗\t1280302176000803840-卧底行动\t1307095884553538304-\"超级隐匿（原广阔天地隐匿模式）\"\t1297394991875754752-守卫生命线\t1278170390282112000-星球守护者\t1287652322611036928-拼图狂欢\t1273928195100380928-特种兵训练\t1300845150154531840-星之继承者\t1302344773925865984-彩色争夺战\t1296062239742105856-抱团冲冲冲\t1281781308570207232-狙击精英',\n  `teamnum` BIGINT COMMENT '组队人数',\n  `icnt` BIGINT COMMENT '对局次数',\n  `itemp1` BIGINT COMMENT '对局时长',\n  `itemp2` BIGINT COMMENT 'itemp2',\n  `vtemp1` TEXT COMMENT 'vtemp1',\n  `vtemp2` TEXT COMMENT 'vtemp2'\n);\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\nCREATE TABLE `dwd_jordass_playerlogin_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `level` BIGINT COMMENT '等级',\n  `playerfriendsnum` BIGINT COMMENT '玩家好友数量',\n  `clientversion` TEXT COMMENT '客户端版本',\n  `screenwidth` BIGINT COMMENT '显示屏宽度',\n  `screenhight` BIGINT COMMENT '显示屏高度',\n  `density` TEXT COMMENT '像素密度',\n  `loginchannel` BIGINT COMMENT '登录渠道',\n  `vroleid` TEXT COMMENT '玩家角色ID',\n  `vrolename` TEXT COMMENT '玩家角色名',\n  `deviceid` TEXT COMMENT '设备ID',\n  `device_type` BIGINT COMMENT '设备类型0为手机,1为模拟器, 2键鼠, 3手柄, 5是PC客户端,也是高清模拟器。',\n  `gender` BIGINT COMMENT '平台性别，1是男，2是女',\n  `emulatorname` TEXT COMMENT '模拟器名',\n  `warzoneid` BIGINT COMMENT '战区ID',\n  `devicename` TEXT COMMENT '客户端devicename',\n  `historymaxsegment` BIGINT COMMENT '历史最高段位',\n  `seasonmaxsegment` BIGINT COMMENT '本赛季最高段位',\n  `firstlogincg` BIGINT COMMENT '第一次登录CG游戏的时间，即CG注册时间，UNIX时间戳',\n  `lobbybgid` BIGINT COMMENT '当前设置的大厅背景resid',\n  `signature` TEXT COMMENT '个性签名',\n  `devicelevel` BIGINT COMMENT '机型档位',\n  `iswxrealname` BIGINT COMMENT '非微信平台或还没拉取数据填0，已微信实名填1，未实名填2',\n  `iswxlowlv` BIGINT COMMENT '非微信平台或还没拉取数据填0，是微信小号填1，不是微信小号填2',\n  `iszombie` BIGINT COMMENT '非微信平台或还没拉取数据填0，是微信僵尸号填1，不是微信僵尸号填2',\n  `topsegtimes` BIGINT COMMENT '王牌印记: -2 首次达到星钻 -1 首次达到王冠  0 无数据 >0 历史王牌次数',\n  `clanid1` BIGINT COMMENT '战队ID1',\n  `clanid2` BIGINT COMMENT '战队ID2',\n  `clanid3` BIGINT COMMENT '战队ID3',\n  `fpslevel` BIGINT COMMENT '帧率等级',\n  `renderqualityapply` BIGINT COMMENT '画质等级',\n  `devicetcqualitygrade` BIGINT COMMENT '机型等级',\n  `relogin` BIGINT COMMENT '是否是断线重连登录的,1为断线重连，0为从登录界面登录',\n  `gameid` TEXT COMMENT '当前正在游戏的对局id',\n  `startime` BIGINT COMMENT '当前正在游戏的对局id',\n  `rolesettingstr` TEXT COMMENT 'RoleSetting设置, 当为空字符串时表示该字段获取异常,否则为以+分隔的rolesetting值，具体字段值咨询开发',\n  `creditscore` TEXT COMMENT '信誉分',\n  `usenewpickup` BIGINT COMMENT '是否使用新版拾取',\n  `isqrlogin` BIGINT COMMENT '是否为扫码登录的,1是扫码登录，0非扫描登录',\n  `is_gamematrix` BIGINT COMMENT '是否为先锋云游，1是，0不是',\n  `clientsceneversion` TEXT COMMENT '客户端场景版本',\n  `whitetype` BIGINT COMMENT '进入服务器的凭证类型',\n  `mobiletablettype` BIGINT COMMENT '平板识别结果：-1结果未出，0是非平板，1已验证是平板，2可能是平板',\n  `behaviorlevel` BIGINT COMMENT '行为分等级',\n  `clientostype` TEXT COMMENT '客户端系统类型：and ios win hm',\n  `pclogintype` BIGINT COMMENT '0=默认类型，1=PC新手玩家，2=PC回流玩家',\n  `escapecoincount` TEXT COMMENT '隧道收益(该字段原来搞错了, 之前以为是隧道币数量)',\n  `vsteamlevel` BIGINT COMMENT '组竞等级',\n  `connectidx` BIGINT COMMENT '连接序号',\n  `isinds` BIGINT COMMENT '当前登录是否在ds场景中重连'\n);\nCREATE TABLE `dws_jordass_buttonpress_pre_di` (\n  `dtstatdate` TEXT COMMENT '统计日期，格式YYYYMMDD',\n  `dteventtime` TEXT COMMENT '事件时间,格式YYYY-MM-DDHH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` TEXT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` TEXT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `clientversion` TEXT COMMENT 'clientversion',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `uid` TEXT COMMENT '角色ID',\n  `buttontype` TEXT COMMENT '按钮代号',\n  `ireason` TEXT COMMENT '额外参数',\n  `extarg1` TEXT COMMENT '附加参数1',\n  `extarg2` TEXT COMMENT '附加参数2'\n);\n\n【参考信息】\n性别根据时间开窗取最新一条\n\n",
    "output": "",
    "category": "用户分群",
    "category_reason": "问题核心是根据用户行为（点击特定事件）和活跃度定义用户类型，并分析其分布特征。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"用户分群\",\n  \"rationale\": \"问题核心是根据用户行为（点击特定事件）和活跃度定义用户类型，并分析其分布特征。\"\n}"
  },
  {
    "question_id": "sql_51",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计4个时间段灰度玩法参与情况\n\n时间段1：周期1：2024.11.08-11.21，周期2：2024.11.22-12.4\n时间段2：周期1：2024.11.10-11.23，周期2：2024.11.24-12.4\n时间段3：周期1：2024.11.15-11.28，周期2：2024.11.29-12.4\n时间段4：周期1：2024.11.17-11.30，周期2：2024.12.1-12.4\n输出：时间段（时间段1、时间段2、时间段3、时间段4），第1个周期进入过灰度玩法的用户数，两个周期都进入过灰度的用户数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_buttonpress_pre_di` (\n  `dtstatdate` TEXT COMMENT '统计日期，格式YYYYMMDD',\n  `dteventtime` TEXT COMMENT '事件时间,格式YYYY-MM-DDHH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` TEXT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` TEXT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `clientversion` TEXT COMMENT 'clientversion',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `uid` TEXT COMMENT '角色ID',\n  `buttontype` TEXT COMMENT '按钮代号',\n  `ireason` TEXT COMMENT '额外参数',\n  `extarg1` TEXT COMMENT '附加参数1',\n  `extarg2` TEXT COMMENT '附加参数2'\n);\nCREATE TABLE `dim_jordass_submodeonlinedate_conf` (\n  `matchsubmodegroup` BIGINT COMMENT '子玩法',\n  `matchsubmodegroupname` TEXT COMMENT '子玩法名',\n  `onlinedate` TEXT COMMENT '上线日期',\n  `itemp1` BIGINT COMMENT '预留数字1',\n  `itemp2` BIGINT COMMENT '预留数字2',\n  `vtemp1` TEXT COMMENT '预留字符1',\n  `vtemp2` TEXT COMMENT '预留字符2'\n);\n\n【参考信息】\n\n\n",
    "output": "",
    "category": "活动分析",
    "category_reason": "问题关注不同时间段内灰度玩法的参与情况，属于对特定运营活动或功能的参与度分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活动分析\",\n  \"rationale\": \"问题关注不同时间段内灰度玩法的参与情况，属于对特定运营活动或功能的参与度分析。\"\n}"
  },
  {
    "question_id": "sql_52",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n2024.10.01-10.08期间参与了参与率在后20%子玩法的用户在周期内每天参与所有乐园子玩法的数量分布\n数量分布：1，2，3，4，5，6-10，11-20，21以上\n输出：统计日期(20241001、...、20241008)、数量分布、人数\n\n参与率：每个子玩法的总对局数从高到低排名\n\n【数据库schema】\nCREATE TABLE `dws_jordass_matchlog_stat_di` (\n  `dtstatdate` TEXT COMMENT '分区，参与乐园日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `imode` BIGINT COMMENT '乐园子玩法：\t255-所有玩法，用户问题未提到明确的子玩法时，默认为所有玩法\t1282371711108385024-跑酷：成神之路\t1281086178576044544-传媒群岛\t1305619333337074432-狂热派对\t1251206313870885120-砺刃运动会5.0\t1313754433693158656-手球特攻（原足球游戏）\t1296730563346958080-盔仔泡泡小队\t1294279575841283072-夺宝行动\t1310822585431254784-桥梁争夺\t1278160113246405632-砺刃大亨\t1313047366167692288-逆转平底锅\t1298874468735655936-战车突袭\t1278948391311645952-能量争夺战\t1295942084687041792-趣味飞盘\t1282101477461985024-盔仔总动员\t1278144466094392064-黑五模拟器\t1313046652157690624-盔仔斗魔王（原盔仔大乱斗）\t1289446028099979264-佣兵阵线\t1309453077449826304-星星争夺战（原名：金币大作战）\t1298445174154728192-停车大作战\t1294211358396518400-特技大乱斗\t1280302176000803840-卧底行动\t1307095884553538304-\"超级隐匿（原广阔天地隐匿模式）\"\t1297394991875754752-守卫生命线\t1278170390282112000-星球守护者\t1287652322611036928-拼图狂欢\t1273928195100380928-特种兵训练\t1300845150154531840-星之继承者\t1302344773925865984-彩色争夺战\t1296062239742105856-抱团冲冲冲\t1281781308570207232-狙击精英',\n  `teamnum` BIGINT COMMENT '组队人数',\n  `icnt` BIGINT COMMENT '对局次数',\n  `itemp1` BIGINT COMMENT '对局时长',\n  `itemp2` BIGINT COMMENT 'itemp2',\n  `vtemp1` TEXT COMMENT 'vtemp1',\n  `vtemp2` TEXT COMMENT 'vtemp2'\n);\n\n【参考信息】\n\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注用户在特定周期内参与不同子玩法的数量分布，属于活跃度在数量维度上的分布分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注用户在特定周期内参与不同子玩法的数量分布，属于活跃度在数量维度上的分布分析。\"\n}"
  },
  {
    "question_id": "sql_53",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2024.10.21-11.21的期间内的非新注册活跃用户并且在2024.10.14-10.20没有活跃的回流用户量级，以及这些用户在10.20的\n1.前8-14天 (10.7-10.13)有活跃的用户\n2.前15-29天有活跃的用户\n3.前30-59天有活跃的用户\n4.前60-179天有活跃的用户\n5.前180-364天有活跃的用户\n输出：回流用户量级，前8-14天有活跃的用户量级，前15-29天有活跃的用户量级，前30-59天有活跃的用户量级，前60-179天有活跃的用户量级，前180-364天有活跃的用户量级\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\nCREATE TABLE `dws_jordass_login_df` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:不区分平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '登录位图',\n  `dregdate` TEXT COMMENT '注册日期，格式YYYYMMDD',\n  `ilevel` BIGINT COMMENT '等级',\n  `friendcount` BIGINT COMMENT '好友数量'\n);\n\n【参考信息】\ndtstatdate限定使用 20241121、20240813、20240505、20240126 这4天的日期\n\n",
    "output": "",
    "category": "留存类",
    "category_reason": "问题关注的是特定时间段内回流用户的识别与分类，属于留存分析中的回流用户分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注的是特定时间段内回流用户的识别与分类，属于留存分析中的回流用户分析。\"\n}"
  },
  {
    "question_id": "sql_54",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2024.9.20到2024.10.20期间matchmode=1003 每种玩法参与周期内的日均参与人数和日均玩法次留\n输出：玩法、上线日期、下线日期、日均参与人数、日均玩法次留\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_player_matchrecord_hi` (\n  `tdbank_imp_date` TEXT COMMENT '分区字段，小时分区，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `matchtime` BIGINT COMMENT '匹配时长（秒）',\n  `matchresult` TEXT COMMENT '匹配结果',\n  `matchmode` BIGINT COMMENT '匹配模式',\n  `isaotufill` BIGINT COMMENT '是否自动填充',\n  `gameid` TEXT COMMENT '匹配成功为当前的battleid失败为0',\n  `submodes` TEXT COMMENT '选择的子模式列表，只有队长才有',\n  `isleader` BIGINT COMMENT '1表示队长0非队长',\n  `teamnum` TEXT COMMENT '组队人数',\n  `teammembers` TEXT COMMENT '组队队伍',\n  `matchteammembers` TEXT COMMENT '最终匹配的队伍',\n  `matchlabel` BIGINT COMMENT '匹配标签',\n  `corpsid` BIGINT COMMENT '联盟id',\n  `teamid` TEXT COMMENT '队伍ID',\n  `teamwaittime` BIGINT COMMENT '队伍首次组队到匹配等待时间',\n  `finalbucketidx` BIGINT COMMENT '匹配成功首队伍所在匹配区间idx',\n  `playermoderating` BIGINT COMMENT '玩家该模式下rating分(段位分)',\n  `playerlevel` BIGINT COMMENT '玩家等级',\n  `regresss` BIGINT COMMENT '是否回流玩家',\n  `matchsubmodegroup` BIGINT COMMENT '最终随机到的submodegroup',\n  `matchrating` BIGINT COMMENT '当前玩家所在队伍匹配积分',\n  `bucketidx` BIGINT COMMENT '当前玩家所在队伍匹配积分所在区间idx',\n  `device_type` BIGINT COMMENT '设备类型0为手机 1为模拟器 2 键鼠 3 手柄 5 PC高清模拟器',\n  `strategys` TEXT COMMENT '分队策略',\n  `match_client_type` BIGINT COMMENT '匹配池渠道0为手机 1为模拟器 2外部模拟器 8为小黑屋 9为新手局',\n  `pandoralost` BIGINT COMMENT '潘多拉预流失标记 1预流失 0非预流失',\n  `teamjoinsource` BIGINT COMMENT '组队加入来源',\n  `regressvalue` BIGINT COMMENT '玩家当前的回流值',\n  `strategy_type` BIGINT COMMENT '策略类型，-1表示服务器保底二次分队, 0表示004的潘多拉策略, 1表示005的潘多拉单局最优策略, 2表示015的技术中心优化分队策略, 3表示技术中心向量化二次分队方案, 4表示内部推荐二次分队方案',\n  `playersign` BIGINT COMMENT '玩家分级标签，1为白，2为红，3为灰, 4为深灰',\n  `livetype` BIGINT COMMENT '直播类型: 2 围观 4 视频号',\n  `liveid` TEXT COMMENT '直播ID',\n  `matchscene` BIGINT COMMENT '匹配成功时玩家所在场景，0为大厅，1为聚乐园',\n  `issilentmode` BIGINT COMMENT '是否是免耳麦模式，0为非免耳麦，1为免耳麦',\n  `ismatchlbs` BIGINT COMMENT '是否是lbs匹配，0为非lbs匹配，1为lbs匹配',\n  `strategy_index` BIGINT COMMENT '二次分队策略采用的weight数组的下标',\n  `xid` TEXT COMMENT 'Xid',\n  `isanchor` BIGINT COMMENT '是否是主播，0为非主播，1为主播',\n  `isanchorgame` BIGINT COMMENT '是否匹配到主播局，0为非主播局，1为主播局',\n  `tournamentid` BIGINT COMMENT '微赛事ID',\n  `expandupsection` BIGINT COMMENT '最大向上扩段数',\n  `expanddownsection` BIGINT COMMENT '最大向下扩段数',\n  `expandupclass` BIGINT COMMENT '最大向上扩载数',\n  `expanddownclass` BIGINT COMMENT '最大向下扩载数',\n  `isfullbucket` BIGINT COMMENT '是否优先遍历满载队',\n  `timingmatchtime` BIGINT COMMENT '定时匹配真实匹配时长（秒）',\n  `tournamentstage` BIGINT COMMENT '微赛事阶段ID',\n  `tournamentclubid` TEXT COMMENT '微赛事战队ID',\n  `promotionmatchstatus` BIGINT COMMENT '参与晋级赛的状态, -1没勾选，0成功参与，1模式不对，2时间不对，3配置不对，4自身段位不对，5队友段位不对',\n  `ugcisgray` BIGINT COMMENT '是否为ugc灰度玩法。默认为0：非灰度；1：灰度',\n  `promotiontaskid` BIGINT COMMENT '晋级赛任务ID',\n  `strategyabtest` TEXT COMMENT '未命中模式为空，对照组记 0:ID，实验组记 1:ID',\n  `accompanytype` BIGINT COMMENT '陪玩标签值 0 ：没有打标签，1：陪玩，2：老板',\n  `minusteamnum` BIGINT COMMENT '匹配成功后踢回匹配池的队伍数',\n  `mobiletabletmatchlabel` BIGINT COMMENT '匹配队伍平板比例标签(非手机=0，纯手机=1，25%平板=2，50%平板=3，75%平板=4，100%平板=5)',\n  `ratingtype` BIGINT COMMENT '积分类型',\n  `idcname` TEXT COMMENT 'IDC集群名字',\n  `strategyextendinfo` TEXT COMMENT '推荐侧二次分队返回的信息',\n  `playerabtest` TEXT COMMENT '个人匹配abtest',\n  `gameabtest` TEXT COMMENT '匹配对局的abtest,没有则为空字符串',\n  `matchtype` BIGINT COMMENT '1表示匹配成局，2表示补人',\n  `matchisolatetype` BIGINT COMMENT '玩家匹配隔离标记, 0不隔离，2所有模式隔离，3积分模式隔离，4E玩法模式隔离',\n  `predictmatchtime` BIGINT COMMENT '预估匹配时长',\n  `expandspeed` BIGINT COMMENT '匹配单阶段扩段时长',\n  `escapehardid` BIGINT COMMENT 'E玩法难度ID',\n  `gameplayernum` BIGINT COMMENT '开局人数',\n  `gameaistrategy` BIGINT COMMENT 'AI投放策略类型',\n  `isfixmatchlabel` BIGINT COMMENT '是否触发了标签修正',\n  `realmatchsubmodes` TEXT COMMENT '实际匹配的模式组列表',\n  `aitype` BIGINT COMMENT '投放的AI類型',\n  `decratingtype` BIGINT COMMENT '降段类型，0=未触发降段，1=pc新手标签降段，2=未成年标签降段，3=回流标签降段，4=情绪值降段',\n  `forcematchtype` BIGINT COMMENT '记录本次匹配是否触发了强制开局，0=未触发，1=通用强制开局，2=PC新手强制开局',\n  `ispcaigame` BIGINT COMMENT '是否触发了PC首局AI局',\n  `matchsubclienttype` BIGINT COMMENT '匹配子池：0非子池, 2外设键鼠,3外设手柄,4主播,5PC新手,6PC-AI局 7BR温暖局，8隧道AI局',\n  `heroexcludetype` BIGINT COMMENT '是否触发了英雄互斥匹配，1采用了互斥匹配, 2没命中灰度 3超时，0其他情况',\n  `natalhero` BIGINT COMMENT '本命英雄ID',\n  `iswarmescapegame` BIGINT COMMENT '是否是E玩法温暖局',\n  `cancrossdevicematch` BIGINT COMMENT '是否可已手机非手机混匹, 1可以，0不可以',\n  `aiteamatetype` BIGINT COMMENT 'AI队友类型',\n  `isfirstteam` BIGINT COMMENT '是否是首队',\n  `firstteamwaittime` BIGINT COMMENT '首队的匹配等待时间',\n  `firstteamrankbucket` BIGINT COMMENT '首队段位分段',\n  `matchprocessinfo` TEXT COMMENT '匹配扩展信息 辅助查询匹配问题',\n  `isabtwarmgame` BIGINT COMMENT '是否触发了温暖局',\n  `warmplayertype` BIGINT COMMENT '温暖局玩家身份, 3=挫败（未来），2=回流，1=低活，0=未触发或无标签',\n  `escapeplayertype` TEXT COMMENT '隧道玩家身份类型, 空字符串表示默认类型，1回流标签有限期内,2积分移动新手(隐藏分专用),3积分非移动新手(隐藏分专用),4积分回流(隐藏分专用),5全局新手(AI局专用),6PC新手(AI局专用),7非PC温暖(AI局专用),8PC温暖(AI局专用),9回流(AI局专用), 以+分割',\n  `secondarydecratingtype` BIGINT COMMENT '二维匹配分降段类型，0=未触发降段，1=隧道回流降分匹配',\n  `finalsecondarybucketidx` BIGINT COMMENT '匹配成功首队所在二维匹配积分区间',\n  `playersecondarymoderating` BIGINT COMMENT '玩家该模式下二维匹配积分',\n  `secondarymatchrating` BIGINT COMMENT '当前玩家所在队伍二维匹配积分',\n  `secondarybucketidx` BIGINT COMMENT '当前玩家所在队伍二维匹配积分所在区间',\n  `escapeasset` TEXT COMMENT '隧道玩法资产',\n  `escapewarmscore` TEXT COMMENT '隧道温暖值',\n  `pvethemeid` BIGINT COMMENT 'PVE挑战事件ID',\n  `escapelesspeoplegamenum` BIGINT COMMENT '隧道每周已触发低真人局次数',\n  `garybucketgroup` BIGINT COMMENT '灰度分桶',\n  `matchsubclienttypebefore` BIGINT COMMENT '发起匹配时的匹配子池：0非子池, 2外设键鼠,3外设手柄,4主播,5PC新手,6PC-AI局, 7BR温暖局，8隧道AI局',\n  `frustratiggerlevel` BIGINT COMMENT 'FrustraTiggerLevel',\n  `frustramanualscore` TEXT COMMENT 'FrustraManualScore',\n  `frustramodelscore` TEXT COMMENT 'FrustraModelScore',\n  `frustragroup` TEXT COMMENT 'FrustraGroup',\n  `frustrathreshold` TEXT COMMENT 'FrustraThreshold',\n  `recomtraceid` TEXT COMMENT 'RecomTraceID'\n);\nCREATE TABLE `dim_jordass_imode_leyuan_nf` (\n  `modename` TEXT,\n  `imode` BIGINT,\n  `startdate` TEXT,\n  `enddate` TEXT,\n  `itemp1` BIGINT COMMENT '预留数字1',\n  `itemp2` BIGINT COMMENT '预留数字2',\n  `vtemp1` TEXT COMMENT '预留字符1',\n  `vtemp2` TEXT COMMENT '预留字符2'\n);\n\n【参考信息】\n玩法次留：每天参与玩法的用户在第2天也参与了该玩法\n日均次留：每种玩法周期内次留人数的平均值\n\n",
    "output": "",
    "category": "留存类",
    "category_reason": "问题关注特定玩法(matchmode=1003)的日均次留情况，属于留存指标分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注特定玩法(matchmode=1003)的日均次留情况，属于留存指标分析。\"\n}"
  },
  {
    "question_id": "sql_55",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计：2024.11.1-11.30，乐园当天往前上线180天以内的子玩法，按七天平均 参与率+次留+七留 算一个总排名，需要每天都提供一个榜单\n\n输出，统计日期、乐园各玩法名、平均参与率排名、次留排名、七留排名、总排名\n\n【数据库schema】\nCREATE TABLE `dws_jordass_matchlog_stat_di` (\n  `dtstatdate` TEXT COMMENT '分区，参与乐园日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `imode` BIGINT COMMENT '乐园子玩法：\t255-所有玩法，用户问题未提到明确的子玩法时，默认为所有玩法\t1282371711108385024-跑酷：成神之路\t1281086178576044544-传媒群岛\t1305619333337074432-狂热派对\t1251206313870885120-砺刃运动会5.0\t1313754433693158656-手球特攻（原足球游戏）\t1296730563346958080-盔仔泡泡小队\t1294279575841283072-夺宝行动\t1310822585431254784-桥梁争夺\t1278160113246405632-砺刃大亨\t1313047366167692288-逆转平底锅\t1298874468735655936-战车突袭\t1278948391311645952-能量争夺战\t1295942084687041792-趣味飞盘\t1282101477461985024-盔仔总动员\t1278144466094392064-黑五模拟器\t1313046652157690624-盔仔斗魔王（原盔仔大乱斗）\t1289446028099979264-佣兵阵线\t1309453077449826304-星星争夺战（原名：金币大作战）\t1298445174154728192-停车大作战\t1294211358396518400-特技大乱斗\t1280302176000803840-卧底行动\t1307095884553538304-\"超级隐匿（原广阔天地隐匿模式）\"\t1297394991875754752-守卫生命线\t1278170390282112000-星球守护者\t1287652322611036928-拼图狂欢\t1273928195100380928-特种兵训练\t1300845150154531840-星之继承者\t1302344773925865984-彩色争夺战\t1296062239742105856-抱团冲冲冲\t1281781308570207232-狙击精英',\n  `teamnum` BIGINT COMMENT '组队人数',\n  `icnt` BIGINT COMMENT '对局次数',\n  `itemp1` BIGINT COMMENT '对局时长',\n  `itemp2` BIGINT COMMENT 'itemp2',\n  `vtemp1` TEXT COMMENT 'vtemp1',\n  `vtemp2` TEXT COMMENT 'vtemp2'\n);\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\nCREATE TABLE `dim_jordass_submodeonline_nf` (\n  `matchsubmodegroup` BIGINT COMMENT '子玩法',\n  `matchsubmodegroupname` TEXT COMMENT '子玩法名',\n  `onlinedate` TEXT COMMENT '上线日期',\n  `itemp1` BIGINT COMMENT '预留数字1',\n  `itemp2` BIGINT COMMENT '预留数字2',\n  `vtemp1` TEXT COMMENT '预留字符1',\n  `vtemp2` TEXT COMMENT '预留字符2'\n);\n\n【参考信息】\n7天平均参与率：当天参与人数/当天活跃人,七日内平均\n7天平均次留：当天参与且第二天也参与人数/当天参与人数,七日内平均\n7天平均七留：当天参与且第7天也参与人数/当天参与人数,七日内平均\n每个玩法在每天都有一个前七天的平均参与率、次留、七留的数值，先需要按照这三个数值排名，然后按照排名总和再order一下，比如说11.1号，玩法A在前七天也就是10.25-10.31具有前七天的平均参与和次留七留，其中参与率在同期所有玩法里排名第一，次留第三，七留第四，那总排名就是1+3+4=8，玩法B相同排名总和是10，玩法C相同排名总和是2，那整体排名就是C=2>A=8>B=10\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是特定时间段内新上线玩法的参与率和留存指标，属于对用户活跃度在时间维度上的分布统计。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是特定时间段内新上线玩法的参与率和留存指标，属于对用户活跃度在时间维度上的分布统计。\"\n}"
  },
  {
    "question_id": "sql_56",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n时间：2024.01.01-2024.01.31\n每日新增用户的LTV，LTV1~LTV10\n输出：注册日期(20240101、20240102、...、20240131)、新进用户数、LTV1、LTV3、LTV7、LTV14、LTV30、LTV60、LTV90、LTV180\n\n【数据库schema】\nCREATE TABLE `dws_jordass_water_di` (\n  `dtstatdate` TEXT COMMENT '分区，付费日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android,255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `iamount` BIGINT COMMENT '代币金额(Q分)',\n  `itimes` BIGINT COMMENT '流水次数',\n  `imoney` DOUBLE COMMENT '除100为实际支付人民币金额'\n);\nCREATE TABLE `dws_jordass_login_df` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:不区分平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '登录位图',\n  `dregdate` TEXT COMMENT '注册日期，格式YYYYMMDD',\n  `ilevel` BIGINT COMMENT '等级',\n  `friendcount` BIGINT COMMENT '好友数量'\n);\n\n【参考信息】\nLTV（Life Time Value，用户生命周期价值）\n从注册日起，到第 N-1 天为止，这批新用户累计产生的总流水 ÷ 这批新用户的总人数。\n单位：元/人，衡量“每个新注册用户在 N 天内平均贡献了多少收入”。\n\n",
    "output": "select\n    register_date,\n    count(distinct vplayerid) as new_user_cnt,\n    round(sum(case when datediff_pay < 1 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv1,\n    round(sum(case when datediff_pay < 3 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv3,\n    round(sum(case when datediff_pay < 7 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv7,\n    round(sum(case when datediff_pay < 14 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv14,\n    round(sum(case when datediff_pay < 30 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv30,\n    round(sum(case when datediff_pay < 60 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv60,\n    round(sum(case when datediff_pay < 90 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv90,\n    round(sum(case when datediff_pay < 180 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv180\nfrom (\n    select\n        s1.register_date,\n        s1.vplayerid,\n        s2.pay_date,\n        datediff(s2.pay_date, s1.register_date) as datediff_pay,\n        sum(s2.pay_amount) as sum_pay_amount\n    from (\n        select\n            distinct dregdate as register_date,\n            vplayerid\n        from dws_jordass_login_df\n        where dtstatdate = '20240131'\n          and platid = 255\n          and dregdate >= '20240101' and dregdate <= '20240131'\n    ) s1\n    left join (\n        select\n            dtstatdate as pay_date,\n            vplayerid,\n            sum(imoney/100) as pay_amount\n        from dws_jordass_water_di\n        where dtstatdate >= '20240101' and dtstatdate <= date_add('20240131', 179)\n          and platid = 255\n        group by dtstatdate, vplayerid\n    ) s2 on s1.vplayerid = s2.vplayerid\n    group by s1.register_date, s1.vplayerid, s2.pay_date\n) base\ngroup by register_date",
    "category": "留存类",
    "category_reason": "问题关注新增用户在不同时间段的付费表现，属于LTV计算，是留存类分析的延伸应用。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注新增用户在不同时间段的付费表现，属于LTV计算，是留存类分析的延伸应用。\"\n}"
  },
  {
    "question_id": "sql_57",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计限定抽取阶梯活动每天的pv和角色数\n活动日期\t2024.11.29-12.19\t\n输出：日期(20241129、...、20241219、汇总)、pv、uv\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_activitypress_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间,格式YYYY-MM-DDHH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '玩家',\n  `uid` TEXT COMMENT '角色UID',\n  `buttontype` BIGINT COMMENT '按钮代号,找客户端开发问下定义',\n  `ireason` BIGINT COMMENT '活动id',\n  `extarg1` BIGINT COMMENT '附加参数1,客户端负责传过来',\n  `extarg2` TEXT COMMENT '附加参数2,客户端负责传过来',\n  `extarg3` BIGINT COMMENT '附加参数3,客户端负责传过来',\n  `devicetype` BIGINT COMMENT 'DeviceType'\n);\n\n【参考信息】\n限定抽取阶梯活动：ireason = 2411291018 and buttontype = 10045 and  extarg1 in (117, 115)\n\n",
    "output": "-- 查询限定抽取阶梯活动相关数据\nselect\n    dtstatdate,\n    pv,\n    uv\nfrom (\n    -- 按天统计\n    select\n        substr(tdbank_imp_date, 1, 8) as dtstatdate,\n        count(*)                       as pv,\n        count(distinct uid)            as uv\n    from dwd_jordass_activitypress_hi\n    where tdbank_imp_date between '2024112900' and '2024121923'\n      and ireason   = 2411291018\n      and buttontype = 10045\n      and extarg1   in (117, 115)\n    group by substr(tdbank_imp_date, 1, 8)\n\n    union all\n\n    -- 汇总\n    select\n        '汇总' as dtstatdate,\n        count(*)            as pv,\n        count(distinct uid) as uv\n    from dwd_jordass_activitypress_hi\n    where tdbank_imp_date between '2024112900' and '2024121923'\n      and ireason   = 2411291018\n      and buttontype = 10045\n      and extarg1   in (117, 115)\n) f \n;",
    "category": "活动分析",
    "category_reason": "问题关注特定活动期间的PV和角色数统计，属于活动效果评估范畴。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活动分析\",\n  \"rationale\": \"问题关注特定活动期间的PV和角色数统计，属于活动效果评估范畴。\"\n}"
  },
  {
    "question_id": "sql_58",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计以下时间对应玩法id下的不同对局时长人数分布\n'20230717'-'20230723'  1310822585431254784    \n'20221116'-'20221122' 1282371711108385024    \n'20221123'-'20221129' 1287652322611036928    \n'20230301'-'20230307' 1294211358396518400    \n'20230607''20230613' 1297394991875754752     \n\n对局时长按照 [0-10min)，[10-30min)，[30min-1h)，[1h,2h)，[2h,3h)，[3h,4h)， [4h,5h)，\n[5h,6h)，[6h,7h)，[7h,8h)，[8h,9h)，[9h,10h)，[10h,∞)\t\t\n输出字段：玩法id、对局时长、人数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_matchlog_stat_di` (\n  `dtstatdate` TEXT COMMENT '分区，参与乐园日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `imode` BIGINT COMMENT '乐园子玩法：\t255-所有玩法，用户问题未提到明确的子玩法时，默认为所有玩法\t1282371711108385024-跑酷：成神之路\t1281086178576044544-传媒群岛\t1305619333337074432-狂热派对\t1251206313870885120-砺刃运动会5.0\t1313754433693158656-手球特攻（原足球游戏）\t1296730563346958080-盔仔泡泡小队\t1294279575841283072-夺宝行动\t1310822585431254784-桥梁争夺\t1278160113246405632-砺刃大亨\t1313047366167692288-逆转平底锅\t1298874468735655936-战车突袭\t1278948391311645952-能量争夺战\t1295942084687041792-趣味飞盘\t1282101477461985024-盔仔总动员\t1278144466094392064-黑五模拟器\t1313046652157690624-盔仔斗魔王（原盔仔大乱斗）\t1289446028099979264-佣兵阵线\t1309453077449826304-星星争夺战（原名：金币大作战）\t1298445174154728192-停车大作战\t1294211358396518400-特技大乱斗\t1280302176000803840-卧底行动\t1307095884553538304-\"超级隐匿（原广阔天地隐匿模式）\"\t1297394991875754752-守卫生命线\t1278170390282112000-星球守护者\t1287652322611036928-拼图狂欢\t1273928195100380928-特种兵训练\t1300845150154531840-星之继承者\t1302344773925865984-彩色争夺战\t1296062239742105856-抱团冲冲冲\t1281781308570207232-狙击精英',\n  `teamnum` BIGINT COMMENT '组队人数',\n  `icnt` BIGINT COMMENT '对局次数',\n  `itemp1` BIGINT COMMENT '对局时长',\n  `itemp2` BIGINT COMMENT 'itemp2',\n  `vtemp1` TEXT COMMENT 'vtemp1',\n  `vtemp2` TEXT COMMENT 'vtemp2'\n);\n\n【参考信息】\n\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注不同时间段内特定玩法的对局时长分布，属于活跃度在时长维度上的分布分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注不同时间段内特定玩法的对局时长分布，属于活跃度在时长维度上的分布分析。\"\n}"
  },
  {
    "question_id": "sql_59",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计：20250111-20250124时间区间内，幻境使者活动抽奖用户第X次触发赠送后，这些用户的总抽奖次数\n输出：第X次触发,触发用户数,用户总抽奖次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_activityrecord_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `actid` BIGINT COMMENT '活动id',\n  `acttype` BIGINT COMMENT '活动类型',\n  `recodtype` BIGINT COMMENT '不同活动自定义不同的类型',\n  `arg1` BIGINT COMMENT '参数1',\n  `arg2` BIGINT COMMENT '参数2',\n  `arg3` BIGINT COMMENT '参数3',\n  `strarg1` TEXT COMMENT '字符串参数1',\n  `strarg2` TEXT COMMENT '字符串参数2',\n  `strarg3` TEXT COMMENT '字符串参数3',\n  `device_type` BIGINT COMMENT 'device_type'\n);\n\n【参考信息】\nactid=2411070621 and acttype= 10062 表示幻境使者活动\narg1表示抽奖次数\nStrArg1<>0表示触发赠送\n\n",
    "output": "select \n    s1.trigger_count as `trigger_count`, -- 第x次触发\n    count(distinct s1.vplayerid) as `trigger_user_cnt`, -- 触发用户数\n    sum(s2.draw_count) as `total_draw_count` -- 用户总抽奖次数\nfrom (\n    select\n        vplayerid,\n        dteventtime,\n        coalesce(lead(dteventtime) over (partition by vplayerid order by dteventtime), '9999-12-31 23:59:59')  as next_dteventtime,\n        row_number() over (partition by vplayerid order by dteventtime) as trigger_count\n    from (\n        select distinct\n            vplayerid,\n            dteventtime\n        from dwd_jordass_activityrecord_hi\n        where tdbank_imp_date >= '2025011100'\n        and tdbank_imp_date <= '2025012423'\n        and actid = 2411070621\n        and acttype = 10062\n        and recodtype in ('1', '2')\n        and strarg1 <> '0'\n    ) ff1\n) s1 \njoin (\n    select\n        vplayerid,\n        dteventtime,\n        sum(arg1) as draw_count\n    from dwd_jordass_activityrecord_hi  -- actgeneralflow表\n    where tdbank_imp_date >= \"2025011100\" and tdbank_imp_date <= \"2025012423\" -- 时间区间：20250111-20250124\n    and actid = 2411070621\n    and acttype = 10062\n    and recodtype in (\"1\", \"2\")\n    group by vplayerid, dteventtime\n\n    \n) s2 \non s1.vplayerid = s2.vplayerid and s2. dteventtime >= s1.dteventtime and s2.dteventtime < s1.next_dteventtime\ngroup by s1.trigger_count",
    "category": "行为链条",
    "category_reason": "问题关注用户在活动中的抽奖行为序列，分析特定触发点后的行为转化。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"行为链条\",\n  \"rationale\": \"问题关注用户在活动中的抽奖行为序列，分析特定触发点后的行为转化。\"\n}"
  },
  {
    "question_id": "sql_60",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20250226往前180天联盟用户，联盟用户的30天滚动付费人数\n输出：统计日期（YYYYMMDD），联盟并付费的人数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_water_di` (\n  `dtstatdate` TEXT COMMENT '分区，付费日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android,255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `iamount` BIGINT COMMENT '代币金额(Q分)',\n  `itimes` BIGINT COMMENT '流水次数',\n  `imoney` DOUBLE COMMENT '除100为实际支付人民币金额'\n);\nCREATE TABLE `dws_jordass_uid_login_df` (\n  `dtstatdate` TEXT COMMENT '日期',\n  `vgameappid` TEXT COMMENT '账号体系： wx - 微信 ；qq - 手Q',\n  `platid` BIGINT COMMENT '系统平台',\n  `vplayerid` TEXT COMMENT '账号id',\n  `uid` BIGINT COMMENT '角色id',\n  `vrolename` TEXT COMMENT '角色名称',\n  `dregdate` TEXT COMMENT '注册日期',\n  `lastactdate` TEXT COMMENT '最后活跃日期',\n  `cbitmap` TEXT COMMENT '活跃位图',\n  `ilevel` TEXT COMMENT '账号等级',\n  `friendcount` BIGINT COMMENT '好友数',\n  `historymaxsegment` BIGINT COMMENT '历史最高段位',\n  `gender` BIGINT COMMENT '游戏内性别'\n);\nCREATE TABLE `dwd_jordass_player_allianceactive_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `uid` TEXT COMMENT '角色UID',\n  `corpsid` TEXT COMMENT '联盟id',\n  `active` BIGINT COMMENT '新增的活跃点',\n  `allianceforceteractive` BIGINT COMMENT '变化后的日活跃点',\n  `reason` BIGINT COMMENT '原因',\n  `vgameappid` TEXT COMMENT '游戏APPID'\n);\n\n【参考信息】\n联盟活跃用户统计日期：\nwhere tdbank_imp_date>=date_sub(\"20250226\",180) and tdbank_imp_date<\"20250226\"\n游戏付费流水统计日期：\nwhere dtstatdate>=date_sub(\"20250226\",210) and dtstatdate<\"20250226\" and platid=255\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是特定时间段内用户的付费行为分布，属于活跃度和参与度的衡量。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是特定时间段内用户的付费行为分布，属于活跃度和参与度的衡量。\"\n}"
  },
  {
    "question_id": "sql_61",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2024.2.9首日累充活动领奖玩家分R\n输出：用户类型（沉默付费、历史非付费、小R、中R、大R、超R），活跃人数、首日付费人数，首日付费ARPU，前一个月有消耗点券人数\n\n沉默付费：历史付过费且前1个月没有消耗过点券\n点券的分R：\n前一个月的点券消耗总金额，小于100代表小R，[100-500)代表中R，[500,1500)代表大R，大于等于1500 -  代表超R\n\n【数据库schema】\nCREATE TABLE `dws_jordass_water_di` (\n  `dtstatdate` TEXT COMMENT '分区，付费日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android,255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `iamount` BIGINT COMMENT '代币金额(Q分)',\n  `itimes` BIGINT COMMENT '流水次数',\n  `imoney` DOUBLE COMMENT '除100为实际支付人民币金额'\n);\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\nCREATE TABLE `dwd_jordass_currencylog_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间,格式YY',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填',\n  `vplayerid` TEXT COMMENT '玩家id',\n  `uid` TEXT COMMENT '玩家UID',\n  `sequence` BIGINT COMMENT '用于关联一次动作产生多条不同类型的货币流动日志',\n  `level` BIGINT COMMENT '玩家等级',\n  `allianceforcetermoney` BIGINT COMMENT '动作后的金钱数',\n  `imoney` BIGINT COMMENT '动作涉及的金钱数',\n  `reason` BIGINT COMMENT '货币流动一级原因',\n  `subreason` BIGINT COMMENT '货币流动二级原因',\n  `addorreduce` BIGINT COMMENT '增加 0/减少 1',\n  `imoneytype` BIGINT COMMENT '枚举值(0:金币;1:点券;2:服饰币;4:物资币;6:荣耀勋章;1026:组竞币;1027:幸运币)',\n  `device_type` BIGINT COMMENT '设备类型0为手机,1为模拟器, 2键鼠, 3手柄, 5是PC客户端,也是高清模拟器。'\n);\nCREATE TABLE `dws_jordass_water_df` (\n  `dtstatdate` TEXT COMMENT '分区，付费日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android，255所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '流水位图',\n  `dwaterdate` TEXT COMMENT '首次流水日期',\n  `imoney` DOUBLE COMMENT '累计流水收入(分)(简称流水)',\n  `iamount` BIGINT COMMENT '代币金额(Q分)'\n);\n\n【参考信息】\n首日累充活动逻辑：\nactid = 2402096612 and awardidx between 1 and 7\n合并\nActType = 661 and RecodType = 1\n\n首日付费ARPU计算方式：新用户首日总付费金额（点券）/新用户首日充值人数\n\n点券换算公式：1:10（rmb:点券）\n\n",
    "output": "",
    "category": "用户分群",
    "category_reason": "问题核心是根据玩家充值和消费行为划分R值等级，属于用户分层与画像构建。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"用户分群\",\n  \"rationale\": \"问题核心是根据玩家充值和消费行为划分R值等级，属于用户分层与画像构建。\"\n}"
  },
  {
    "question_id": "sql_62",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20250226联盟前180日（包含当天）基础数据 说明：按照uid计算\n输出：统计日期（YYYYMMDD），角色DAU，联盟参与角色数，联盟完成特训任务角色数，联盟商店兑换次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_allianceshopbuy_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `addresresult` BIGINT,\n  `itemclass` BIGINT,\n  `itemid` BIGINT,\n  `itemnum` BIGINT,\n  `corpslevel` BIGINT,\n  `corpsid` TEXT,\n  `consumeallmoney` BIGINT,\n  `buyitemlist` TEXT\n);\nCREATE TABLE `dwd_jordass_player_allianceactive_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `uid` TEXT COMMENT '角色UID',\n  `corpsid` TEXT COMMENT '联盟id',\n  `active` BIGINT COMMENT '新增的活跃点',\n  `allianceforceteractive` BIGINT COMMENT '变化后的日活跃点',\n  `reason` BIGINT COMMENT '原因',\n  `vgameappid` TEXT COMMENT '游戏APPID'\n);\nCREATE TABLE `dwd_jordass_alliancebootcamprecord_hi` (\n  `tdbank_imp_date` TEXT,\n  `corpssvrid` TEXT COMMENT '战队服务器ID',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `corpsid` TEXT COMMENT '联盟ID',\n  `memberuid` TEXT COMMENT '成员UID',\n  `trainid` BIGINT COMMENT '特训ID',\n  `taskid` BIGINT COMMENT '任务ID'\n);\nCREATE TABLE `dwd_jordass_playerlogout_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `gamesvrid` TEXT COMMENT '登录的游戏服务器编号',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `uid` TEXT COMMENT '玩家UID',\n  `onlinetime` BIGINT COMMENT '本次登录在线时间(秒)',\n  `level` BIGINT COMMENT '等级',\n  `playerfriendsnum` BIGINT COMMENT '玩家好友数量',\n  `clientversion` TEXT COMMENT '客户端版本',\n  `loginchannel` BIGINT COMMENT '登录渠道',\n  `deviceid` TEXT COMMENT '设备ID',\n  `ticket` BIGINT COMMENT '点券',\n  `itemcoin` BIGINT COMMENT '物资币',\n  `luckycoin` BIGINT COMMENT '幸运币',\n  `ironcoin` BIGINT COMMENT '荣耀勋章',\n  `diamond` BIGINT COMMENT '服饰币',\n  `corpsid` TEXT COMMENT '联盟ID',\n  `corpsname` TEXT COMMENT '联盟名称',\n  `clannum` BIGINT COMMENT '玩家战队数量',\n  `clanid1` BIGINT COMMENT '战队ID1',\n  `clanid2` BIGINT COMMENT '战队ID2',\n  `clanid3` BIGINT COMMENT '战队ID3',\n  `logoutreason` TEXT COMMENT '登出原因',\n  `gameid` TEXT COMMENT '当前正在游戏的对局id',\n  `rolesettingstr` TEXT COMMENT 'RoleSetting设置, 当为空字符串时表示该字段获取异常,否则为以+分隔的rolesetting值，具体字段值咨询开发',\n  `historytotalcharm` BIGINT COMMENT '历史总魅力值',\n  `device_type` BIGINT COMMENT '设备类型0为手机,1为模拟器, 2键鼠, 3手柄, 5是PC客户端,也是高清模拟器。',\n  `clientostype` TEXT COMMENT '客户端系统类型：and ios win hm'\n);\nCREATE TABLE `dwd_jordass_playerlogin_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `level` BIGINT COMMENT '等级',\n  `playerfriendsnum` BIGINT COMMENT '玩家好友数量',\n  `clientversion` TEXT COMMENT '客户端版本',\n  `screenwidth` BIGINT COMMENT '显示屏宽度',\n  `screenhight` BIGINT COMMENT '显示屏高度',\n  `density` TEXT COMMENT '像素密度',\n  `loginchannel` BIGINT COMMENT '登录渠道',\n  `vroleid` TEXT COMMENT '玩家角色ID',\n  `vrolename` TEXT COMMENT '玩家角色名',\n  `deviceid` TEXT COMMENT '设备ID',\n  `device_type` BIGINT COMMENT '设备类型0为手机,1为模拟器, 2键鼠, 3手柄, 5是PC客户端,也是高清模拟器。',\n  `gender` BIGINT COMMENT '平台性别，1是男，2是女',\n  `emulatorname` TEXT COMMENT '模拟器名',\n  `warzoneid` BIGINT COMMENT '战区ID',\n  `devicename` TEXT COMMENT '客户端devicename',\n  `historymaxsegment` BIGINT COMMENT '历史最高段位',\n  `seasonmaxsegment` BIGINT COMMENT '本赛季最高段位',\n  `firstlogincg` BIGINT COMMENT '第一次登录CG游戏的时间，即CG注册时间，UNIX时间戳',\n  `lobbybgid` BIGINT COMMENT '当前设置的大厅背景resid',\n  `signature` TEXT COMMENT '个性签名',\n  `devicelevel` BIGINT COMMENT '机型档位',\n  `iswxrealname` BIGINT COMMENT '非微信平台或还没拉取数据填0，已微信实名填1，未实名填2',\n  `iswxlowlv` BIGINT COMMENT '非微信平台或还没拉取数据填0，是微信小号填1，不是微信小号填2',\n  `iszombie` BIGINT COMMENT '非微信平台或还没拉取数据填0，是微信僵尸号填1，不是微信僵尸号填2',\n  `topsegtimes` BIGINT COMMENT '王牌印记: -2 首次达到星钻 -1 首次达到王冠  0 无数据 >0 历史王牌次数',\n  `clanid1` BIGINT COMMENT '战队ID1',\n  `clanid2` BIGINT COMMENT '战队ID2',\n  `clanid3` BIGINT COMMENT '战队ID3',\n  `fpslevel` BIGINT COMMENT '帧率等级',\n  `renderqualityapply` BIGINT COMMENT '画质等级',\n  `devicetcqualitygrade` BIGINT COMMENT '机型等级',\n  `relogin` BIGINT COMMENT '是否是断线重连登录的,1为断线重连，0为从登录界面登录',\n  `gameid` TEXT COMMENT '当前正在游戏的对局id',\n  `startime` BIGINT COMMENT '当前正在游戏的对局id',\n  `rolesettingstr` TEXT COMMENT 'RoleSetting设置, 当为空字符串时表示该字段获取异常,否则为以+分隔的rolesetting值，具体字段值咨询开发',\n  `creditscore` TEXT COMMENT '信誉分',\n  `usenewpickup` BIGINT COMMENT '是否使用新版拾取',\n  `isqrlogin` BIGINT COMMENT '是否为扫码登录的,1是扫码登录，0非扫描登录',\n  `is_gamematrix` BIGINT COMMENT '是否为先锋云游，1是，0不是',\n  `clientsceneversion` TEXT COMMENT '客户端场景版本',\n  `whitetype` BIGINT COMMENT '进入服务器的凭证类型',\n  `mobiletablettype` BIGINT COMMENT '平板识别结果：-1结果未出，0是非平板，1已验证是平板，2可能是平板',\n  `behaviorlevel` BIGINT COMMENT '行为分等级',\n  `clientostype` TEXT COMMENT '客户端系统类型：and ios win hm',\n  `pclogintype` BIGINT COMMENT '0=默认类型，1=PC新手玩家，2=PC回流玩家',\n  `escapecoincount` TEXT COMMENT '隧道收益(该字段原来搞错了, 之前以为是隧道币数量)',\n  `vsteamlevel` BIGINT COMMENT '组竞等级',\n  `connectidx` BIGINT COMMENT '连接序号',\n  `isinds` BIGINT COMMENT '当前登录是否在ds场景中重连'\n);\n\n【参考信息】\n\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是特定日期范围内用户的购买行为统计，属于用户活跃度相关的分布分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是特定日期范围内用户的购买行为统计，属于用户活跃度相关的分布分析。\"\n}"
  },
  {
    "question_id": "sql_64",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计：2024.10.22-2024.11.19、2024.11.22-2024.12.19、2024.10.22-10.27、2024.10.28-11.03、2024.11.04-11.10、2024.11.11-11.17、2024.11.18-11.19、2024.11.22-11.24、2024.11.25-12.01、2024.12.02-12.08、2024.12.09-12.15、2024.12.16-12.19几个时间段的最近上新的曝光用户数（UV）、曝光次数（PV）\n输出：统计日期（例:20241023）、UV、PV\n\n【数据库schema】\nCREATE TABLE `dws_jordass_buttonpress_pre_di` (\n  `dtstatdate` TEXT COMMENT '统计日期，格式YYYYMMDD',\n  `dteventtime` TEXT COMMENT '事件时间,格式YYYY-MM-DDHH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` TEXT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` TEXT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `clientversion` TEXT COMMENT 'clientversion',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `uid` TEXT COMMENT '角色ID',\n  `buttontype` TEXT COMMENT '按钮代号',\n  `ireason` TEXT COMMENT '额外参数',\n  `extarg1` TEXT COMMENT '附加参数1',\n  `extarg2` TEXT COMMENT '附加参数2'\n);\n\n【参考信息】\nbuttontype=\"410012\"表示曝光，一条记录代表一次\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注不同时间段内用户曝光行为的分布情况，属于时间维度上的活跃度分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注不同时间段内用户曝光行为的分布情况，属于时间维度上的活跃度分析。\"\n}"
  },
  {
    "question_id": "sql_65",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n查询2024.11.29-2024.12.19期间的任务领取数据，并按类型汇总（跨日期）\n输出 ：日期（YYYYMMDD、汇总），类型，人数，次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_activity_rewardrecord_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `gamesvrid` TEXT COMMENT '登录的游戏服务器编号',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `actid` BIGINT COMMENT '活动id',\n  `acttype` BIGINT COMMENT '活动类型',\n  `awardidx` BIGINT COMMENT '第几挡奖励',\n  `awardcnt` BIGINT COMMENT '兑换几次 默认1次',\n  `value` BIGINT COMMENT '扩展字段(不同业务解释)',\n  `reissueflag` BIGINT COMMENT '活动补发字段，默认为0不补发，1为补发',\n  `cond1` BIGINT COMMENT '条件1值，任务大类型',\n  `cond2` BIGINT COMMENT '条件2值，任务子类型',\n  `cond3` BIGINT COMMENT '条件3值，任务条件值',\n  `device_type` BIGINT COMMENT '设备类型0为手机,1为模拟器, 2键鼠, 3手柄, 5是PC客户端,也是高清模拟器。'\n);\n\n【参考信息】\n任务领取：actid = 2411291018and acttype = 10045 and awardidx in (1, 2, 3)，一条记录代表领取一次\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注任务领取行为在时间与类型维度上的分布情况。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注任务领取行为在时间与类型维度上的分布情况。\"\n}"
  },
  {
    "question_id": "sql_67",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2025.1.24-2025.2.6时间区间内，道具为430487,430485,602004025,602002011 的产出次数\t\n输出：道具id，产出次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_gearlog_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `uid` TEXT COMMENT '玩家UID',\n  `igoodsinstid` TEXT COMMENT '(可填)道具唯一ID',\n  `level` BIGINT COMMENT '玩家等级',\n  `sequence` BIGINT COMMENT '(可填)用于关联一次购买产生多条不同类型的货币日志',\n  `igoodstype` BIGINT COMMENT '道具类型',\n  `igoodsid` BIGINT COMMENT '道具ID',\n  `count` BIGINT COMMENT '数量',\n  `allianceforcetercount` BIGINT COMMENT '动作后的物品存量',\n  `reason` BIGINT COMMENT '道具流动一级原因',\n  `subreason` BIGINT COMMENT '道具流动二级原因',\n  `imoney` BIGINT COMMENT '花费代币或金币购买道具情况下输出消耗的钱数量，否则填0',\n  `imoneytype` BIGINT COMMENT '钱的类型MONEYTYPE,其它货币类型参考FAQ文档',\n  `addorreduce` BIGINT COMMENT '增加 0/减少 1',\n  `validhours` BIGINT COMMENT '(可填)有效时间(乘以1000倍存储)',\n  `expiretime` TEXT COMMENT '(可填)到期时间',\n  `subtype` BIGINT COMMENT '(可填)道具子类型',\n  `device_type` BIGINT COMMENT '设备类型0为手机 1为模拟器 2 键鼠 3 手柄'\n);\n\n【参考信息】\naddorreduce=0表示产出，1表示消耗\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注特定道具在指定时间区间的产出次数，属于对游戏内行为的统计分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注特定道具在指定时间区间的产出次数，属于对游戏内行为的统计分析。\"\n}"
  },
  {
    "question_id": "sql_68",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计时间范围：25.1.28-25.2.10，新春华服id：848，841 \n输出：日期（YYDDMM），人数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_lotteryrecord_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '玩家',\n  `uid` TEXT COMMENT '角色UID',\n  `activitytype` BIGINT COMMENT '活动类型',\n  `discountnum` BIGINT COMMENT '折扣使用次数',\n  `allianceforcetermoney` BIGINT COMMENT '操作后剩余抽奖比',\n  `allianceforceterround` BIGINT COMMENT '操作后累计轮次数',\n  `dailyround` BIGINT COMMENT '操作后当日累计轮次数',\n  `lotteryround` BIGINT COMMENT '抽奖次数, 单抽：1, 十连抽：10',\n  `suprisehit` BIGINT COMMENT '惊喜,0不命中,1命中',\n  `costnum` BIGINT COMMENT '消耗活动币数量',\n  `awardsitems` TEXT COMMENT '第一个是道具id，第二个是道具个数，比如：1602517-2-0-0 道具id是1602517， 道具个数是2。\t使用以下逻辑获取道具id和道具个数明细：\t```\tselect \t  -- 提取道具ID（第一个数字段）\t  split(exploded_item, -)[0] AS item_id,\t  -- 提取道具数量（第二个数字段）\t  split(exploded_item, -)[1] AS item_count \tfrom ieg_tdbank::dwd_jordass_lotteryrecord_hi\tlateral view explode(split(awardsitems, :)) tmp AS exploded_item\t```',\n  `device_type` BIGINT COMMENT '设备类型0为手机 1为模拟器 2 键鼠 3 手柄',\n  `couponinfo` TEXT COMMENT '使用优惠券列表',\n  `reductionnum` BIGINT COMMENT '减免活动币数量'\n);\n\n【参考信息】\n新春华服：\nactivitytype in (848, 841)\n\n",
    "output": "",
    "category": "活动分析",
    "category_reason": "问题聚焦于特定时间段内特定活动（新春华服）的相关数据统计，属于对具体运营活动的表现分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活动分析\",\n  \"rationale\": \"问题聚焦于特定时间段内特定活动（新春华服）的相关数据统计，属于对具体运营活动的表现分析。\"\n}"
  },
  {
    "question_id": "sql_69",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2024.12.25——2025.1.5 ，不同信息类型的玩家数量\n\n信息类型:chattype in (20,25,26,16,27,8)\n\n输出 日期（20241225-20250105），信息类型，人数，次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_msgchatrecord_hi` (\n  `tdbank_imp_date` TEXT,\n  `gamesvrid` TEXT COMMENT '登录的游戏服务端编号',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `gameappid` TEXT COMMENT '游戏APPID',\n  `playerid` TEXT COMMENT '发送方用户playerid号',\n  `platid` BIGINT COMMENT 'ios 0 /android 1',\n  `areaid` BIGINT COMMENT '微信 1 /手Q 2 /游客 3',\n  `zoneid` BIGINT COMMENT '小区号id',\n  `clientversion` TEXT COMMENT '客户端版本号',\n  `rolename` TEXT COMMENT '发送方角色昵称只保留中文字符、英文和数字。如果昵称中带有特殊字符（比如|或者/t），则记录时过滤，比如 张|三 记为 张.三',\n  `roleid` TEXT COMMENT '发送方角色唯一ID',\n  `rolelevel` BIGINT COMMENT '发送方角色等级',\n  `rolebattlepoint` BIGINT COMMENT '发送方角色军衔',\n  `userip` TEXT COMMENT '发送信息玩家ip地址',\n  `groupid` TEXT COMMENT '发送信息玩家公会ID,没有公会则上报0',\n  `picurl` TEXT COMMENT '玩家头像URL，手Q默认上报后缀为/100的URL , 微信默认上报后缀为/96的URL',\n  `usersign` TEXT COMMENT '个人签名内容，目前最多能发送单条512字节的信息内容只保留中文字符、英文和数字。如果内容中带有特殊字符（比如|或者\\t），则记录时去掉，比如 张|三 记为 张三',\n  `receiverplayerid` TEXT COMMENT '接收方角色playerid号',\n  `receiverroleid` TEXT COMMENT '接收方角色唯一ID或游乐场聊天对应的战斗ID',\n  `receiverroletype` BIGINT COMMENT '接收方角色职业编号',\n  `receiverrolelevel` BIGINT COMMENT '接收方角色等级',\n  `chattype` BIGINT COMMENT '信息类型，信息类型，1世界聊天，2点对点聊天，3 房间聊天，4加好友的请求信息 5 聊天室聊天 6 组队 8 联盟 9 师徒 10 巅峰赛 11 游乐场 12 临时会话 13 阵营聊天 100 战斗内聊天',\n  `chatroomid` BIGINT COMMENT '聊天室ID，非聊天室聊天报0',\n  `msgtype` BIGINT COMMENT '聊天信息类型，0 为文字信息，1 为语音信息 2为模板发言',\n  `chatcontents` TEXT COMMENT 'comment',\n  `chatroomname` TEXT COMMENT '聊天室名称或联盟名称，非聊天室聊天报0',\n  `chatroomownerplayerid` TEXT COMMENT '聊天室创建者playerid，非聊天室聊天报0, 这里报UID',\n  `chatroomsign` TEXT COMMENT '聊天室签名，非聊天室聊天报0',\n  `currentscene` BIGINT COMMENT '(可填)来源场景:1 大厅; 2 战斗; 3 观战; 4 特训岛; 5 营地',\n  `battleid` TEXT COMMENT '对局ID，适用于广阔天地/UGC/狼人杀等场景',\n  `submode` TEXT COMMENT '子模式',\n  `accompanytype` TEXT COMMENT '玩家陪玩标签获取接口',\n  `devicetype` BIGINT COMMENT '设备类型0为手机 1为模拟器 2 键鼠 3 手柄 5 PC'\n);\n\n【参考信息】\nchattype in (20,25,26,16,27,8)\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注不同信息类型的玩家数量和次数分布，属于按维度细分的活跃行为统计。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注不同信息类型的玩家数量和次数分布，属于按维度细分的活跃行为统计。\"\n}"
  },
  {
    "question_id": "sql_70",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2024.11.29-2024.12.19期间，不同抽奖档位的对应人数\n输出 抽奖档位（含汇总档位），人数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_activity_rewardrecord_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `gamesvrid` TEXT COMMENT '登录的游戏服务器编号',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `actid` BIGINT COMMENT '活动id',\n  `acttype` BIGINT COMMENT '活动类型',\n  `awardidx` BIGINT COMMENT '第几挡奖励',\n  `awardcnt` BIGINT COMMENT '兑换几次 默认1次',\n  `value` BIGINT COMMENT '扩展字段(不同业务解释)',\n  `reissueflag` BIGINT COMMENT '活动补发字段，默认为0不补发，1为补发',\n  `cond1` BIGINT COMMENT '条件1值，任务大类型',\n  `cond2` BIGINT COMMENT '条件2值，任务子类型',\n  `cond3` BIGINT COMMENT '条件3值，任务条件值',\n  `device_type` BIGINT COMMENT '设备类型0为手机,1为模拟器, 2键鼠, 3手柄, 5是PC客户端,也是高清模拟器。'\n);\n\n【参考信息】\n抽奖活动：actid = 2411291018\n汇总：额外计算一个全档位统计组\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注不同抽奖档位的参与人数分布，属于用户行为在特定活动中的分布情况。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注不同抽奖档位的参与人数分布，属于用户行为在特定活动中的分布情况。\"\n}"
  },
  {
    "question_id": "sql_71",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2024.11.29-2024.12.19期间，每七天统计一次阶梯活动相关用户数\n输出 日期范围（20241129-20241205、20241206-20241212、20241213-20241219），extarg1类型，用户数，次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_activitypress_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间,格式YYYY-MM-DDHH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '玩家',\n  `uid` TEXT COMMENT '角色UID',\n  `buttontype` BIGINT COMMENT '按钮代号,找客户端开发问下定义',\n  `ireason` BIGINT COMMENT '活动id',\n  `extarg1` BIGINT COMMENT '附加参数1,客户端负责传过来',\n  `extarg2` TEXT COMMENT '附加参数2,客户端负责传过来',\n  `extarg3` BIGINT COMMENT '附加参数3,客户端负责传过来',\n  `devicetype` BIGINT COMMENT 'DeviceType'\n);\n\n【参考信息】\n阶梯活动：ireason = 2411291018 and buttontype = 10045 and extarg1 in (101,109,110)\n\n",
    "output": "",
    "category": "活动分析",
    "category_reason": "问题关注的是特定时间段内阶梯活动相关用户数的统计，属于活动效果评估范畴。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活动分析\",\n  \"rationale\": \"问题关注的是特定时间段内阶梯活动相关用户数的统计，属于活动效果评估范畴。\"\n}"
  },
  {
    "question_id": "sql_73",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20241123-20241222对决冠军，乐园其他，和乐园汇总 三类用户的组队和对局情况\n输出：乐园总参与人数，乐园总参与局数，乐园组队人数，乐园组队局数，对决冠军总参与人数，对决冠军总参与局数，对决冠军组队人数，对决冠军组队局数，乐园其他总参与人数，乐园其他总参与局数，乐园其他组队人数，乐园其他组队局数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_player_matchrecord_hi` (\n  `tdbank_imp_date` TEXT COMMENT '分区字段，小时分区，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `matchtime` BIGINT COMMENT '匹配时长（秒）',\n  `matchresult` TEXT COMMENT '匹配结果',\n  `matchmode` BIGINT COMMENT '匹配模式',\n  `isaotufill` BIGINT COMMENT '是否自动填充',\n  `gameid` TEXT COMMENT '匹配成功为当前的battleid失败为0',\n  `submodes` TEXT COMMENT '选择的子模式列表，只有队长才有',\n  `isleader` BIGINT COMMENT '1表示队长0非队长',\n  `teamnum` TEXT COMMENT '组队人数',\n  `teammembers` TEXT COMMENT '组队队伍',\n  `matchteammembers` TEXT COMMENT '最终匹配的队伍',\n  `matchlabel` BIGINT COMMENT '匹配标签',\n  `corpsid` BIGINT COMMENT '联盟id',\n  `teamid` TEXT COMMENT '队伍ID',\n  `teamwaittime` BIGINT COMMENT '队伍首次组队到匹配等待时间',\n  `finalbucketidx` BIGINT COMMENT '匹配成功首队伍所在匹配区间idx',\n  `playermoderating` BIGINT COMMENT '玩家该模式下rating分(段位分)',\n  `playerlevel` BIGINT COMMENT '玩家等级',\n  `regresss` BIGINT COMMENT '是否回流玩家',\n  `matchsubmodegroup` BIGINT COMMENT '最终随机到的submodegroup',\n  `matchrating` BIGINT COMMENT '当前玩家所在队伍匹配积分',\n  `bucketidx` BIGINT COMMENT '当前玩家所在队伍匹配积分所在区间idx',\n  `device_type` BIGINT COMMENT '设备类型0为手机 1为模拟器 2 键鼠 3 手柄 5 PC高清模拟器',\n  `strategys` TEXT COMMENT '分队策略',\n  `match_client_type` BIGINT COMMENT '匹配池渠道0为手机 1为模拟器 2外部模拟器 8为小黑屋 9为新手局',\n  `pandoralost` BIGINT COMMENT '潘多拉预流失标记 1预流失 0非预流失',\n  `teamjoinsource` BIGINT COMMENT '组队加入来源',\n  `regressvalue` BIGINT COMMENT '玩家当前的回流值',\n  `strategy_type` BIGINT COMMENT '策略类型，-1表示服务器保底二次分队, 0表示004的潘多拉策略, 1表示005的潘多拉单局最优策略, 2表示015的技术中心优化分队策略, 3表示技术中心向量化二次分队方案, 4表示内部推荐二次分队方案',\n  `playersign` BIGINT COMMENT '玩家分级标签，1为白，2为红，3为灰, 4为深灰',\n  `livetype` BIGINT COMMENT '直播类型: 2 围观 4 视频号',\n  `liveid` TEXT COMMENT '直播ID',\n  `matchscene` BIGINT COMMENT '匹配成功时玩家所在场景，0为大厅，1为聚乐园',\n  `issilentmode` BIGINT COMMENT '是否是免耳麦模式，0为非免耳麦，1为免耳麦',\n  `ismatchlbs` BIGINT COMMENT '是否是lbs匹配，0为非lbs匹配，1为lbs匹配',\n  `strategy_index` BIGINT COMMENT '二次分队策略采用的weight数组的下标',\n  `xid` TEXT COMMENT 'Xid',\n  `isanchor` BIGINT COMMENT '是否是主播，0为非主播，1为主播',\n  `isanchorgame` BIGINT COMMENT '是否匹配到主播局，0为非主播局，1为主播局',\n  `tournamentid` BIGINT COMMENT '微赛事ID',\n  `expandupsection` BIGINT COMMENT '最大向上扩段数',\n  `expanddownsection` BIGINT COMMENT '最大向下扩段数',\n  `expandupclass` BIGINT COMMENT '最大向上扩载数',\n  `expanddownclass` BIGINT COMMENT '最大向下扩载数',\n  `isfullbucket` BIGINT COMMENT '是否优先遍历满载队',\n  `timingmatchtime` BIGINT COMMENT '定时匹配真实匹配时长（秒）',\n  `tournamentstage` BIGINT COMMENT '微赛事阶段ID',\n  `tournamentclubid` TEXT COMMENT '微赛事战队ID',\n  `promotionmatchstatus` BIGINT COMMENT '参与晋级赛的状态, -1没勾选，0成功参与，1模式不对，2时间不对，3配置不对，4自身段位不对，5队友段位不对',\n  `ugcisgray` BIGINT COMMENT '是否为ugc灰度玩法。默认为0：非灰度；1：灰度',\n  `promotiontaskid` BIGINT COMMENT '晋级赛任务ID',\n  `strategyabtest` TEXT COMMENT '未命中模式为空，对照组记 0:ID，实验组记 1:ID',\n  `accompanytype` BIGINT COMMENT '陪玩标签值 0 ：没有打标签，1：陪玩，2：老板',\n  `minusteamnum` BIGINT COMMENT '匹配成功后踢回匹配池的队伍数',\n  `mobiletabletmatchlabel` BIGINT COMMENT '匹配队伍平板比例标签(非手机=0，纯手机=1，25%平板=2，50%平板=3，75%平板=4，100%平板=5)',\n  `ratingtype` BIGINT COMMENT '积分类型',\n  `idcname` TEXT COMMENT 'IDC集群名字',\n  `strategyextendinfo` TEXT COMMENT '推荐侧二次分队返回的信息',\n  `playerabtest` TEXT COMMENT '个人匹配abtest',\n  `gameabtest` TEXT COMMENT '匹配对局的abtest,没有则为空字符串',\n  `matchtype` BIGINT COMMENT '1表示匹配成局，2表示补人',\n  `matchisolatetype` BIGINT COMMENT '玩家匹配隔离标记, 0不隔离，2所有模式隔离，3积分模式隔离，4E玩法模式隔离',\n  `predictmatchtime` BIGINT COMMENT '预估匹配时长',\n  `expandspeed` BIGINT COMMENT '匹配单阶段扩段时长',\n  `escapehardid` BIGINT COMMENT 'E玩法难度ID',\n  `gameplayernum` BIGINT COMMENT '开局人数',\n  `gameaistrategy` BIGINT COMMENT 'AI投放策略类型',\n  `isfixmatchlabel` BIGINT COMMENT '是否触发了标签修正',\n  `realmatchsubmodes` TEXT COMMENT '实际匹配的模式组列表',\n  `aitype` BIGINT COMMENT '投放的AI類型',\n  `decratingtype` BIGINT COMMENT '降段类型，0=未触发降段，1=pc新手标签降段，2=未成年标签降段，3=回流标签降段，4=情绪值降段',\n  `forcematchtype` BIGINT COMMENT '记录本次匹配是否触发了强制开局，0=未触发，1=通用强制开局，2=PC新手强制开局',\n  `ispcaigame` BIGINT COMMENT '是否触发了PC首局AI局',\n  `matchsubclienttype` BIGINT COMMENT '匹配子池：0非子池, 2外设键鼠,3外设手柄,4主播,5PC新手,6PC-AI局 7BR温暖局，8隧道AI局',\n  `heroexcludetype` BIGINT COMMENT '是否触发了英雄互斥匹配，1采用了互斥匹配, 2没命中灰度 3超时，0其他情况',\n  `natalhero` BIGINT COMMENT '本命英雄ID',\n  `iswarmescapegame` BIGINT COMMENT '是否是E玩法温暖局',\n  `cancrossdevicematch` BIGINT COMMENT '是否可已手机非手机混匹, 1可以，0不可以',\n  `aiteamatetype` BIGINT COMMENT 'AI队友类型',\n  `isfirstteam` BIGINT COMMENT '是否是首队',\n  `firstteamwaittime` BIGINT COMMENT '首队的匹配等待时间',\n  `firstteamrankbucket` BIGINT COMMENT '首队段位分段',\n  `matchprocessinfo` TEXT COMMENT '匹配扩展信息 辅助查询匹配问题',\n  `isabtwarmgame` BIGINT COMMENT '是否触发了温暖局',\n  `warmplayertype` BIGINT COMMENT '温暖局玩家身份, 3=挫败（未来），2=回流，1=低活，0=未触发或无标签',\n  `escapeplayertype` TEXT COMMENT '隧道玩家身份类型, 空字符串表示默认类型，1回流标签有限期内,2积分移动新手(隐藏分专用),3积分非移动新手(隐藏分专用),4积分回流(隐藏分专用),5全局新手(AI局专用),6PC新手(AI局专用),7非PC温暖(AI局专用),8PC温暖(AI局专用),9回流(AI局专用), 以+分割',\n  `secondarydecratingtype` BIGINT COMMENT '二维匹配分降段类型，0=未触发降段，1=隧道回流降分匹配',\n  `finalsecondarybucketidx` BIGINT COMMENT '匹配成功首队所在二维匹配积分区间',\n  `playersecondarymoderating` BIGINT COMMENT '玩家该模式下二维匹配积分',\n  `secondarymatchrating` BIGINT COMMENT '当前玩家所在队伍二维匹配积分',\n  `secondarybucketidx` BIGINT COMMENT '当前玩家所在队伍二维匹配积分所在区间',\n  `escapeasset` TEXT COMMENT '隧道玩法资产',\n  `escapewarmscore` TEXT COMMENT '隧道温暖值',\n  `pvethemeid` BIGINT COMMENT 'PVE挑战事件ID',\n  `escapelesspeoplegamenum` BIGINT COMMENT '隧道每周已触发低真人局次数',\n  `garybucketgroup` BIGINT COMMENT '灰度分桶',\n  `matchsubclienttypebefore` BIGINT COMMENT '发起匹配时的匹配子池：0非子池, 2外设键鼠,3外设手柄,4主播,5PC新手,6PC-AI局, 7BR温暖局，8隧道AI局',\n  `frustratiggerlevel` BIGINT COMMENT 'FrustraTiggerLevel',\n  `frustramanualscore` TEXT COMMENT 'FrustraManualScore',\n  `frustramodelscore` TEXT COMMENT 'FrustraModelScore',\n  `frustragroup` TEXT COMMENT 'FrustraGroup',\n  `frustrathreshold` TEXT COMMENT 'FrustraThreshold',\n  `recomtraceid` TEXT COMMENT 'RecomTraceID'\n);\n\n【参考信息】\n对决冠军：matchmode=1003 and matchsubmodegroup=1345785623905087744\n乐园其他：matchmode=1003 and matchsubmodegroup<>1345785623905087744\n乐园汇总：matchmode=1003\n都需要限制 matchresult=\"ok\"\n组队：teamnum>1\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注不同用户群体在特定时间范围内的组队和对局行为，属于活动/参与度的分布统计。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注不同用户群体在特定时间范围内的组队和对局行为，属于活动/参与度的分布统计。\"\n}"
  },
  {
    "question_id": "sql_74",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计 SS30赛季手册和SS29赛季手册的按钮人数\nSS30赛季:2024112305 - 2024112616\nSS29赛季:2024092405 - 2024092716\n输出：按钮类型，SS30赛季手册人数，SS29赛季手册人数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_pressbutton_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '玩家',\n  `uid` TEXT COMMENT '角色UID',\n  `buttontypes` TEXT COMMENT '按钮代号,找客户端开发问下定义，以;分隔',\n  `ireasons` TEXT COMMENT '额外参数,客户端负责传过来，以;分隔',\n  `extarg1s` TEXT COMMENT '附加参数1,客户端负责传过来，以;分隔',\n  `extarg2s` TEXT COMMENT '附加参数2,客户端负责传过来，以;分隔'\n);\n\n【参考信息】\n按钮：buttontypes等于411130或411200\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是特定赛季期间按钮点击人数的统计，属于用户行为在时间维度上的分布情况。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是特定赛季期间按钮点击人数的统计，属于用户行为在时间维度上的分布情况。\"\n}"
  },
  {
    "question_id": "sql_75",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计：2022080400-2024112400的研究所解锁语音数量\n输出：baseid,解锁语音数量\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_voicethemelog_hi` (\n  `tdbank_imp_date` TEXT,\n  `gamesvrid` TEXT COMMENT '登录的游戏服务器编号',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `baseid` BIGINT COMMENT '胚子ResID',\n  `level` BIGINT COMMENT '等级',\n  `effectid` BIGINT COMMENT '解锁语音主题效果ID'\n);\n\n【参考信息】\n研究所：baseid in (3336008, 3304024, 3336012, 3306028, 3304030, 3336016, 3336018, 3304038, 3336023, 3306033, 3349004, 3308014, 3336032, 3304043, 3306039, 3336041, 3301024, 3336045, 3306042)\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "统计特定时间段内语音解锁行为的总量，属于对用户行为活跃度的分布统计。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"统计特定时间段内语音解锁行为的总量，属于对用户行为活跃度的分布统计。\"\n}"
  },
  {
    "question_id": "sql_77",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计：20230123开始7日内元素付费金额\n输出：日期（20230123-20230129），人数，元素付费金额\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_currencylog_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间,格式YY',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填',\n  `vplayerid` TEXT COMMENT '玩家id',\n  `uid` TEXT COMMENT '玩家UID',\n  `sequence` BIGINT COMMENT '用于关联一次动作产生多条不同类型的货币流动日志',\n  `level` BIGINT COMMENT '玩家等级',\n  `allianceforcetermoney` BIGINT COMMENT '动作后的金钱数',\n  `imoney` BIGINT COMMENT '动作涉及的金钱数',\n  `reason` BIGINT COMMENT '货币流动一级原因',\n  `subreason` BIGINT COMMENT '货币流动二级原因',\n  `addorreduce` BIGINT COMMENT '增加 0/减少 1',\n  `imoneytype` BIGINT COMMENT '枚举值(0:金币;1:点券;2:服饰币;4:物资币;6:荣耀勋章;1026:组竞币;1027:幸运币)',\n  `device_type` BIGINT COMMENT '设备类型0为手机,1为模拟器, 2键鼠, 3手柄, 5是PC客户端,也是高清模拟器。'\n);\n\n【参考信息】\n限定：reason in (189, 190)\n元素付费类型：imoneytype = 1027\n元素付费金额：imoney\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是特定时间段内用户的付费行为分布，属于活跃度相关的货币流动分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是特定时间段内用户的付费行为分布，属于活跃度相关的货币流动分析。\"\n}"
  },
  {
    "question_id": "sql_78",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计：首日红装活动（20250119）返场抽奖的用户属性\n输出：初日华服回归抽奖&沙漠统治者有抽奖人数\n初日华服回归抽奖&境界双花有抽奖人数\t\t\n初日华服回归抽奖&玄龙凌霄有抽奖人数\t\t\n初日华服回归抽奖&沙漠统治者有抽奖&但没有其主套人数\t\t\n初日华服回归抽奖&境界双花有抽奖&但没有其主套人数\t\t\n初日华服回归抽奖&玄龙凌霄有抽奖&但没有其主套人数\t\t\n初日华服回归抽奖&【沙漠统治者和境界双花有主套】人数\t\t\n初日华服回归抽奖&【沙漠统治者和玄龙凌霄有主套】人数\t\t\t\t\n初日华服回归抽奖&【境界双花和玄龙凌霄有主套】人数\t\t\t\t\n初日华服回归抽奖但【沙漠统治者&境界双花&玄龙凌霄】没有抽奖人数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_gearlog_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `uid` TEXT COMMENT '玩家UID',\n  `igoodsinstid` TEXT COMMENT '(可填)道具唯一ID',\n  `level` BIGINT COMMENT '玩家等级',\n  `sequence` BIGINT COMMENT '(可填)用于关联一次购买产生多条不同类型的货币日志',\n  `igoodstype` BIGINT COMMENT '道具类型',\n  `igoodsid` BIGINT COMMENT '道具ID',\n  `count` BIGINT COMMENT '数量',\n  `allianceforcetercount` BIGINT COMMENT '动作后的物品存量',\n  `reason` BIGINT COMMENT '道具流动一级原因',\n  `subreason` BIGINT COMMENT '道具流动二级原因',\n  `imoney` BIGINT COMMENT '花费代币或金币购买道具情况下输出消耗的钱数量，否则填0',\n  `imoneytype` BIGINT COMMENT '钱的类型MONEYTYPE,其它货币类型参考FAQ文档',\n  `addorreduce` BIGINT COMMENT '增加 0/减少 1',\n  `validhours` BIGINT COMMENT '(可填)有效时间(乘以1000倍存储)',\n  `expiretime` TEXT COMMENT '(可填)到期时间',\n  `subtype` BIGINT COMMENT '(可填)道具子类型',\n  `device_type` BIGINT COMMENT '设备类型0为手机 1为模拟器 2 键鼠 3 手柄'\n);\nCREATE TABLE `dwd_jordass_lotteryrecord_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '玩家',\n  `uid` TEXT COMMENT '角色UID',\n  `activitytype` BIGINT COMMENT '活动类型',\n  `discountnum` BIGINT COMMENT '折扣使用次数',\n  `allianceforcetermoney` BIGINT COMMENT '操作后剩余抽奖比',\n  `allianceforceterround` BIGINT COMMENT '操作后累计轮次数',\n  `dailyround` BIGINT COMMENT '操作后当日累计轮次数',\n  `lotteryround` BIGINT COMMENT '抽奖次数, 单抽：1, 十连抽：10',\n  `suprisehit` BIGINT COMMENT '惊喜,0不命中,1命中',\n  `costnum` BIGINT COMMENT '消耗活动币数量',\n  `awardsitems` TEXT COMMENT '第一个是道具id，第二个是道具个数，比如：1602517-2-0-0 道具id是1602517， 道具个数是2。\t使用以下逻辑获取道具id和道具个数明细：\t```\tselect \t  -- 提取道具ID（第一个数字段）\t  split(exploded_item, -)[0] AS item_id,\t  -- 提取道具数量（第二个数字段）\t  split(exploded_item, -)[1] AS item_count \tfrom ieg_tdbank::dwd_jordass_lotteryrecord_hi\tlateral view explode(split(awardsitems, :)) tmp AS exploded_item\t```',\n  `device_type` BIGINT COMMENT '设备类型0为手机 1为模拟器 2 键鼠 3 手柄',\n  `couponinfo` TEXT COMMENT '使用优惠券列表',\n  `reductionnum` BIGINT COMMENT '减免活动币数量'\n);\n\n【参考信息】\n抽奖活动时间：\n沙漠统治者：20240426-20240606 \n镜域双华：20240607-20240725 \n玄龙凌霄：20240726-20240822\n抽奖活动筛选条件：\n初日华服回归抽奖 activitytype = 815\n沙漠统治者有抽奖 activitytype = 690\n境界双花有抽奖 activitytype = 748\n玄龙凌霄有抽奖 activitytype = 750\n主套提取逻辑：\n提取道具沙漠统治者-有主套的用户 igoodsid = 430179 and addorreduce = 0\n提取道具镜域双华-有主套的用户 igoodsid = 430265  and addorreduce = 0\n提取道具玄龙凌霄-有主套用户 igoodsid = 430225  and addorreduce = 0\n\n",
    "output": "",
    "category": "用户分群",
    "category_reason": "问题聚焦于根据特定活动行为和装备持有情况对用户进行细分。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"用户分群\",\n  \"rationale\": \"问题聚焦于根据特定活动行为和装备持有情况对用户进行细分。\"\n}"
  },
  {
    "question_id": "sql_80",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计：2024.10.2-2025.1.8内，每七天为一个周期，上周没参与对决冠军玩法但下周参与了对决冠军玩法的用户，上下周的主玩玩法、参与玩法以及对决冠军玩法游玩时长\n输出：时间区间（2024-10-09-2025-01-08），上周主玩玩法游玩时长，上周参与玩法游玩时长，本周主玩玩法游玩时长，本周参与玩法游玩时长，本周对决冠军玩法游玩时长\n\n【数据库schema】\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT '统计日期格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `mode` BIGINT COMMENT '模式ID',\n  `modename` TEXT COMMENT '模式名称',\n  `submode` BIGINT COMMENT '子模式ID',\n  `submodename` TEXT COMMENT '子模式名称',\n  `map` BIGINT COMMENT '地图ID',\n  `mapname` TEXT COMMENT '地图名称',\n  `seasonid` BIGINT COMMENT '赛季ID',\n  `seasonname` TEXT COMMENT '赛季名称',\n  `roundcnt` BIGINT COMMENT '当日对局数',\n  `roundtime` BIGINT COMMENT '当日对局时长(秒)',\n  `survivaltime` BIGINT COMMENT '当日存活时长(秒)',\n  `firstroundtime` TEXT COMMENT '当日首次对局时间',\n  `device_type` BIGINT COMMENT '设备类型'\n);\n\n【参考信息】\n对决冠军模式是指modename = \"乐园\" AND submodename = \"对决冠军\"\n时间固定从10.2开始计算周期，也就是说10.1实际上算作上周\n\n玩法时长保留两位小数\ncase when modename=\"传统模式\" and submodename like \"CG%\" and mapname=\"群屿\" then \"主题群屿\" \nwhen modename=\"传统模式\" and mapname=\"群屿\" then \"传统群屿\"\nwhen modename=\"传统模式\" and mapname=\"假日群岛\" then \"假日群岛\"\nwhen submodename = \"广域战场模式\" then \"广域战场\"\nWHEN submodename=\"极能形态模式\" THEN \"极能形态\"\nwhen modename=\"组队竞技\" then \"组竞\"\nwhen modename=\"休闲模式\" then \"休闲\" \nwhen modename=\"乐园\" then \"乐园\" \nwhen modename=\"领地\" then \"领地\" \nwhen modename=\"广阔天地\" then \"广阔天地\"\nwhen modename=\"生存模式\" then \"隧道\"\nelse \"其他模式\"\n\n主玩定义：从上述所以玩法中选取对局时长最长的玩法\n\n",
    "output": "",
    "category": "行为链条",
    "category_reason": "问题关注用户在不同周期内从不参与到参与特定玩法的行为转变，属于多步骤行为分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"行为链条\",\n  \"rationale\": \"问题关注用户在不同周期内从不参与到参与特定玩法的行为转变，属于多步骤行为分析。\"\n}"
  },
  {
    "question_id": "sql_82",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220408-20220410第三人称四排用户中 玩法类型（群屿 山峦 假日群岛）赛季等级总积分的人数\n输出：玩法类型，赛季等级，总积分范围（[1,2) 、[2,3).. 左闭右开），人数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_roundflow_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `gamesvrid` TEXT COMMENT '登录的游戏服务器编号',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '玩家',\n  `uid` TEXT COMMENT '玩家UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `battletype` BIGINT COMMENT '战斗类型对应BATTLETYPE,其它说明参考FAQ文档',\n  `roundscore` BIGINT COMMENT '本局分数,无得分的填0',\n  `roundtime` BIGINT COMMENT '对局时长(秒)',\n  `result` BIGINT COMMENT '单局结果，参考 Result',\n  `gold` BIGINT COMMENT '金钱变化值',\n  `level` BIGINT COMMENT '等级变化值',\n  `seasonid` BIGINT COMMENT '所属赛季ID',\n  `mode` BIGINT COMMENT '101：传统模式第三人称单排\t102：传统模式第三人称双排\t103：传统模式第三人称四排\t401：传统模式第一人称单排\t402：传统模式第一人称双排\t403：传统模式第一人称四排\t603：创意创作间计分模式第三人称四排(含极能形态模式、极限追猎、特种作战等子模式)',\n  `submode` BIGINT COMMENT '子模式',\n  `map` BIGINT COMMENT '地图',\n  `weather` BIGINT COMMENT '天气',\n  `startime` BIGINT COMMENT '开局时刻',\n  `endtime` BIGINT COMMENT '结束时刻',\n  `playernumber` BIGINT COMMENT '玩家数',\n  `realplayernumber` BIGINT COMMENT '真人玩家数',\n  `teamnumber` BIGINT COMMENT '小队数',\n  `teammemberlist` TEXT COMMENT '队友id解析字段teammemberlist步骤：\t使用lateral VIEW explode(split(teammemberlist,\\\\+)) adTable AS buttontype 函数通过 \"\\\\+\"截取进行行转列进行计算。',\n  `escapecheckup` BIGINT COMMENT '是否逃跑',\n  `totalchangedpointvalue` BIGINT COMMENT '综合积分变化值',\n  `changedratingvalue` BIGINT COMMENT 'rating分变化值',\n  `ratingvalueallianceforceterchanged` BIGINT COMMENT 'rating分变化后的值',\n  `changedkillratingvalue` BIGINT COMMENT 'kill rating分变化值',\n  `killratingvalueallianceforceterchanged` BIGINT COMMENT 'kill rating分变化后的值',\n  `changedwinratingvalue` BIGINT COMMENT 'win rating分变化值',\n  `winratingvalueallianceforceterchanged` BIGINT COMMENT 'win rating分变化后的值',\n  `playergetexperience` BIGINT COMMENT '玩家获得的经验值',\n  `currentroundrank` BIGINT COMMENT '当局名次',\n  `killingcount` BIGINT COMMENT '击杀',\n  `assistcount` BIGINT COMMENT '助攻次数',\n  `survivaltime` BIGINT COMMENT '存活总时间(秒)',\n  `damageamount` BIGINT COMMENT '总伤害量,浮点数，乘以100存入',\n  `healtimes` BIGINT COMMENT '救人次数',\n  `healamount` BIGINT COMMENT '治疗量，浮点数，乘以100存入',\n  `movingdistance` BIGINT COMMENT '前进距离，单位米',\n  `dyingflow` TEXT COMMENT '濒死流水，暂无',\n  `deadflow` TEXT COMMENT '死亡流水 死亡坐标/死亡类型/死亡时间',\n  `headshotcounts` BIGINT COMMENT '爆头数',\n  `gunkillingtimes` BIGINT COMMENT '枪械击杀数，暂无',\n  `meleekilltimes` BIGINT COMMENT '近战击杀数，暂无',\n  `rangeddamagedamount` BIGINT COMMENT '远程武器伤害量，暂无',\n  `meleedamageamount` BIGINT COMMENT '近战伤害量，暂无',\n  `obtianeditemflow` BIGINT COMMENT '获得的物品流水，暂无',\n  `obtianedairdroptimes` BIGINT COMMENT '获得空投次数',\n  `vehicledestoryedtimes` BIGINT COMMENT '摧毁载具次数',\n  `landingcoordinate` BIGINT COMMENT '落地点坐标,弃用，之前定义的类型是int，应该是字符串',\n  `killingflow` TEXT COMMENT '击杀流水 :击杀目标ID\\t击杀类型\\t是否爆头\\t击杀距离\\t使用的武器ID\\t击杀者（角色自己）位置  新增：\\t被击杀者位置\\t击杀时间（从进入小岛开始到击杀时的毫秒数）\\t造成伤害量\\t是否移动\\t击杀区域ID(-1表示区域表中不记录)\\t状态(1:卧倒)\\t被击倒的武器id\\t击杀圈数\\t被击杀者名字\\t是否灭队\\t是否为ai\\tAI的类型\\t击倒者uid\\t击杀者uid',\n  `creepingtime` BIGINT COMMENT '匍匐时间',\n  `swimmingtime` BIGINT COMMENT '游泳时间，暂无',\n  `divingtime` BIGINT COMMENT '潜水时间，暂无',\n  `drivingtime` BIGINT COMMENT '驾驶载具时间',\n  `ridingtime` BIGINT COMMENT '乘坐载具时间，暂无',\n  `walkingdistance` BIGINT COMMENT '步行距离，单位米',\n  `staytimeinpoisonedarea` BIGINT COMMENT '吃毒时间',\n  `damageindex` BIGINT COMMENT '击杀指数,乘100后四舍五入',\n  `luckyindex` BIGINT COMMENT '幸运指数，弃用无效',\n  `collectindex` BIGINT COMMENT '物资指数,乘100后四舍五入',\n  `survivalindex` BIGINT COMMENT '生存指数,乘100后四舍五入',\n  `movingindex` BIGINT COMMENT '前进指数，弃用无效',\n  `creepindex` BIGINT COMMENT '伏地指数，弃用无效',\n  `accuracyindex` BIGINT COMMENT '精准指数，弃用无效',\n  `deliveryindex` BIGINT COMMENT '快递指数，弃用无效',\n  `sneakattackindex` BIGINT COMMENT '偷袭指数，弃用无效',\n  `healindex` BIGINT COMMENT '支援指数,乘100后四舍五入',\n  `boxindex` BIGINT COMMENT '盒子指数，弃用无效',\n  `assaultindex` BIGINT COMMENT '伤害指数,乘100后四舍五入',\n  `totalpoint` BIGINT COMMENT '综合积分变化后的值',\n  `ratinglevel` BIGINT COMMENT '流水评价等级',\n  `titleidlist` TEXT COMMENT '当局获得的称号Id',\n  `itemuseflow` TEXT COMMENT '装备的物品流水',\n  `medicineuseflow` TEXT COMMENT '使用的药品流水',\n  `gunhittimes` BIGINT COMMENT '枪械命中次数',\n  `gunshottimes` BIGINT COMMENT '枪械射击次数',\n  `teamrank` BIGINT COMMENT '队伍名次',\n  `curecount` BIGINT COMMENT '治疗次数',\n  `drivingdistance` BIGINT COMMENT '行驶距离，单位米',\n  `totalscorerank` BIGINT COMMENT '综合评分排名，弃用无效',\n  `rating` BIGINT COMMENT '鸡分',\n  `killrating` BIGINT COMMENT '消灭鸡分',\n  `winrating` BIGINT COMMENT '排名鸡分',\n  `ratingrank` BIGINT COMMENT '鸡分排名，弃用无效',\n  `killingratingrank` BIGINT COMMENT '消灭鸡分排名，弃用无效',\n  `winratingrank` BIGINT COMMENT '排名鸡分排名，弃用无效',\n  `totalround` BIGINT COMMENT '赛季分人称几排总场数',\n  `totalkill` BIGINT COMMENT '赛季分人称几排总杀敌数',\n  `totalwin` BIGINT COMMENT '赛季分人称几排总胜利数',\n  `top10times` BIGINT COMMENT '前十数',\n  `totalheadshotrate` BIGINT COMMENT '赛季分人称几排总爆头率',\n  `averagesurvivaltimeperround` BIGINT COMMENT '场均存活时间',\n  `healfriendtimes` BIGINT COMMENT '救助队友次数',\n  `averagemovedistanceperround` BIGINT COMMENT '场均移动距离',\n  `maxdamageinoneround` BIGINT COMMENT '单局最高伤害',\n  `maxkillinginoneround` BIGINT COMMENT '单局最高击杀',\n  `maxsurvivaltime` BIGINT COMMENT '最长存活时间',\n  `maxmovingdistance` BIGINT COMMENT '最长移动距离',\n  `contributionrankrating` BIGINT COMMENT '单排总积分贡献分',\n  `contributionkillrating` BIGINT COMMENT '单排击败积分贡献分',\n  `contributionwinrating` BIGINT COMMENT '单排生存积分贡献分',\n  `oldsegmentlevel` BIGINT COMMENT '旧段位',\n  `newsegmentlevel` BIGINT COMMENT '新段位',\n  `teamid` BIGINT COMMENT '小队ID',\n  `landlocation` TEXT COMMENT '落地点坐标,有效字段,单位cm',\n  `totaldeadtimes` BIGINT COMMENT '赛季分人称几排总死亡数',\n  `sumscore` BIGINT COMMENT '流水总评分，乘以100后存入',\n  `seasonsurvivalindex` BIGINT COMMENT '赛季参赛指数',\n  `seasontop1index` BIGINT COMMENT '赛季获胜率指数',\n  `seasonratingindex` BIGINT COMMENT '赛季总积分指数',\n  `seasonassaultindex` BIGINT COMMENT '赛季竞赛指数',\n  `seasonhealindex` BIGINT COMMENT '赛季支援指数',\n  `seasonmovingindex` BIGINT COMMENT '赛季前进指数',\n  `seasonsumscore` BIGINT COMMENT '赛季总评分，乘以100后存入',\n  `seasonratinglevel` BIGINT COMMENT '赛季评价等级',\n  `modesurvivalindex` BIGINT COMMENT '当前模式参赛指数',\n  `modetop1index` BIGINT COMMENT '当前模式获胜率指数',\n  `moderatingindex` BIGINT COMMENT '当前模式总积分指数',\n  `modeassaultindex` BIGINT COMMENT '当前模式竞赛指数',\n  `modehealindex` BIGINT COMMENT '当前模式支援指数',\n  `modemovingindex` BIGINT COMMENT '当前模式前进指数',\n  `modesumscore` BIGINT COMMENT '当前模式总评分，乘以100后存入',\n  `moderatinglevel` BIGINT COMMENT '当前模式评价等级',\n  `flowratinglevel` TEXT COMMENT '当局游戏的评价等级，前面有个Int类型的，但是非要求加一个字符串类型的',\n  `rolename` TEXT COMMENT '玩家角色名',\n  `totaldamage` BIGINT COMMENT '赛季分人称几排总伤害量',\n  `totalheal` BIGINT COMMENT '赛季分人称几排总治疗量',\n  `matchtype` BIGINT COMMENT '匹配模式0：手机 1模拟器 8小黑屋 9新手局',\n  `duocontributionrankrating` BIGINT COMMENT '双人总积分贡献分',\n  `duocontributionkillrating` BIGINT COMMENT '双人击败积分贡献分',\n  `duocontributionwinrating` BIGINT COMMENT '双人生存积分贡献分',\n  `squadcontributionrankrating` BIGINT COMMENT '四人总积分贡献分',\n  `squadcontributionkillrating` BIGINT COMMENT '四人击败积分贡献分',\n  `squadcontributionwinrating` BIGINT COMMENT '四人生存积分贡献分',\n  `famousid` BIGINT COMMENT '名人名言tips ID',\n  `dsendtime` TEXT COMMENT '新结束时间字段，ds传过来的字符串',\n  `equipmentinfo` TEXT COMMENT '装备信息:头盔ID\\t防弹衣ID\\t背包ID\\t主武器1ID\\t主武器1配件ID列表(以,分隔)\\t主武器2ID\\t主武器2配件ID列表(以,分隔)\\t副武器ID\\t副武器配件ID列表(以,分隔)\\t近战武器ID\\t投掷武器ID\\t是否佩戴吉利服',\n  `segmentprotect` BIGINT COMMENT '段位保护标记，1为触发了该段位的段位保护，0为没有触发',\n  `ismvp` BIGINT COMMENT '不是mvp 0/是mvp 1',\n  `pronetime` BIGINT COMMENT '趴地时间',\n  `followstate` BIGINT COMMENT '跳伞跟随  0不跟随，也不被跟随；1是被跟随；2是跟随',\n  `touchdownareaid` BIGINT COMMENT '降落地点类型, 参见赛季任务降落地点类型表',\n  `getpropsnumfromteammates` BIGINT COMMENT '接受队友道具数',\n  `sendpropsnumtoteammates` BIGINT COMMENT '赠送队友道具数',\n  `starttorescuetimes` BIGINT COMMENT '开始救援次数',\n  `avatargamegender` BIGINT COMMENT 'Avatar性别',\n  `avatarhairid` BIGINT COMMENT 'Avatar发型',\n  `avatarheadid` BIGINT COMMENT 'Avatar脸型',\n  `avatarfeaturenum` BIGINT COMMENT 'Avatar时装个数',\n  `avatarfeaturelist_1` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_2` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_3` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_4` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_5` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_6` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_7` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_8` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_9` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_10` BIGINT COMMENT 'Avatar时装',\n  `avatarweaponid` BIGINT COMMENT 'Avatar枪械',\n  `avatarweaponskinid` BIGINT COMMENT 'Avatar枪械皮肤',\n  `killeruid` TEXT COMMENT '击杀者UID',\n  `killerweaponid` BIGINT COMMENT '击杀者使用武器ID',\n  `killerdistance` BIGINT COMMENT '击杀者距离',\n  `lobbyteamid` TEXT COMMENT '大厅队伍id,ug字段，兼容保留',\n  `makefiresnum` BIGINT COMMENT '生火成功次数,极寒模式',\n  `isregress` BIGINT COMMENT '是否回流',\n  `topxtipsresponse` BIGINT COMMENT '未进入前5:-1;不点击:0;继续战斗:1;退出竞赛:2',\n  `signalhealamount` BIGINT COMMENT '信号治疗量',\n  `drivinghelicoptertime` BIGINT COMMENT '驾驶直升飞机时间',\n  `inhelicoptertime` BIGINT COMMENT '乘坐直升飞机时间',\n  `noreductratingscore` BIGINT COMMENT '是否触发了不掉分活动',\n  `changedtrueratingvalue` BIGINT COMMENT 'true rating分变化值',\n  `trueratingvalueallianceforceterchanged` BIGINT COMMENT 'true rating分变化后的值',\n  `teammemberrelalist` TEXT COMMENT '与TeamMemberList相对应，与其他队员之间的好友关系（0非好友，1平台好友，2为游戏好友）拼接，多个好友之间用+拼接。例如1+2+2',\n  `teammembersexlist` TEXT COMMENT '与TeamMemberList相对应，其他队员的性别拼接（1表示男，2表示女），多个好友之间用+拼接。例如1+2+2',\n  `friendcount` BIGINT COMMENT '队友中的好友数量',\n  `maxhurtweaponid` BIGINT COMMENT '最大伤害的武器ID',\n  `maxdamage` BIGINT COMMENT '武器的最大伤害',\n  `allianceforceterlevel` BIGINT COMMENT '结算后等级',\n  `isobexit` BIGINT COMMENT '是否观战退出',\n  `noreductrating` BIGINT COMMENT '是否触发不掉分活动',\n  `extraaddrating` BIGINT COMMENT '是否触发首战加分活动',\n  `protectrating` BIGINT COMMENT '是否触发保分机制',\n  `doublescore` BIGINT COMMENT '是否触发双倍上分活动',\n  `fateaddscore` BIGINT COMMENT '是否触发缘分队友加分活动',\n  `isnewaistrategy` BIGINT COMMENT '是否新的AI策略',\n  `lobbymemberlist` TEXT COMMENT '大厅组队队友列表',\n  `ratingtype` BIGINT COMMENT '计算的排位积分类型',\n  `killername` TEXT COMMENT '击杀我的人的名字',\n  `changekd` BIGINT COMMENT '当局结算引起的KD变化值，乘100后存入',\n  `friendteamaddscore` BIGINT COMMENT '是否触发好友四排组队加分活动',\n  `xuanwunoreductrating` BIGINT COMMENT '是否触发玄武不掉分活动',\n  `gunmateriallist` TEXT COMMENT '枪匠模式对局带出的改装件',\n  `bountynum` BIGINT COMMENT '枪匠模式的赏金数量',\n  `evacuatetype` BIGINT COMMENT '枪匠模式的逃脱类型。0 没有逃脱，1 直升机， 2 地堡， 3 的士',\n  `triggerrepeatkilllimit` BIGINT COMMENT '触发重复击杀限制',\n  `doublescoretimes` BIGINT COMMENT '是否触发双倍上分次数活动',\n  `teammembertmrelalist` TEXT COMMENT 'Avatar时装',\n  `device_type` BIGINT COMMENT '设备类型0为手机 1为模拟器 2 键鼠 3 手柄'\n);\n\n【参考信息】\n总积分计算：群屿需要乘1.2，其他乘1\n群屿: submode in (1001, 1002, 1003, 1064, 1065, 1066, 1076, 1077, 1078, 1091, 1092, 1093, 1137, 1138, 1139, 1143, 1144, 1145, 1152, 1153, 1154, 1158, 1159, 1160, 2029, 2030, 2031, 2044, 2045, 2046, 2122, 2123, 2124, 2129, 2130, 2131, 2166, 2167, 2168, 2169, 2170, 2171, 2172, 2173, 2174, 2203, 2216, 2217, 2218, 2219, 2220, 2221, 2297, 2298, 2299, 2300, 2301, 2302, 2304, 2305, 2306, 2322, 2323, 2324, 2325, 2326, 2327, 2359, 2360, 2361, 2368, 2367, 2366, 2419, 2420, 2421, 2422, 2423, 2424, 2425, 2426, 2427, 2453, 2454, 2455, 2460, 2461, 2462, 2472, 2473, 2474, 2463, 2464, 2465, 2466, 2467, 2468), 山峦: submode in (2160, 2161, 2162, 2163, 2164, 2165, 2334, 2335, 2336, 2337, 2338, 2339), 假日群岛: submode in (2396, 2397, 2398, 2399, 2400, 2401)\n第三人称四排限定mode=103\n赛季积分逻辑：ChangedRatingValue/(SurvivalTime / 60)\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注特定时间段内用户在不同玩法类型中的赛季积分分布情况，属于活跃度维度分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注特定时间段内用户在不同玩法类型中的赛季积分分布情况，属于活跃度维度分析。\"\n}"
  },
  {
    "question_id": "sql_83",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计流失14天以上的回流用户的点击量子鸟赠礼、回到大厅和参与乐园对局的数据\n统计日期\n2024/1/2\n2023/12/19\n2023/12/12\n2023/12/5\n2023/10/10\n2023/9/19\n2023/1/3\n2022/12/20\n输出：统计日（YYYYMMDD）、用户类型（'流失14天以上的回流用户'）、当天回流用户数、点击量子鸟赠礼用户数、回到大厅用户数、当天有参与乐园对局的用户数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_matchlog_stat_di` (\n  `dtstatdate` TEXT COMMENT '分区，参与乐园日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `imode` BIGINT COMMENT '乐园子玩法：\t255-所有玩法，用户问题未提到明确的子玩法时，默认为所有玩法\t1282371711108385024-跑酷：成神之路\t1281086178576044544-传媒群岛\t1305619333337074432-狂热派对\t1251206313870885120-砺刃运动会5.0\t1313754433693158656-手球特攻（原足球游戏）\t1296730563346958080-盔仔泡泡小队\t1294279575841283072-夺宝行动\t1310822585431254784-桥梁争夺\t1278160113246405632-砺刃大亨\t1313047366167692288-逆转平底锅\t1298874468735655936-战车突袭\t1278948391311645952-能量争夺战\t1295942084687041792-趣味飞盘\t1282101477461985024-盔仔总动员\t1278144466094392064-黑五模拟器\t1313046652157690624-盔仔斗魔王（原盔仔大乱斗）\t1289446028099979264-佣兵阵线\t1309453077449826304-星星争夺战（原名：金币大作战）\t1298445174154728192-停车大作战\t1294211358396518400-特技大乱斗\t1280302176000803840-卧底行动\t1307095884553538304-\"超级隐匿（原广阔天地隐匿模式）\"\t1297394991875754752-守卫生命线\t1278170390282112000-星球守护者\t1287652322611036928-拼图狂欢\t1273928195100380928-特种兵训练\t1300845150154531840-星之继承者\t1302344773925865984-彩色争夺战\t1296062239742105856-抱团冲冲冲\t1281781308570207232-狙击精英',\n  `teamnum` BIGINT COMMENT '组队人数',\n  `icnt` BIGINT COMMENT '对局次数',\n  `itemp1` BIGINT COMMENT '对局时长',\n  `itemp2` BIGINT COMMENT 'itemp2',\n  `vtemp1` TEXT COMMENT 'vtemp1',\n  `vtemp2` TEXT COMMENT 'vtemp2'\n);\nCREATE TABLE `dws_jordass_login_df` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:不区分平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '登录位图',\n  `dregdate` TEXT COMMENT '注册日期，格式YYYYMMDD',\n  `ilevel` BIGINT COMMENT '等级',\n  `friendcount` BIGINT COMMENT '好友数量'\n);\nCREATE TABLE `dws_jordass_buttonpress_pre_di` (\n  `dtstatdate` TEXT COMMENT '统计日期，格式YYYYMMDD',\n  `dteventtime` TEXT COMMENT '事件时间,格式YYYY-MM-DDHH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` TEXT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` TEXT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `clientversion` TEXT COMMENT 'clientversion',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `uid` TEXT COMMENT '角色ID',\n  `buttontype` TEXT COMMENT '按钮代号',\n  `ireason` TEXT COMMENT '额外参数',\n  `extarg1` TEXT COMMENT '附加参数1',\n  `extarg2` TEXT COMMENT '附加参数2'\n);\n\n【参考信息】\n点击量子鸟赠礼：buttontype =10370\n回到大厅：buttontype 10373或10374  \n流失14天以上的回流用户：统计日往前14天以上没有登陆游戏，在统计日登陆了游戏，比如统计日是2024-1-2，用户在2023-12-19到2024-1-1这14天连续没有登陆游戏，并且在2023-12-18及之前有登陆游戏，就是2024-1-2的流失14天以上的回流用户，其他统计日以此类推。\n\n",
    "output": "",
    "category": "留存类",
    "category_reason": "问题关注流失用户回流后的特定行为，属于留存分析中的回流用户追踪。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注流失用户回流后的特定行为，属于留存分析中的回流用户追踪。\"\n}"
  },
  {
    "question_id": "sql_84",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2018年注册且近30天有活跃用户，并且在2020年9月到22年4月期间添加过好友的用户，每个月人均在线好友数\n输出：自然月（YYYYMM），人均在线好友数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_df` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:不区分平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '登录位图',\n  `dregdate` TEXT COMMENT '注册日期，格式YYYYMMDD',\n  `ilevel` BIGINT COMMENT '等级',\n  `friendcount` BIGINT COMMENT '好友数量'\n);\nCREATE TABLE `dwd_jordass_playerlogin_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `level` BIGINT COMMENT '等级',\n  `playerfriendsnum` BIGINT COMMENT '玩家好友数量',\n  `clientversion` TEXT COMMENT '客户端版本',\n  `screenwidth` BIGINT COMMENT '显示屏宽度',\n  `screenhight` BIGINT COMMENT '显示屏高度',\n  `density` TEXT COMMENT '像素密度',\n  `loginchannel` BIGINT COMMENT '登录渠道',\n  `vroleid` TEXT COMMENT '玩家角色ID',\n  `vrolename` TEXT COMMENT '玩家角色名',\n  `deviceid` TEXT COMMENT '设备ID',\n  `device_type` BIGINT COMMENT '设备类型0为手机,1为模拟器, 2键鼠, 3手柄, 5是PC客户端,也是高清模拟器。',\n  `gender` BIGINT COMMENT '平台性别，1是男，2是女',\n  `emulatorname` TEXT COMMENT '模拟器名',\n  `warzoneid` BIGINT COMMENT '战区ID',\n  `devicename` TEXT COMMENT '客户端devicename',\n  `historymaxsegment` BIGINT COMMENT '历史最高段位',\n  `seasonmaxsegment` BIGINT COMMENT '本赛季最高段位',\n  `firstlogincg` BIGINT COMMENT '第一次登录CG游戏的时间，即CG注册时间，UNIX时间戳',\n  `lobbybgid` BIGINT COMMENT '当前设置的大厅背景resid',\n  `signature` TEXT COMMENT '个性签名',\n  `devicelevel` BIGINT COMMENT '机型档位',\n  `iswxrealname` BIGINT COMMENT '非微信平台或还没拉取数据填0，已微信实名填1，未实名填2',\n  `iswxlowlv` BIGINT COMMENT '非微信平台或还没拉取数据填0，是微信小号填1，不是微信小号填2',\n  `iszombie` BIGINT COMMENT '非微信平台或还没拉取数据填0，是微信僵尸号填1，不是微信僵尸号填2',\n  `topsegtimes` BIGINT COMMENT '王牌印记: -2 首次达到星钻 -1 首次达到王冠  0 无数据 >0 历史王牌次数',\n  `clanid1` BIGINT COMMENT '战队ID1',\n  `clanid2` BIGINT COMMENT '战队ID2',\n  `clanid3` BIGINT COMMENT '战队ID3',\n  `fpslevel` BIGINT COMMENT '帧率等级',\n  `renderqualityapply` BIGINT COMMENT '画质等级',\n  `devicetcqualitygrade` BIGINT COMMENT '机型等级',\n  `relogin` BIGINT COMMENT '是否是断线重连登录的,1为断线重连，0为从登录界面登录',\n  `gameid` TEXT COMMENT '当前正在游戏的对局id',\n  `startime` BIGINT COMMENT '当前正在游戏的对局id',\n  `rolesettingstr` TEXT COMMENT 'RoleSetting设置, 当为空字符串时表示该字段获取异常,否则为以+分隔的rolesetting值，具体字段值咨询开发',\n  `creditscore` TEXT COMMENT '信誉分',\n  `usenewpickup` BIGINT COMMENT '是否使用新版拾取',\n  `isqrlogin` BIGINT COMMENT '是否为扫码登录的,1是扫码登录，0非扫描登录',\n  `is_gamematrix` BIGINT COMMENT '是否为先锋云游，1是，0不是',\n  `clientsceneversion` TEXT COMMENT '客户端场景版本',\n  `whitetype` BIGINT COMMENT '进入服务器的凭证类型',\n  `mobiletablettype` BIGINT COMMENT '平板识别结果：-1结果未出，0是非平板，1已验证是平板，2可能是平板',\n  `behaviorlevel` BIGINT COMMENT '行为分等级',\n  `clientostype` TEXT COMMENT '客户端系统类型：and ios win hm',\n  `pclogintype` BIGINT COMMENT '0=默认类型，1=PC新手玩家，2=PC回流玩家',\n  `escapecoincount` TEXT COMMENT '隧道收益(该字段原来搞错了, 之前以为是隧道币数量)',\n  `vsteamlevel` BIGINT COMMENT '组竞等级',\n  `connectidx` BIGINT COMMENT '连接序号',\n  `isinds` BIGINT COMMENT '当前登录是否在ds场景中重连'\n);\nCREATE TABLE `dwd_jordass_friendlist_hi` (\n  `tdbank_imp_date` TEXT,\n  `gamesvrid` TEXT COMMENT '登录的游戏服务器编号',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `type` BIGINT COMMENT '好友类型(1 平台 2 游戏内), 两种类型的好友可能重合',\n  `num` BIGINT COMMENT '好友总个数',\n  `list` TEXT COMMENT '当前段好友列表',\n  `seg` BIGINT COMMENT '当前是第几段'\n);\n\n【参考信息】\n添加过好友：type=2\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是特定时间段内用户的活跃情况及其好友数分布，属于活跃度和行为分布的范畴。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是特定时间段内用户的活跃情况及其好友数分布，属于活跃度和行为分布的范畴。\"\n}"
  },
  {
    "question_id": "sql_85",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计 20220506-20220508，20220513-20220515 两个区间的活跃用户进入匹配对局以及是否进入微赛事的情况\n输出：统计日期（YYYYMMDD），活跃人数，匹配人数，参加微赛事人数，未参加微赛事人数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\nCREATE TABLE `dwd_jordass_player_matchrecord_hi` (\n  `tdbank_imp_date` TEXT COMMENT '分区字段，小时分区，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `matchtime` BIGINT COMMENT '匹配时长（秒）',\n  `matchresult` TEXT COMMENT '匹配结果',\n  `matchmode` BIGINT COMMENT '匹配模式',\n  `isaotufill` BIGINT COMMENT '是否自动填充',\n  `gameid` TEXT COMMENT '匹配成功为当前的battleid失败为0',\n  `submodes` TEXT COMMENT '选择的子模式列表，只有队长才有',\n  `isleader` BIGINT COMMENT '1表示队长0非队长',\n  `teamnum` TEXT COMMENT '组队人数',\n  `teammembers` TEXT COMMENT '组队队伍',\n  `matchteammembers` TEXT COMMENT '最终匹配的队伍',\n  `matchlabel` BIGINT COMMENT '匹配标签',\n  `corpsid` BIGINT COMMENT '联盟id',\n  `teamid` TEXT COMMENT '队伍ID',\n  `teamwaittime` BIGINT COMMENT '队伍首次组队到匹配等待时间',\n  `finalbucketidx` BIGINT COMMENT '匹配成功首队伍所在匹配区间idx',\n  `playermoderating` BIGINT COMMENT '玩家该模式下rating分(段位分)',\n  `playerlevel` BIGINT COMMENT '玩家等级',\n  `regresss` BIGINT COMMENT '是否回流玩家',\n  `matchsubmodegroup` BIGINT COMMENT '最终随机到的submodegroup',\n  `matchrating` BIGINT COMMENT '当前玩家所在队伍匹配积分',\n  `bucketidx` BIGINT COMMENT '当前玩家所在队伍匹配积分所在区间idx',\n  `device_type` BIGINT COMMENT '设备类型0为手机 1为模拟器 2 键鼠 3 手柄 5 PC高清模拟器',\n  `strategys` TEXT COMMENT '分队策略',\n  `match_client_type` BIGINT COMMENT '匹配池渠道0为手机 1为模拟器 2外部模拟器 8为小黑屋 9为新手局',\n  `pandoralost` BIGINT COMMENT '潘多拉预流失标记 1预流失 0非预流失',\n  `teamjoinsource` BIGINT COMMENT '组队加入来源',\n  `regressvalue` BIGINT COMMENT '玩家当前的回流值',\n  `strategy_type` BIGINT COMMENT '策略类型，-1表示服务器保底二次分队, 0表示004的潘多拉策略, 1表示005的潘多拉单局最优策略, 2表示015的技术中心优化分队策略, 3表示技术中心向量化二次分队方案, 4表示内部推荐二次分队方案',\n  `playersign` BIGINT COMMENT '玩家分级标签，1为白，2为红，3为灰, 4为深灰',\n  `livetype` BIGINT COMMENT '直播类型: 2 围观 4 视频号',\n  `liveid` TEXT COMMENT '直播ID',\n  `matchscene` BIGINT COMMENT '匹配成功时玩家所在场景，0为大厅，1为聚乐园',\n  `issilentmode` BIGINT COMMENT '是否是免耳麦模式，0为非免耳麦，1为免耳麦',\n  `ismatchlbs` BIGINT COMMENT '是否是lbs匹配，0为非lbs匹配，1为lbs匹配',\n  `strategy_index` BIGINT COMMENT '二次分队策略采用的weight数组的下标',\n  `xid` TEXT COMMENT 'Xid',\n  `isanchor` BIGINT COMMENT '是否是主播，0为非主播，1为主播',\n  `isanchorgame` BIGINT COMMENT '是否匹配到主播局，0为非主播局，1为主播局',\n  `tournamentid` BIGINT COMMENT '微赛事ID',\n  `expandupsection` BIGINT COMMENT '最大向上扩段数',\n  `expanddownsection` BIGINT COMMENT '最大向下扩段数',\n  `expandupclass` BIGINT COMMENT '最大向上扩载数',\n  `expanddownclass` BIGINT COMMENT '最大向下扩载数',\n  `isfullbucket` BIGINT COMMENT '是否优先遍历满载队',\n  `timingmatchtime` BIGINT COMMENT '定时匹配真实匹配时长（秒）',\n  `tournamentstage` BIGINT COMMENT '微赛事阶段ID',\n  `tournamentclubid` TEXT COMMENT '微赛事战队ID',\n  `promotionmatchstatus` BIGINT COMMENT '参与晋级赛的状态, -1没勾选，0成功参与，1模式不对，2时间不对，3配置不对，4自身段位不对，5队友段位不对',\n  `ugcisgray` BIGINT COMMENT '是否为ugc灰度玩法。默认为0：非灰度；1：灰度',\n  `promotiontaskid` BIGINT COMMENT '晋级赛任务ID',\n  `strategyabtest` TEXT COMMENT '未命中模式为空，对照组记 0:ID，实验组记 1:ID',\n  `accompanytype` BIGINT COMMENT '陪玩标签值 0 ：没有打标签，1：陪玩，2：老板',\n  `minusteamnum` BIGINT COMMENT '匹配成功后踢回匹配池的队伍数',\n  `mobiletabletmatchlabel` BIGINT COMMENT '匹配队伍平板比例标签(非手机=0，纯手机=1，25%平板=2，50%平板=3，75%平板=4，100%平板=5)',\n  `ratingtype` BIGINT COMMENT '积分类型',\n  `idcname` TEXT COMMENT 'IDC集群名字',\n  `strategyextendinfo` TEXT COMMENT '推荐侧二次分队返回的信息',\n  `playerabtest` TEXT COMMENT '个人匹配abtest',\n  `gameabtest` TEXT COMMENT '匹配对局的abtest,没有则为空字符串',\n  `matchtype` BIGINT COMMENT '1表示匹配成局，2表示补人',\n  `matchisolatetype` BIGINT COMMENT '玩家匹配隔离标记, 0不隔离，2所有模式隔离，3积分模式隔离，4E玩法模式隔离',\n  `predictmatchtime` BIGINT COMMENT '预估匹配时长',\n  `expandspeed` BIGINT COMMENT '匹配单阶段扩段时长',\n  `escapehardid` BIGINT COMMENT 'E玩法难度ID',\n  `gameplayernum` BIGINT COMMENT '开局人数',\n  `gameaistrategy` BIGINT COMMENT 'AI投放策略类型',\n  `isfixmatchlabel` BIGINT COMMENT '是否触发了标签修正',\n  `realmatchsubmodes` TEXT COMMENT '实际匹配的模式组列表',\n  `aitype` BIGINT COMMENT '投放的AI類型',\n  `decratingtype` BIGINT COMMENT '降段类型，0=未触发降段，1=pc新手标签降段，2=未成年标签降段，3=回流标签降段，4=情绪值降段',\n  `forcematchtype` BIGINT COMMENT '记录本次匹配是否触发了强制开局，0=未触发，1=通用强制开局，2=PC新手强制开局',\n  `ispcaigame` BIGINT COMMENT '是否触发了PC首局AI局',\n  `matchsubclienttype` BIGINT COMMENT '匹配子池：0非子池, 2外设键鼠,3外设手柄,4主播,5PC新手,6PC-AI局 7BR温暖局，8隧道AI局',\n  `heroexcludetype` BIGINT COMMENT '是否触发了英雄互斥匹配，1采用了互斥匹配, 2没命中灰度 3超时，0其他情况',\n  `natalhero` BIGINT COMMENT '本命英雄ID',\n  `iswarmescapegame` BIGINT COMMENT '是否是E玩法温暖局',\n  `cancrossdevicematch` BIGINT COMMENT '是否可已手机非手机混匹, 1可以，0不可以',\n  `aiteamatetype` BIGINT COMMENT 'AI队友类型',\n  `isfirstteam` BIGINT COMMENT '是否是首队',\n  `firstteamwaittime` BIGINT COMMENT '首队的匹配等待时间',\n  `firstteamrankbucket` BIGINT COMMENT '首队段位分段',\n  `matchprocessinfo` TEXT COMMENT '匹配扩展信息 辅助查询匹配问题',\n  `isabtwarmgame` BIGINT COMMENT '是否触发了温暖局',\n  `warmplayertype` BIGINT COMMENT '温暖局玩家身份, 3=挫败（未来），2=回流，1=低活，0=未触发或无标签',\n  `escapeplayertype` TEXT COMMENT '隧道玩家身份类型, 空字符串表示默认类型，1回流标签有限期内,2积分移动新手(隐藏分专用),3积分非移动新手(隐藏分专用),4积分回流(隐藏分专用),5全局新手(AI局专用),6PC新手(AI局专用),7非PC温暖(AI局专用),8PC温暖(AI局专用),9回流(AI局专用), 以+分割',\n  `secondarydecratingtype` BIGINT COMMENT '二维匹配分降段类型，0=未触发降段，1=隧道回流降分匹配',\n  `finalsecondarybucketidx` BIGINT COMMENT '匹配成功首队所在二维匹配积分区间',\n  `playersecondarymoderating` BIGINT COMMENT '玩家该模式下二维匹配积分',\n  `secondarymatchrating` BIGINT COMMENT '当前玩家所在队伍二维匹配积分',\n  `secondarybucketidx` BIGINT COMMENT '当前玩家所在队伍二维匹配积分所在区间',\n  `escapeasset` TEXT COMMENT '隧道玩法资产',\n  `escapewarmscore` TEXT COMMENT '隧道温暖值',\n  `pvethemeid` BIGINT COMMENT 'PVE挑战事件ID',\n  `escapelesspeoplegamenum` BIGINT COMMENT '隧道每周已触发低真人局次数',\n  `garybucketgroup` BIGINT COMMENT '灰度分桶',\n  `matchsubclienttypebefore` BIGINT COMMENT '发起匹配时的匹配子池：0非子池, 2外设键鼠,3外设手柄,4主播,5PC新手,6PC-AI局, 7BR温暖局，8隧道AI局',\n  `frustratiggerlevel` BIGINT COMMENT 'FrustraTiggerLevel',\n  `frustramanualscore` TEXT COMMENT 'FrustraManualScore',\n  `frustramodelscore` TEXT COMMENT 'FrustraModelScore',\n  `frustragroup` TEXT COMMENT 'FrustraGroup',\n  `frustrathreshold` TEXT COMMENT 'FrustraThreshold',\n  `recomtraceid` TEXT COMMENT 'RecomTraceID'\n);\nCREATE TABLE `dwd_jordass_roundflow_entertain_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '玩家',\n  `uid` TEXT COMMENT '(可填)玩家UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `battletype` BIGINT COMMENT '战斗类型 对应BATTLETYPE,其它说明参考FAQ文档',\n  `roundscore` BIGINT COMMENT '本局分数,无得分的填0',\n  `roundtime` BIGINT COMMENT '对局时长(秒)',\n  `seasonid` BIGINT COMMENT '所属赛季ID',\n  `mode` BIGINT COMMENT '模式',\n  `submode` BIGINT COMMENT '子模式',\n  `map` BIGINT COMMENT '地图',\n  `startime` BIGINT COMMENT '开局时刻',\n  `endtime` BIGINT COMMENT '结束时刻',\n  `playernumber` BIGINT COMMENT '玩家数',\n  `teamnumber` BIGINT COMMENT '小队数',\n  `teammemberlist` TEXT COMMENT '队友List',\n  `escapecheckup` BIGINT COMMENT '是否逃跑',\n  `currentroundrank` BIGINT COMMENT '当局名次',\n  `killingcount` BIGINT COMMENT '击杀',\n  `assistcount` BIGINT COMMENT '助攻次数',\n  `survivaltime` BIGINT COMMENT '存活总时间',\n  `damageamount` BIGINT COMMENT '总伤害量,浮点数，乘以100存入',\n  `healtimes` BIGINT COMMENT '救人次数',\n  `healamount` BIGINT COMMENT '治疗量，浮点数，乘以100存入',\n  `movingdistance` BIGINT COMMENT '前进距离',\n  `deadflow` TEXT COMMENT '死亡流水 死亡坐标/死亡类型/死亡时间',\n  `headshotcounts` BIGINT COMMENT '爆头数',\n  `obtianedairdroptimes` BIGINT COMMENT '获得空投次数',\n  `vehicledestoryedtimes` BIGINT COMMENT '摧毁载具次数',\n  `killingflow` TEXT COMMENT '击杀流水 :击杀目标ID\\t击杀类型\\t是否爆头\\t击杀距离\\t使用的武器ID\\t击杀者（角色自己）位置  新增：\\t被击杀者位置\\t击杀时间（从进入小岛开始到击杀时的毫秒数）\\t造成伤害量\\t是否移动\\t击杀区域ID(-1表示区域表中不记录)\\t状态(1:卧倒)\\t被击倒的武器id\\t击杀圈数\\t被击杀者名字\\t是否灭队\\t是否为ai\\tAI的类型\\t击倒者uid\\t击杀者uid',\n  `creepingtime` BIGINT COMMENT '匍匐时间',\n  `drivingtime` BIGINT COMMENT '驾驶载具时间',\n  `walkingdistance` BIGINT COMMENT '步行距离',\n  `staytimeinpoisonedarea` BIGINT COMMENT '吃毒时间',\n  `damageindex` BIGINT COMMENT '击杀指数,乘100后四舍五入',\n  `collectindex` BIGINT COMMENT '物资指数,乘100后四舍五入',\n  `survivalindex` BIGINT COMMENT '生存指数,乘100后四舍五入',\n  `healindex` BIGINT COMMENT '支援指数,乘100后四舍五入',\n  `assaultindex` BIGINT COMMENT '伤害指数,乘100后四舍五入',\n  `ratinglevel` BIGINT COMMENT '流水评价等级',\n  `itemuseflow` TEXT COMMENT '装备的物品流水',\n  `medicineuseflow` TEXT COMMENT '使用的药品流水',\n  `gunhittimes` BIGINT COMMENT '枪械命中次数',\n  `gunshottimes` BIGINT COMMENT '枪械射击次数',\n  `teamrank` BIGINT COMMENT '队伍名次',\n  `curecount` BIGINT COMMENT '治疗次数',\n  `drivingdistance` BIGINT COMMENT '行驶距离',\n  `teamid` BIGINT COMMENT '小队ID',\n  `landlocation` TEXT COMMENT '落地点坐标,有效字段',\n  `flowratinglevel` TEXT COMMENT '当局游戏的评价等级，前面有个Int类型的，但是非要求加一个字符串类型的',\n  `rolename` TEXT COMMENT '玩家角色名',\n  `matchtype` BIGINT COMMENT '匹配模式0：手机 1模拟器 8小黑屋 9新手局',\n  `dsendtime` TEXT COMMENT '新结束时间字段，ds传过来的字符串',\n  `equipmentinfo` TEXT COMMENT '装备信息:头盔ID\\t防弹衣ID\\t背包ID\\t主武器1ID\\t主武器1配件ID列表(以,分隔)\\t主武器2ID\\t主武器2配件ID列表(以,分隔)\\t副武器ID\\t副武器配件ID列表(以,分隔)\\t近战武器ID\\t投掷武器ID\\t是否佩戴吉利服',\n  `ismvp` BIGINT COMMENT '不是mvp 0/是mvp 1',\n  `pronetime` BIGINT COMMENT '趴地时间',\n  `followstate` BIGINT COMMENT '跳伞跟随  0不跟随，也不被跟随；1是被跟随；2是跟随',\n  `touchdownareaid` BIGINT COMMENT '降落地点类型, 参见赛季任务降落地点类型表',\n  `getpropsnumfromteammates` BIGINT COMMENT '接受队友道具数',\n  `sendpropsnumtoteammates` BIGINT COMMENT '赠送队友道具数',\n  `starttorescuetimes` BIGINT COMMENT '开始救援次数',\n  `killeruid` TEXT COMMENT '击杀者UID',\n  `killerweaponid` BIGINT COMMENT '击杀者使用武器ID',\n  `killerdistance` BIGINT COMMENT '击杀者距离',\n  `lobbyteamid` TEXT COMMENT '大厅队伍id,ug字段，兼容保留',\n  `topxtipsresponse` BIGINT COMMENT '未进入前5:-1;不点击:0;继续战斗:1;退出竞赛:2',\n  `signalhealamount` BIGINT COMMENT '信号治疗量',\n  `friendcount` BIGINT COMMENT '队友中的好友数量',\n  `tournamentid` BIGINT COMMENT '赛事ID',\n  `tournamentstage` BIGINT COMMENT '赛事阶段',\n  `clubname` TEXT COMMENT '众竞赛事战队名称',\n  `score` BIGINT COMMENT '专业赛积分赛段对局的积分',\n  `isscorerule` BIGINT COMMENT '专业赛是否是积分规则赛段',\n  `changedrating` BIGINT COMMENT '算积分模式的rating分变化值',\n  `ratingallianceforceterchanged` BIGINT COMMENT '算积分模式的rating分变化后的值',\n  `device_type` BIGINT COMMENT '设备类型0为手机 1为模拟器 2 键鼠 3 手柄'\n);\n\n【参考信息】\n对局匹配成功 matchresult ='ok'  ；\n微赛事时间：每天19-21点\n\n",
    "output": "",
    "category": "行为链条",
    "category_reason": "问题关注用户从活跃到进入匹配对局及微赛事的行为路径。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"行为链条\",\n  \"rationale\": \"问题关注用户从活跃到进入匹配对局及微赛事的行为路径。\"\n}"
  },
  {
    "question_id": "sql_87",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2023.07.02和2023.07.09 参与乐园各子玩法的用户里，砺刃新进、回流、留存用户数\n注：新进，回流，留存都按照7天为一个周期来计算\n输出：统计日期（YYYYMMDD），玩法，类型（新进、回流、留存），人数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_df` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:不区分平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '登录位图',\n  `dregdate` TEXT COMMENT '注册日期，格式YYYYMMDD',\n  `ilevel` BIGINT COMMENT '等级',\n  `friendcount` BIGINT COMMENT '好友数量'\n);\nCREATE TABLE `dim_jordass_leyuan_participate_cdf_nf` (\n  `dtstatdate` TEXT COMMENT '日期格式YYYYMMDD',\n  `matchsubmodegroup` BIGINT COMMENT '乐园子玩法id',\n  `vplayerid` TEXT COMMENT 'playerid',\n  `cbitmap` TEXT COMMENT '活动参与位图',\n  `dregdate` TEXT COMMENT '首次参与该子玩法日期',\n  `itemp1` BIGINT COMMENT '预留数字1',\n  `itemp2` BIGINT COMMENT '预留数字2',\n  `vtemp1` TEXT COMMENT '预留字符1',\n  `vtemp2` TEXT COMMENT '预留字符2'\n);\n\n【参考信息】\n乐园玩法子用户筛选条件：\ninstr(substr(cbitmap,1,7),'1')>0\n回流与留存计算：\ncase when datediff(dtstatdate,dregdate)<=6 then '新进'\nwhen instr(substr(cbitmap,8,7),'1')>0 then '留存'\nwhen instr(substr(cbitmap,8,7),'1')=0 then '回流'\n注意只需要统计上述三种类型\n\n",
    "output": "",
    "category": "留存类",
    "category_reason": "问题关注用户在特定时间点的新进、回流和留存状态，属于典型的留存分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注用户在特定时间点的新进、回流和留存状态，属于典型的留存分析。\"\n}"
  },
  {
    "question_id": "sql_88",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计赛季末期（20230529-20230627）的垂类玩法轻中重度及垂类独占用户，从3.22-6.27的，每周玩法分布和段位变化情况\n输出：周期（7天为一个周期），活跃度(轻度、中度、重度、独占)，玩法（主题群屿、群屿、传统其他、休闲模式、...），段位，人数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_playerlogin_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `level` BIGINT COMMENT '等级',\n  `playerfriendsnum` BIGINT COMMENT '玩家好友数量',\n  `clientversion` TEXT COMMENT '客户端版本',\n  `screenwidth` BIGINT COMMENT '显示屏宽度',\n  `screenhight` BIGINT COMMENT '显示屏高度',\n  `density` TEXT COMMENT '像素密度',\n  `loginchannel` BIGINT COMMENT '登录渠道',\n  `vroleid` TEXT COMMENT '玩家角色ID',\n  `vrolename` TEXT COMMENT '玩家角色名',\n  `deviceid` TEXT COMMENT '设备ID',\n  `device_type` BIGINT COMMENT '设备类型0为手机,1为模拟器, 2键鼠, 3手柄, 5是PC客户端,也是高清模拟器。',\n  `gender` BIGINT COMMENT '平台性别，1是男，2是女',\n  `emulatorname` TEXT COMMENT '模拟器名',\n  `warzoneid` BIGINT COMMENT '战区ID',\n  `devicename` TEXT COMMENT '客户端devicename',\n  `historymaxsegment` BIGINT COMMENT '历史最高段位',\n  `seasonmaxsegment` BIGINT COMMENT '本赛季最高段位',\n  `firstlogincg` BIGINT COMMENT '第一次登录CG游戏的时间，即CG注册时间，UNIX时间戳',\n  `lobbybgid` BIGINT COMMENT '当前设置的大厅背景resid',\n  `signature` TEXT COMMENT '个性签名',\n  `devicelevel` BIGINT COMMENT '机型档位',\n  `iswxrealname` BIGINT COMMENT '非微信平台或还没拉取数据填0，已微信实名填1，未实名填2',\n  `iswxlowlv` BIGINT COMMENT '非微信平台或还没拉取数据填0，是微信小号填1，不是微信小号填2',\n  `iszombie` BIGINT COMMENT '非微信平台或还没拉取数据填0，是微信僵尸号填1，不是微信僵尸号填2',\n  `topsegtimes` BIGINT COMMENT '王牌印记: -2 首次达到星钻 -1 首次达到王冠  0 无数据 >0 历史王牌次数',\n  `clanid1` BIGINT COMMENT '战队ID1',\n  `clanid2` BIGINT COMMENT '战队ID2',\n  `clanid3` BIGINT COMMENT '战队ID3',\n  `fpslevel` BIGINT COMMENT '帧率等级',\n  `renderqualityapply` BIGINT COMMENT '画质等级',\n  `devicetcqualitygrade` BIGINT COMMENT '机型等级',\n  `relogin` BIGINT COMMENT '是否是断线重连登录的,1为断线重连，0为从登录界面登录',\n  `gameid` TEXT COMMENT '当前正在游戏的对局id',\n  `startime` BIGINT COMMENT '当前正在游戏的对局id',\n  `rolesettingstr` TEXT COMMENT 'RoleSetting设置, 当为空字符串时表示该字段获取异常,否则为以+分隔的rolesetting值，具体字段值咨询开发',\n  `creditscore` TEXT COMMENT '信誉分',\n  `usenewpickup` BIGINT COMMENT '是否使用新版拾取',\n  `isqrlogin` BIGINT COMMENT '是否为扫码登录的,1是扫码登录，0非扫描登录',\n  `is_gamematrix` BIGINT COMMENT '是否为先锋云游，1是，0不是',\n  `clientsceneversion` TEXT COMMENT '客户端场景版本',\n  `whitetype` BIGINT COMMENT '进入服务器的凭证类型',\n  `mobiletablettype` BIGINT COMMENT '平板识别结果：-1结果未出，0是非平板，1已验证是平板，2可能是平板',\n  `behaviorlevel` BIGINT COMMENT '行为分等级',\n  `clientostype` TEXT COMMENT '客户端系统类型：and ios win hm',\n  `pclogintype` BIGINT COMMENT '0=默认类型，1=PC新手玩家，2=PC回流玩家',\n  `escapecoincount` TEXT COMMENT '隧道收益(该字段原来搞错了, 之前以为是隧道币数量)',\n  `vsteamlevel` BIGINT COMMENT '组竞等级',\n  `connectidx` BIGINT COMMENT '连接序号',\n  `isinds` BIGINT COMMENT '当前登录是否在ds场景中重连'\n);\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT '统计日期格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `mode` BIGINT COMMENT '模式ID',\n  `modename` TEXT COMMENT '模式名称',\n  `submode` BIGINT COMMENT '子模式ID',\n  `submodename` TEXT COMMENT '子模式名称',\n  `map` BIGINT COMMENT '地图ID',\n  `mapname` TEXT COMMENT '地图名称',\n  `seasonid` BIGINT COMMENT '赛季ID',\n  `seasonname` TEXT COMMENT '赛季名称',\n  `roundcnt` BIGINT COMMENT '当日对局数',\n  `roundtime` BIGINT COMMENT '当日对局时长(秒)',\n  `survivaltime` BIGINT COMMENT '当日存活时长(秒)',\n  `firstroundtime` TEXT COMMENT '当日首次对局时间',\n  `device_type` BIGINT COMMENT '设备类型'\n);\n\n【参考信息】\n垂类玩法轻中重度用户划分条件：\n 轻度：1-4天，中度：5-15天，重度：16-30天\n垂类独占用户筛选逻辑:\n至少玩过submode IN (1265972235155284992,1278160113246405632)模式一次且没玩过其他任何模式的用户（注意submode可为空的情况）\n垂类玩法： modename = '乐园' and submode IN (1265972235155284992,1278160113246405632\n段位截取方式：seasonmaxsegment截取第一位 1-7分别代表青铜、白银、黄金、铂金、星钻、王冠、王牌\n限定modename in ('传统模式','休闲模式','组队竞技','领地','乐园','广阔天地','创意创作间'), case when modename='传统模式' and mapname='群屿' and submode in (2557,2558,2559) then '主题群屿'\nwhen modename='传统模式' and mapname='群屿' then '群屿'\nwhen modename='传统模式' then '传统其他'\nelse modename end\n\n",
    "output": "",
    "category": "用户分群",
    "category_reason": "问题关注的是根据玩法行为对用户进行轻中重度及独占性分类，属于用户分群范畴。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"用户分群\",\n  \"rationale\": \"问题关注的是根据玩法行为对用户进行轻中重度及独占性分类，属于用户分群范畴。\"\n}"
  },
  {
    "question_id": "sql_89",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n赛季末期（20230529-20230627）的垂类玩法轻中重度及垂类独占用户，从3.22-6.27的，每周砺刃登录天数 和 垂类玩法参与局数和天数分布\n输出：周期（7天为一个周期），活跃度，活跃天数，人数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT '统计日期格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `mode` BIGINT COMMENT '模式ID',\n  `modename` TEXT COMMENT '模式名称',\n  `submode` BIGINT COMMENT '子模式ID',\n  `submodename` TEXT COMMENT '子模式名称',\n  `map` BIGINT COMMENT '地图ID',\n  `mapname` TEXT COMMENT '地图名称',\n  `seasonid` BIGINT COMMENT '赛季ID',\n  `seasonname` TEXT COMMENT '赛季名称',\n  `roundcnt` BIGINT COMMENT '当日对局数',\n  `roundtime` BIGINT COMMENT '当日对局时长(秒)',\n  `survivaltime` BIGINT COMMENT '当日存活时长(秒)',\n  `firstroundtime` TEXT COMMENT '当日首次对局时间',\n  `device_type` BIGINT COMMENT '设备类型'\n);\n\n【参考信息】\n垂类玩法轻中重度用户划分条件：\n when active_days between 1 and 4 then '轻度'\n when active_days between 5 and 15 then '中度'\n when active_days between 16 and 30 then '重度'\n垂类独占用户筛选逻辑:\n至少玩过submode IN (1265972235155284992,1278160113246405632)模式一次且没玩过其他任何模式的用户（注意submode可为空的情况）\n垂类玩法： modename = '乐园' and submode IN (1265972235155284992,1278160113246405632\n\n",
    "output": "",
    "category": "用户分群",
    "category_reason": "问题关注的是根据用户在特定时间段内的登录和玩法行为进行分类，属于用户分群分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"用户分群\",\n  \"rationale\": \"问题关注的是根据用户在特定时间段内的登录和玩法行为进行分类，属于用户分群分析。\"\n}"
  },
  {
    "question_id": "sql_90",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计截至2023.6.30活跃分层，并在2023.7.01~2023.7.16未活跃，后续在2023.7.17-2023.7.23玩桥梁争夺的用户\n输出：活跃分层（360天内未活跃、180天内未活跃、90天内未活跃、60天内未活跃、30天内未活跃、14天内未活跃、7天内未活跃、7天内活跃），玩桥梁争夺人数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_df` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:不区分平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '登录位图',\n  `dregdate` TEXT COMMENT '注册日期，格式YYYYMMDD',\n  `ilevel` BIGINT COMMENT '等级',\n  `friendcount` BIGINT COMMENT '好友数量'\n);\nCREATE TABLE `dwd_jordass_player_matchrecord_hi` (\n  `tdbank_imp_date` TEXT COMMENT '分区字段，小时分区，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `matchtime` BIGINT COMMENT '匹配时长（秒）',\n  `matchresult` TEXT COMMENT '匹配结果',\n  `matchmode` BIGINT COMMENT '匹配模式',\n  `isaotufill` BIGINT COMMENT '是否自动填充',\n  `gameid` TEXT COMMENT '匹配成功为当前的battleid失败为0',\n  `submodes` TEXT COMMENT '选择的子模式列表，只有队长才有',\n  `isleader` BIGINT COMMENT '1表示队长0非队长',\n  `teamnum` TEXT COMMENT '组队人数',\n  `teammembers` TEXT COMMENT '组队队伍',\n  `matchteammembers` TEXT COMMENT '最终匹配的队伍',\n  `matchlabel` BIGINT COMMENT '匹配标签',\n  `corpsid` BIGINT COMMENT '联盟id',\n  `teamid` TEXT COMMENT '队伍ID',\n  `teamwaittime` BIGINT COMMENT '队伍首次组队到匹配等待时间',\n  `finalbucketidx` BIGINT COMMENT '匹配成功首队伍所在匹配区间idx',\n  `playermoderating` BIGINT COMMENT '玩家该模式下rating分(段位分)',\n  `playerlevel` BIGINT COMMENT '玩家等级',\n  `regresss` BIGINT COMMENT '是否回流玩家',\n  `matchsubmodegroup` BIGINT COMMENT '最终随机到的submodegroup',\n  `matchrating` BIGINT COMMENT '当前玩家所在队伍匹配积分',\n  `bucketidx` BIGINT COMMENT '当前玩家所在队伍匹配积分所在区间idx',\n  `device_type` BIGINT COMMENT '设备类型0为手机 1为模拟器 2 键鼠 3 手柄 5 PC高清模拟器',\n  `strategys` TEXT COMMENT '分队策略',\n  `match_client_type` BIGINT COMMENT '匹配池渠道0为手机 1为模拟器 2外部模拟器 8为小黑屋 9为新手局',\n  `pandoralost` BIGINT COMMENT '潘多拉预流失标记 1预流失 0非预流失',\n  `teamjoinsource` BIGINT COMMENT '组队加入来源',\n  `regressvalue` BIGINT COMMENT '玩家当前的回流值',\n  `strategy_type` BIGINT COMMENT '策略类型，-1表示服务器保底二次分队, 0表示004的潘多拉策略, 1表示005的潘多拉单局最优策略, 2表示015的技术中心优化分队策略, 3表示技术中心向量化二次分队方案, 4表示内部推荐二次分队方案',\n  `playersign` BIGINT COMMENT '玩家分级标签，1为白，2为红，3为灰, 4为深灰',\n  `livetype` BIGINT COMMENT '直播类型: 2 围观 4 视频号',\n  `liveid` TEXT COMMENT '直播ID',\n  `matchscene` BIGINT COMMENT '匹配成功时玩家所在场景，0为大厅，1为聚乐园',\n  `issilentmode` BIGINT COMMENT '是否是免耳麦模式，0为非免耳麦，1为免耳麦',\n  `ismatchlbs` BIGINT COMMENT '是否是lbs匹配，0为非lbs匹配，1为lbs匹配',\n  `strategy_index` BIGINT COMMENT '二次分队策略采用的weight数组的下标',\n  `xid` TEXT COMMENT 'Xid',\n  `isanchor` BIGINT COMMENT '是否是主播，0为非主播，1为主播',\n  `isanchorgame` BIGINT COMMENT '是否匹配到主播局，0为非主播局，1为主播局',\n  `tournamentid` BIGINT COMMENT '微赛事ID',\n  `expandupsection` BIGINT COMMENT '最大向上扩段数',\n  `expanddownsection` BIGINT COMMENT '最大向下扩段数',\n  `expandupclass` BIGINT COMMENT '最大向上扩载数',\n  `expanddownclass` BIGINT COMMENT '最大向下扩载数',\n  `isfullbucket` BIGINT COMMENT '是否优先遍历满载队',\n  `timingmatchtime` BIGINT COMMENT '定时匹配真实匹配时长（秒）',\n  `tournamentstage` BIGINT COMMENT '微赛事阶段ID',\n  `tournamentclubid` TEXT COMMENT '微赛事战队ID',\n  `promotionmatchstatus` BIGINT COMMENT '参与晋级赛的状态, -1没勾选，0成功参与，1模式不对，2时间不对，3配置不对，4自身段位不对，5队友段位不对',\n  `ugcisgray` BIGINT COMMENT '是否为ugc灰度玩法。默认为0：非灰度；1：灰度',\n  `promotiontaskid` BIGINT COMMENT '晋级赛任务ID',\n  `strategyabtest` TEXT COMMENT '未命中模式为空，对照组记 0:ID，实验组记 1:ID',\n  `accompanytype` BIGINT COMMENT '陪玩标签值 0 ：没有打标签，1：陪玩，2：老板',\n  `minusteamnum` BIGINT COMMENT '匹配成功后踢回匹配池的队伍数',\n  `mobiletabletmatchlabel` BIGINT COMMENT '匹配队伍平板比例标签(非手机=0，纯手机=1，25%平板=2，50%平板=3，75%平板=4，100%平板=5)',\n  `ratingtype` BIGINT COMMENT '积分类型',\n  `idcname` TEXT COMMENT 'IDC集群名字',\n  `strategyextendinfo` TEXT COMMENT '推荐侧二次分队返回的信息',\n  `playerabtest` TEXT COMMENT '个人匹配abtest',\n  `gameabtest` TEXT COMMENT '匹配对局的abtest,没有则为空字符串',\n  `matchtype` BIGINT COMMENT '1表示匹配成局，2表示补人',\n  `matchisolatetype` BIGINT COMMENT '玩家匹配隔离标记, 0不隔离，2所有模式隔离，3积分模式隔离，4E玩法模式隔离',\n  `predictmatchtime` BIGINT COMMENT '预估匹配时长',\n  `expandspeed` BIGINT COMMENT '匹配单阶段扩段时长',\n  `escapehardid` BIGINT COMMENT 'E玩法难度ID',\n  `gameplayernum` BIGINT COMMENT '开局人数',\n  `gameaistrategy` BIGINT COMMENT 'AI投放策略类型',\n  `isfixmatchlabel` BIGINT COMMENT '是否触发了标签修正',\n  `realmatchsubmodes` TEXT COMMENT '实际匹配的模式组列表',\n  `aitype` BIGINT COMMENT '投放的AI類型',\n  `decratingtype` BIGINT COMMENT '降段类型，0=未触发降段，1=pc新手标签降段，2=未成年标签降段，3=回流标签降段，4=情绪值降段',\n  `forcematchtype` BIGINT COMMENT '记录本次匹配是否触发了强制开局，0=未触发，1=通用强制开局，2=PC新手强制开局',\n  `ispcaigame` BIGINT COMMENT '是否触发了PC首局AI局',\n  `matchsubclienttype` BIGINT COMMENT '匹配子池：0非子池, 2外设键鼠,3外设手柄,4主播,5PC新手,6PC-AI局 7BR温暖局，8隧道AI局',\n  `heroexcludetype` BIGINT COMMENT '是否触发了英雄互斥匹配，1采用了互斥匹配, 2没命中灰度 3超时，0其他情况',\n  `natalhero` BIGINT COMMENT '本命英雄ID',\n  `iswarmescapegame` BIGINT COMMENT '是否是E玩法温暖局',\n  `cancrossdevicematch` BIGINT COMMENT '是否可已手机非手机混匹, 1可以，0不可以',\n  `aiteamatetype` BIGINT COMMENT 'AI队友类型',\n  `isfirstteam` BIGINT COMMENT '是否是首队',\n  `firstteamwaittime` BIGINT COMMENT '首队的匹配等待时间',\n  `firstteamrankbucket` BIGINT COMMENT '首队段位分段',\n  `matchprocessinfo` TEXT COMMENT '匹配扩展信息 辅助查询匹配问题',\n  `isabtwarmgame` BIGINT COMMENT '是否触发了温暖局',\n  `warmplayertype` BIGINT COMMENT '温暖局玩家身份, 3=挫败（未来），2=回流，1=低活，0=未触发或无标签',\n  `escapeplayertype` TEXT COMMENT '隧道玩家身份类型, 空字符串表示默认类型，1回流标签有限期内,2积分移动新手(隐藏分专用),3积分非移动新手(隐藏分专用),4积分回流(隐藏分专用),5全局新手(AI局专用),6PC新手(AI局专用),7非PC温暖(AI局专用),8PC温暖(AI局专用),9回流(AI局专用), 以+分割',\n  `secondarydecratingtype` BIGINT COMMENT '二维匹配分降段类型，0=未触发降段，1=隧道回流降分匹配',\n  `finalsecondarybucketidx` BIGINT COMMENT '匹配成功首队所在二维匹配积分区间',\n  `playersecondarymoderating` BIGINT COMMENT '玩家该模式下二维匹配积分',\n  `secondarymatchrating` BIGINT COMMENT '当前玩家所在队伍二维匹配积分',\n  `secondarybucketidx` BIGINT COMMENT '当前玩家所在队伍二维匹配积分所在区间',\n  `escapeasset` TEXT COMMENT '隧道玩法资产',\n  `escapewarmscore` TEXT COMMENT '隧道温暖值',\n  `pvethemeid` BIGINT COMMENT 'PVE挑战事件ID',\n  `escapelesspeoplegamenum` BIGINT COMMENT '隧道每周已触发低真人局次数',\n  `garybucketgroup` BIGINT COMMENT '灰度分桶',\n  `matchsubclienttypebefore` BIGINT COMMENT '发起匹配时的匹配子池：0非子池, 2外设键鼠,3外设手柄,4主播,5PC新手,6PC-AI局, 7BR温暖局，8隧道AI局',\n  `frustratiggerlevel` BIGINT COMMENT 'FrustraTiggerLevel',\n  `frustramanualscore` TEXT COMMENT 'FrustraManualScore',\n  `frustramodelscore` TEXT COMMENT 'FrustraModelScore',\n  `frustragroup` TEXT COMMENT 'FrustraGroup',\n  `frustrathreshold` TEXT COMMENT 'FrustraThreshold',\n  `recomtraceid` TEXT COMMENT 'RecomTraceID'\n);\n\n【参考信息】\n桥梁争夺 MatchSubModeGroup=1310822585431254784 \n使用dws_jordass_login_df，只允许dtStatDate = '20230630'\n\n",
    "output": "",
    "category": "留存类",
    "category_reason": "问题关注用户在特定时间段的活跃状态变化及后续行为，属于留存与流失分析范畴。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注用户在特定时间段的活跃状态变化及后续行为，属于留存与流失分析范畴。\"\n}"
  },
  {
    "question_id": "sql_91",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2023.7.12-7.18,2023.7.19-7.25的全平台活跃用户的回流情况(7留存，14留存，30留存，60留存，90留存，180留存)\n输出：统计日期（20230712，20230713...20230725），类型（新进，7，14，30，60，90，180），人数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_df` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:不区分平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '登录位图',\n  `dregdate` TEXT COMMENT '注册日期，格式YYYYMMDD',\n  `ilevel` BIGINT COMMENT '等级',\n  `friendcount` BIGINT COMMENT '好友数量'\n);\n\n【参考信息】\n\n\n",
    "output": "",
    "category": "留存类",
    "category_reason": "问题关注的是特定时间段内活跃用户的回流情况，涉及多个留存指标（如7留存、14留存等），属于典型的留存分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注的是特定时间段内活跃用户的回流情况，涉及多个留存指标（如7留存、14留存等），属于典型的留存分析。\"\n}"
  },
  {
    "question_id": "sql_92",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计日期： 上周：2023.7.5-2023.7.11 本周：2023.7.12-2023.7.18\n统计在上周全平台回流砺刃的用户中（7天以上回流、30天以上回流），本周的砺刃活跃情况（轻中重活跃和流失）\n,[1,2]为轻度，[3,5]为中度，[6,7]为重度，否则为流失。输出：回流类型（7天回流，30天回流），活跃情况（轻中重活跃和流失）,人数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\nCREATE TABLE `dws_jordass_login_df` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:不区分平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '登录位图',\n  `dregdate` TEXT COMMENT '注册日期，格式YYYYMMDD',\n  `ilevel` BIGINT COMMENT '等级',\n  `friendcount` BIGINT COMMENT '好友数量'\n);\n\n【参考信息】\n活跃情况使用dws_jordass_login_di表，回流使用dws_jordass_login_df\n\n",
    "output": "",
    "category": "留存类",
    "category_reason": "问题关注回流用户的后续活跃情况，属于留存与流失分析范畴。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注回流用户的后续活跃情况，属于留存与流失分析范畴。\"\n}"
  },
  {
    "question_id": "sql_93",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2024.1到2024.5每月全平台的新增付费、持续付费和回流付费用户人数\n输出：自然月（202401,...,2024.5），类型（1对应 新增付费用户； 2对应 持续付费用户；3对应 回流付费用户）,人数，付费金额（元）\n\n【数据库schema】\nCREATE TABLE `dws_jordass_water_di` (\n  `dtstatdate` TEXT COMMENT '分区，付费日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android,255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `iamount` BIGINT COMMENT '代币金额(Q分)',\n  `itimes` BIGINT COMMENT '流水次数',\n  `imoney` DOUBLE COMMENT '除100为实际支付人民币金额'\n);\nCREATE TABLE `dws_jordass_water_df` (\n  `dtstatdate` TEXT COMMENT '分区，付费日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android，255所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '流水位图',\n  `dwaterdate` TEXT COMMENT '首次流水日期',\n  `imoney` DOUBLE COMMENT '累计流水收入(分)(简称流水)',\n  `iamount` BIGINT COMMENT '代币金额(Q分)'\n);\n\n【参考信息】\n当月新增付费用户：用户第一笔支付在这个月\n当月持续付费用户：用户在本月的第一笔支付距离上一笔支付在30天以内\n当月回流付费用户：用户在本月的第一笔支付距离上一笔支付在30天以上\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是每月付费用户的行为分布，涉及时间维度上的用户活跃情况。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是每月付费用户的行为分布，涉及时间维度上的用户活跃情况。\"\n}"
  },
  {
    "question_id": "sql_94",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20241123-20241128 全平台生存模式用户注册年份的设备情况\n输出：统计日期(20241123-20241128)，设备类型（手机、模拟器），注册年份，使用设备的人数，使用设备玩生存模式人数，使用设备玩生存模式占总设备人数的比例，使用设备玩生存模式的次留率\n\n【数据库schema】\nCREATE TABLE `dws_jordass_device_login_di` (\n  `dtstatdate` TEXT COMMENT '统计日期',\n  `vgameappid` TEXT COMMENT 'qq/wx',\n  `platid` BIGINT COMMENT 'ios0/android1',\n  `vplayerid` TEXT COMMENT 'vplayerid',\n  `device_type` BIGINT COMMENT '登录端',\n  `loginchannel` BIGINT COMMENT '登录渠道',\n  `ionlinetime` BIGINT COMMENT '在线时长',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `vtemp1` TEXT COMMENT '预留字段1',\n  `vtemp2` TEXT COMMENT '预留字段2',\n  `vtemp3` TEXT COMMENT '预留字段3',\n  `itemp1` BIGINT COMMENT '预留字段4',\n  `itemp2` BIGINT COMMENT '预留字段5',\n  `itemp3` BIGINT COMMENT '预留字段6',\n  `seasonmaxsegment` BIGINT COMMENT '当前赛季最高段位'\n);\nCREATE TABLE `dws_jordass_login_df` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:不区分平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '登录位图',\n  `dregdate` TEXT COMMENT '注册日期，格式YYYYMMDD',\n  `ilevel` BIGINT COMMENT '等级',\n  `friendcount` BIGINT COMMENT '好友数量'\n);\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT '统计日期格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `mode` BIGINT COMMENT '模式ID',\n  `modename` TEXT COMMENT '模式名称',\n  `submode` BIGINT COMMENT '子模式ID',\n  `submodename` TEXT COMMENT '子模式名称',\n  `map` BIGINT COMMENT '地图ID',\n  `mapname` TEXT COMMENT '地图名称',\n  `seasonid` BIGINT COMMENT '赛季ID',\n  `seasonname` TEXT COMMENT '赛季名称',\n  `roundcnt` BIGINT COMMENT '当日对局数',\n  `roundtime` BIGINT COMMENT '当日对局时长(秒)',\n  `survivaltime` BIGINT COMMENT '当日存活时长(秒)',\n  `firstroundtime` TEXT COMMENT '当日首次对局时间',\n  `device_type` BIGINT COMMENT '设备类型'\n);\n\n【参考信息】\n设备类型：device_type 0-手机 1,5-模拟器 \n生存模式：modename='生存模式'\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是特定时间段内用户在不同设备上的登录情况，属于活跃用户在设备维度上的分布。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是特定时间段内用户在不同设备上的登录情况，属于活跃用户在设备维度上的分布。\"\n}"
  },
  {
    "question_id": "sql_97",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n在2023.7.19-2023.7.25时间范围内，分别统计参与了隐匿的用户人数、既参与隐匿也参与了桥梁争夺的用户、既参与隐匿也参与了隐匿模式的用户\n输出：参与了隐匿的不重复的人的个数、参与隐匿并且参与了桥梁争夺的不重复的人的个数、参与隐匿并且参与了隐匿模式的不重复的人的个数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_matchlog_stat_di` (\n  `dtstatdate` TEXT COMMENT '分区，参与乐园日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `imode` BIGINT COMMENT '乐园子玩法：\t255-所有玩法，用户问题未提到明确的子玩法时，默认为所有玩法\t1282371711108385024-跑酷：成神之路\t1281086178576044544-传媒群岛\t1305619333337074432-狂热派对\t1251206313870885120-砺刃运动会5.0\t1313754433693158656-手球特攻（原足球游戏）\t1296730563346958080-盔仔泡泡小队\t1294279575841283072-夺宝行动\t1310822585431254784-桥梁争夺\t1278160113246405632-砺刃大亨\t1313047366167692288-逆转平底锅\t1298874468735655936-战车突袭\t1278948391311645952-能量争夺战\t1295942084687041792-趣味飞盘\t1282101477461985024-盔仔总动员\t1278144466094392064-黑五模拟器\t1313046652157690624-盔仔斗魔王（原盔仔大乱斗）\t1289446028099979264-佣兵阵线\t1309453077449826304-星星争夺战（原名：金币大作战）\t1298445174154728192-停车大作战\t1294211358396518400-特技大乱斗\t1280302176000803840-卧底行动\t1307095884553538304-\"超级隐匿（原广阔天地隐匿模式）\"\t1297394991875754752-守卫生命线\t1278170390282112000-星球守护者\t1287652322611036928-拼图狂欢\t1273928195100380928-特种兵训练\t1300845150154531840-星之继承者\t1302344773925865984-彩色争夺战\t1296062239742105856-抱团冲冲冲\t1281781308570207232-狙击精英',\n  `teamnum` BIGINT COMMENT '组队人数',\n  `icnt` BIGINT COMMENT '对局次数',\n  `itemp1` BIGINT COMMENT '对局时长',\n  `itemp2` BIGINT COMMENT 'itemp2',\n  `vtemp1` TEXT COMMENT 'vtemp1',\n  `vtemp2` TEXT COMMENT 'vtemp2'\n);\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT '统计日期格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `mode` BIGINT COMMENT '模式ID',\n  `modename` TEXT COMMENT '模式名称',\n  `submode` BIGINT COMMENT '子模式ID',\n  `submodename` TEXT COMMENT '子模式名称',\n  `map` BIGINT COMMENT '地图ID',\n  `mapname` TEXT COMMENT '地图名称',\n  `seasonid` BIGINT COMMENT '赛季ID',\n  `seasonname` TEXT COMMENT '赛季名称',\n  `roundcnt` BIGINT COMMENT '当日对局数',\n  `roundtime` BIGINT COMMENT '当日对局时长(秒)',\n  `survivaltime` BIGINT COMMENT '当日存活时长(秒)',\n  `firstroundtime` TEXT COMMENT '当日首次对局时间',\n  `device_type` BIGINT COMMENT '设备类型'\n);\n\n【参考信息】\n隐匿的用户：imode = 1307095884553538304  and platid <> 255\n桥梁争夺的用户：imode = 1310822585431254784  and platid <> 255\n隐匿模式的用户：mode=2370\n\n",
    "output": "",
    "category": "行为链条",
    "category_reason": "问题关注用户在特定时间内参与多个玩法的行为路径，属于多步骤行为分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"行为链条\",\n  \"rationale\": \"问题关注用户在特定时间内参与多个玩法的行为路径，属于多步骤行为分析。\"\n}"
  },
  {
    "question_id": "sql_98",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2024.05.27-2024.6.16每天的乐园高活跃用户和砺刃高活跃用户不重复人数、\n乐园高活跃用户和砺刃高活跃用户在当天登录的不重复人数\n输出：日期（YYYYMMDD），用户类型（乐园高活、砺刃高活），用户人数，登录人数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\nCREATE TABLE `dim_jordass_packet_conf` (\n  `ds` TEXT COMMENT 'ds'\n);\nCREATE TABLE `dws_jordass_buttonpress_pre_di` (\n  `dtstatdate` TEXT COMMENT '统计日期，格式YYYYMMDD',\n  `dteventtime` TEXT COMMENT '事件时间,格式YYYY-MM-DDHH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` TEXT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` TEXT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `clientversion` TEXT COMMENT 'clientversion',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `uid` TEXT COMMENT '角色ID',\n  `buttontype` TEXT COMMENT '按钮代号',\n  `ireason` TEXT COMMENT '额外参数',\n  `extarg1` TEXT COMMENT '附加参数1',\n  `extarg2` TEXT COMMENT '附加参数2'\n);\n\n【参考信息】\n\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是特定时间段内不同模块（乐园和砺刃）的高活跃用户数及交集，属于对用户活跃度在时间和业务维度上的分布统计。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是特定时间段内不同模块（乐园和砺刃）的高活跃用户数及交集，属于对用户活跃度在时间和业务维度上的分布统计。\"\n}"
  },
  {
    "question_id": "sql_99",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2024.6.1-2024.6.30期间乐园付费用户的砺刃和乐园付费分布,需要看不同乐园子玩法\n付费分层（小R 1-30，中小R 30-100，中R 100-500，大R 500-1500，超R 1500+，否则为未付费），乐园付费金额sum(Amount/10)\n输出：子玩法、分类（砺刃or乐园），付费分层，人数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_payrespond_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `billno` TEXT COMMENT '订单号',\n  `res` TEXT COMMENT '错误码',\n  `balance` BIGINT COMMENT '点券余额',\n  `amount` BIGINT COMMENT 'amount',\n  `source` BIGINT COMMENT '请求点券的请求源',\n  `is_online` BIGINT COMMENT '应答当时玩家是否在线',\n  `gen_balance` BIGINT COMMENT 'gen_balance',\n  `used_gen_amt` BIGINT COMMENT 'used_gen_amt',\n  `submode` TEXT COMMENT 'ugc模式',\n  `devicetype` BIGINT COMMENT 'DeviceType'\n);\n\n【参考信息】\nres = 'ok'\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是付费用户在不同乐园子玩法中的金额分布情况，属于对用户行为或消费分布的分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是付费用户在不同乐园子玩法中的金额分布情况，属于对用户行为或消费分布的分析。\"\n}"
  },
  {
    "question_id": "sql_100",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2024.3.26~2024.5.27 的玩家类型(7日回流/30日回流/新进玩家)，总人数、总付费、总付费人数，商业化类型，消耗人数，抽奖次数/购买次数，付费数 \n\n输出：日期(yyyymmdd)，玩家类型（7日回流/30日回流/新进），总人数、总付费、总付费人数，商业化类型（手册、战备、限定抽取、轮盘、元素、专属卡、直购），消耗人数，抽奖次数,付费数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_lotteryrecord_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '玩家',\n  `uid` TEXT COMMENT '角色UID',\n  `activitytype` BIGINT COMMENT '活动类型',\n  `discountnum` BIGINT COMMENT '折扣使用次数',\n  `allianceforcetermoney` BIGINT COMMENT '操作后剩余抽奖比',\n  `allianceforceterround` BIGINT COMMENT '操作后累计轮次数',\n  `dailyround` BIGINT COMMENT '操作后当日累计轮次数',\n  `lotteryround` BIGINT COMMENT '抽奖次数, 单抽：1, 十连抽：10',\n  `suprisehit` BIGINT COMMENT '惊喜,0不命中,1命中',\n  `costnum` BIGINT COMMENT '消耗活动币数量',\n  `awardsitems` TEXT COMMENT '第一个是道具id，第二个是道具个数，比如：1602517-2-0-0 道具id是1602517， 道具个数是2。\t使用以下逻辑获取道具id和道具个数明细：\t```\tselect \t  -- 提取道具ID（第一个数字段）\t  split(exploded_item, -)[0] AS item_id,\t  -- 提取道具数量（第二个数字段）\t  split(exploded_item, -)[1] AS item_count \tfrom ieg_tdbank::dwd_jordass_lotteryrecord_hi\tlateral view explode(split(awardsitems, :)) tmp AS exploded_item\t```',\n  `device_type` BIGINT COMMENT '设备类型0为手机 1为模拟器 2 键鼠 3 手柄',\n  `couponinfo` TEXT COMMENT '使用优惠券列表',\n  `reductionnum` BIGINT COMMENT '减免活动币数量'\n);\nCREATE TABLE `dwd_jordass_lotterylog_twostage_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '玩家',\n  `uid` TEXT COMMENT '角色UID',\n  `awardidx` BIGINT COMMENT '获得奖励编号值,只对单抽有效',\n  `advancedawardidx` BIGINT COMMENT '进阶奖励编号值',\n  `costnum` BIGINT COMMENT '消耗活动币数量',\n  `round` BIGINT COMMENT '总轮次',\n  `moneyleft` BIGINT COMMENT '剩余活动币',\n  `level` BIGINT COMMENT '当前层',\n  `levelround` BIGINT COMMENT '当前层的轮次',\n  `superflag` BIGINT COMMENT '特殊格子奖励，0没中,1中',\n  `activityid` BIGINT COMMENT '活动ID',\n  `activitytype` BIGINT COMMENT '活动类型',\n  `lotterytype` BIGINT COMMENT '抽奖类型，0单抽，1抽完本轮, 2盲盒随机大奖励',\n  `realcount` BIGINT COMMENT '抽完本轮实际消耗的次数，只对抽完本轮有效',\n  `savedticket` BIGINT COMMENT '节省的点券数量',\n  `exemptticket` BIGINT COMMENT '返还点券数量',\n  `luckyvalue` BIGINT COMMENT '累计幸运值',\n  `totalsavedmoney` BIGINT COMMENT '累计节省活动币',\n  `luckysavedmoney` BIGINT COMMENT '本次抽奖幸运值节省活动币',\n  `device_type` BIGINT COMMENT '设备类型0为手机 1为模拟器 2 键鼠 3 手柄',\n  `moneytype` BIGINT COMMENT '消耗代币类型, 0为活动币, 1为通用货币',\n  `freecouponid` BIGINT COMMENT '抵扣券res_id, 0表示没有使用抵扣券',\n  `exempttype` BIGINT COMMENT '返还类型，0表示点券，1表示通用货币',\n  `exemptcommmoney` BIGINT COMMENT '返还通用货币数量',\n  `awardsitems` TEXT COMMENT '获得道具列表',\n  `usedcoupons` TEXT COMMENT 'UsedCoupons',\n  `iswish` BIGINT COMMENT 'IsWish',\n  `isanchor` BIGINT COMMENT 'IsAnchor',\n  `ticketcost` BIGINT COMMENT 'TicketCost',\n  `uscorecost` BIGINT COMMENT 'UscoreCost'\n);\nCREATE TABLE `dwd_jordass_privpackagelog_hi` (\n  `tdbank_imp_date` TEXT,\n  `gamesvrid` TEXT COMMENT '登录的游戏服务器编号',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `packageid` BIGINT COMMENT '补给包ID',\n  `opendays` BIGINT COMMENT '购买天数',\n  `moneytype` BIGINT COMMENT '购买货币类型',\n  `moneycnt` BIGINT COMMENT '购买货币数据',\n  `oldbegintime` BIGINT COMMENT '老的开始时间',\n  `oldendtime` BIGINT COMMENT '老的结束时间',\n  `newbegintime` BIGINT COMMENT '新的开始时间',\n  `newendtime` BIGINT COMMENT '新的结束时间',\n  `additems` TEXT COMMENT '获得道具列表，resid1-cnt1-hour1-extra_id1:resid2-cnt2-hour2-extra_id2',\n  `openway` BIGINT COMMENT '开通方式, 1:直购，2:点券支付，3:使用仓库物品'\n);\nCREATE TABLE `dwd_jordass_currencylog_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间,格式YY',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填',\n  `vplayerid` TEXT COMMENT '玩家id',\n  `uid` TEXT COMMENT '玩家UID',\n  `sequence` BIGINT COMMENT '用于关联一次动作产生多条不同类型的货币流动日志',\n  `level` BIGINT COMMENT '玩家等级',\n  `allianceforcetermoney` BIGINT COMMENT '动作后的金钱数',\n  `imoney` BIGINT COMMENT '动作涉及的金钱数',\n  `reason` BIGINT COMMENT '货币流动一级原因',\n  `subreason` BIGINT COMMENT '货币流动二级原因',\n  `addorreduce` BIGINT COMMENT '增加 0/减少 1',\n  `imoneytype` BIGINT COMMENT '枚举值(0:金币;1:点券;2:服饰币;4:物资币;6:荣耀勋章;1026:组竞币;1027:幸运币)',\n  `device_type` BIGINT COMMENT '设备类型0为手机,1为模拟器, 2键鼠, 3手柄, 5是PC客户端,也是高清模拟器。'\n);\nCREATE TABLE `dws_jordass_login_df` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:不区分平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '登录位图',\n  `dregdate` TEXT COMMENT '注册日期，格式YYYYMMDD',\n  `ilevel` BIGINT COMMENT '等级',\n  `friendcount` BIGINT COMMENT '好友数量'\n);\nCREATE TABLE `dwd_jordass_marketpurchase_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `shopid_1` BIGINT COMMENT '第1个商品的商品id',\n  `shopmoneytype_1` BIGINT COMMENT '第1个商品的货币类型',\n  `shopprice_1` BIGINT COMMENT '第1个商品的商品单价',\n  `shopcnt_1` BIGINT COMMENT '第1个商品的购买个数',\n  `shoptime_1` BIGINT COMMENT '第1个商品的购买时限',\n  `itemid_1` BIGINT COMMENT '第1个商品的道具ID',\n  `itemextra_1` BIGINT COMMENT '第1个商品的道具extra_id',\n  `shopid_2` BIGINT COMMENT '第2个商品的商品id',\n  `shopmoneytype_2` BIGINT COMMENT '第2个商品的货币类型',\n  `shopprice_2` BIGINT COMMENT '第2个商品的商品单价',\n  `shopcnt_2` BIGINT COMMENT '第2个商品的购买个数',\n  `shoptime_2` BIGINT COMMENT '第2个商品的购买时限',\n  `itemid_2` BIGINT COMMENT '第2个商品的道具ID',\n  `itemextra_2` BIGINT COMMENT '第2个商品的道具extra_id',\n  `shopid_3` BIGINT COMMENT '第3个商品的商品id',\n  `shopmoneytype_3` BIGINT COMMENT '第3个商品的货币类型',\n  `shopprice_3` BIGINT COMMENT '第3个商品的商品单价',\n  `shopcnt_3` BIGINT COMMENT '第3个商品的购买个数',\n  `shoptime_3` BIGINT COMMENT '第3个商品的购买时限',\n  `itemid_3` BIGINT COMMENT '第3个商品的道具ID',\n  `itemextra_3` BIGINT COMMENT '第3个商品的道具extra_id',\n  `shopid_4` BIGINT COMMENT '第4个商品的商品id',\n  `shopmoneytype_4` BIGINT COMMENT '第4个商品的货币类型',\n  `shopprice_4` BIGINT COMMENT '第4个商品的商品单价',\n  `shopcnt_4` BIGINT COMMENT '第4个商品的购买个数',\n  `shoptime_4` BIGINT COMMENT '第4个商品的购买时限',\n  `itemid_4` BIGINT COMMENT '第4个商品的道具ID',\n  `itemextra_4` BIGINT COMMENT '第4个商品的道具extra_id',\n  `shopid_5` BIGINT COMMENT '第5个商品的商品id',\n  `shopmoneytype_5` BIGINT COMMENT '第5个商品的货币类型',\n  `shopprice_5` BIGINT COMMENT '第5个商品的商品单价',\n  `shopcnt_5` BIGINT COMMENT '第5个商品的购买个数',\n  `shoptime_5` BIGINT COMMENT '第5个商品的购买时限',\n  `itemid_5` BIGINT COMMENT '第5个商品的道具ID',\n  `itemextra_5` BIGINT COMMENT '第5个商品的道具extra_id',\n  `total_ticket` BIGINT COMMENT '总消耗点券数',\n  `total_diamond` BIGINT COMMENT '总消耗钻石数',\n  `total_gold` BIGINT COMMENT '总消耗金币数',\n  `present_flag` BIGINT COMMENT '此次购买是否是赠送给他人',\n  `billno` TEXT COMMENT '订单号',\n  `shopid_6` BIGINT COMMENT '第6个商品的商品id',\n  `shopmoneytype_6` BIGINT COMMENT '第6个商品的货币类型',\n  `shopprice_6` BIGINT COMMENT '第6个商品的商品单价',\n  `shopcnt_6` BIGINT COMMENT '第6个商品的购买个数',\n  `shoptime_6` BIGINT COMMENT '第6个商品的购买时限',\n  `itemid_6` BIGINT COMMENT '第6个商品的道具ID',\n  `itemextra_6` BIGINT COMMENT '第6个商品的道具extra_id',\n  `shopid_7` BIGINT COMMENT '第7个商品的商品id',\n  `shopmoneytype_7` BIGINT COMMENT '第7个商品的货币类型',\n  `shopprice_7` BIGINT COMMENT '第7个商品的商品单价',\n  `shopcnt_7` BIGINT COMMENT '第7个商品的购买个数',\n  `shoptime_7` BIGINT COMMENT '第7个商品的购买时限',\n  `itemid_7` BIGINT COMMENT '第7个商品的道具ID',\n  `itemextra_7` BIGINT COMMENT '第7个商品的道具extra_id',\n  `total_gun_coin` BIGINT COMMENT '总消耗枪械币数',\n  `total_item_coin` BIGINT COMMENT '总消耗物资币数',\n  `total_trans_server_coin` BIGINT COMMENT '总消耗换服币数',\n  `full_sub_resid` BIGINT COMMENT '满减券物品id',\n  `full_sub_value` BIGINT COMMENT '满减券减免点券',\n  `total_bw_coin` BIGINT COMMENT '总消耗广阔天地币数',\n  `shopid_8` BIGINT COMMENT '第8个商品的商品id',\n  `shopmoneytype_8` BIGINT COMMENT '第8个商品的货币类型',\n  `shopprice_8` BIGINT COMMENT '第8个商品的商品单价',\n  `shopcnt_8` BIGINT COMMENT '第8个商品的购买个数',\n  `shoptime_8` BIGINT COMMENT '第8个商品的购买时限',\n  `itemid_8` BIGINT COMMENT '第8个商品的道具ID',\n  `itemextra_8` BIGINT COMMENT '第8个商品的道具extra_id',\n  `shopid_9` BIGINT COMMENT '第9个商品的商品id',\n  `shopmoneytype_9` BIGINT COMMENT '第9个商品的货币类型',\n  `shopprice_9` BIGINT COMMENT '第9个商品的商品单价',\n  `shopcnt_9` BIGINT COMMENT '第9个商品的购买个数',\n  `shoptime_9` BIGINT COMMENT '第9个商品的购买时限',\n  `itemid_9` BIGINT COMMENT '第9个商品的道具ID',\n  `itemextra_9` BIGINT COMMENT '第9个商品的道具extra_id',\n  `shopid_10` BIGINT COMMENT '第10个商品的商品id',\n  `shopmoneytype_10` BIGINT COMMENT '第10个商品的货币类型',\n  `shopprice_10` BIGINT COMMENT '第10个商品的商品单价',\n  `shopcnt_10` BIGINT COMMENT '第10个商品的购买个数',\n  `shoptime_10` BIGINT COMMENT '第10个商品的购买时限',\n  `itemid_10` BIGINT COMMENT '第10个商品的道具ID',\n  `itemextra_10` BIGINT COMMENT '第10个商品的道具extra_id',\n  `shopid_11` BIGINT COMMENT '第11个商品的商品id',\n  `shopmoneytype_11` BIGINT COMMENT '第11个商品的货币类型',\n  `shopprice_11` BIGINT COMMENT '第11个商品的商品单价',\n  `shopcnt_11` BIGINT COMMENT '第11个商品的购买个数',\n  `shoptime_11` BIGINT COMMENT '第11个商品的购买时限',\n  `itemid_11` BIGINT COMMENT '第11个商品的道具ID',\n  `itemextra_11` BIGINT COMMENT '第11个商品的道具extra_id',\n  `shopid_12` BIGINT COMMENT '第12个商品的商品id',\n  `shopmoneytype_12` BIGINT COMMENT '第12个商品的货币类型',\n  `shopprice_12` BIGINT COMMENT '第12个商品的商品单价',\n  `shopcnt_12` BIGINT COMMENT '第12个商品的购买个数',\n  `shoptime_12` BIGINT COMMENT '第12个商品的购买时限',\n  `itemid_12` BIGINT COMMENT '第12个商品的道具ID',\n  `itemextra_12` BIGINT COMMENT '第12个商品的道具extra_id',\n  `source` BIGINT COMMENT '商城购买的来源',\n  `device_type` BIGINT COMMENT '设备类型0为手机 1为模拟器 2 键鼠 3 手柄'\n);\n\n【参考信息】\n货币转化规则：轮盘、限定抽取、专属卡（*10），战备、直购、元素、手册（*1）\n抽奖次数：轮盘需要求和，其他直接计数；\n商业化类型计算逻辑：\n战备：when itemid_1 in (1515013,1515020,1515023,1515060,1515277,1515279) then '战备'\n直购：when itemid_1 not in (1515013,1515020,1515023,1515060,1515277,1515279,1515029,1515120,1515123,1515122,1515121) then '直购'\n元素：when (Reason in (189,190) and AddOrReduce=1 and iMoneyType=1027) then '元素'\n手册：when (Reason in (143,144,156,158,246,269,273) and AddOrReduce=1 and iMoneyType=1 ) then '手册'\n专属卡：select '专属卡' itype,substr(tdbank_imp_date,1,8) dt,vplayerid,sum(moneycnt)*10.0 money,count(*) icnt\n轮盘：select '轮盘' itype,substr(tdbank_imp_date,1,8) dt,vplayerid, sum(CostNum)*10.0 money,sum(LotteryRound) icnt from dwd_jordass_lotteryrecord_hi where tdbank_imp_date >= '2024032600' and tdbank_imp_date <= '2024052723' group by substr(tdbank_imp_date,1,8),vplayerid\nunion all\n限定抽取：select '限定抽取' itype,substr(tdbank_imp_date,1,8) dt,vplayerid, sum(CostNum)*10.0 CostNum,count(*) icnt from dwd_jordass_lotterylog_twostage_hi where tdbank_imp_date >= '2024032600' and tdbank_imp_date <= '2024052723' group by substr(tdbank_imp_date,1,8),vplayerid\n且只统计属于商业化类型的用户数据\n\n",
    "output": "",
    "category": "用户分群",
    "category_reason": "问题关注将玩家按行为特征（回流/新进）进行分类，并统计各类别的关键指标。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"用户分群\",\n  \"rationale\": \"问题关注将玩家按行为特征（回流/新进）进行分类，并统计各类别的关键指标。\"\n}"
  },
  {
    "question_id": "sql_101",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计日(2024.9.2,2024.9.3,2025.9.8,2025.9.9) 全平台活跃用户的本赛季最高段位等信息\n输出：统计日，本赛季最高段位，活跃用户数，统计日参与主题群屿玩法用户数，参与率\n\n【数据库schema】\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT '统计日期格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `mode` BIGINT COMMENT '模式ID',\n  `modename` TEXT COMMENT '模式名称',\n  `submode` BIGINT COMMENT '子模式ID',\n  `submodename` TEXT COMMENT '子模式名称',\n  `map` BIGINT COMMENT '地图ID',\n  `mapname` TEXT COMMENT '地图名称',\n  `seasonid` BIGINT COMMENT '赛季ID',\n  `seasonname` TEXT COMMENT '赛季名称',\n  `roundcnt` BIGINT COMMENT '当日对局数',\n  `roundtime` BIGINT COMMENT '当日对局时长(秒)',\n  `survivaltime` BIGINT COMMENT '当日存活时长(秒)',\n  `firstroundtime` TEXT COMMENT '当日首次对局时间',\n  `device_type` BIGINT COMMENT '设备类型'\n);\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\nCREATE TABLE `dwd_jordass_playerlogin_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `level` BIGINT COMMENT '等级',\n  `playerfriendsnum` BIGINT COMMENT '玩家好友数量',\n  `clientversion` TEXT COMMENT '客户端版本',\n  `screenwidth` BIGINT COMMENT '显示屏宽度',\n  `screenhight` BIGINT COMMENT '显示屏高度',\n  `density` TEXT COMMENT '像素密度',\n  `loginchannel` BIGINT COMMENT '登录渠道',\n  `vroleid` TEXT COMMENT '玩家角色ID',\n  `vrolename` TEXT COMMENT '玩家角色名',\n  `deviceid` TEXT COMMENT '设备ID',\n  `device_type` BIGINT COMMENT '设备类型0为手机,1为模拟器, 2键鼠, 3手柄, 5是PC客户端,也是高清模拟器。',\n  `gender` BIGINT COMMENT '平台性别，1是男，2是女',\n  `emulatorname` TEXT COMMENT '模拟器名',\n  `warzoneid` BIGINT COMMENT '战区ID',\n  `devicename` TEXT COMMENT '客户端devicename',\n  `historymaxsegment` BIGINT COMMENT '历史最高段位',\n  `seasonmaxsegment` BIGINT COMMENT '本赛季最高段位',\n  `firstlogincg` BIGINT COMMENT '第一次登录CG游戏的时间，即CG注册时间，UNIX时间戳',\n  `lobbybgid` BIGINT COMMENT '当前设置的大厅背景resid',\n  `signature` TEXT COMMENT '个性签名',\n  `devicelevel` BIGINT COMMENT '机型档位',\n  `iswxrealname` BIGINT COMMENT '非微信平台或还没拉取数据填0，已微信实名填1，未实名填2',\n  `iswxlowlv` BIGINT COMMENT '非微信平台或还没拉取数据填0，是微信小号填1，不是微信小号填2',\n  `iszombie` BIGINT COMMENT '非微信平台或还没拉取数据填0，是微信僵尸号填1，不是微信僵尸号填2',\n  `topsegtimes` BIGINT COMMENT '王牌印记: -2 首次达到星钻 -1 首次达到王冠  0 无数据 >0 历史王牌次数',\n  `clanid1` BIGINT COMMENT '战队ID1',\n  `clanid2` BIGINT COMMENT '战队ID2',\n  `clanid3` BIGINT COMMENT '战队ID3',\n  `fpslevel` BIGINT COMMENT '帧率等级',\n  `renderqualityapply` BIGINT COMMENT '画质等级',\n  `devicetcqualitygrade` BIGINT COMMENT '机型等级',\n  `relogin` BIGINT COMMENT '是否是断线重连登录的,1为断线重连，0为从登录界面登录',\n  `gameid` TEXT COMMENT '当前正在游戏的对局id',\n  `startime` BIGINT COMMENT '当前正在游戏的对局id',\n  `rolesettingstr` TEXT COMMENT 'RoleSetting设置, 当为空字符串时表示该字段获取异常,否则为以+分隔的rolesetting值，具体字段值咨询开发',\n  `creditscore` TEXT COMMENT '信誉分',\n  `usenewpickup` BIGINT COMMENT '是否使用新版拾取',\n  `isqrlogin` BIGINT COMMENT '是否为扫码登录的,1是扫码登录，0非扫描登录',\n  `is_gamematrix` BIGINT COMMENT '是否为先锋云游，1是，0不是',\n  `clientsceneversion` TEXT COMMENT '客户端场景版本',\n  `whitetype` BIGINT COMMENT '进入服务器的凭证类型',\n  `mobiletablettype` BIGINT COMMENT '平板识别结果：-1结果未出，0是非平板，1已验证是平板，2可能是平板',\n  `behaviorlevel` BIGINT COMMENT '行为分等级',\n  `clientostype` TEXT COMMENT '客户端系统类型：and ios win hm',\n  `pclogintype` BIGINT COMMENT '0=默认类型，1=PC新手玩家，2=PC回流玩家',\n  `escapecoincount` TEXT COMMENT '隧道收益(该字段原来搞错了, 之前以为是隧道币数量)',\n  `vsteamlevel` BIGINT COMMENT '组竞等级',\n  `connectidx` BIGINT COMMENT '连接序号',\n  `isinds` BIGINT COMMENT '当前登录是否在ds场景中重连'\n);\n\n【参考信息】\n主题群屿玩法：modename='传统模式' and submodename like 'CG%'\n段位分布：case when substr(seasonmaxsegment, 1, 1) = '1' then '青铜'\n                          when substr(seasonmaxsegment, 1, 1) = '2' then '白银'\n                          when substr(seasonmaxsegment, 1, 1) = '3' then '黄金'\n                          when substr(seasonmaxsegment, 1, 1) = '4' then '铂金'\n                          when substr(seasonmaxsegment, 1, 1) = '5' then '星钻'\n                          when substr(seasonmaxsegment, 1, 1) = '6' then '王冠'\n                          when substr(seasonmaxsegment, 1, 1) >= '7' then '王牌'\n                          else '无段位'\n\t            end\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注特定日期全平台活跃用户的段位分布情况，属于用户活跃度在时间与平台维度上的分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注特定日期全平台活跃用户的段位分布情况，属于用户活跃度在时间与平台维度上的分析。\"\n}"
  },
  {
    "question_id": "sql_103",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2025.9.1到9.10每天productid的参与直购购买人数，直购购买金额以及数量，当天注册人数\n输出：统计日期(yyyymmdd),productid,直购购买人数,直购购买金额,直购购买数量\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_df` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:不区分平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '登录位图',\n  `dregdate` TEXT COMMENT '注册日期，格式YYYYMMDD',\n  `ilevel` BIGINT COMMENT '等级',\n  `friendcount` BIGINT COMMENT '好友数量'\n);\nCREATE TABLE `dwd_jordass_directpaycommflow_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID，操作人',\n  `orderid` TEXT COMMENT '订单号',\n  `productid` TEXT COMMENT 'productid',\n  `goodsnum` BIGINT COMMENT '商品数量',\n  `money` BIGINT COMMENT '商品对应消耗货币数量',\n  `op` TEXT COMMENT '操作步骤',\n  `opres` TEXT COMMENT '操作步骤结果',\n  `midasbillno` TEXT COMMENT 'midas订单号'\n);\n\n【参考信息】\nproductid的参与直购：op='take' and opres='ok'\n\tand productid in ('package_6','package_18','outfit_pack','weapon_pack')\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注每日不同产品ID的购买人数、金额及注册人数，属于按时间与产品维度的活跃度分布统计。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注每日不同产品ID的购买人数、金额及注册人数，属于按时间与产品维度的活跃度分布统计。\"\n}"
  },
  {
    "question_id": "sql_105",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20240101-20250601全平台每天充值金额数和消耗金币数\n输出：统计日期(yyyymmdd)，充值金额数，消耗金币数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_water_di` (\n  `dtstatdate` TEXT COMMENT '分区，付费日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android,255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `iamount` BIGINT COMMENT '代币金额(Q分)',\n  `itimes` BIGINT COMMENT '流水次数',\n  `imoney` DOUBLE COMMENT '除100为实际支付人民币金额'\n);\nCREATE TABLE `dwd_jordass_currencylog_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间,格式YY',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填',\n  `vplayerid` TEXT COMMENT '玩家id',\n  `uid` TEXT COMMENT '玩家UID',\n  `sequence` BIGINT COMMENT '用于关联一次动作产生多条不同类型的货币流动日志',\n  `level` BIGINT COMMENT '玩家等级',\n  `allianceforcetermoney` BIGINT COMMENT '动作后的金钱数',\n  `imoney` BIGINT COMMENT '动作涉及的金钱数',\n  `reason` BIGINT COMMENT '货币流动一级原因',\n  `subreason` BIGINT COMMENT '货币流动二级原因',\n  `addorreduce` BIGINT COMMENT '增加 0/减少 1',\n  `imoneytype` BIGINT COMMENT '枚举值(0:金币;1:点券;2:服饰币;4:物资币;6:荣耀勋章;1026:组竞币;1027:幸运币)',\n  `device_type` BIGINT COMMENT '设备类型0为手机,1为模拟器, 2键鼠, 3手柄, 5是PC客户端,也是高清模拟器。'\n);\n\n【参考信息】\n消耗金币：AddOrReduce=1 and imoneytype=1\n 充值和消耗金币都直接使用imoney\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注每日充值金额和消耗金币数，属于按时间维度观察用户活跃或消费行为的分布情况。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注每日充值金额和消耗金币数，属于按时间维度观察用户活跃或消费行为的分布情况。\"\n}"
  },
  {
    "question_id": "sql_107",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2022.1.18-1.24与2021.10.19-12.20这两个时间段\n buttontype =99123并且 ireason=3的人数，以及两个时间段都满足条件的交叉人数\n输出：2022.1.18-1.24人数，2021.10.19-12.20人数，两个时间段交叉的人数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_activitypress_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间,格式YYYY-MM-DDHH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '玩家',\n  `uid` TEXT COMMENT '角色UID',\n  `buttontype` BIGINT COMMENT '按钮代号,找客户端开发问下定义',\n  `ireason` BIGINT COMMENT '活动id',\n  `extarg1` BIGINT COMMENT '附加参数1,客户端负责传过来',\n  `extarg2` TEXT COMMENT '附加参数2,客户端负责传过来',\n  `extarg3` BIGINT COMMENT '附加参数3,客户端负责传过来',\n  `devicetype` BIGINT COMMENT 'DeviceType'\n);\n\n【参考信息】\n\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注特定条件下用户行为的时间分布及交叉情况。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注特定条件下用户行为的时间分布及交叉情况。\"\n}"
  },
  {
    "question_id": "sql_108",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2025.4月24日，全平台周流失 +  双周流失 +月流失 包 + 近30天登陆小于3天的低活跃号码包\n输出：类型（iweek，doubleiweek，imonth，30dayxioayu3day）、QQ 号\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_df` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:不区分平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '登录位图',\n  `dregdate` TEXT COMMENT '注册日期，格式YYYYMMDD',\n  `ilevel` BIGINT COMMENT '等级',\n  `friendcount` BIGINT COMMENT '好友数量'\n);\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\nCREATE TABLE `dim_mgamejp_tbplayerid2qq_nf` (\n  `dtstatdate` BIGINT COMMENT '统计日期YYYYMMDD',\n  `sappid` TEXT COMMENT '游戏id',\n  `splayerid` TEXT COMMENT 'playerid',\n  `iqq` BIGINT COMMENT 'QQ帐号'\n);\n\n【参考信息】\n\n\n",
    "output": "",
    "category": "用户分群",
    "category_reason": "问题旨在识别特定时间范围内不同流失程度及活跃度的用户群体。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"用户分群\",\n  \"rationale\": \"问题旨在识别特定时间范围内不同流失程度及活跃度的用户群体。\"\n}"
  },
  {
    "question_id": "sql_109",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计 20250424-20250508 期间 传统和休闲的胜利情况\n\n 胜利数分布层次：1,2-10,11-20,21-50,51-80,81-100，101-200,201-500,501以上\n 输出：胜利数分布层次，人数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_roundlog_funnymode_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '玩家',\n  `uid` TEXT COMMENT '玩家UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `mode` BIGINT COMMENT '模式',\n  `submode` BIGINT COMMENT '子模式',\n  `startime` BIGINT COMMENT '开局时刻',\n  `escapecheckup` BIGINT COMMENT '是否逃跑',\n  `currentroundrank` BIGINT COMMENT '当局名次,广域战场模式是本阵营中的排名',\n  `sumscore` BIGINT COMMENT '流水总评分',\n  `titleidlist` TEXT COMMENT '当局获得的称号Id',\n  `teamrank` BIGINT COMMENT '队伍名次',\n  `teamid` BIGINT COMMENT '小队ID',\n  `flowratinglevel` TEXT COMMENT '当局游戏的评价等级，前面有个Int类型的，但是非要求加一个字符串类型的',\n  `roundtime` BIGINT COMMENT '对局时长(秒)',\n  `gold` BIGINT COMMENT '金钱变化值',\n  `level` BIGINT COMMENT '等级变化值',\n  `map` BIGINT COMMENT '地图',\n  `playernumber` BIGINT COMMENT '玩家数',\n  `realplayernumber` BIGINT COMMENT '真人玩家数',\n  `teamnumber` BIGINT COMMENT '小队数',\n  `teammemberlist` TEXT COMMENT '队友List',\n  `killingcount` BIGINT COMMENT '击杀',\n  `assistcount` BIGINT COMMENT '助攻次数',\n  `survivaltime` BIGINT COMMENT '存活总时间',\n  `damageamount` BIGINT COMMENT '总伤害量,浮点数，乘以100存入',\n  `healtimes` BIGINT COMMENT '救人次数',\n  `healamount` BIGINT COMMENT '治疗量，浮点数，乘以100存入',\n  `movingdistance` BIGINT COMMENT '前进距离',\n  `deadflow` TEXT COMMENT '死亡流水 死亡坐标/死亡类型/死亡时间',\n  `headshotcounts` BIGINT COMMENT '爆头数',\n  `vehicledestoryedtimes` BIGINT COMMENT '摧毁载具次数',\n  `killingflow` TEXT COMMENT '击杀流水 :击杀目标ID\\t击杀类型\\t是否爆头\\t击杀距离\\t使用的武器ID\\t击杀者（角色自己）位置  新增：\\t被击杀者位置\\t击杀时间（从进入小岛开始到击杀时的毫秒数）\\t造成伤害量\\t是否移动\\t击杀区域ID(-1表示区域表中不记录)\\t状态(1:卧倒)\\t被击倒的武器id\\t击杀圈数\\t被击杀者名字\\t是否灭队\\t是否为ai\\tAI的类型\\t击倒者uid\\t击杀者uid',\n  `walkingdistance` BIGINT COMMENT '步行距离',\n  `collectindex` BIGINT COMMENT '物资指数，浮点数，乘以100存入',\n  `survivalindex` BIGINT COMMENT '生存指数，浮点数，乘以100存入',\n  `damageindex` BIGINT COMMENT '伤害指数，浮点数，乘以100存入',\n  `healindex` BIGINT COMMENT '支援指数，浮点数，乘以100存入',\n  `assaultindex` BIGINT COMMENT '战斗指数，浮点数，乘以100存入',\n  `gunhittimes` BIGINT COMMENT '枪械命中次数',\n  `gunshottimes` BIGINT COMMENT '枪械射击次数',\n  `curecount` BIGINT COMMENT '治疗次数',\n  `landlocation` TEXT COMMENT '落地点坐标,有效字段',\n  `oweruid` TEXT COMMENT '房主uid',\n  `ismvp` BIGINT COMMENT '不是mvp 0/是mvp 1',\n  `pronetime` BIGINT COMMENT '趴地时间',\n  `drivingdistance` BIGINT COMMENT '行驶距离',\n  `obtianedairdroptimes` BIGINT COMMENT '获得空投次数',\n  `killeruid` TEXT COMMENT '击杀者UID',\n  `giveboxnum` BIGINT COMMENT '年兽模式给宝箱个数,ug字段，兼容保留',\n  `deadnum` BIGINT COMMENT '年兽模式死亡次数,ug字段，兼容保留',\n  `result` TEXT COMMENT 'Reason字段，广域战场模式：胜利Win，失败Fail。年兽模式：击败年兽win 全部人员死亡dead 打年兽超时timeout,ug字段，兼容保留',\n  `lobbyteamid` TEXT COMMENT '大厅队伍id',\n  `topxtipsresponse` BIGINT COMMENT '未进入前5:-1;不点击:0;继续战斗:1;退出竞赛:2',\n  `signalhealamount` BIGINT COMMENT '信号治疗量',\n  `monsterkilltotalnum` BIGINT COMMENT '总击杀僵尸数量',\n  `zombiekillingflow` TEXT COMMENT '僵尸击杀流水 僵尸id\\t击杀数量\\t是否爆头击杀\\t击杀类型\\t击杀武器id',\n  `monsterdamageamount` BIGINT COMMENT '总对僵尸伤害',\n  `drivinghelicoptertime` BIGINT COMMENT '驾驶直升飞机时间',\n  `inhelicoptertime` BIGINT COMMENT '乘坐直升飞机时间',\n  `makefiresnum` BIGINT COMMENT '生火成功次数,极寒模式',\n  `friendcount` BIGINT COMMENT '队友中的好友数量',\n  `teammemberrelalist` TEXT COMMENT '与TeamMemberList相对应，与其他队员之间的好友关系（0非好友，1平台好友，2为游戏好友）拼接，多个好友之间用+拼接。例如1+2+2',\n  `teammembersexlist` TEXT COMMENT '与TeamMemberList相对应，其他队员的性别拼接（1表示男，2表示女），多个好友之间用+拼接。例如1+2+2',\n  `maxhurtweaponid` BIGINT COMMENT '最大伤害的武器ID',\n  `maxdamage` BIGINT COMMENT '武器的最大伤害',\n  `pointsurvivalseconds` BIGINT COMMENT '据点内存活时间',\n  `useweaponlist` TEXT COMMENT '击杀所用武器的列表, 用,拼接。例如1,2,2',\n  `teammembertmrelalist` TEXT COMMENT '与TeamMemberList相对应，与其他队员之间的默契好友关系（1是0非）拼接，多个好友之间用+拼接。例如1+0+1',\n  `playid` BIGINT COMMENT '限时模式的玩法id,非限时模式则为0',\n  `campid` BIGINT COMMENT '广域战场阵营id，进攻方1，防守方2',\n  `score` BIGINT COMMENT '广域战场获得积分',\n  `professioncareerinfo` TEXT COMMENT '广域战场每个职业的总积分/总时间及经验获取list 职业id:获得积分,使用时间,获得经验 + 职业id:获得积分,使用时间,获得经验',\n  `device_type` BIGINT COMMENT '设备类型0为手机 1为模拟器 2 键鼠 3 手柄',\n  `deploymaxkills` BIGINT COMMENT '广域战场单局单次部署最大击杀',\n  `gamenum` BIGINT COMMENT '广域战场模式对局数',\n  `bigwarrating` BIGINT COMMENT '广域战场模式积分,这局前',\n  `bigwarchangerating` BIGINT COMMENT '广域战场模式积分这局的变化值',\n  `destroyvehicleweaponlist` TEXT COMMENT '摧毁载具武器列表，载具ID:武器ID+载具ID:武器ID'\n);\nCREATE TABLE `dwd_jordass_roundflow_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `gamesvrid` TEXT COMMENT '登录的游戏服务器编号',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '玩家',\n  `uid` TEXT COMMENT '玩家UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `battletype` BIGINT COMMENT '战斗类型对应BATTLETYPE,其它说明参考FAQ文档',\n  `roundscore` BIGINT COMMENT '本局分数,无得分的填0',\n  `roundtime` BIGINT COMMENT '对局时长(秒)',\n  `result` BIGINT COMMENT '单局结果，参考 Result',\n  `gold` BIGINT COMMENT '金钱变化值',\n  `level` BIGINT COMMENT '等级变化值',\n  `seasonid` BIGINT COMMENT '所属赛季ID',\n  `mode` BIGINT COMMENT '101：传统模式第三人称单排\t102：传统模式第三人称双排\t103：传统模式第三人称四排\t401：传统模式第一人称单排\t402：传统模式第一人称双排\t403：传统模式第一人称四排\t603：创意创作间计分模式第三人称四排(含极能形态模式、极限追猎、特种作战等子模式)',\n  `submode` BIGINT COMMENT '子模式',\n  `map` BIGINT COMMENT '地图',\n  `weather` BIGINT COMMENT '天气',\n  `startime` BIGINT COMMENT '开局时刻',\n  `endtime` BIGINT COMMENT '结束时刻',\n  `playernumber` BIGINT COMMENT '玩家数',\n  `realplayernumber` BIGINT COMMENT '真人玩家数',\n  `teamnumber` BIGINT COMMENT '小队数',\n  `teammemberlist` TEXT COMMENT '队友id解析字段teammemberlist步骤：\t使用lateral VIEW explode(split(teammemberlist,\\\\+)) adTable AS buttontype 函数通过 \"\\\\+\"截取进行行转列进行计算。',\n  `escapecheckup` BIGINT COMMENT '是否逃跑',\n  `totalchangedpointvalue` BIGINT COMMENT '综合积分变化值',\n  `changedratingvalue` BIGINT COMMENT 'rating分变化值',\n  `ratingvalueallianceforceterchanged` BIGINT COMMENT 'rating分变化后的值',\n  `changedkillratingvalue` BIGINT COMMENT 'kill rating分变化值',\n  `killratingvalueallianceforceterchanged` BIGINT COMMENT 'kill rating分变化后的值',\n  `changedwinratingvalue` BIGINT COMMENT 'win rating分变化值',\n  `winratingvalueallianceforceterchanged` BIGINT COMMENT 'win rating分变化后的值',\n  `playergetexperience` BIGINT COMMENT '玩家获得的经验值',\n  `currentroundrank` BIGINT COMMENT '当局名次',\n  `killingcount` BIGINT COMMENT '击杀',\n  `assistcount` BIGINT COMMENT '助攻次数',\n  `survivaltime` BIGINT COMMENT '存活总时间(秒)',\n  `damageamount` BIGINT COMMENT '总伤害量,浮点数，乘以100存入',\n  `healtimes` BIGINT COMMENT '救人次数',\n  `healamount` BIGINT COMMENT '治疗量，浮点数，乘以100存入',\n  `movingdistance` BIGINT COMMENT '前进距离，单位米',\n  `dyingflow` TEXT COMMENT '濒死流水，暂无',\n  `deadflow` TEXT COMMENT '死亡流水 死亡坐标/死亡类型/死亡时间',\n  `headshotcounts` BIGINT COMMENT '爆头数',\n  `gunkillingtimes` BIGINT COMMENT '枪械击杀数，暂无',\n  `meleekilltimes` BIGINT COMMENT '近战击杀数，暂无',\n  `rangeddamagedamount` BIGINT COMMENT '远程武器伤害量，暂无',\n  `meleedamageamount` BIGINT COMMENT '近战伤害量，暂无',\n  `obtianeditemflow` BIGINT COMMENT '获得的物品流水，暂无',\n  `obtianedairdroptimes` BIGINT COMMENT '获得空投次数',\n  `vehicledestoryedtimes` BIGINT COMMENT '摧毁载具次数',\n  `landingcoordinate` BIGINT COMMENT '落地点坐标,弃用，之前定义的类型是int，应该是字符串',\n  `killingflow` TEXT COMMENT '击杀流水 :击杀目标ID\\t击杀类型\\t是否爆头\\t击杀距离\\t使用的武器ID\\t击杀者（角色自己）位置  新增：\\t被击杀者位置\\t击杀时间（从进入小岛开始到击杀时的毫秒数）\\t造成伤害量\\t是否移动\\t击杀区域ID(-1表示区域表中不记录)\\t状态(1:卧倒)\\t被击倒的武器id\\t击杀圈数\\t被击杀者名字\\t是否灭队\\t是否为ai\\tAI的类型\\t击倒者uid\\t击杀者uid',\n  `creepingtime` BIGINT COMMENT '匍匐时间',\n  `swimmingtime` BIGINT COMMENT '游泳时间，暂无',\n  `divingtime` BIGINT COMMENT '潜水时间，暂无',\n  `drivingtime` BIGINT COMMENT '驾驶载具时间',\n  `ridingtime` BIGINT COMMENT '乘坐载具时间，暂无',\n  `walkingdistance` BIGINT COMMENT '步行距离，单位米',\n  `staytimeinpoisonedarea` BIGINT COMMENT '吃毒时间',\n  `damageindex` BIGINT COMMENT '击杀指数,乘100后四舍五入',\n  `luckyindex` BIGINT COMMENT '幸运指数，弃用无效',\n  `collectindex` BIGINT COMMENT '物资指数,乘100后四舍五入',\n  `survivalindex` BIGINT COMMENT '生存指数,乘100后四舍五入',\n  `movingindex` BIGINT COMMENT '前进指数，弃用无效',\n  `creepindex` BIGINT COMMENT '伏地指数，弃用无效',\n  `accuracyindex` BIGINT COMMENT '精准指数，弃用无效',\n  `deliveryindex` BIGINT COMMENT '快递指数，弃用无效',\n  `sneakattackindex` BIGINT COMMENT '偷袭指数，弃用无效',\n  `healindex` BIGINT COMMENT '支援指数,乘100后四舍五入',\n  `boxindex` BIGINT COMMENT '盒子指数，弃用无效',\n  `assaultindex` BIGINT COMMENT '伤害指数,乘100后四舍五入',\n  `totalpoint` BIGINT COMMENT '综合积分变化后的值',\n  `ratinglevel` BIGINT COMMENT '流水评价等级',\n  `titleidlist` TEXT COMMENT '当局获得的称号Id',\n  `itemuseflow` TEXT COMMENT '装备的物品流水',\n  `medicineuseflow` TEXT COMMENT '使用的药品流水',\n  `gunhittimes` BIGINT COMMENT '枪械命中次数',\n  `gunshottimes` BIGINT COMMENT '枪械射击次数',\n  `teamrank` BIGINT COMMENT '队伍名次',\n  `curecount` BIGINT COMMENT '治疗次数',\n  `drivingdistance` BIGINT COMMENT '行驶距离，单位米',\n  `totalscorerank` BIGINT COMMENT '综合评分排名，弃用无效',\n  `rating` BIGINT COMMENT '鸡分',\n  `killrating` BIGINT COMMENT '消灭鸡分',\n  `winrating` BIGINT COMMENT '排名鸡分',\n  `ratingrank` BIGINT COMMENT '鸡分排名，弃用无效',\n  `killingratingrank` BIGINT COMMENT '消灭鸡分排名，弃用无效',\n  `winratingrank` BIGINT COMMENT '排名鸡分排名，弃用无效',\n  `totalround` BIGINT COMMENT '赛季分人称几排总场数',\n  `totalkill` BIGINT COMMENT '赛季分人称几排总杀敌数',\n  `totalwin` BIGINT COMMENT '赛季分人称几排总胜利数',\n  `top10times` BIGINT COMMENT '前十数',\n  `totalheadshotrate` BIGINT COMMENT '赛季分人称几排总爆头率',\n  `averagesurvivaltimeperround` BIGINT COMMENT '场均存活时间',\n  `healfriendtimes` BIGINT COMMENT '救助队友次数',\n  `averagemovedistanceperround` BIGINT COMMENT '场均移动距离',\n  `maxdamageinoneround` BIGINT COMMENT '单局最高伤害',\n  `maxkillinginoneround` BIGINT COMMENT '单局最高击杀',\n  `maxsurvivaltime` BIGINT COMMENT '最长存活时间',\n  `maxmovingdistance` BIGINT COMMENT '最长移动距离',\n  `contributionrankrating` BIGINT COMMENT '单排总积分贡献分',\n  `contributionkillrating` BIGINT COMMENT '单排击败积分贡献分',\n  `contributionwinrating` BIGINT COMMENT '单排生存积分贡献分',\n  `oldsegmentlevel` BIGINT COMMENT '旧段位',\n  `newsegmentlevel` BIGINT COMMENT '新段位',\n  `teamid` BIGINT COMMENT '小队ID',\n  `landlocation` TEXT COMMENT '落地点坐标,有效字段,单位cm',\n  `totaldeadtimes` BIGINT COMMENT '赛季分人称几排总死亡数',\n  `sumscore` BIGINT COMMENT '流水总评分，乘以100后存入',\n  `seasonsurvivalindex` BIGINT COMMENT '赛季参赛指数',\n  `seasontop1index` BIGINT COMMENT '赛季获胜率指数',\n  `seasonratingindex` BIGINT COMMENT '赛季总积分指数',\n  `seasonassaultindex` BIGINT COMMENT '赛季竞赛指数',\n  `seasonhealindex` BIGINT COMMENT '赛季支援指数',\n  `seasonmovingindex` BIGINT COMMENT '赛季前进指数',\n  `seasonsumscore` BIGINT COMMENT '赛季总评分，乘以100后存入',\n  `seasonratinglevel` BIGINT COMMENT '赛季评价等级',\n  `modesurvivalindex` BIGINT COMMENT '当前模式参赛指数',\n  `modetop1index` BIGINT COMMENT '当前模式获胜率指数',\n  `moderatingindex` BIGINT COMMENT '当前模式总积分指数',\n  `modeassaultindex` BIGINT COMMENT '当前模式竞赛指数',\n  `modehealindex` BIGINT COMMENT '当前模式支援指数',\n  `modemovingindex` BIGINT COMMENT '当前模式前进指数',\n  `modesumscore` BIGINT COMMENT '当前模式总评分，乘以100后存入',\n  `moderatinglevel` BIGINT COMMENT '当前模式评价等级',\n  `flowratinglevel` TEXT COMMENT '当局游戏的评价等级，前面有个Int类型的，但是非要求加一个字符串类型的',\n  `rolename` TEXT COMMENT '玩家角色名',\n  `totaldamage` BIGINT COMMENT '赛季分人称几排总伤害量',\n  `totalheal` BIGINT COMMENT '赛季分人称几排总治疗量',\n  `matchtype` BIGINT COMMENT '匹配模式0：手机 1模拟器 8小黑屋 9新手局',\n  `duocontributionrankrating` BIGINT COMMENT '双人总积分贡献分',\n  `duocontributionkillrating` BIGINT COMMENT '双人击败积分贡献分',\n  `duocontributionwinrating` BIGINT COMMENT '双人生存积分贡献分',\n  `squadcontributionrankrating` BIGINT COMMENT '四人总积分贡献分',\n  `squadcontributionkillrating` BIGINT COMMENT '四人击败积分贡献分',\n  `squadcontributionwinrating` BIGINT COMMENT '四人生存积分贡献分',\n  `famousid` BIGINT COMMENT '名人名言tips ID',\n  `dsendtime` TEXT COMMENT '新结束时间字段，ds传过来的字符串',\n  `equipmentinfo` TEXT COMMENT '装备信息:头盔ID\\t防弹衣ID\\t背包ID\\t主武器1ID\\t主武器1配件ID列表(以,分隔)\\t主武器2ID\\t主武器2配件ID列表(以,分隔)\\t副武器ID\\t副武器配件ID列表(以,分隔)\\t近战武器ID\\t投掷武器ID\\t是否佩戴吉利服',\n  `segmentprotect` BIGINT COMMENT '段位保护标记，1为触发了该段位的段位保护，0为没有触发',\n  `ismvp` BIGINT COMMENT '不是mvp 0/是mvp 1',\n  `pronetime` BIGINT COMMENT '趴地时间',\n  `followstate` BIGINT COMMENT '跳伞跟随  0不跟随，也不被跟随；1是被跟随；2是跟随',\n  `touchdownareaid` BIGINT COMMENT '降落地点类型, 参见赛季任务降落地点类型表',\n  `getpropsnumfromteammates` BIGINT COMMENT '接受队友道具数',\n  `sendpropsnumtoteammates` BIGINT COMMENT '赠送队友道具数',\n  `starttorescuetimes` BIGINT COMMENT '开始救援次数',\n  `avatargamegender` BIGINT COMMENT 'Avatar性别',\n  `avatarhairid` BIGINT COMMENT 'Avatar发型',\n  `avatarheadid` BIGINT COMMENT 'Avatar脸型',\n  `avatarfeaturenum` BIGINT COMMENT 'Avatar时装个数',\n  `avatarfeaturelist_1` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_2` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_3` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_4` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_5` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_6` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_7` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_8` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_9` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_10` BIGINT COMMENT 'Avatar时装',\n  `avatarweaponid` BIGINT COMMENT 'Avatar枪械',\n  `avatarweaponskinid` BIGINT COMMENT 'Avatar枪械皮肤',\n  `killeruid` TEXT COMMENT '击杀者UID',\n  `killerweaponid` BIGINT COMMENT '击杀者使用武器ID',\n  `killerdistance` BIGINT COMMENT '击杀者距离',\n  `lobbyteamid` TEXT COMMENT '大厅队伍id,ug字段，兼容保留',\n  `makefiresnum` BIGINT COMMENT '生火成功次数,极寒模式',\n  `isregress` BIGINT COMMENT '是否回流',\n  `topxtipsresponse` BIGINT COMMENT '未进入前5:-1;不点击:0;继续战斗:1;退出竞赛:2',\n  `signalhealamount` BIGINT COMMENT '信号治疗量',\n  `drivinghelicoptertime` BIGINT COMMENT '驾驶直升飞机时间',\n  `inhelicoptertime` BIGINT COMMENT '乘坐直升飞机时间',\n  `noreductratingscore` BIGINT COMMENT '是否触发了不掉分活动',\n  `changedtrueratingvalue` BIGINT COMMENT 'true rating分变化值',\n  `trueratingvalueallianceforceterchanged` BIGINT COMMENT 'true rating分变化后的值',\n  `teammemberrelalist` TEXT COMMENT '与TeamMemberList相对应，与其他队员之间的好友关系（0非好友，1平台好友，2为游戏好友）拼接，多个好友之间用+拼接。例如1+2+2',\n  `teammembersexlist` TEXT COMMENT '与TeamMemberList相对应，其他队员的性别拼接（1表示男，2表示女），多个好友之间用+拼接。例如1+2+2',\n  `friendcount` BIGINT COMMENT '队友中的好友数量',\n  `maxhurtweaponid` BIGINT COMMENT '最大伤害的武器ID',\n  `maxdamage` BIGINT COMMENT '武器的最大伤害',\n  `allianceforceterlevel` BIGINT COMMENT '结算后等级',\n  `isobexit` BIGINT COMMENT '是否观战退出',\n  `noreductrating` BIGINT COMMENT '是否触发不掉分活动',\n  `extraaddrating` BIGINT COMMENT '是否触发首战加分活动',\n  `protectrating` BIGINT COMMENT '是否触发保分机制',\n  `doublescore` BIGINT COMMENT '是否触发双倍上分活动',\n  `fateaddscore` BIGINT COMMENT '是否触发缘分队友加分活动',\n  `isnewaistrategy` BIGINT COMMENT '是否新的AI策略',\n  `lobbymemberlist` TEXT COMMENT '大厅组队队友列表',\n  `ratingtype` BIGINT COMMENT '计算的排位积分类型',\n  `killername` TEXT COMMENT '击杀我的人的名字',\n  `changekd` BIGINT COMMENT '当局结算引起的KD变化值，乘100后存入',\n  `friendteamaddscore` BIGINT COMMENT '是否触发好友四排组队加分活动',\n  `xuanwunoreductrating` BIGINT COMMENT '是否触发玄武不掉分活动',\n  `gunmateriallist` TEXT COMMENT '枪匠模式对局带出的改装件',\n  `bountynum` BIGINT COMMENT '枪匠模式的赏金数量',\n  `evacuatetype` BIGINT COMMENT '枪匠模式的逃脱类型。0 没有逃脱，1 直升机， 2 地堡， 3 的士',\n  `triggerrepeatkilllimit` BIGINT COMMENT '触发重复击杀限制',\n  `doublescoretimes` BIGINT COMMENT '是否触发双倍上分次数活动',\n  `teammembertmrelalist` TEXT COMMENT 'Avatar时装',\n  `device_type` BIGINT COMMENT '设备类型0为手机 1为模拟器 2 键鼠 3 手柄'\n);\n\n【参考信息】\n传统模式： mode in(101,102,103,401,402,403)\n 休闲：mode in(201,202,203,601,602,603) \n 胜利：teamrank =1\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是不同胜利数层级的用户分布情况，属于活跃度在胜利维度上的分布分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是不同胜利数层级的用户分布情况，属于活跃度在胜利维度上的分布分析。\"\n}"
  },
  {
    "question_id": "sql_110",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220413-20220421全平台每天活跃的次留，3留，7留情况（分活动和登录）\n输出：统计日期(yyyymmdd),活动人数，登录次留，登录3留，登录7留，活动次留，活动3留，活动7留\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\nCREATE TABLE `dwd_jordass_activity_rewardrecord_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `gamesvrid` TEXT COMMENT '登录的游戏服务器编号',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `actid` BIGINT COMMENT '活动id',\n  `acttype` BIGINT COMMENT '活动类型',\n  `awardidx` BIGINT COMMENT '第几挡奖励',\n  `awardcnt` BIGINT COMMENT '兑换几次 默认1次',\n  `value` BIGINT COMMENT '扩展字段(不同业务解释)',\n  `reissueflag` BIGINT COMMENT '活动补发字段，默认为0不补发，1为补发',\n  `cond1` BIGINT COMMENT '条件1值，任务大类型',\n  `cond2` BIGINT COMMENT '条件2值，任务子类型',\n  `cond3` BIGINT COMMENT '条件3值，任务条件值',\n  `device_type` BIGINT COMMENT '设备类型0为手机,1为模拟器, 2键鼠, 3手柄, 5是PC客户端,也是高清模拟器。'\n);\n\n【参考信息】\n活动:actid = 2201123904\n\n",
    "output": "",
    "category": "留存类",
    "category_reason": "问题关注的是特定时间段内用户登录后的次日、3日、7日留存情况，属于典型的留存分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注的是特定时间段内用户登录后的次日、3日、7日留存情况，属于典型的留存分析。\"\n}"
  },
  {
    "question_id": "sql_111",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425突变组竞2.0局内数据需求感染人类坐标热区（人类的坐标）  按天分布，重点关注\n类型包括：（变身速行战士，变身隐形战士，变身钩链战士，变身强能猎手，变身冰霜领主，变身强化战士，变身龙焰猎手）\n\n输出：统计日期(yyyymmdd)，类型，x,y,z,次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteaminfectlog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `roundid` BIGINT COMMENT '回合数',\n  `isescape` BIGINT COMMENT '是否逃跑',\n  `infectionscore` BIGINT COMMENT '回合总积分',\n  `infectionscoreasinfected` BIGINT COMMENT '突变者阵营积分',\n  `infectionscoreashuman` BIGINT COMMENT '人类阵营积分',\n  `infectlevelupbyitemtimes` BIGINT COMMENT '突变者强化升级次数',\n  `infectlevelupbykilltimes` BIGINT COMMENT '突变者淘汰升级次数',\n  `infecttimes` BIGINT COMMENT '回合感染人类数量',\n  `killsupermantimes` BIGINT COMMENT '回合击杀超级英雄数量',\n  `isadvancedinfected` BIGINT COMMENT '是否超级突变者（0，为成为超级突变者、1初始超级突变者、2进化为超级突变者）',\n  `revivaltimes` BIGINT COMMENT '复活次数',\n  `beensuperman` BIGINT COMMENT '是否升级为超级英雄（0，未成为超级英雄，1升级为超级突变者）',\n  `supermanleveluptimes` BIGINT COMMENT '超级战士升级次数',\n  `usesupplytimes` BIGINT COMMENT '弹药补给次数',\n  `damageoninfect` BIGINT COMMENT '回合对突变者造成伤害数',\n  `killadvancedinfectedtimes` BIGINT COMMENT '回合淘汰超级突变者数量',\n  `killinfectedtimes` BIGINT COMMENT '淘汰突变者次数',\n  `assisttimes` BIGINT COMMENT '助攻次数',\n  `killwithshootingtimes` BIGINT COMMENT '枪械击杀数',\n  `killwithmeleetimes` BIGINT COMMENT '近战击杀数',\n  `headshottimes` BIGINT COMMENT '爆头数',\n  `wincamp` BIGINT COMMENT '人类获胜：1，突变者胜利：2',\n  `usefortifiertimes` BIGINT COMMENT '回合拾取强化剂次数',\n  `changeposxhero` TEXT COMMENT '回合升级为超级英雄的X坐标',\n  `changeposyhero` TEXT COMMENT '回合升级为超级英雄的Y坐标',\n  `changeposzhero` TEXT COMMENT '回合升级为超级英雄的Z坐标',\n  `changetimehero` TEXT COMMENT '回合升级为超级英雄的时间点',\n  `changetypehero` BIGINT COMMENT '回合升级为超级英雄的类型',\n  `changeposxinfectman` TEXT COMMENT '回合变异为突变者的X坐标',\n  `changeposyinfectman` TEXT COMMENT '回合变异为突变者的Y坐标',\n  `changeposzinfectman` TEXT COMMENT '回合变异为突变者的Z坐标',\n  `changetimeinfectman` TEXT COMMENT '回合变异为突变者的时间点',\n  `changetypeinfectman` BIGINT COMMENT '回合变异为突变者的类型',\n  `changeposxsuperinfectman` TEXT COMMENT '回合变异为超级突变者的X坐标',\n  `changeposysuperinfectman` TEXT COMMENT '回合变异为超级突变者的Y坐标',\n  `changeposzsuperinfectman` TEXT COMMENT '回合变异为超级突变者的Z坐标',\n  `changetimesuperinfectman` TEXT COMMENT '回合变异为超级突变者的时间点',\n  `changetypesuperinfectman` BIGINT COMMENT '回合变异为超级突变者的类型',\n  `totalragehuman` BIGINT COMMENT '本回合获取怒气值总值（人类）',\n  `totalragesuperman` BIGINT COMMENT '本回合获取怒气值总值（强能猎手）',\n  `totalrageinfectedman` BIGINT COMMENT '本回合获取怒气值总值（普通突变者）',\n  `totalrageadvinfectedman` BIGINT COMMENT '本回合获取怒气值总值（高级突变者）',\n  `totalinfect02passiveskill` BIGINT COMMENT '本回合小紫皮—疾行技能使用次数',\n  `totalinfect01passiveskill` BIGINT COMMENT '本回合大紫皮—护盾技能使用次数',\n  `totalinfect01passiveskillcaldamage` TEXT COMMENT '本回合大紫皮—护盾技能吸收伤害总值',\n  `totalhookskilluse` BIGINT COMMENT '本回合狂爪——钩爪技能使用次数',\n  `totalhookcapture` BIGINT COMMENT '本回合狂爪——钩爪技能命中次数',\n  `totalhooktakedamage` TEXT COMMENT '本回合狂爪——本回合钩爪损失血量总值',\n  `totalhookbroken` BIGINT COMMENT '本回合狂爪——本回合钩爪被打坏次数',\n  `totalinvisibleskilluse` BIGINT COMMENT '本回合魅影——隐身技能使用次数',\n  `totalvisibletakedamage` TEXT COMMENT '本回合本回合魅影——本回合非隐身状态损失总血量',\n  `totalvisibletime` BIGINT COMMENT '本回合魅影——本回合非隐身状态身总时长',\n  `totalinvisibletakedamage` TEXT COMMENT '本回合魅影——本回合隐身状态损失总血量',\n  `totalinvisibletime` BIGINT COMMENT '本回合魅影——本回合隐身状态总时长',\n  `totalfrozengrenadeskilluse` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹使用次数',\n  `totalfronzengrenadeattackcount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹命中次数',\n  `totalfrozenplayercount` BIGINT COMMENT '本回合冰霜领主——冰霜炸弹冰冻玩家次数',\n  `totaldragonbreathskilluse` BIGINT COMMENT '本回合龙焰猎手——龙息弹使用次数',\n  `totaldragonbreathattackcount` BIGINT COMMENT '本回合龙焰猎手——龙息弹命中次数',\n  `totaldmghuman` TEXT COMMENT '本回合普通人类造成伤害总值',\n  `totaldmgdragonsuperman` TEXT COMMENT '本回合龙焰猎手造成伤害总值',\n  `totaldmgpowersuperman` TEXT COMMENT '本回合强能猎手造成伤害总值',\n  `totaldmgspeedinfected` TEXT COMMENT '本回合速行战士造成伤害总值--疾行',\n  `totaldmginvisinfected` TEXT COMMENT '本回合隐形战士造成伤害总值--魅影',\n  `totaldmghookinfected` TEXT COMMENT '本回合钩链战士造成伤害总值--狂爪',\n  `totaldmgpoweradvinfected` TEXT COMMENT '本回合强化战士造成伤害总值--强化',\n  `totaldmgfrozenadvinfected` TEXT COMMENT '本回合冰霜领主造成伤害总值--冰霜领主',\n  `SwiftMorphInfo` TEXT COMMENT '变身速行战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `StealthMorphInfo` TEXT COMMENT '变身隐形战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `GrappleMorphInfo` TEXT COMMENT '变身钩链战士：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `PowerAdvMorphInfo` TEXT COMMENT '变身强化战士（原大胖子）：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `IceAdvMorphInfo` TEXT COMMENT '变身冰霜领主：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `HeroMorphInfo` TEXT COMMENT '变身强能猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `DragonHeroMorphInfo` TEXT COMMENT '变身龙焰猎手：变身时间+变身类型+坐标x+坐标y+坐标z',\n  `fakerinfectedchangeinfo` TEXT COMMENT 'FakerInfectedChangeInfo',\n  `forgingironinfectedchangeinfo` TEXT COMMENT 'ForgingIronInfectedChangeInfo',\n  `enchantingbutterflyinfectedchangeinfo` TEXT COMMENT 'EnchantingButterflyInfectedChangeInfo',\n  `ironfistinfectedchangeinfo` TEXT COMMENT 'IronFistInfectedChangeInfo',\n  `phoenixsupermanchangeinfo` TEXT COMMENT 'PhoenixSupermanChangeInfo',\n  `titansupermanchangeinfo` TEXT COMMENT 'TitanSupermanChangeInfo',\n  `humanadditionevolution` TEXT COMMENT 'HumanAdditionEvolution',\n  `supermanadditionevolution` TEXT COMMENT 'SupermanAdditionEvolution',\n  `infectedmanadditionevolution` TEXT COMMENT 'InfectedManAdditionEvolution',\n  `humanadditionevolutionbyitemtimes` TEXT COMMENT 'HumanAdditionEvolutionByItemTimes',\n  `usehumanfortifiertimes` BIGINT COMMENT 'UseHumanFortifierTimes',\n  `totalfibuildboxcount` BIGINT COMMENT 'TotalFIBuildBoxCount',\n  `totalfiboxdestroyedcount` BIGINT COMMENT 'TotalFIBoxDestroyedCount',\n  `totalfakerdisguiseusecount` BIGINT COMMENT 'TotalFakerDisguiseUseCount',\n  `totalfakerdeadinhumanstate` BIGINT COMMENT 'TotalFakerDeadInHumanState',\n  `totalfakerdeadinmonsterstate` BIGINT COMMENT 'TotalFakerDeadInMonsterState',\n  `totalpowersupermanskilluse` BIGINT COMMENT 'TotalPowerSupermanSkillUse',\n  `totalpowersupermanhitcount` BIGINT COMMENT 'TotalPowerSupermanHitCount',\n  `totalpowersupermandamage` TEXT COMMENT 'TotalPowerSupermanDamage',\n  `totalphoenixfireringusecount` BIGINT COMMENT 'TotalPhoenixFireRingUseCount',\n  `totalphoenixfireringdamage` TEXT COMMENT 'TotalPhoenixFireRingDamage',\n  `totalphoenixfireringhealth` TEXT COMMENT 'TotalPhoenixFireRingHealth',\n  `totaltitanjumpsmathusecount` BIGINT COMMENT 'TotalTitanJumpSmathUseCount',\n  `totaltitanjumpsmathhitcount` BIGINT COMMENT 'TotalTitanJumpSmathHitCount',\n  `totaltitanjumpsmathdamage` TEXT COMMENT 'TotalTitanJumpSmathDamage',\n  `totalebskilluse` BIGINT COMMENT 'TotalEBSkillUse',\n  `totalebhitcount` BIGINT COMMENT 'TotalEBHitCount',\n  `totalebinfectcount` BIGINT COMMENT 'TotalEBInfectCount',\n  `totalironfistchargeusecount` BIGINT COMMENT 'TotalIronFistChargeUseCount',\n  `totalironfistchargedamagereduce` TEXT COMMENT 'TotalIronFistChargeDamageReduce',\n  `totalironfistchargehitcount` BIGINT COMMENT 'TotalIronFistChargeHitCount',\n  `totalironfistchargedamage` TEXT COMMENT 'TotalIronFistChargeDamage',\n  `totaldmgforgingironinfected` TEXT COMMENT 'TotalDMGForgingIronInfected',\n  `totaldmgfakerinfected` TEXT COMMENT 'TotalDMGFakerInfected',\n  `totaldmgphoenixsuperman` TEXT COMMENT 'TotalDMGPhoenixSuperman',\n  `totaldmgtitansuperman` TEXT COMMENT 'TotalDMGTitanSuperman',\n  `totaldmgenchantingbutterflyinfected` TEXT COMMENT 'TotalDMGEnchantingButterflyInfected',\n  `totaldmgironfistinfected` TEXT COMMENT 'TotalDMGIronFistInfected',\n  `roundusedcountforgingironinfected` BIGINT COMMENT 'RoundUsedCountForgingIronInfected',\n  `roundusedcountfakerinfected` BIGINT COMMENT 'RoundUsedCountFakerInfected',\n  `roundusedcountphoenixsuperman` BIGINT COMMENT 'RoundUsedCountPhoenixSuperman',\n  `roundusedcounttitansuperman` BIGINT COMMENT 'RoundUsedCountTitanSuperman',\n  `roundusedcountenchantingbutterflyinfected` BIGINT COMMENT 'RoundUsedCountEnchantingButterflyInfected',\n  `roundusedcountironfistinfected` BIGINT COMMENT 'RoundUsedCountIronFistInfected',\n  `roundusedcountspeedinfected` BIGINT COMMENT 'RoundUsedCountSpeedInfected',\n  `roundusedcounthookinfected` BIGINT COMMENT 'RoundUsedCountHookInfected',\n  `roundusedcountinvisinfected` BIGINT COMMENT 'RoundUsedCountInvisInfected',\n  `roundusedcountpoweradvinfected` BIGINT COMMENT 'RoundUsedCountPowerAdvInfected',\n  `roundusedcountfrozenadvinfected` BIGINT COMMENT 'RoundUsedCountFrozenAdvInfected',\n  `roundusedcountpowersuperman` BIGINT COMMENT 'RoundUsedCountPowerSuperman',\n  `roundusedcountdragonsuperman` BIGINT COMMENT 'RoundUsedCountDragonSuperman',\n  `roundselectcamptype` BIGINT COMMENT 'RoundSelectCampType',\n  `roundrandomcamptype` BIGINT COMMENT 'RoundRandomCampType',\n  `roundendcamptype` BIGINT COMMENT 'RoundEndCampType',\n  `roundwinstate` BIGINT COMMENT 'RoundWinState'\n);\n\n【参考信息】\n每个类型都要限制各自字段不为空\n各种类型计算方式：\n变身速行战士 用 SwiftMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身隐形战士 用 StealthMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身钩链战士 用 GrappleMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强能猎手 用 HeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身冰霜领主 用 IceAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身强化战士 用 PowerAdvMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n变身龙焰猎手 用 DragonHeroMorphInfo 取坐标（数组下标3,4,5对应x,y,z）\n坐标保留一位小数点\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注的是特定日期和角色类型在局内行为的地理坐标分布，属于按时间和用户特征划分的行为活跃度分析。\"\n}"
  },
  {
    "question_id": "sql_112",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计2022.04.23-2022.04.30和2022.05.01-2022.05.08传统模式存活时长达到90分钟的玩家人数，每日人数\n输出：统计日期(yyyymmdd)，人数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_roundflow_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `gamesvrid` TEXT COMMENT '登录的游戏服务器编号',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '玩家',\n  `uid` TEXT COMMENT '玩家UID',\n  `battleid` TEXT COMMENT '对局ID',\n  `battletype` BIGINT COMMENT '战斗类型对应BATTLETYPE,其它说明参考FAQ文档',\n  `roundscore` BIGINT COMMENT '本局分数,无得分的填0',\n  `roundtime` BIGINT COMMENT '对局时长(秒)',\n  `result` BIGINT COMMENT '单局结果，参考 Result',\n  `gold` BIGINT COMMENT '金钱变化值',\n  `level` BIGINT COMMENT '等级变化值',\n  `seasonid` BIGINT COMMENT '所属赛季ID',\n  `mode` BIGINT COMMENT '101：传统模式第三人称单排\t102：传统模式第三人称双排\t103：传统模式第三人称四排\t401：传统模式第一人称单排\t402：传统模式第一人称双排\t403：传统模式第一人称四排\t603：创意创作间计分模式第三人称四排(含极能形态模式、极限追猎、特种作战等子模式)',\n  `submode` BIGINT COMMENT '子模式',\n  `map` BIGINT COMMENT '地图',\n  `weather` BIGINT COMMENT '天气',\n  `startime` BIGINT COMMENT '开局时刻',\n  `endtime` BIGINT COMMENT '结束时刻',\n  `playernumber` BIGINT COMMENT '玩家数',\n  `realplayernumber` BIGINT COMMENT '真人玩家数',\n  `teamnumber` BIGINT COMMENT '小队数',\n  `teammemberlist` TEXT COMMENT '队友id解析字段teammemberlist步骤：\t使用lateral VIEW explode(split(teammemberlist,\\\\+)) adTable AS buttontype 函数通过 \"\\\\+\"截取进行行转列进行计算。',\n  `escapecheckup` BIGINT COMMENT '是否逃跑',\n  `totalchangedpointvalue` BIGINT COMMENT '综合积分变化值',\n  `changedratingvalue` BIGINT COMMENT 'rating分变化值',\n  `ratingvalueallianceforceterchanged` BIGINT COMMENT 'rating分变化后的值',\n  `changedkillratingvalue` BIGINT COMMENT 'kill rating分变化值',\n  `killratingvalueallianceforceterchanged` BIGINT COMMENT 'kill rating分变化后的值',\n  `changedwinratingvalue` BIGINT COMMENT 'win rating分变化值',\n  `winratingvalueallianceforceterchanged` BIGINT COMMENT 'win rating分变化后的值',\n  `playergetexperience` BIGINT COMMENT '玩家获得的经验值',\n  `currentroundrank` BIGINT COMMENT '当局名次',\n  `killingcount` BIGINT COMMENT '击杀',\n  `assistcount` BIGINT COMMENT '助攻次数',\n  `survivaltime` BIGINT COMMENT '存活总时间(秒)',\n  `damageamount` BIGINT COMMENT '总伤害量,浮点数，乘以100存入',\n  `healtimes` BIGINT COMMENT '救人次数',\n  `healamount` BIGINT COMMENT '治疗量，浮点数，乘以100存入',\n  `movingdistance` BIGINT COMMENT '前进距离，单位米',\n  `dyingflow` TEXT COMMENT '濒死流水，暂无',\n  `deadflow` TEXT COMMENT '死亡流水 死亡坐标/死亡类型/死亡时间',\n  `headshotcounts` BIGINT COMMENT '爆头数',\n  `gunkillingtimes` BIGINT COMMENT '枪械击杀数，暂无',\n  `meleekilltimes` BIGINT COMMENT '近战击杀数，暂无',\n  `rangeddamagedamount` BIGINT COMMENT '远程武器伤害量，暂无',\n  `meleedamageamount` BIGINT COMMENT '近战伤害量，暂无',\n  `obtianeditemflow` BIGINT COMMENT '获得的物品流水，暂无',\n  `obtianedairdroptimes` BIGINT COMMENT '获得空投次数',\n  `vehicledestoryedtimes` BIGINT COMMENT '摧毁载具次数',\n  `landingcoordinate` BIGINT COMMENT '落地点坐标,弃用，之前定义的类型是int，应该是字符串',\n  `killingflow` TEXT COMMENT '击杀流水 :击杀目标ID\\t击杀类型\\t是否爆头\\t击杀距离\\t使用的武器ID\\t击杀者（角色自己）位置  新增：\\t被击杀者位置\\t击杀时间（从进入小岛开始到击杀时的毫秒数）\\t造成伤害量\\t是否移动\\t击杀区域ID(-1表示区域表中不记录)\\t状态(1:卧倒)\\t被击倒的武器id\\t击杀圈数\\t被击杀者名字\\t是否灭队\\t是否为ai\\tAI的类型\\t击倒者uid\\t击杀者uid',\n  `creepingtime` BIGINT COMMENT '匍匐时间',\n  `swimmingtime` BIGINT COMMENT '游泳时间，暂无',\n  `divingtime` BIGINT COMMENT '潜水时间，暂无',\n  `drivingtime` BIGINT COMMENT '驾驶载具时间',\n  `ridingtime` BIGINT COMMENT '乘坐载具时间，暂无',\n  `walkingdistance` BIGINT COMMENT '步行距离，单位米',\n  `staytimeinpoisonedarea` BIGINT COMMENT '吃毒时间',\n  `damageindex` BIGINT COMMENT '击杀指数,乘100后四舍五入',\n  `luckyindex` BIGINT COMMENT '幸运指数，弃用无效',\n  `collectindex` BIGINT COMMENT '物资指数,乘100后四舍五入',\n  `survivalindex` BIGINT COMMENT '生存指数,乘100后四舍五入',\n  `movingindex` BIGINT COMMENT '前进指数，弃用无效',\n  `creepindex` BIGINT COMMENT '伏地指数，弃用无效',\n  `accuracyindex` BIGINT COMMENT '精准指数，弃用无效',\n  `deliveryindex` BIGINT COMMENT '快递指数，弃用无效',\n  `sneakattackindex` BIGINT COMMENT '偷袭指数，弃用无效',\n  `healindex` BIGINT COMMENT '支援指数,乘100后四舍五入',\n  `boxindex` BIGINT COMMENT '盒子指数，弃用无效',\n  `assaultindex` BIGINT COMMENT '伤害指数,乘100后四舍五入',\n  `totalpoint` BIGINT COMMENT '综合积分变化后的值',\n  `ratinglevel` BIGINT COMMENT '流水评价等级',\n  `titleidlist` TEXT COMMENT '当局获得的称号Id',\n  `itemuseflow` TEXT COMMENT '装备的物品流水',\n  `medicineuseflow` TEXT COMMENT '使用的药品流水',\n  `gunhittimes` BIGINT COMMENT '枪械命中次数',\n  `gunshottimes` BIGINT COMMENT '枪械射击次数',\n  `teamrank` BIGINT COMMENT '队伍名次',\n  `curecount` BIGINT COMMENT '治疗次数',\n  `drivingdistance` BIGINT COMMENT '行驶距离，单位米',\n  `totalscorerank` BIGINT COMMENT '综合评分排名，弃用无效',\n  `rating` BIGINT COMMENT '鸡分',\n  `killrating` BIGINT COMMENT '消灭鸡分',\n  `winrating` BIGINT COMMENT '排名鸡分',\n  `ratingrank` BIGINT COMMENT '鸡分排名，弃用无效',\n  `killingratingrank` BIGINT COMMENT '消灭鸡分排名，弃用无效',\n  `winratingrank` BIGINT COMMENT '排名鸡分排名，弃用无效',\n  `totalround` BIGINT COMMENT '赛季分人称几排总场数',\n  `totalkill` BIGINT COMMENT '赛季分人称几排总杀敌数',\n  `totalwin` BIGINT COMMENT '赛季分人称几排总胜利数',\n  `top10times` BIGINT COMMENT '前十数',\n  `totalheadshotrate` BIGINT COMMENT '赛季分人称几排总爆头率',\n  `averagesurvivaltimeperround` BIGINT COMMENT '场均存活时间',\n  `healfriendtimes` BIGINT COMMENT '救助队友次数',\n  `averagemovedistanceperround` BIGINT COMMENT '场均移动距离',\n  `maxdamageinoneround` BIGINT COMMENT '单局最高伤害',\n  `maxkillinginoneround` BIGINT COMMENT '单局最高击杀',\n  `maxsurvivaltime` BIGINT COMMENT '最长存活时间',\n  `maxmovingdistance` BIGINT COMMENT '最长移动距离',\n  `contributionrankrating` BIGINT COMMENT '单排总积分贡献分',\n  `contributionkillrating` BIGINT COMMENT '单排击败积分贡献分',\n  `contributionwinrating` BIGINT COMMENT '单排生存积分贡献分',\n  `oldsegmentlevel` BIGINT COMMENT '旧段位',\n  `newsegmentlevel` BIGINT COMMENT '新段位',\n  `teamid` BIGINT COMMENT '小队ID',\n  `landlocation` TEXT COMMENT '落地点坐标,有效字段,单位cm',\n  `totaldeadtimes` BIGINT COMMENT '赛季分人称几排总死亡数',\n  `sumscore` BIGINT COMMENT '流水总评分，乘以100后存入',\n  `seasonsurvivalindex` BIGINT COMMENT '赛季参赛指数',\n  `seasontop1index` BIGINT COMMENT '赛季获胜率指数',\n  `seasonratingindex` BIGINT COMMENT '赛季总积分指数',\n  `seasonassaultindex` BIGINT COMMENT '赛季竞赛指数',\n  `seasonhealindex` BIGINT COMMENT '赛季支援指数',\n  `seasonmovingindex` BIGINT COMMENT '赛季前进指数',\n  `seasonsumscore` BIGINT COMMENT '赛季总评分，乘以100后存入',\n  `seasonratinglevel` BIGINT COMMENT '赛季评价等级',\n  `modesurvivalindex` BIGINT COMMENT '当前模式参赛指数',\n  `modetop1index` BIGINT COMMENT '当前模式获胜率指数',\n  `moderatingindex` BIGINT COMMENT '当前模式总积分指数',\n  `modeassaultindex` BIGINT COMMENT '当前模式竞赛指数',\n  `modehealindex` BIGINT COMMENT '当前模式支援指数',\n  `modemovingindex` BIGINT COMMENT '当前模式前进指数',\n  `modesumscore` BIGINT COMMENT '当前模式总评分，乘以100后存入',\n  `moderatinglevel` BIGINT COMMENT '当前模式评价等级',\n  `flowratinglevel` TEXT COMMENT '当局游戏的评价等级，前面有个Int类型的，但是非要求加一个字符串类型的',\n  `rolename` TEXT COMMENT '玩家角色名',\n  `totaldamage` BIGINT COMMENT '赛季分人称几排总伤害量',\n  `totalheal` BIGINT COMMENT '赛季分人称几排总治疗量',\n  `matchtype` BIGINT COMMENT '匹配模式0：手机 1模拟器 8小黑屋 9新手局',\n  `duocontributionrankrating` BIGINT COMMENT '双人总积分贡献分',\n  `duocontributionkillrating` BIGINT COMMENT '双人击败积分贡献分',\n  `duocontributionwinrating` BIGINT COMMENT '双人生存积分贡献分',\n  `squadcontributionrankrating` BIGINT COMMENT '四人总积分贡献分',\n  `squadcontributionkillrating` BIGINT COMMENT '四人击败积分贡献分',\n  `squadcontributionwinrating` BIGINT COMMENT '四人生存积分贡献分',\n  `famousid` BIGINT COMMENT '名人名言tips ID',\n  `dsendtime` TEXT COMMENT '新结束时间字段，ds传过来的字符串',\n  `equipmentinfo` TEXT COMMENT '装备信息:头盔ID\\t防弹衣ID\\t背包ID\\t主武器1ID\\t主武器1配件ID列表(以,分隔)\\t主武器2ID\\t主武器2配件ID列表(以,分隔)\\t副武器ID\\t副武器配件ID列表(以,分隔)\\t近战武器ID\\t投掷武器ID\\t是否佩戴吉利服',\n  `segmentprotect` BIGINT COMMENT '段位保护标记，1为触发了该段位的段位保护，0为没有触发',\n  `ismvp` BIGINT COMMENT '不是mvp 0/是mvp 1',\n  `pronetime` BIGINT COMMENT '趴地时间',\n  `followstate` BIGINT COMMENT '跳伞跟随  0不跟随，也不被跟随；1是被跟随；2是跟随',\n  `touchdownareaid` BIGINT COMMENT '降落地点类型, 参见赛季任务降落地点类型表',\n  `getpropsnumfromteammates` BIGINT COMMENT '接受队友道具数',\n  `sendpropsnumtoteammates` BIGINT COMMENT '赠送队友道具数',\n  `starttorescuetimes` BIGINT COMMENT '开始救援次数',\n  `avatargamegender` BIGINT COMMENT 'Avatar性别',\n  `avatarhairid` BIGINT COMMENT 'Avatar发型',\n  `avatarheadid` BIGINT COMMENT 'Avatar脸型',\n  `avatarfeaturenum` BIGINT COMMENT 'Avatar时装个数',\n  `avatarfeaturelist_1` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_2` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_3` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_4` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_5` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_6` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_7` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_8` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_9` BIGINT COMMENT 'Avatar时装',\n  `avatarfeaturelist_10` BIGINT COMMENT 'Avatar时装',\n  `avatarweaponid` BIGINT COMMENT 'Avatar枪械',\n  `avatarweaponskinid` BIGINT COMMENT 'Avatar枪械皮肤',\n  `killeruid` TEXT COMMENT '击杀者UID',\n  `killerweaponid` BIGINT COMMENT '击杀者使用武器ID',\n  `killerdistance` BIGINT COMMENT '击杀者距离',\n  `lobbyteamid` TEXT COMMENT '大厅队伍id,ug字段，兼容保留',\n  `makefiresnum` BIGINT COMMENT '生火成功次数,极寒模式',\n  `isregress` BIGINT COMMENT '是否回流',\n  `topxtipsresponse` BIGINT COMMENT '未进入前5:-1;不点击:0;继续战斗:1;退出竞赛:2',\n  `signalhealamount` BIGINT COMMENT '信号治疗量',\n  `drivinghelicoptertime` BIGINT COMMENT '驾驶直升飞机时间',\n  `inhelicoptertime` BIGINT COMMENT '乘坐直升飞机时间',\n  `noreductratingscore` BIGINT COMMENT '是否触发了不掉分活动',\n  `changedtrueratingvalue` BIGINT COMMENT 'true rating分变化值',\n  `trueratingvalueallianceforceterchanged` BIGINT COMMENT 'true rating分变化后的值',\n  `teammemberrelalist` TEXT COMMENT '与TeamMemberList相对应，与其他队员之间的好友关系（0非好友，1平台好友，2为游戏好友）拼接，多个好友之间用+拼接。例如1+2+2',\n  `teammembersexlist` TEXT COMMENT '与TeamMemberList相对应，其他队员的性别拼接（1表示男，2表示女），多个好友之间用+拼接。例如1+2+2',\n  `friendcount` BIGINT COMMENT '队友中的好友数量',\n  `maxhurtweaponid` BIGINT COMMENT '最大伤害的武器ID',\n  `maxdamage` BIGINT COMMENT '武器的最大伤害',\n  `allianceforceterlevel` BIGINT COMMENT '结算后等级',\n  `isobexit` BIGINT COMMENT '是否观战退出',\n  `noreductrating` BIGINT COMMENT '是否触发不掉分活动',\n  `extraaddrating` BIGINT COMMENT '是否触发首战加分活动',\n  `protectrating` BIGINT COMMENT '是否触发保分机制',\n  `doublescore` BIGINT COMMENT '是否触发双倍上分活动',\n  `fateaddscore` BIGINT COMMENT '是否触发缘分队友加分活动',\n  `isnewaistrategy` BIGINT COMMENT '是否新的AI策略',\n  `lobbymemberlist` TEXT COMMENT '大厅组队队友列表',\n  `ratingtype` BIGINT COMMENT '计算的排位积分类型',\n  `killername` TEXT COMMENT '击杀我的人的名字',\n  `changekd` BIGINT COMMENT '当局结算引起的KD变化值，乘100后存入',\n  `friendteamaddscore` BIGINT COMMENT '是否触发好友四排组队加分活动',\n  `xuanwunoreductrating` BIGINT COMMENT '是否触发玄武不掉分活动',\n  `gunmateriallist` TEXT COMMENT '枪匠模式对局带出的改装件',\n  `bountynum` BIGINT COMMENT '枪匠模式的赏金数量',\n  `evacuatetype` BIGINT COMMENT '枪匠模式的逃脱类型。0 没有逃脱，1 直升机， 2 地堡， 3 的士',\n  `triggerrepeatkilllimit` BIGINT COMMENT '触发重复击杀限制',\n  `doublescoretimes` BIGINT COMMENT '是否触发双倍上分次数活动',\n  `teammembertmrelalist` TEXT COMMENT 'Avatar时装',\n  `device_type` BIGINT COMMENT '设备类型0为手机 1为模拟器 2 键鼠 3 手柄'\n);\n\n【参考信息】\n传统模式mode in(101,102,103,401,402,403)\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注特定时间段内玩家在传统模式下的存活时长分布，属于活跃度时间维度分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注特定时间段内玩家在传统模式下的存活时长分布，属于活跃度时间维度分析。\"\n}"
  },
  {
    "question_id": "sql_113",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20220425-20220508组竞商店购买情况\n输出：统计日期（YYYYMMDD），商店id，人数，次数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_vsteamshoplog_hi` (\n  `tdbank_imp_date` TEXT,\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '游戏APPID',\n  `platid` BIGINT COMMENT 'ios 0/android 1',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '玩家',\n  `uid` TEXT COMMENT '(可填)角色UID',\n  `shopid` BIGINT COMMENT '购买id',\n  `count` BIGINT COMMENT '购买数量'\n);\n\n【参考信息】\n\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "该需求关注的是特定时间段内组竞商店的购买行为统计，属于对用户活跃或参与度在时间维度上的分布分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"该需求关注的是特定时间段内组竞商店的购买行为统计，属于对用户活跃或参与度在时间维度上的分布分析。\"\n}"
  },
  {
    "question_id": "sql_115",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计 玩家参与\n\t新年竞赛杯（20240202-20240204，20240209-20240211）\n\t明星竞赛杯（20231208-20231210，20231215-20231217）\n\t众竞赛道（20231006-20231008，20230929-20231001，20230922-20230924）\n\t珍禽竞赛杯（20230721-20230723，20230728-20230730）\n\t都会竞速（20230519-20230611，20230616-20230625）\n\t寒域竞赛杯（20230505-20230507，20230512-20230514）\n\t飞跃竞赛杯（20230121-20230127）\n\t联队竞赛杯（20221125-20221127，20221202-20221204）\n\t职赛杯（20220819-20220821，20220826-20220828）\n\t夏日假期竞赛杯（20220722-20220724，20220729-20220731）\n\t众投竞赛（20220506-20220508，20220513-20220515，20220520-20220522）且matchmode为（1503,1603）的期数\n\t输出：每个玩家参与的不相同的期数\n\n【数据库schema】\nCREATE TABLE `dwd_jordass_player_matchrecord_hi` (\n  `tdbank_imp_date` TEXT COMMENT '分区字段，小时分区，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `matchtime` BIGINT COMMENT '匹配时长（秒）',\n  `matchresult` TEXT COMMENT '匹配结果',\n  `matchmode` BIGINT COMMENT '匹配模式',\n  `isaotufill` BIGINT COMMENT '是否自动填充',\n  `gameid` TEXT COMMENT '匹配成功为当前的battleid失败为0',\n  `submodes` TEXT COMMENT '选择的子模式列表，只有队长才有',\n  `isleader` BIGINT COMMENT '1表示队长0非队长',\n  `teamnum` TEXT COMMENT '组队人数',\n  `teammembers` TEXT COMMENT '组队队伍',\n  `matchteammembers` TEXT COMMENT '最终匹配的队伍',\n  `matchlabel` BIGINT COMMENT '匹配标签',\n  `corpsid` BIGINT COMMENT '联盟id',\n  `teamid` TEXT COMMENT '队伍ID',\n  `teamwaittime` BIGINT COMMENT '队伍首次组队到匹配等待时间',\n  `finalbucketidx` BIGINT COMMENT '匹配成功首队伍所在匹配区间idx',\n  `playermoderating` BIGINT COMMENT '玩家该模式下rating分(段位分)',\n  `playerlevel` BIGINT COMMENT '玩家等级',\n  `regresss` BIGINT COMMENT '是否回流玩家',\n  `matchsubmodegroup` BIGINT COMMENT '最终随机到的submodegroup',\n  `matchrating` BIGINT COMMENT '当前玩家所在队伍匹配积分',\n  `bucketidx` BIGINT COMMENT '当前玩家所在队伍匹配积分所在区间idx',\n  `device_type` BIGINT COMMENT '设备类型0为手机 1为模拟器 2 键鼠 3 手柄 5 PC高清模拟器',\n  `strategys` TEXT COMMENT '分队策略',\n  `match_client_type` BIGINT COMMENT '匹配池渠道0为手机 1为模拟器 2外部模拟器 8为小黑屋 9为新手局',\n  `pandoralost` BIGINT COMMENT '潘多拉预流失标记 1预流失 0非预流失',\n  `teamjoinsource` BIGINT COMMENT '组队加入来源',\n  `regressvalue` BIGINT COMMENT '玩家当前的回流值',\n  `strategy_type` BIGINT COMMENT '策略类型，-1表示服务器保底二次分队, 0表示004的潘多拉策略, 1表示005的潘多拉单局最优策略, 2表示015的技术中心优化分队策略, 3表示技术中心向量化二次分队方案, 4表示内部推荐二次分队方案',\n  `playersign` BIGINT COMMENT '玩家分级标签，1为白，2为红，3为灰, 4为深灰',\n  `livetype` BIGINT COMMENT '直播类型: 2 围观 4 视频号',\n  `liveid` TEXT COMMENT '直播ID',\n  `matchscene` BIGINT COMMENT '匹配成功时玩家所在场景，0为大厅，1为聚乐园',\n  `issilentmode` BIGINT COMMENT '是否是免耳麦模式，0为非免耳麦，1为免耳麦',\n  `ismatchlbs` BIGINT COMMENT '是否是lbs匹配，0为非lbs匹配，1为lbs匹配',\n  `strategy_index` BIGINT COMMENT '二次分队策略采用的weight数组的下标',\n  `xid` TEXT COMMENT 'Xid',\n  `isanchor` BIGINT COMMENT '是否是主播，0为非主播，1为主播',\n  `isanchorgame` BIGINT COMMENT '是否匹配到主播局，0为非主播局，1为主播局',\n  `tournamentid` BIGINT COMMENT '微赛事ID',\n  `expandupsection` BIGINT COMMENT '最大向上扩段数',\n  `expanddownsection` BIGINT COMMENT '最大向下扩段数',\n  `expandupclass` BIGINT COMMENT '最大向上扩载数',\n  `expanddownclass` BIGINT COMMENT '最大向下扩载数',\n  `isfullbucket` BIGINT COMMENT '是否优先遍历满载队',\n  `timingmatchtime` BIGINT COMMENT '定时匹配真实匹配时长（秒）',\n  `tournamentstage` BIGINT COMMENT '微赛事阶段ID',\n  `tournamentclubid` TEXT COMMENT '微赛事战队ID',\n  `promotionmatchstatus` BIGINT COMMENT '参与晋级赛的状态, -1没勾选，0成功参与，1模式不对，2时间不对，3配置不对，4自身段位不对，5队友段位不对',\n  `ugcisgray` BIGINT COMMENT '是否为ugc灰度玩法。默认为0：非灰度；1：灰度',\n  `promotiontaskid` BIGINT COMMENT '晋级赛任务ID',\n  `strategyabtest` TEXT COMMENT '未命中模式为空，对照组记 0:ID，实验组记 1:ID',\n  `accompanytype` BIGINT COMMENT '陪玩标签值 0 ：没有打标签，1：陪玩，2：老板',\n  `minusteamnum` BIGINT COMMENT '匹配成功后踢回匹配池的队伍数',\n  `mobiletabletmatchlabel` BIGINT COMMENT '匹配队伍平板比例标签(非手机=0，纯手机=1，25%平板=2，50%平板=3，75%平板=4，100%平板=5)',\n  `ratingtype` BIGINT COMMENT '积分类型',\n  `idcname` TEXT COMMENT 'IDC集群名字',\n  `strategyextendinfo` TEXT COMMENT '推荐侧二次分队返回的信息',\n  `playerabtest` TEXT COMMENT '个人匹配abtest',\n  `gameabtest` TEXT COMMENT '匹配对局的abtest,没有则为空字符串',\n  `matchtype` BIGINT COMMENT '1表示匹配成局，2表示补人',\n  `matchisolatetype` BIGINT COMMENT '玩家匹配隔离标记, 0不隔离，2所有模式隔离，3积分模式隔离，4E玩法模式隔离',\n  `predictmatchtime` BIGINT COMMENT '预估匹配时长',\n  `expandspeed` BIGINT COMMENT '匹配单阶段扩段时长',\n  `escapehardid` BIGINT COMMENT 'E玩法难度ID',\n  `gameplayernum` BIGINT COMMENT '开局人数',\n  `gameaistrategy` BIGINT COMMENT 'AI投放策略类型',\n  `isfixmatchlabel` BIGINT COMMENT '是否触发了标签修正',\n  `realmatchsubmodes` TEXT COMMENT '实际匹配的模式组列表',\n  `aitype` BIGINT COMMENT '投放的AI類型',\n  `decratingtype` BIGINT COMMENT '降段类型，0=未触发降段，1=pc新手标签降段，2=未成年标签降段，3=回流标签降段，4=情绪值降段',\n  `forcematchtype` BIGINT COMMENT '记录本次匹配是否触发了强制开局，0=未触发，1=通用强制开局，2=PC新手强制开局',\n  `ispcaigame` BIGINT COMMENT '是否触发了PC首局AI局',\n  `matchsubclienttype` BIGINT COMMENT '匹配子池：0非子池, 2外设键鼠,3外设手柄,4主播,5PC新手,6PC-AI局 7BR温暖局，8隧道AI局',\n  `heroexcludetype` BIGINT COMMENT '是否触发了英雄互斥匹配，1采用了互斥匹配, 2没命中灰度 3超时，0其他情况',\n  `natalhero` BIGINT COMMENT '本命英雄ID',\n  `iswarmescapegame` BIGINT COMMENT '是否是E玩法温暖局',\n  `cancrossdevicematch` BIGINT COMMENT '是否可已手机非手机混匹, 1可以，0不可以',\n  `aiteamatetype` BIGINT COMMENT 'AI队友类型',\n  `isfirstteam` BIGINT COMMENT '是否是首队',\n  `firstteamwaittime` BIGINT COMMENT '首队的匹配等待时间',\n  `firstteamrankbucket` BIGINT COMMENT '首队段位分段',\n  `matchprocessinfo` TEXT COMMENT '匹配扩展信息 辅助查询匹配问题',\n  `isabtwarmgame` BIGINT COMMENT '是否触发了温暖局',\n  `warmplayertype` BIGINT COMMENT '温暖局玩家身份, 3=挫败（未来），2=回流，1=低活，0=未触发或无标签',\n  `escapeplayertype` TEXT COMMENT '隧道玩家身份类型, 空字符串表示默认类型，1回流标签有限期内,2积分移动新手(隐藏分专用),3积分非移动新手(隐藏分专用),4积分回流(隐藏分专用),5全局新手(AI局专用),6PC新手(AI局专用),7非PC温暖(AI局专用),8PC温暖(AI局专用),9回流(AI局专用), 以+分割',\n  `secondarydecratingtype` BIGINT COMMENT '二维匹配分降段类型，0=未触发降段，1=隧道回流降分匹配',\n  `finalsecondarybucketidx` BIGINT COMMENT '匹配成功首队所在二维匹配积分区间',\n  `playersecondarymoderating` BIGINT COMMENT '玩家该模式下二维匹配积分',\n  `secondarymatchrating` BIGINT COMMENT '当前玩家所在队伍二维匹配积分',\n  `secondarybucketidx` BIGINT COMMENT '当前玩家所在队伍二维匹配积分所在区间',\n  `escapeasset` TEXT COMMENT '隧道玩法资产',\n  `escapewarmscore` TEXT COMMENT '隧道温暖值',\n  `pvethemeid` BIGINT COMMENT 'PVE挑战事件ID',\n  `escapelesspeoplegamenum` BIGINT COMMENT '隧道每周已触发低真人局次数',\n  `garybucketgroup` BIGINT COMMENT '灰度分桶',\n  `matchsubclienttypebefore` BIGINT COMMENT '发起匹配时的匹配子池：0非子池, 2外设键鼠,3外设手柄,4主播,5PC新手,6PC-AI局, 7BR温暖局，8隧道AI局',\n  `frustratiggerlevel` BIGINT COMMENT 'FrustraTiggerLevel',\n  `frustramanualscore` TEXT COMMENT 'FrustraManualScore',\n  `frustramodelscore` TEXT COMMENT 'FrustraModelScore',\n  `frustragroup` TEXT COMMENT 'FrustraGroup',\n  `frustrathreshold` TEXT COMMENT 'FrustraThreshold',\n  `recomtraceid` TEXT COMMENT 'RecomTraceID'\n);\n\n【参考信息】\n\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注玩家在多个赛事期间的参与情况，属于跨时间维度的活动分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注玩家在多个赛事期间的参与情况，属于跨时间维度的活动分析。\"\n}"
  },
  {
    "question_id": "sql_116",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计全平台20250225存量用户的类型（近三个月流失，近三个月活跃但近三个月无付费，近三个月活跃且有付费），历史段位，历史付费分层情况\n\t输出：用户类型，历史段位，历史付费分层，人数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_df` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:不区分平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '登录位图',\n  `dregdate` TEXT COMMENT '注册日期，格式YYYYMMDD',\n  `ilevel` BIGINT COMMENT '等级',\n  `friendcount` BIGINT COMMENT '好友数量'\n);\nCREATE TABLE `dws_jordass_water_di` (\n  `dtstatdate` TEXT COMMENT '分区，付费日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android,255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `iamount` BIGINT COMMENT '代币金额(Q分)',\n  `itimes` BIGINT COMMENT '流水次数',\n  `imoney` DOUBLE COMMENT '除100为实际支付人民币金额'\n);\nCREATE TABLE `dws_jordass_uid_login_df` (\n  `dtstatdate` TEXT COMMENT '日期',\n  `vgameappid` TEXT COMMENT '账号体系： wx - 微信 ；qq - 手Q',\n  `platid` BIGINT COMMENT '系统平台',\n  `vplayerid` TEXT COMMENT '账号id',\n  `uid` BIGINT COMMENT '角色id',\n  `vrolename` TEXT COMMENT '角色名称',\n  `dregdate` TEXT COMMENT '注册日期',\n  `lastactdate` TEXT COMMENT '最后活跃日期',\n  `cbitmap` TEXT COMMENT '活跃位图',\n  `ilevel` TEXT COMMENT '账号等级',\n  `friendcount` BIGINT COMMENT '好友数',\n  `historymaxsegment` BIGINT COMMENT '历史最高段位',\n  `gender` BIGINT COMMENT '游戏内性别'\n);\nCREATE TABLE `dws_jordass_water_df` (\n  `dtstatdate` TEXT COMMENT '分区，付费日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android，255所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '流水位图',\n  `dwaterdate` TEXT COMMENT '首次流水日期',\n  `imoney` DOUBLE COMMENT '累计流水收入(分)(简称流水)',\n  `iamount` BIGINT COMMENT '代币金额(Q分)'\n);\n\n【参考信息】\n付费分层：\n\t\t0 \n\t\t(0-1200]\n\t\t(1200-6000]\n\t\t(6000-18000]\n\t\t(18000+]\n历史段位：MAX(historymaxsegment)\n\n",
    "output": "",
    "category": "用户分群",
    "category_reason": "问题旨在根据用户的历史行为（活跃、付费、段位等）对存量用户进行多维度分类和画像。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"用户分群\",\n  \"rationale\": \"问题旨在根据用户的历史行为（活跃、付费、段位等）对存量用户进行多维度分类和画像。\"\n}"
  },
  {
    "question_id": "sql_117",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计全平台20250331-20250510当天活跃前30用户回流类型   （活跃，7日回流，14日回流，30日回流），人数\n\t输出：用户回流类型（活跃，7日回流，14日回流，30日回流）， 人数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_df` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:不区分平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '登录位图',\n  `dregdate` TEXT COMMENT '注册日期，格式YYYYMMDD',\n  `ilevel` BIGINT COMMENT '等级',\n  `friendcount` BIGINT COMMENT '好友数量'\n);\n\n【参考信息】\n\n\n",
    "output": "",
    "category": "留存类",
    "category_reason": "问题关注用户回流类型及人数统计，属于留存分析中的回流用户识别。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注用户回流类型及人数统计，属于留存分析中的回流用户识别。\"\n}"
  },
  {
    "question_id": "sql_118",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计20240426-20240505期间活动为1193536的曝光情况\n曝光：itype='1'\n参与：itype in ('10','200','201','202','203','204','31','32','33','34','35','702','703')\n输出：曝光参与情况（曝光未参与，曝光且参与）,人数，传统模式人数，传统模式对局数，传统模式对局时长，活跃人数，活跃时长，专业赛人数，专业赛局数（按照记录数）\n\n【数据库schema】\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT '统计日期格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `mode` BIGINT COMMENT '模式ID',\n  `modename` TEXT COMMENT '模式名称',\n  `submode` BIGINT COMMENT '子模式ID',\n  `submodename` TEXT COMMENT '子模式名称',\n  `map` BIGINT COMMENT '地图ID',\n  `mapname` TEXT COMMENT '地图名称',\n  `seasonid` BIGINT COMMENT '赛季ID',\n  `seasonname` TEXT COMMENT '赛季名称',\n  `roundcnt` BIGINT COMMENT '当日对局数',\n  `roundtime` BIGINT COMMENT '当日对局时长(秒)',\n  `survivaltime` BIGINT COMMENT '当日存活时长(秒)',\n  `firstroundtime` TEXT COMMENT '当日首次对局时间',\n  `device_type` BIGINT COMMENT '设备类型'\n);\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\nCREATE TABLE `dwd_jordass_playerprofstagechange_hi` (\n  `tdbank_imp_date` TEXT COMMENT '小时分区字段，格式YYYYMMDDHH',\n  `dteventtime` TEXT COMMENT '游戏事件的时间, 格式 YYYY-MM-DD HH:MM:SS',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS,1:Android',\n  `izoneareaid` BIGINT COMMENT '针对分区分服的游戏填写分区id，用来唯一标示一个区；非分区分服游戏请填写0',\n  `vplayerid` TEXT COMMENT '用户playerid号',\n  `uid` TEXT COMMENT '角色UID',\n  `tournamentid` BIGINT COMMENT '赛事id',\n  `beforstage` BIGINT COMMENT '变更前阶段',\n  `allianceforceterstage` BIGINT COMMENT '变更后阶段',\n  `ruletype` BIGINT COMMENT '晋级规则类型',\n  `ispass` BIGINT COMMENT '是否晋级',\n  `teamrank` BIGINT COMMENT '积分赛排名，没有上榜的值为-1',\n  `battlecount` BIGINT COMMENT '当前赛段对局数',\n  `clubid` TEXT COMMENT '战队id,单人参赛阶段值为0'\n);\nCREATE TABLE `dwd_jordass_mysteryplaylog_hi` (\n  `tdbank_imp_date` TEXT COMMENT '分区字段，小时分区，格式：YYYYMMDDHH',\n  `iid` TEXT COMMENT '日志唯一ID',\n  `dttime` TEXT COMMENT '时间戳',\n  `suser` TEXT COMMENT '对应游戏内vplayerid',\n  `sphoneid` TEXT COMMENT 'PhoneID',\n  `imodule` TEXT COMMENT '模块ID',\n  `ichannel` TEXT COMMENT '频道ID',\n  `itype` TEXT COMMENT '类型',\n  `sappid` TEXT COMMENT 'vgameappid(手Q、微信)',\n  `iostype` TEXT COMMENT 'platid(安卓、IOS)',\n  `iactid` TEXT COMMENT '活动ID',\n  `ijumptype` TEXT COMMENT '跳转类型',\n  `sjumpurl` TEXT COMMENT '跳转地址',\n  `ipartition` TEXT COMMENT '小区',\n  `recommend_id` TEXT COMMENT '推荐ID',\n  `changjing_id` TEXT COMMENT '场景ID',\n  `goods_id` TEXT COMMENT '礼包ID',\n  `useridt_count` TEXT COMMENT '个数',\n  `useridt_fee` TEXT COMMENT '价格',\n  `currency_type` TEXT COMMENT '货币类型',\n  `service_type` BIGINT COMMENT '业务类型',\n  `sroleid` TEXT COMMENT '角色ID',\n  `act_style` TEXT COMMENT '活动类型',\n  `flow_id` TEXT COMMENT '活动FlowID',\n  `dteventtime` TEXT COMMENT '事件时间,格式YYYY-MM-DDHH:MM:SS',\n  `reserve0` TEXT COMMENT '预留字段',\n  `reserve1` TEXT COMMENT '预留字段',\n  `reserve2` TEXT COMMENT '预留字段',\n  `reserve3` TEXT COMMENT '预留字段',\n  `reserve4` TEXT COMMENT '预留字段',\n  `reserve5` TEXT COMMENT '预留字段',\n  `reserve6` TEXT COMMENT 'comment',\n  `reserve7` TEXT COMMENT '预留字段',\n  `reserve8` TEXT COMMENT '预留字段',\n  `reserve9` TEXT COMMENT '预留字段',\n  `taskid` TEXT COMMENT '流量管家taskid',\n  `partflag` TEXT COMMENT '参与活动标志:0表示非参与,大于0表示参与'\n);\n\n【参考信息】\n注意将曝光未参与中无记录的null值统一转化为0\n用户过滤条件：platid=255\n赛事id：TournamentID = 30002\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注特定活动在指定时间范围内的曝光情况，属于用户行为的活跃度统计。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注特定活动在指定时间范围内的曝光情况，属于用户行为的活跃度统计。\"\n}"
  },
  {
    "question_id": "sql_119",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n2025年4月29日，2025年6月1日这两天\n在后续半个月未登录用户，在后续半个月有登录用户：\n输出：统计日期（yyyymmdd）,用户类型（后续半个月未登录，后续半个月有登录，新增、7日以内留存（不含当天的前七日后面同理）、7~14日回流、14~30日回流、30~90日回流、90日以上回流的用户量级），人数\n\n【数据库schema】\nCREATE TABLE `dws_jordass_login_df` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:不区分平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '登录位图',\n  `dregdate` TEXT COMMENT '注册日期，格式YYYYMMDD',\n  `ilevel` BIGINT COMMENT '等级',\n  `friendcount` BIGINT COMMENT '好友数量'\n);\nCREATE TABLE `dws_jordass_login_di` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：\twx - 微信\tqq - 手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:所有平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `ilevel` BIGINT COMMENT '等级',\n  `ionlinetime` BIGINT COMMENT '在线时长(秒)',\n  `ilogincount` BIGINT COMMENT '登录次数',\n  `friendcount` BIGINT COMMENT '好友数量',\n  `dtlogintime` TEXT COMMENT '当日最早登录时间,格式YYYY-MM-DDHH:MM:SS'\n);\n\n【参考信息】\n\n\n",
    "output": "",
    "category": "留存类",
    "category_reason": "问题关注用户在特定时间窗口内的登录行为变化，属于留存与流失分析范畴。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"留存类\",\n  \"rationale\": \"问题关注用户在特定时间窗口内的登录行为变化，属于留存与流失分析范畴。\"\n}"
  },
  {
    "question_id": "sql_120",
    "instruction": "请你接下来一步步思考，写出正确的SQL查询语句以满足用户的需求。",
    "input": "你是一名MySQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用MySQL知识生成sql语句回答【用户问题】。\n【用户问题】\n统计用户（2025.7月24~7月25日持续活跃，2025.7.24活跃7.25流失到盘外），且帐号体系为qq的性别人数\n输出：用户类型（7月24~7月25日持续活跃，7.24活跃7.25流失到盘外）,性别,人数\n\n【数据库schema】\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT '统计日期YYYYMMDD',\n  `saccounttype` TEXT COMMENT '帐号类型:QQ号或者微信',\n  `suserid` TEXT COMMENT '帐号',\n  `suseridtype` TEXT COMMENT '帐号类型:qq wxid playerid',\n  `sgamecode` TEXT COMMENT '业务',\n  `splattype` TEXT COMMENT '平台类型(大平台)。枚举值为Android/ iOS，取汇总时取-100',\n  `splat` TEXT COMMENT '平台(小平台)。备注：写死的-100',\n  `sgameparam` TEXT COMMENT '场次',\n  `schannel` TEXT COMMENT '不可用字段，用户可以忽略',\n  `sip` TEXT COMMENT '实际上是当日登录的最小时间戳，即最早登录时间',\n  `sclientver` TEXT COMMENT '客户端版本',\n  `ilevel` BIGINT COMMENT '用户等级。不可用',\n  `iviplevel` BIGINT COMMENT 'Vip等级。不可用',\n  `itimes` BIGINT COMMENT '活跃总次数。备注：该字段表示用户在T日的当日活跃总次数',\n  `ionlinetime` BIGINT COMMENT '活跃总时间。备注：该字段表示用户在T日的当日活跃总时间'\n);\nCREATE TABLE `dws_jordass_login_df` (\n  `dtstatdate` TEXT COMMENT '分区字段，登陆日期，格式YYYYMMDD',\n  `vgameappid` TEXT COMMENT '账号体系：wx:微信，qq：手Q',\n  `platid` BIGINT COMMENT '系统平台：0:IOS，1:Android，255:不区分平台',\n  `vplayerid` TEXT COMMENT '玩家ID',\n  `cbitmap` TEXT COMMENT '登录位图',\n  `dregdate` TEXT COMMENT '注册日期，格式YYYYMMDD',\n  `ilevel` BIGINT COMMENT '等级',\n  `friendcount` BIGINT COMMENT '好友数量'\n);\nCREATE TABLE `dim_mgamejp_tbplayerid2qq_nf` (\n  `dtstatdate` BIGINT COMMENT '统计日期YYYYMMDD',\n  `sappid` TEXT COMMENT '游戏id',\n  `splayerid` TEXT COMMENT 'playerid',\n  `iqq` BIGINT COMMENT 'QQ帐号'\n);\nCREATE TABLE `dws_jordass_uid_login_df` (\n  `dtstatdate` TEXT COMMENT '日期',\n  `vgameappid` TEXT COMMENT '账号体系： wx - 微信 ；qq - 手Q',\n  `platid` BIGINT COMMENT '系统平台',\n  `vplayerid` TEXT COMMENT '账号id',\n  `uid` BIGINT COMMENT '角色id',\n  `vrolename` TEXT COMMENT '角色名称',\n  `dregdate` TEXT COMMENT '注册日期',\n  `lastactdate` TEXT COMMENT '最后活跃日期',\n  `cbitmap` TEXT COMMENT '活跃位图',\n  `ilevel` TEXT COMMENT '账号等级',\n  `friendcount` BIGINT COMMENT '好友数',\n  `historymaxsegment` BIGINT COMMENT '历史最高段位',\n  `gender` BIGINT COMMENT '游戏内性别'\n);\n\n【参考信息】\nn流失盘外：\nWHERE dtstatdate='20250725' \n           AND platid = 255 \n           AND substr(cbitmap,1,2)='01')\n需要将vplayerid转化为qq，体系转化用到字段：iqq, splayerid\n用户在盘内数据：dtstatdate='20250725' AND saccounttype='-100' AND sgamecode='-100' AND splattype='-100' AND splat='-100'\n\n",
    "output": "",
    "category": "活跃分布",
    "category_reason": "问题关注特定时间段内用户的活跃与流失情况，属于时间维度上的活跃度分析。",
    "category_source": "LLM",
    "llm_raw": "{\n  \"category\": \"活跃分布\",\n  \"rationale\": \"问题关注特定时间段内用户的活跃与流失情况，属于时间维度上的活跃度分析。\"\n}"
  }
]
