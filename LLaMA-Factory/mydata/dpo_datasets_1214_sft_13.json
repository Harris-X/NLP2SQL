[
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025.07.24çš„æ‰‹æ¸¸å…¨é‡ç”¨æˆ·ä¸”æ ‡ç­¾ä¸ºå…¶ä»–ï¼Œåœ¨ç«å“ä¸šåŠ¡ä¸‹2025.05.30-2025.07.24çš„åœ¨çº¿æ—¶é•¿ã€‚\nè¾“å‡ºï¼šsuseridã€sgamecodeã€ionlinetime\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹:QQå·æˆ–è€…å¾®ä¿¡',\n  `suserid` TEXT COMMENT 'å¸å·',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹:qq wxid playerid',\n  `sgamecode` TEXT COMMENT 'ä¸šåŠ¡',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚æšä¸¾å€¼ä¸ºAndroid/ iOSï¼Œå–æ±‡æ€»æ—¶å–-100',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `sgameparam` TEXT COMMENT 'åœºæ¬¡',\n  `schannel` TEXT COMMENT 'ä¸å¯ç”¨å­—æ®µï¼Œç”¨æˆ·å¯ä»¥å¿½ç•¥',\n  `sip` TEXT COMMENT 'å®é™…ä¸Šæ˜¯å½“æ—¥ç™»å½•çš„æœ€å°æ—¶é—´æˆ³ï¼Œå³æœ€æ—©ç™»å½•æ—¶é—´',\n  `sclientver` TEXT COMMENT 'å®¢æˆ·ç«¯ç‰ˆæœ¬',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚ä¸å¯ç”¨',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚ä¸å¯ç”¨',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ¬¡æ•°',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ—¶é—´'\n);\nCREATE TABLE `dim_vplayerid_vies_df` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'ç³»ç»Ÿ',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suseridç±»å‹',\n  `itag` TEXT COMMENT 'ç”¨æˆ·åˆ†å±‚æ ‡ç­¾',\n  `is_reg` BIGINT COMMENT 'æ˜¯å¦å½“æ—¥æ–°è¿›',\n  `is_actv` BIGINT COMMENT 'æ˜¯å¦å½“æ—¥æ´»è·ƒ',\n  `is_neibu` BIGINT COMMENT 'æ˜¯å¦å†…éƒ¨ç©å®¶',\n  `is_lowfps` BIGINT COMMENT 'æ˜¯å¦æ–°è¿›ä½å¸§ç‡',\n  `cbitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾æœ€å·¦æœ€æ–°æ´»è·ƒ',\n  `gender` TEXT COMMENT 'æ€§åˆ«',\n  `province` TEXT COMMENT 'çœä»½',\n  `city` TEXT COMMENT 'åŸå¸‚',\n  `city_level` TEXT COMMENT 'åŸå¸‚ç­‰çº§',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `iregdate_agamek6` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ_ç«¯æ¸¸',\n  `lastdate` TEXT COMMENT 'æœ€åæ´»è·ƒæ—¥æœŸ',\n  `lastdate_agamek6` TEXT COMMENT 'æœ€åæ´»è·ƒæ—¥æœŸ_ç«¯æ¸¸',\n  `lastdays` BIGINT COMMENT 'å½“æ—¥è·ç¦»æœ€åæ´»è·ƒçš„å¤©æ•°',\n  `lastdays_agamek6` BIGINT COMMENT 'å½“æ—¥è·ç¦»æœ€åæ´»è·ƒçš„å¤©æ•°_æœªæ³¨å†Œä¸º-1_å½“æ—¥æ´»è·ƒä¸º1_ä¸Šæ—¥æ´»è·ƒä¸º2',\n  `lastdays_fps` BIGINT COMMENT 'FPSæ‰‹æ¸¸',\n  `lastdays_vie1` BIGINT COMMENT 'æˆ˜å½¹å…ˆé”‹æ‰‹æ¸¸ esports',\n  `lastdays_vie2` BIGINT COMMENT 'çªå‡ºé‡å›´ mobile_live',\n  `lastdays_vie3` BIGINT COMMENT 'æªç«äº‰é”‹æ‰‹æ¸¸ allianceforce',\n  `lastdays_vie4` BIGINT COMMENT 'è±ªæ°å¯¹å†³ strategy',\n  `lastdays_vie5` BIGINT COMMENT 'ç ºåˆƒä½¿è€… jordass',\n  `lastdays_vie6` BIGINT COMMENT 'å¤©å¼ˆ su',\n  `lastdays_vie7` BIGINT COMMENT 'å‹‡å£«å¬å”¤æ‰‹æ¸¸ playzone',\n  `lastdays_vie8` BIGINT COMMENT 'å³¡è°·æ‰‹æ¸¸æ´»è·ƒ initiatived',\n  `lastdays_vie9` BIGINT COMMENT 'å³¡è°·å…¨é‡æ´»è·ƒ initiatived',\n  `lastdays_vie10` BIGINT COMMENT 'å³¡è°·ç«¯æ¸¸æ´»è·ƒ initiatived',\n  `lastdays_vie11` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie12` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie13` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie14` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie15` BIGINT COMMENT 'é¢„ç•™',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nç«å“ä¸šåŠ¡ï¼š\nsgamecode in (\"initiatived\",\"jordass\",\"esports\",\"allianceforce\",\"strategy\",\"playzone\",\"su\")\nsaccounttype = \"-100\" -- è´¦å·ä½“ç³»ï¼Œå–-100è¡¨ç¤ºæ±‡æ€»\nand suseridtype in (\"qq\",\"wxid\") -- ç”¨æˆ·ç±»å‹\nand splattype = \"-100\" -- å¹³å°ç±»å‹\nand splat = \"-100\" -- å¹³å°ï¼Œå†™æ­»ä¸º-100\n\n",
  "chosen": "SELECT \n    t1.suserid,\n    t1.sgamecode,\n    SUM(t1.ionlinetime) as ionlinetime\nFROM dws_mgamejp_login_user_activity_di t1\nJOIN dim_vplayerid_vies_df t2 \n    ON t1.suserid = t2.suserid \n    AND t2.dtstatdate = '20250724' \n    AND t2.itag = 'å…¶ä»–'\nWHERE t1.dtstatdate BETWEEN 20250530 AND 20250724\n    AND t1.sgamecode IN ('initiatived','jordass','esports','allianceforce','strategy','playzone','su')\n    AND t1.saccounttype = '-100'\n    AND t1.suseridtype IN ('qq','wxid')\n    AND t1.splattype = '-100'\n    AND t1.splat = '-100'\nGROUP BY t1.suserid, t1.sgamecode\nORDER BY t1.suserid, t1.sgamecode;",
  "rejected": "SELECT\n  `t1`.`suserid`,\n  `t1`.`sgamecode`,\n  SUM(`t1`.`ionlinetime`)\nFROM `dws_mgamejp_login_user_activity_di` AS `t1`\nINNER JOIN `dim_vplayerid_vies_df` AS `t2`\n  ON `t1`.`suserid` = `t2`.`suserid`\nWHERE\n  `t1`.`dtstatdate` BETWEEN 20250530 AND 20250724\n  AND `t2`.`itag` = \"å…¶ä»–\"\n  AND `t1`.`sgamecode` IN ('initiatived', 'jordass', 'esports', 'allianceforce', 'strategy', 'playzone', 'su')\n  AND `t1`.`saccounttype` = '-100'\n  AND `t1`.`suseridtype` IN ('qq', 'wxid')\n  AND `t1`.`splattype` = '-100'\n  AND `t1`.`splat` = '-100'\nGROUP BY\n  `t1`.`suserid`,\n  `t1`.`sgamecode`"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025.07.24çš„æ‰‹æ¸¸å…¨é‡ç”¨æˆ·ä¸”æ ‡ç­¾ä¸ºå…¶ä»–ï¼Œåœ¨ç«å“ä¸šåŠ¡ä¸‹2025.05.30-2025.07.24çš„åœ¨çº¿æ—¶é•¿ã€‚\nè¾“å‡ºï¼šsuseridã€sgamecodeã€ionlinetime\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹:QQå·æˆ–è€…å¾®ä¿¡',\n  `suserid` TEXT COMMENT 'å¸å·',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹:qq wxid playerid',\n  `sgamecode` TEXT COMMENT 'ä¸šåŠ¡',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚æšä¸¾å€¼ä¸ºAndroid/ iOSï¼Œå–æ±‡æ€»æ—¶å–-100',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `sgameparam` TEXT COMMENT 'åœºæ¬¡',\n  `schannel` TEXT COMMENT 'ä¸å¯ç”¨å­—æ®µï¼Œç”¨æˆ·å¯ä»¥å¿½ç•¥',\n  `sip` TEXT COMMENT 'å®é™…ä¸Šæ˜¯å½“æ—¥ç™»å½•çš„æœ€å°æ—¶é—´æˆ³ï¼Œå³æœ€æ—©ç™»å½•æ—¶é—´',\n  `sclientver` TEXT COMMENT 'å®¢æˆ·ç«¯ç‰ˆæœ¬',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚ä¸å¯ç”¨',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚ä¸å¯ç”¨',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ¬¡æ•°',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ—¶é—´'\n);\nCREATE TABLE `dim_vplayerid_vies_df` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'ç³»ç»Ÿ',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suseridç±»å‹',\n  `itag` TEXT COMMENT 'ç”¨æˆ·åˆ†å±‚æ ‡ç­¾',\n  `is_reg` BIGINT COMMENT 'æ˜¯å¦å½“æ—¥æ–°è¿›',\n  `is_actv` BIGINT COMMENT 'æ˜¯å¦å½“æ—¥æ´»è·ƒ',\n  `is_neibu` BIGINT COMMENT 'æ˜¯å¦å†…éƒ¨ç©å®¶',\n  `is_lowfps` BIGINT COMMENT 'æ˜¯å¦æ–°è¿›ä½å¸§ç‡',\n  `cbitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾æœ€å·¦æœ€æ–°æ´»è·ƒ',\n  `gender` TEXT COMMENT 'æ€§åˆ«',\n  `province` TEXT COMMENT 'çœä»½',\n  `city` TEXT COMMENT 'åŸå¸‚',\n  `city_level` TEXT COMMENT 'åŸå¸‚ç­‰çº§',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `iregdate_agamek6` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ_ç«¯æ¸¸',\n  `lastdate` TEXT COMMENT 'æœ€åæ´»è·ƒæ—¥æœŸ',\n  `lastdate_agamek6` TEXT COMMENT 'æœ€åæ´»è·ƒæ—¥æœŸ_ç«¯æ¸¸',\n  `lastdays` BIGINT COMMENT 'å½“æ—¥è·ç¦»æœ€åæ´»è·ƒçš„å¤©æ•°',\n  `lastdays_agamek6` BIGINT COMMENT 'å½“æ—¥è·ç¦»æœ€åæ´»è·ƒçš„å¤©æ•°_æœªæ³¨å†Œä¸º-1_å½“æ—¥æ´»è·ƒä¸º1_ä¸Šæ—¥æ´»è·ƒä¸º2',\n  `lastdays_fps` BIGINT COMMENT 'FPSæ‰‹æ¸¸',\n  `lastdays_vie1` BIGINT COMMENT 'æˆ˜å½¹å…ˆé”‹æ‰‹æ¸¸ esports',\n  `lastdays_vie2` BIGINT COMMENT 'çªå‡ºé‡å›´ mobile_live',\n  `lastdays_vie3` BIGINT COMMENT 'æªç«äº‰é”‹æ‰‹æ¸¸ allianceforce',\n  `lastdays_vie4` BIGINT COMMENT 'è±ªæ°å¯¹å†³ strategy',\n  `lastdays_vie5` BIGINT COMMENT 'ç ºåˆƒä½¿è€… jordass',\n  `lastdays_vie6` BIGINT COMMENT 'å¤©å¼ˆ su',\n  `lastdays_vie7` BIGINT COMMENT 'å‹‡å£«å¬å”¤æ‰‹æ¸¸ playzone',\n  `lastdays_vie8` BIGINT COMMENT 'å³¡è°·æ‰‹æ¸¸æ´»è·ƒ initiatived',\n  `lastdays_vie9` BIGINT COMMENT 'å³¡è°·å…¨é‡æ´»è·ƒ initiatived',\n  `lastdays_vie10` BIGINT COMMENT 'å³¡è°·ç«¯æ¸¸æ´»è·ƒ initiatived',\n  `lastdays_vie11` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie12` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie13` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie14` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie15` BIGINT COMMENT 'é¢„ç•™',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nç«å“ä¸šåŠ¡ï¼š\nsgamecode in (\"initiatived\",\"jordass\",\"esports\",\"allianceforce\",\"strategy\",\"playzone\",\"su\")\nsaccounttype = \"-100\" -- è´¦å·ä½“ç³»ï¼Œå–-100è¡¨ç¤ºæ±‡æ€»\nand suseridtype in (\"qq\",\"wxid\") -- ç”¨æˆ·ç±»å‹\nand splattype = \"-100\" -- å¹³å°ç±»å‹\nand splat = \"-100\" -- å¹³å°ï¼Œå†™æ­»ä¸º-100\n\n",
  "chosen": "SELECT \n    t1.suserid,\n    t1.sgamecode,\n    SUM(t1.ionlinetime) as ionlinetime\nFROM dws_mgamejp_login_user_activity_di t1\nJOIN dim_vplayerid_vies_df t2 \n    ON t1.suserid = t2.suserid \n    AND t2.dtstatdate = '20250724' \n    AND t2.itag = 'å…¶ä»–'\nWHERE t1.dtstatdate BETWEEN 20250530 AND 20250724\n    AND t1.sgamecode IN ('initiatived','jordass','esports','allianceforce','strategy','playzone','su')\n    AND t1.saccounttype = '-100'\n    AND t1.suseridtype IN ('qq','wxid')\n    AND t1.splattype = '-100'\n    AND t1.splat = '-100'\nGROUP BY t1.suserid, t1.sgamecode\nORDER BY t1.suserid, t1.sgamecode;",
  "rejected": "æˆ‘ä»¬æ¥é€æ­¥åˆ†æè¿™ä¸ªéœ€æ±‚ï¼Œå¹¶æ„å»ºå‡ºæ­£ç¡®çš„ SQL æŸ¥è¯¢è¯­å¥ã€‚\n\n---\n\n## ğŸ” **ç¬¬ä¸€æ­¥ï¼šç†è§£ç”¨æˆ·é—®é¢˜**\n\næˆ‘ä»¬è¦ç»Ÿè®¡çš„æ˜¯ï¼š\n\n> åœ¨ **2025å¹´7æœˆ24æ—¥** è¿™ä¸€å¤©ï¼Œ**æ‰€æœ‰æ‰‹æ¸¸å…¨é‡ç”¨æˆ·ï¼ˆå³æ‰€æœ‰ç©å®¶ï¼‰ä¸­**ï¼Œå¹¶ä¸”è¿™äº›ç”¨æˆ·çš„æ ‡ç­¾æ˜¯â€œå…¶ä»–â€ï¼ˆå‡è®¾æ˜¯æŒ‡æŸä¸ªç‰¹å®šçš„æ ‡ç­¾ï¼‰ï¼Œåœ¨ **ç«å“ä¸šåŠ¡ä¸‹**ï¼ˆå³ `sgamecode` å±äºæŒ‡å®šé›†åˆï¼‰ï¼Œå¹¶ä¸”è¿™äº›ç”¨æˆ·åœ¨ **2025å¹´5æœˆ30æ—¥è‡³2025å¹´7æœˆ24æ—¥ä¹‹é—´** çš„åœ¨çº¿æ—¶é•¿ã€‚\n\nè¾“å‡ºå­—æ®µä¸ºï¼š\n- `suserid`\n- `sgamecode`\n- `ionlinetime`\n\n---\n\n## ğŸ§  **ç¬¬äºŒæ­¥ï¼šåˆ†ææ•°æ®åº“ç»“æ„å’Œå­—æ®µå«ä¹‰**\n\n### âœ… è¡¨ä¸€ï¼š`dws_mgamejp_login_user_activity_di`\n\nè¿™æ˜¯ä¸€ä¸ªæŒ‰å¤©ç»Ÿè®¡çš„æ´»è·ƒç”¨æˆ·è¡Œä¸ºè¡¨ã€‚\n\nå…³é”®å­—æ®µåŒ…æ‹¬ï¼š\n| å­—æ®µå | å«ä¹‰ |\n|--------|------|\n| `dtstatdate` | ç»Ÿè®¡æ—¥æœŸï¼ˆæ ¼å¼ä¸º YYYYMMDDï¼‰ |\n| `saccounttype` | å¸å·ç±»å‹ï¼ˆå¦‚ QQ æˆ– å¾®ä¿¡ï¼‰ |\n| `suserid` | å¸å· ID |\n| `suseridtype` | å¸å·ç±»å‹ï¼ˆqq / wxid / playeridï¼‰ |\n| `sgamecode` | æ¸¸æˆä¸šåŠ¡ä»£ç  |\n| `splattype` | å¹³å°ç±»å‹ï¼ˆAndroid/iOSï¼‰ |\n| `splat` | å°å¹³å°ï¼ˆå›ºå®šä¸º -100ï¼‰ |\n| `ionlinetime` | å½“æ—¥åœ¨çº¿æ—¶é•¿ |\n\n### âœ… è¡¨äºŒï¼š`dim_vplayerid_vies_df`\n\nè¿™æ˜¯ç»´åº¦è¡¨ï¼ŒåŒ…å«ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ä¸æ ‡ç­¾ç­‰ã€‚\n\nå…³é”®å­—æ®µåŒ…æ‹¬ï¼š\n| å­—æ®µå | å«ä¹‰ |\n|--------|------|\n| `suserid` | ç”¨æˆ·ID |\n| `itag` | ç”¨æˆ·æ ‡ç­¾ |\n| `dtstatdate` | ç»Ÿè®¡æ—¥æœŸï¼ˆYYYYMMDDï¼‰ |\n\n---\n\n## ğŸ¯ **ç¬¬ä¸‰æ­¥ï¼šæ˜ç¡®ç­›é€‰æ¡ä»¶**\n\næˆ‘ä»¬éœ€è¦ä»ä¸¤ä¸ªè¡¨ä¸­æå–æ•°æ®å¹¶è¿›è¡Œå…³è”ã€‚\n\n### ğŸ“Œ æ¡ä»¶ä¸€ï¼šæ—¶é—´èŒƒå›´\n\n- `dtstatdate BETWEEN '20250530' AND '20250724'`\n- å› ä¸ºæˆ‘ä»¬å…³æ³¨çš„æ˜¯è¿™æœŸé—´çš„åœ¨çº¿æ—¶é•¿ï¼Œæ‰€ä»¥è¦ä½¿ç”¨ `dws_mgamejp_login_user_activity_di` è¡¨ä¸­çš„ `dtstatdate` å­—æ®µã€‚\n\n### ğŸ“Œ æ¡ä»¶äºŒï¼šç«å“ä¸šåŠ¡\n\n- `sgamecode IN ('initiatived', 'jordass', 'esports', 'allianceforce', 'strategy', 'playzone', 'su')`\n\n### ğŸ“Œ æ¡ä»¶ä¸‰ï¼šè´¦å·ä½“ç³» & ç±»å‹\n\n- `saccounttype = '-100'`\n- `suseridtype IN ('qq', 'wxid')`\n- `splattype = '-100'`\n- `splat = '-100'`\n\n### ğŸ“Œ æ¡ä»¶å››ï¼šç”¨æˆ·æ ‡ç­¾ä¸ºâ€œå…¶ä»–â€\n\n- éœ€è¦ä» `dim_vplayerid_vies_df` ä¸­è·å– `itag = 'å…¶ä»–'` çš„ç”¨æˆ·\n\n### ğŸ“Œ æ¡ä»¶äº”ï¼šç›®æ ‡æ—¥æœŸï¼ˆ2025å¹´7æœˆ24æ—¥ï¼‰\n\n- æœ€ç»ˆç»“æœåº”åªä¿ç•™ `dtstatdate = '20250724'` çš„è®°å½•ï¼ˆå› ä¸ºé¢˜ç›®è¯´â€œç»Ÿè®¡2025.07.24çš„æ‰‹æ¸¸å…¨é‡ç”¨æˆ·â€ï¼Œè¯´æ˜æˆ‘ä»¬æœ€ç»ˆçœ‹çš„æ˜¯è¿™ä¸€å¤©çš„æ•°æ®ï¼‰\n\n---\n\n## ğŸ§© **ç¬¬å››æ­¥ï¼šè®¾è®¡ JOIN å…³ç³»**\n\næˆ‘ä»¬å°†ä¸¤ä¸ªè¡¨é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡Œè¿æ¥ï¼š\n\n- ä½¿ç”¨ `suserid` å’Œ `dtstatdate` ä½œä¸ºè¿æ¥é”®\n- ä» `dim_vplayerid_vies_df` è·å–æ ‡ç­¾ä¿¡æ¯\n- ä» `dws_mgamejp_login_user_activity_di` è·å–åœ¨çº¿æ—¶é•¿\n\n---\n\n## ğŸ§¾ **ç¬¬äº”æ­¥ï¼šç¼–å†™ SQL æŸ¥è¯¢è¯­å¥**\n\n```sql\nSELECT\n    t1.suserid,\n    t1.sgamecode,\n    SUM(t1.ionlinetime) AS ionlinetime\nFROM dws_mgamejp_login_user_activity_di t1\nJOIN dim_vplayerid_vies_df t2\n    ON t1.suserid = t2.suserid\n    AND t1.dtstatdate = t2.dtstatdate\nWHERE\n    t1.dtstatdate BETWEEN '20250530' AND '20250724'\n    AND t1.sgamecode IN ('initiatived', 'jordass', 'esports', 'allianceforce', 'strategy', 'playzone', 'su')\n    AND t1.saccounttype = '-100'\n    AND t1.suseridtype IN ('qq', 'wxid')\n    AND t1.splattype = '-100'\n    AND t1.splat = '-100'\n    AND t2.itag = 'å…¶ä»–'\nGROUP BY\n    t1.suserid,\n    t1.sgamecode;\n```\n\n---\n\n## âœ… **ç¬¬å…­æ­¥ï¼šè§£é‡Šé€»è¾‘**\n\n1. æˆ‘ä»¬å…ˆä» `dws_mgamejp_login_user_activity_di` è¡¨ä¸­é€‰å‡ºç¬¦åˆæ—¶é—´èŒƒå›´å’Œä¸šåŠ¡èŒƒå›´çš„æ•°æ®ï¼›\n2. ç„¶åä¸ `dim_vplayerid_vies_df` è¡¨åšå†…è¿æ¥ï¼Œç¡®ä¿ç”¨æˆ·æœ‰å¯¹åº”çš„æ ‡ç­¾ï¼›\n3. æŒ‡å®šæ ‡ç­¾ä¸ºâ€œå…¶ä»–â€ï¼›\n4. æœ€åæŒ‰ç…§ `suserid` å’Œ `sgamecode` åˆ†ç»„ï¼Œè®¡ç®—æ¯ä¸ªç”¨æˆ·åœ¨æŒ‡å®šæ—¶é—´æ®µå†…çš„æ€»åœ¨çº¿æ—¶é•¿ï¼›\n5. è¾“å‡ºå­—æ®µä¸º `suserid`, `sgamecode`, `ionlinetime`ã€‚\n\n---\n\n## ğŸ“ **è¡¥å……è¯´æ˜**\n\nå¦‚æœå®é™…è¿è¡Œæ—¶å‘ç°æ€§èƒ½ä¸ä½³æˆ–å‡ºç°é‡å¤æ•°æ®ï¼Œå¯è€ƒè™‘ï¼š\n- å¯¹ `dtstatdate` å’Œ `suserid` å»ºç«‹ç´¢å¼•ï¼›\n- æˆ–è€…å¯¹ `sgamecode`ã€`itag` ç­‰è¿‡æ»¤å­—æ®µä¹ŸåŠ ç´¢å¼•ã€‚\n\n--- \n\nå¦‚æœ‰æ›´å¤šå…·ä½“è¦æ±‚ï¼ˆæ¯”å¦‚æ˜¯å¦åŒ…å«æœªæ´»è·ƒç”¨æˆ·ã€æ˜¯å¦éœ€å»é‡ç­‰ï¼‰ï¼Œæ¬¢è¿ç»§ç»­æé—®ï¼"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025.07.24çš„æ‰‹æ¸¸å…¨é‡ç”¨æˆ·ä¸”æ ‡ç­¾ä¸ºå…¶ä»–ï¼Œåœ¨ç«å“ä¸šåŠ¡ä¸‹2025.05.30-2025.07.24çš„åœ¨çº¿æ—¶é•¿ã€‚\nè¾“å‡ºï¼šsuseridã€sgamecodeã€ionlinetime\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹:QQå·æˆ–è€…å¾®ä¿¡',\n  `suserid` TEXT COMMENT 'å¸å·',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹:qq wxid playerid',\n  `sgamecode` TEXT COMMENT 'ä¸šåŠ¡',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚æšä¸¾å€¼ä¸ºAndroid/ iOSï¼Œå–æ±‡æ€»æ—¶å–-100',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `sgameparam` TEXT COMMENT 'åœºæ¬¡',\n  `schannel` TEXT COMMENT 'ä¸å¯ç”¨å­—æ®µï¼Œç”¨æˆ·å¯ä»¥å¿½ç•¥',\n  `sip` TEXT COMMENT 'å®é™…ä¸Šæ˜¯å½“æ—¥ç™»å½•çš„æœ€å°æ—¶é—´æˆ³ï¼Œå³æœ€æ—©ç™»å½•æ—¶é—´',\n  `sclientver` TEXT COMMENT 'å®¢æˆ·ç«¯ç‰ˆæœ¬',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚ä¸å¯ç”¨',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚ä¸å¯ç”¨',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ¬¡æ•°',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ—¶é—´'\n);\nCREATE TABLE `dim_vplayerid_vies_df` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'ç³»ç»Ÿ',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suseridç±»å‹',\n  `itag` TEXT COMMENT 'ç”¨æˆ·åˆ†å±‚æ ‡ç­¾',\n  `is_reg` BIGINT COMMENT 'æ˜¯å¦å½“æ—¥æ–°è¿›',\n  `is_actv` BIGINT COMMENT 'æ˜¯å¦å½“æ—¥æ´»è·ƒ',\n  `is_neibu` BIGINT COMMENT 'æ˜¯å¦å†…éƒ¨ç©å®¶',\n  `is_lowfps` BIGINT COMMENT 'æ˜¯å¦æ–°è¿›ä½å¸§ç‡',\n  `cbitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾æœ€å·¦æœ€æ–°æ´»è·ƒ',\n  `gender` TEXT COMMENT 'æ€§åˆ«',\n  `province` TEXT COMMENT 'çœä»½',\n  `city` TEXT COMMENT 'åŸå¸‚',\n  `city_level` TEXT COMMENT 'åŸå¸‚ç­‰çº§',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `iregdate_agamek6` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ_ç«¯æ¸¸',\n  `lastdate` TEXT COMMENT 'æœ€åæ´»è·ƒæ—¥æœŸ',\n  `lastdate_agamek6` TEXT COMMENT 'æœ€åæ´»è·ƒæ—¥æœŸ_ç«¯æ¸¸',\n  `lastdays` BIGINT COMMENT 'å½“æ—¥è·ç¦»æœ€åæ´»è·ƒçš„å¤©æ•°',\n  `lastdays_agamek6` BIGINT COMMENT 'å½“æ—¥è·ç¦»æœ€åæ´»è·ƒçš„å¤©æ•°_æœªæ³¨å†Œä¸º-1_å½“æ—¥æ´»è·ƒä¸º1_ä¸Šæ—¥æ´»è·ƒä¸º2',\n  `lastdays_fps` BIGINT COMMENT 'FPSæ‰‹æ¸¸',\n  `lastdays_vie1` BIGINT COMMENT 'æˆ˜å½¹å…ˆé”‹æ‰‹æ¸¸ esports',\n  `lastdays_vie2` BIGINT COMMENT 'çªå‡ºé‡å›´ mobile_live',\n  `lastdays_vie3` BIGINT COMMENT 'æªç«äº‰é”‹æ‰‹æ¸¸ allianceforce',\n  `lastdays_vie4` BIGINT COMMENT 'è±ªæ°å¯¹å†³ strategy',\n  `lastdays_vie5` BIGINT COMMENT 'ç ºåˆƒä½¿è€… jordass',\n  `lastdays_vie6` BIGINT COMMENT 'å¤©å¼ˆ su',\n  `lastdays_vie7` BIGINT COMMENT 'å‹‡å£«å¬å”¤æ‰‹æ¸¸ playzone',\n  `lastdays_vie8` BIGINT COMMENT 'å³¡è°·æ‰‹æ¸¸æ´»è·ƒ initiatived',\n  `lastdays_vie9` BIGINT COMMENT 'å³¡è°·å…¨é‡æ´»è·ƒ initiatived',\n  `lastdays_vie10` BIGINT COMMENT 'å³¡è°·ç«¯æ¸¸æ´»è·ƒ initiatived',\n  `lastdays_vie11` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie12` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie13` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie14` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie15` BIGINT COMMENT 'é¢„ç•™',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nç«å“ä¸šåŠ¡ï¼š\nsgamecode in (\"initiatived\",\"jordass\",\"esports\",\"allianceforce\",\"strategy\",\"playzone\",\"su\")\nsaccounttype = \"-100\" -- è´¦å·ä½“ç³»ï¼Œå–-100è¡¨ç¤ºæ±‡æ€»\nand suseridtype in (\"qq\",\"wxid\") -- ç”¨æˆ·ç±»å‹\nand splattype = \"-100\" -- å¹³å°ç±»å‹\nand splat = \"-100\" -- å¹³å°ï¼Œå†™æ­»ä¸º-100\n\n",
  "chosen": "SELECT \n    t1.suserid,\n    t1.sgamecode,\n    SUM(t1.ionlinetime) as ionlinetime\nFROM dws_mgamejp_login_user_activity_di t1\nJOIN dim_vplayerid_vies_df t2 \n    ON t1.suserid = t2.suserid \n    AND t2.dtstatdate = '20250724' \n    AND t2.itag = 'å…¶ä»–'\nWHERE t1.dtstatdate BETWEEN 20250530 AND 20250724\n    AND t1.sgamecode IN ('initiatived','jordass','esports','allianceforce','strategy','playzone','su')\n    AND t1.saccounttype = '-100'\n    AND t1.suseridtype IN ('qq','wxid')\n    AND t1.splattype = '-100'\n    AND t1.splat = '-100'\nGROUP BY t1.suserid, t1.sgamecode\nORDER BY t1.suserid, t1.sgamecode;",
  "rejected": "### ç¬¬ä¸€æ­¥ï¼šç†è§£éœ€æ±‚\n\næˆ‘ä»¬è¦ä»ä¸¤ä¸ªè¡¨ä¸­è·å–æ•°æ®ï¼š\n\n1. **dws_mgamejp_login_user_activity_di** è¡¨ï¼šç”¨äºè·å–ç”¨æˆ·çš„åœ¨çº¿æ—¶é•¿ï¼ˆionlinetimeï¼‰å’Œç›¸å…³æ ‡è¯†ã€‚\n2. **dim_vplayerid_vies_df** è¡¨ï¼šç”¨äºç­›é€‰ç‰¹å®šæ ‡ç­¾çš„ç”¨æˆ·ï¼ˆä¾‹å¦‚â€œå…¶ä»–â€æ ‡ç­¾ï¼‰ï¼Œå¹¶ä¸”é™å®šå…¶æ‰€å±çš„ä¸šåŠ¡èŒƒå›´ï¼ˆç«å“ä¸šåŠ¡ï¼‰ã€‚\n\nå…³é”®æ¡ä»¶åŒ…æ‹¬ï¼š\n- ç»Ÿè®¡æ—¥æœŸä¸º 2025-07-24ï¼›\n- æ ‡ç­¾ä¸ºâ€œå…¶ä»–â€ï¼›\n- ä¸šåŠ¡å±äºç«å“ä¸šåŠ¡ï¼ˆå³ `sgamecode` åœ¨æŒ‡å®šåˆ—è¡¨å†…ï¼‰ï¼›\n- ç”¨æˆ·ç±»å‹æ˜¯ QQ æˆ– å¾®ä¿¡è´¦å·ï¼›\n- å¹³å°ç±»å‹å’Œå¹³å°éƒ½ä¸º `-100`ï¼›\n- æ—¶é—´çª—å£ä¸º 2025-05-30 åˆ° 2025-07-24ã€‚\n\n---\n\n### ç¬¬äºŒæ­¥ï¼šç¡®å®šå­—æ®µæ¥æº\n\n#### æ¥è‡ª `dws_mgamejp_login_user_activity_di` çš„å­—æ®µï¼š\n- `suserid`: ç”¨æˆ· ID\n- `sgamecode`: ä¸šåŠ¡ä»£ç \n- `ionlinetime`: åœ¨çº¿æ—¶é•¿ï¼ˆå•ä½å¯èƒ½æ˜¯ç§’ï¼‰\n\n#### æ¥è‡ª `dim_vplayerid_vies_df` çš„å­—æ®µï¼š\n- `suserid`: ç”¨æˆ· IDï¼ˆä¸ä¸Šé¢ä¸€è‡´ï¼‰\n- `itag`: ç”¨æˆ·æ ‡ç­¾ï¼ˆæˆ‘ä»¬éœ€è¦ç­›é€‰å‡ºâ€œå…¶ä»–â€æ ‡ç­¾ï¼‰\n\n---\n\n### ç¬¬ä¸‰æ­¥ï¼šæ„å»º JOIN æ¡ä»¶\n\næˆ‘ä»¬éœ€è¦å°†ä¸¤ä¸ªè¡¨é€šè¿‡ `suserid` å­—æ®µè¿›è¡Œè¿æ¥ï¼Œå¹¶ç¡®ä¿åŒ¹é…çš„æ˜¯åŒä¸€å¤©çš„æ•°æ®ã€‚\n\n- å¯¹äº `dws_mgamejp_login_user_activity_di` è¡¨ï¼Œæˆ‘ä»¬ä½¿ç”¨ `dtstatdate = 20250724`\n- å¯¹äº `dim_vplayerid_vies_df` è¡¨ï¼Œæˆ‘ä»¬ä¹Ÿä½¿ç”¨ `dtstatdate = 20250724`\n\n---\n\n### ç¬¬å››æ­¥ï¼šæ·»åŠ è¿‡æ»¤æ¡ä»¶\n\n#### ç«å“ä¸šåŠ¡èŒƒå›´ï¼š\n```sql\nsgamecode IN ('initiatived', 'jordass', 'esports', 'allianceforce', 'strategy', 'playzone', 'su')\n```\n\n#### ç”¨æˆ·ç±»å‹ï¼š\n```sql\nsuseridtype IN ('qq', 'wxid')\n```\n\n#### å¹³å°ç±»å‹ä¸å¹³å°ï¼š\n```sql\nsplattype = '-100' AND splat = '-100'\n```\n\n#### æ ‡ç­¾ç­›é€‰ï¼š\n```sql\nitag = 'å…¶ä»–'\n```\n\n---\n\n### ç¬¬äº”æ­¥ï¼šæœ€ç»ˆ SQL æŸ¥è¯¢è¯­å¥\n\n```sql\nSELECT\n    a.suserid,\n    a.sgamecode,\n    a.ionlinetime\nFROM dws_mgamejp_login_user_activity_di AS a\nJOIN dim_vplayerid_vies_df AS b\n    ON a.suserid = b.suserid\nWHERE\n    a.dtstatdate = 20250724\n    AND b.dtstatdate = 20250724\n    AND a.sgamecode IN ('initiatived', 'jordass', 'esports', 'allianceforce', 'strategy', 'playzone', 'su')\n    AND a.suseridtype IN ('qq', 'wxid')\n    AND a.splattype = '-100'\n    AND a.splat = '-100'\n    AND b.itag = 'å…¶ä»–';\n```\n\n---\n\n### ç¬¬å…­æ­¥ï¼šè¯´æ˜\n\n- ä½¿ç”¨äº† INNER JOIN å°†ä¸¤ä¸ªè¡¨æŒ‰ `suserid` è¿›è¡Œå…³è”ï¼›\n- æ‰€æœ‰å­—æ®µå‡æ¥è‡ªå¯¹åº”çš„è¡¨ï¼›\n- æœ€ç»ˆåªä¿ç•™æ»¡è¶³æ‰€æœ‰æ¡ä»¶çš„ç»“æœï¼›\n- è¾“å‡ºå­—æ®µä¸ºé¢˜ç›®è¦æ±‚çš„ `suserid`, `sgamecode`, `ionlinetime`ã€‚\n\nå¦‚æœ‰æ›´å¤šç»´åº¦æˆ–å¤æ‚é€»è¾‘å¯è¿›ä¸€æ­¥æ‰©å±•æ­¤æŸ¥è¯¢ã€‚"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025.07.24çš„æ‰‹æ¸¸å…¨é‡ç”¨æˆ·ä¸”æ ‡ç­¾ä¸ºå…¶ä»–ï¼Œåœ¨ç«å“ä¸šåŠ¡ä¸‹2025.05.30-2025.07.24çš„åœ¨çº¿æ—¶é•¿ã€‚\nè¾“å‡ºï¼šsuseridã€sgamecodeã€ionlinetime\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹:QQå·æˆ–è€…å¾®ä¿¡',\n  `suserid` TEXT COMMENT 'å¸å·',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹:qq wxid playerid',\n  `sgamecode` TEXT COMMENT 'ä¸šåŠ¡',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚æšä¸¾å€¼ä¸ºAndroid/ iOSï¼Œå–æ±‡æ€»æ—¶å–-100',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `sgameparam` TEXT COMMENT 'åœºæ¬¡',\n  `schannel` TEXT COMMENT 'ä¸å¯ç”¨å­—æ®µï¼Œç”¨æˆ·å¯ä»¥å¿½ç•¥',\n  `sip` TEXT COMMENT 'å®é™…ä¸Šæ˜¯å½“æ—¥ç™»å½•çš„æœ€å°æ—¶é—´æˆ³ï¼Œå³æœ€æ—©ç™»å½•æ—¶é—´',\n  `sclientver` TEXT COMMENT 'å®¢æˆ·ç«¯ç‰ˆæœ¬',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚ä¸å¯ç”¨',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚ä¸å¯ç”¨',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ¬¡æ•°',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ—¶é—´'\n);\nCREATE TABLE `dim_vplayerid_vies_df` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'ç³»ç»Ÿ',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suseridç±»å‹',\n  `itag` TEXT COMMENT 'ç”¨æˆ·åˆ†å±‚æ ‡ç­¾',\n  `is_reg` BIGINT COMMENT 'æ˜¯å¦å½“æ—¥æ–°è¿›',\n  `is_actv` BIGINT COMMENT 'æ˜¯å¦å½“æ—¥æ´»è·ƒ',\n  `is_neibu` BIGINT COMMENT 'æ˜¯å¦å†…éƒ¨ç©å®¶',\n  `is_lowfps` BIGINT COMMENT 'æ˜¯å¦æ–°è¿›ä½å¸§ç‡',\n  `cbitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾æœ€å·¦æœ€æ–°æ´»è·ƒ',\n  `gender` TEXT COMMENT 'æ€§åˆ«',\n  `province` TEXT COMMENT 'çœä»½',\n  `city` TEXT COMMENT 'åŸå¸‚',\n  `city_level` TEXT COMMENT 'åŸå¸‚ç­‰çº§',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `iregdate_agamek6` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ_ç«¯æ¸¸',\n  `lastdate` TEXT COMMENT 'æœ€åæ´»è·ƒæ—¥æœŸ',\n  `lastdate_agamek6` TEXT COMMENT 'æœ€åæ´»è·ƒæ—¥æœŸ_ç«¯æ¸¸',\n  `lastdays` BIGINT COMMENT 'å½“æ—¥è·ç¦»æœ€åæ´»è·ƒçš„å¤©æ•°',\n  `lastdays_agamek6` BIGINT COMMENT 'å½“æ—¥è·ç¦»æœ€åæ´»è·ƒçš„å¤©æ•°_æœªæ³¨å†Œä¸º-1_å½“æ—¥æ´»è·ƒä¸º1_ä¸Šæ—¥æ´»è·ƒä¸º2',\n  `lastdays_fps` BIGINT COMMENT 'FPSæ‰‹æ¸¸',\n  `lastdays_vie1` BIGINT COMMENT 'æˆ˜å½¹å…ˆé”‹æ‰‹æ¸¸ esports',\n  `lastdays_vie2` BIGINT COMMENT 'çªå‡ºé‡å›´ mobile_live',\n  `lastdays_vie3` BIGINT COMMENT 'æªç«äº‰é”‹æ‰‹æ¸¸ allianceforce',\n  `lastdays_vie4` BIGINT COMMENT 'è±ªæ°å¯¹å†³ strategy',\n  `lastdays_vie5` BIGINT COMMENT 'ç ºåˆƒä½¿è€… jordass',\n  `lastdays_vie6` BIGINT COMMENT 'å¤©å¼ˆ su',\n  `lastdays_vie7` BIGINT COMMENT 'å‹‡å£«å¬å”¤æ‰‹æ¸¸ playzone',\n  `lastdays_vie8` BIGINT COMMENT 'å³¡è°·æ‰‹æ¸¸æ´»è·ƒ initiatived',\n  `lastdays_vie9` BIGINT COMMENT 'å³¡è°·å…¨é‡æ´»è·ƒ initiatived',\n  `lastdays_vie10` BIGINT COMMENT 'å³¡è°·ç«¯æ¸¸æ´»è·ƒ initiatived',\n  `lastdays_vie11` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie12` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie13` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie14` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie15` BIGINT COMMENT 'é¢„ç•™',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nç«å“ä¸šåŠ¡ï¼š\nsgamecode in (\"initiatived\",\"jordass\",\"esports\",\"allianceforce\",\"strategy\",\"playzone\",\"su\")\nsaccounttype = \"-100\" -- è´¦å·ä½“ç³»ï¼Œå–-100è¡¨ç¤ºæ±‡æ€»\nand suseridtype in (\"qq\",\"wxid\") -- ç”¨æˆ·ç±»å‹\nand splattype = \"-100\" -- å¹³å°ç±»å‹\nand splat = \"-100\" -- å¹³å°ï¼Œå†™æ­»ä¸º-100\n\n",
  "chosen": "SELECT \n    t1.suserid,\n    t1.sgamecode,\n    SUM(t1.ionlinetime) as ionlinetime\nFROM dws_mgamejp_login_user_activity_di t1\nJOIN dim_vplayerid_vies_df t2 \n    ON t1.suserid = t2.suserid \n    AND t2.dtstatdate = '20250724' \n    AND t2.itag = 'å…¶ä»–'\nWHERE t1.dtstatdate BETWEEN 20250530 AND 20250724\n    AND t1.sgamecode IN ('initiatived','jordass','esports','allianceforce','strategy','playzone','su')\n    AND t1.saccounttype = '-100'\n    AND t1.suseridtype IN ('qq','wxid')\n    AND t1.splattype = '-100'\n    AND t1.splat = '-100'\nGROUP BY t1.suserid, t1.sgamecode\nORDER BY t1.suserid, t1.sgamecode;",
  "rejected": "SELECT\n  `t1`.`suserid`,\n  `t1`.`sgamecode`,\n  `t1`.`ionlinetime`\nFROM `dws_mgamejp_login_user_activity_di` AS `t1`\nINNER JOIN `dim_vplayerid_vies_df` AS `t2`\n  ON `t1`.`suserid` = `t2`.`suserid`\nWHERE\n  `t1`.`dtstatdate` = 20250724\n  AND `t2`.`itag` = \"å…¶ä»–\"\n  AND `t1`.`sgamecode` IN (\"initiatived\", \"jordass\", \"esports\", \"allianceforce\", \"strategy\", \"playzone\", \"su\")\n  AND `t1`.`saccounttype` = \"-100\"\n  AND `t1`.`suseridtype` IN (\"qq\", \"wxid\")\n  AND `t1`.`splattype` = \"-100\"\n  AND `t1`.`splat` = \"-100\"\n  AND `t2`.`lastdate` BETWEEN \"20250530\" AND \"20250724\""
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025.07.24çš„æ‰‹æ¸¸å…¨é‡ç”¨æˆ·ä¸”æ ‡ç­¾ä¸ºå…¶ä»–ï¼Œåœ¨ç«å“ä¸šåŠ¡ä¸‹2025.05.30-2025.07.24çš„åœ¨çº¿æ—¶é•¿ã€‚\nè¾“å‡ºï¼šsuseridã€sgamecodeã€ionlinetime\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹:QQå·æˆ–è€…å¾®ä¿¡',\n  `suserid` TEXT COMMENT 'å¸å·',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹:qq wxid playerid',\n  `sgamecode` TEXT COMMENT 'ä¸šåŠ¡',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚æšä¸¾å€¼ä¸ºAndroid/ iOSï¼Œå–æ±‡æ€»æ—¶å–-100',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `sgameparam` TEXT COMMENT 'åœºæ¬¡',\n  `schannel` TEXT COMMENT 'ä¸å¯ç”¨å­—æ®µï¼Œç”¨æˆ·å¯ä»¥å¿½ç•¥',\n  `sip` TEXT COMMENT 'å®é™…ä¸Šæ˜¯å½“æ—¥ç™»å½•çš„æœ€å°æ—¶é—´æˆ³ï¼Œå³æœ€æ—©ç™»å½•æ—¶é—´',\n  `sclientver` TEXT COMMENT 'å®¢æˆ·ç«¯ç‰ˆæœ¬',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚ä¸å¯ç”¨',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚ä¸å¯ç”¨',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ¬¡æ•°',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ—¶é—´'\n);\nCREATE TABLE `dim_vplayerid_vies_df` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'ç³»ç»Ÿ',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suseridç±»å‹',\n  `itag` TEXT COMMENT 'ç”¨æˆ·åˆ†å±‚æ ‡ç­¾',\n  `is_reg` BIGINT COMMENT 'æ˜¯å¦å½“æ—¥æ–°è¿›',\n  `is_actv` BIGINT COMMENT 'æ˜¯å¦å½“æ—¥æ´»è·ƒ',\n  `is_neibu` BIGINT COMMENT 'æ˜¯å¦å†…éƒ¨ç©å®¶',\n  `is_lowfps` BIGINT COMMENT 'æ˜¯å¦æ–°è¿›ä½å¸§ç‡',\n  `cbitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾æœ€å·¦æœ€æ–°æ´»è·ƒ',\n  `gender` TEXT COMMENT 'æ€§åˆ«',\n  `province` TEXT COMMENT 'çœä»½',\n  `city` TEXT COMMENT 'åŸå¸‚',\n  `city_level` TEXT COMMENT 'åŸå¸‚ç­‰çº§',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `iregdate_agamek6` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ_ç«¯æ¸¸',\n  `lastdate` TEXT COMMENT 'æœ€åæ´»è·ƒæ—¥æœŸ',\n  `lastdate_agamek6` TEXT COMMENT 'æœ€åæ´»è·ƒæ—¥æœŸ_ç«¯æ¸¸',\n  `lastdays` BIGINT COMMENT 'å½“æ—¥è·ç¦»æœ€åæ´»è·ƒçš„å¤©æ•°',\n  `lastdays_agamek6` BIGINT COMMENT 'å½“æ—¥è·ç¦»æœ€åæ´»è·ƒçš„å¤©æ•°_æœªæ³¨å†Œä¸º-1_å½“æ—¥æ´»è·ƒä¸º1_ä¸Šæ—¥æ´»è·ƒä¸º2',\n  `lastdays_fps` BIGINT COMMENT 'FPSæ‰‹æ¸¸',\n  `lastdays_vie1` BIGINT COMMENT 'æˆ˜å½¹å…ˆé”‹æ‰‹æ¸¸ esports',\n  `lastdays_vie2` BIGINT COMMENT 'çªå‡ºé‡å›´ mobile_live',\n  `lastdays_vie3` BIGINT COMMENT 'æªç«äº‰é”‹æ‰‹æ¸¸ allianceforce',\n  `lastdays_vie4` BIGINT COMMENT 'è±ªæ°å¯¹å†³ strategy',\n  `lastdays_vie5` BIGINT COMMENT 'ç ºåˆƒä½¿è€… jordass',\n  `lastdays_vie6` BIGINT COMMENT 'å¤©å¼ˆ su',\n  `lastdays_vie7` BIGINT COMMENT 'å‹‡å£«å¬å”¤æ‰‹æ¸¸ playzone',\n  `lastdays_vie8` BIGINT COMMENT 'å³¡è°·æ‰‹æ¸¸æ´»è·ƒ initiatived',\n  `lastdays_vie9` BIGINT COMMENT 'å³¡è°·å…¨é‡æ´»è·ƒ initiatived',\n  `lastdays_vie10` BIGINT COMMENT 'å³¡è°·ç«¯æ¸¸æ´»è·ƒ initiatived',\n  `lastdays_vie11` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie12` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie13` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie14` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie15` BIGINT COMMENT 'é¢„ç•™',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nç«å“ä¸šåŠ¡ï¼š\nsgamecode in (\"initiatived\",\"jordass\",\"esports\",\"allianceforce\",\"strategy\",\"playzone\",\"su\")\nsaccounttype = \"-100\" -- è´¦å·ä½“ç³»ï¼Œå–-100è¡¨ç¤ºæ±‡æ€»\nand suseridtype in (\"qq\",\"wxid\") -- ç”¨æˆ·ç±»å‹\nand splattype = \"-100\" -- å¹³å°ç±»å‹\nand splat = \"-100\" -- å¹³å°ï¼Œå†™æ­»ä¸º-100\n\n",
  "chosen": "SELECT \n    t1.suserid,\n    t1.sgamecode,\n    SUM(t1.ionlinetime) as ionlinetime\nFROM dws_mgamejp_login_user_activity_di t1\nJOIN dim_vplayerid_vies_df t2 \n    ON t1.suserid = t2.suserid \n    AND t2.dtstatdate = '20250724' \n    AND t2.itag = 'å…¶ä»–'\nWHERE t1.dtstatdate BETWEEN 20250530 AND 20250724\n    AND t1.sgamecode IN ('initiatived','jordass','esports','allianceforce','strategy','playzone','su')\n    AND t1.saccounttype = '-100'\n    AND t1.suseridtype IN ('qq','wxid')\n    AND t1.splattype = '-100'\n    AND t1.splat = '-100'\nGROUP BY t1.suserid, t1.sgamecode\nORDER BY t1.suserid, t1.sgamecode;",
  "rejected": "SELECT\n  `T1`.`suserid`,\n  `T1`.`sgamecode`,\n  SUM(`T1`.`ionlinetime`)\nFROM `dws_mgamejp_login_user_activity_di` AS `T1`\nINNER JOIN `dim_vplayerid_vies_df` AS `T2`\n  ON `T1`.`suserid` = `T2`.`suserid`\nWHERE\n  `T1`.`dtstatdate` BETWEEN 20250530 AND 20250724\n  AND `T2`.`itag` = \"å…¶ä»–\"\n  AND `T1`.`sgamecode` IN (\"initiatived\", \"jordass\", \"esports\", \"allianceforce\", \"strategy\", \"playzone\", \"su\")\n  AND `T1`.`saccounttype` = \"-100\"\n  AND `T1`.`suseridtype` IN (\"qq\", \"wxid\")\n  AND `T1`.`splattype` = \"-100\"\n  AND `T1`.`splat` = \"-100\"\nGROUP BY\n  `T1`.`suserid`,\n  `T1`.`sgamecode`"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025.07.24çš„æ‰‹æ¸¸å…¨é‡ç”¨æˆ·ä¸”æ ‡ç­¾ä¸ºå…¶ä»–ï¼Œåœ¨ç«å“ä¸šåŠ¡ä¸‹2025.05.30-2025.07.24çš„åœ¨çº¿æ—¶é•¿ã€‚\nè¾“å‡ºï¼šsuseridã€sgamecodeã€ionlinetime\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹:QQå·æˆ–è€…å¾®ä¿¡',\n  `suserid` TEXT COMMENT 'å¸å·',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹:qq wxid playerid',\n  `sgamecode` TEXT COMMENT 'ä¸šåŠ¡',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚æšä¸¾å€¼ä¸ºAndroid/ iOSï¼Œå–æ±‡æ€»æ—¶å–-100',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `sgameparam` TEXT COMMENT 'åœºæ¬¡',\n  `schannel` TEXT COMMENT 'ä¸å¯ç”¨å­—æ®µï¼Œç”¨æˆ·å¯ä»¥å¿½ç•¥',\n  `sip` TEXT COMMENT 'å®é™…ä¸Šæ˜¯å½“æ—¥ç™»å½•çš„æœ€å°æ—¶é—´æˆ³ï¼Œå³æœ€æ—©ç™»å½•æ—¶é—´',\n  `sclientver` TEXT COMMENT 'å®¢æˆ·ç«¯ç‰ˆæœ¬',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚ä¸å¯ç”¨',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚ä¸å¯ç”¨',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ¬¡æ•°',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ—¶é—´'\n);\nCREATE TABLE `dim_vplayerid_vies_df` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'ç³»ç»Ÿ',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suseridç±»å‹',\n  `itag` TEXT COMMENT 'ç”¨æˆ·åˆ†å±‚æ ‡ç­¾',\n  `is_reg` BIGINT COMMENT 'æ˜¯å¦å½“æ—¥æ–°è¿›',\n  `is_actv` BIGINT COMMENT 'æ˜¯å¦å½“æ—¥æ´»è·ƒ',\n  `is_neibu` BIGINT COMMENT 'æ˜¯å¦å†…éƒ¨ç©å®¶',\n  `is_lowfps` BIGINT COMMENT 'æ˜¯å¦æ–°è¿›ä½å¸§ç‡',\n  `cbitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾æœ€å·¦æœ€æ–°æ´»è·ƒ',\n  `gender` TEXT COMMENT 'æ€§åˆ«',\n  `province` TEXT COMMENT 'çœä»½',\n  `city` TEXT COMMENT 'åŸå¸‚',\n  `city_level` TEXT COMMENT 'åŸå¸‚ç­‰çº§',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `iregdate_agamek6` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ_ç«¯æ¸¸',\n  `lastdate` TEXT COMMENT 'æœ€åæ´»è·ƒæ—¥æœŸ',\n  `lastdate_agamek6` TEXT COMMENT 'æœ€åæ´»è·ƒæ—¥æœŸ_ç«¯æ¸¸',\n  `lastdays` BIGINT COMMENT 'å½“æ—¥è·ç¦»æœ€åæ´»è·ƒçš„å¤©æ•°',\n  `lastdays_agamek6` BIGINT COMMENT 'å½“æ—¥è·ç¦»æœ€åæ´»è·ƒçš„å¤©æ•°_æœªæ³¨å†Œä¸º-1_å½“æ—¥æ´»è·ƒä¸º1_ä¸Šæ—¥æ´»è·ƒä¸º2',\n  `lastdays_fps` BIGINT COMMENT 'FPSæ‰‹æ¸¸',\n  `lastdays_vie1` BIGINT COMMENT 'æˆ˜å½¹å…ˆé”‹æ‰‹æ¸¸ esports',\n  `lastdays_vie2` BIGINT COMMENT 'çªå‡ºé‡å›´ mobile_live',\n  `lastdays_vie3` BIGINT COMMENT 'æªç«äº‰é”‹æ‰‹æ¸¸ allianceforce',\n  `lastdays_vie4` BIGINT COMMENT 'è±ªæ°å¯¹å†³ strategy',\n  `lastdays_vie5` BIGINT COMMENT 'ç ºåˆƒä½¿è€… jordass',\n  `lastdays_vie6` BIGINT COMMENT 'å¤©å¼ˆ su',\n  `lastdays_vie7` BIGINT COMMENT 'å‹‡å£«å¬å”¤æ‰‹æ¸¸ playzone',\n  `lastdays_vie8` BIGINT COMMENT 'å³¡è°·æ‰‹æ¸¸æ´»è·ƒ initiatived',\n  `lastdays_vie9` BIGINT COMMENT 'å³¡è°·å…¨é‡æ´»è·ƒ initiatived',\n  `lastdays_vie10` BIGINT COMMENT 'å³¡è°·ç«¯æ¸¸æ´»è·ƒ initiatived',\n  `lastdays_vie11` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie12` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie13` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie14` BIGINT COMMENT 'é¢„ç•™',\n  `lastdays_vie15` BIGINT COMMENT 'é¢„ç•™',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nç«å“ä¸šåŠ¡ï¼š\nsgamecode in (\"initiatived\",\"jordass\",\"esports\",\"allianceforce\",\"strategy\",\"playzone\",\"su\")\nsaccounttype = \"-100\" -- è´¦å·ä½“ç³»ï¼Œå–-100è¡¨ç¤ºæ±‡æ€»\nand suseridtype in (\"qq\",\"wxid\") -- ç”¨æˆ·ç±»å‹\nand splattype = \"-100\" -- å¹³å°ç±»å‹\nand splat = \"-100\" -- å¹³å°ï¼Œå†™æ­»ä¸º-100\n\n",
  "chosen": "SELECT \n    t1.suserid,\n    t1.sgamecode,\n    SUM(t1.ionlinetime) as ionlinetime\nFROM dws_mgamejp_login_user_activity_di t1\nJOIN dim_vplayerid_vies_df t2 \n    ON t1.suserid = t2.suserid \n    AND t2.dtstatdate = '20250724' \n    AND t2.itag = 'å…¶ä»–'\nWHERE t1.dtstatdate BETWEEN 20250530 AND 20250724\n    AND t1.sgamecode IN ('initiatived','jordass','esports','allianceforce','strategy','playzone','su')\n    AND t1.saccounttype = '-100'\n    AND t1.suseridtype IN ('qq','wxid')\n    AND t1.splattype = '-100'\n    AND t1.splat = '-100'\nGROUP BY t1.suserid, t1.sgamecode\nORDER BY t1.suserid, t1.sgamecode;",
  "rejected": "SELECT\n  `T1`.`suserid`,\n  `T1`.`sgamecode`,\n  SUM(`T1`.`ionlinetime`)\nFROM `dws_mgamejp_login_user_activity_di` AS `T1`\nINNER JOIN `dim_vplayerid_vies_df` AS `T2`\n  ON `T1`.`suserid` = `T2`.`suserid`\nWHERE\n  `T1`.`dtstatdate` BETWEEN 20250530 AND 20250724\n  AND `T2`.`itag` = \"å…¶ä»–\"\n  AND `T1`.`sgamecode` IN (\"initiatived\", \"jordass\", \"esports\", \"allianceforce\", \"strategy\", \"playzone\", \"su\")\n  AND `T1`.`saccounttype` = \"-100\"\n  AND `T1`.`suseridtype` IN (\"qq\", \"wxid\")\n  AND `T1`.`splattype` = \"-100\"\n  AND `T1`.`splat` = \"-100\"\nGROUP BY\n  `T1`.`suserid`,\n  `T1`.`sgamecode`"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´1æœˆå‹‡è€…ç›Ÿçº¦ç«¯æ¸¸æ´»è·ƒç©å®¶äº¤å‰å³¡è°·ç«¯æ¸¸åŠæ‰‹æ¸¸æ´»è·ƒç©å®¶\nè¾“å‡ºï¼šç©å®¶gplayerid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹:QQå·æˆ–è€…å¾®ä¿¡',\n  `suserid` TEXT COMMENT 'å¸å·',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹:qq wxid playerid',\n  `sgamecode` TEXT COMMENT 'ä¸šåŠ¡',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚æšä¸¾å€¼ä¸ºAndroid/ iOSï¼Œå–æ±‡æ€»æ—¶å–-100',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `sgameparam` TEXT COMMENT 'åœºæ¬¡',\n  `schannel` TEXT COMMENT 'ä¸å¯ç”¨å­—æ®µï¼Œç”¨æˆ·å¯ä»¥å¿½ç•¥',\n  `sip` TEXT COMMENT 'å®é™…ä¸Šæ˜¯å½“æ—¥ç™»å½•çš„æœ€å°æ—¶é—´æˆ³ï¼Œå³æœ€æ—©ç™»å½•æ—¶é—´',\n  `sclientver` TEXT COMMENT 'å®¢æˆ·ç«¯ç‰ˆæœ¬',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚ä¸å¯ç”¨',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚ä¸å¯ç”¨',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ¬¡æ•°',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ—¶é—´'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nå³¡è°·ç­›é€‰é€»è¾‘:\nsgamecode = \"initiatived\" -- ç­›é€‰å³¡è°·æ¸¸æˆ\nand saccounttype = \"-100\" -- è´¦å·ä½“ç³»ï¼Œå–-100è¡¨ç¤ºæ±‡æ€»\nand suseridtype in (\"qq\", \"wxid\") -- è´¦å·ç±»å‹ï¼Œå–qqæˆ–wxid\nand splattype in (\"-100\", \"PC\") -- å³¡è°·æ‰‹æ¸¸ç©å®¶åŠPCç«¯ç©å®¶\nand splat = \"-100\" -- å†™æ­»ä¸º-100\n\n",
  "chosen": "SELECT DISTINCT a.iuserid AS gplayerid\nFROM dws_argothek_oss_login_di a\nJOIN dim_argothek_gplayerid2qqwxid_df b ON a.iuserid = b.iuserid\nWHERE a.statis_date BETWEEN 20250101 AND 20250131\nAND b.suserid IN (\n    SELECT DISTINCT suserid\n    FROM dws_mgamejp_login_user_activity_di\n    WHERE sgamecode = 'initiatived'\n    AND saccounttype = '-100'\n    AND suseridtype IN ('qq', 'wxid')\n    AND splattype IN ('-100', 'PC')\n    AND splat = '-100'\n    AND dtstatdate BETWEEN 20250101 AND 20250131\n)\nORDER BY a.iuserid",
  "rejected": "SELECT DISTINCT\n  `T1`.`suserid`\nFROM `dws_mgamejp_login_user_activity_di` AS `T1`\nINNER JOIN `dim_argothek_gplayerid2qqwxid_df` AS `T2`\n  ON `T1`.`suserid` = `T2`.`suserid`\nWHERE\n  `T1`.`sgamecode` = 'initiatived'\n  AND `T1`.`saccounttype` = '-100'\n  AND `T1`.`suseridtype` IN ('qq', 'wxid')\n  AND `T1`.`splattype` IN ('-100', 'PC')\n  AND `T1`.`splat` = '-100'\n  AND `T2`.`vGameAppid` = '202501'"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´1æœˆå‹‡è€…ç›Ÿçº¦ç«¯æ¸¸æ´»è·ƒç©å®¶äº¤å‰å³¡è°·ç«¯æ¸¸åŠæ‰‹æ¸¸æ´»è·ƒç©å®¶\nè¾“å‡ºï¼šç©å®¶gplayerid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹:QQå·æˆ–è€…å¾®ä¿¡',\n  `suserid` TEXT COMMENT 'å¸å·',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹:qq wxid playerid',\n  `sgamecode` TEXT COMMENT 'ä¸šåŠ¡',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚æšä¸¾å€¼ä¸ºAndroid/ iOSï¼Œå–æ±‡æ€»æ—¶å–-100',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `sgameparam` TEXT COMMENT 'åœºæ¬¡',\n  `schannel` TEXT COMMENT 'ä¸å¯ç”¨å­—æ®µï¼Œç”¨æˆ·å¯ä»¥å¿½ç•¥',\n  `sip` TEXT COMMENT 'å®é™…ä¸Šæ˜¯å½“æ—¥ç™»å½•çš„æœ€å°æ—¶é—´æˆ³ï¼Œå³æœ€æ—©ç™»å½•æ—¶é—´',\n  `sclientver` TEXT COMMENT 'å®¢æˆ·ç«¯ç‰ˆæœ¬',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚ä¸å¯ç”¨',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚ä¸å¯ç”¨',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ¬¡æ•°',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ—¶é—´'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nå³¡è°·ç­›é€‰é€»è¾‘:\nsgamecode = \"initiatived\" -- ç­›é€‰å³¡è°·æ¸¸æˆ\nand saccounttype = \"-100\" -- è´¦å·ä½“ç³»ï¼Œå–-100è¡¨ç¤ºæ±‡æ€»\nand suseridtype in (\"qq\", \"wxid\") -- è´¦å·ç±»å‹ï¼Œå–qqæˆ–wxid\nand splattype in (\"-100\", \"PC\") -- å³¡è°·æ‰‹æ¸¸ç©å®¶åŠPCç«¯ç©å®¶\nand splat = \"-100\" -- å†™æ­»ä¸º-100\n\n",
  "chosen": "SELECT DISTINCT a.iuserid AS gplayerid\nFROM dws_argothek_oss_login_di a\nJOIN dim_argothek_gplayerid2qqwxid_df b ON a.iuserid = b.iuserid\nWHERE a.statis_date BETWEEN 20250101 AND 20250131\nAND b.suserid IN (\n    SELECT DISTINCT suserid\n    FROM dws_mgamejp_login_user_activity_di\n    WHERE sgamecode = 'initiatived'\n    AND saccounttype = '-100'\n    AND suseridtype IN ('qq', 'wxid')\n    AND splattype IN ('-100', 'PC')\n    AND splat = '-100'\n    AND dtstatdate BETWEEN 20250101 AND 20250131\n)\nORDER BY a.iuserid",
  "rejected": "SELECT DISTINCT\n  `T1`.`iuserid`\nFROM `dim_argothek_gplayerid2qqwxid_df` AS `T1`\nINNER JOIN `dws_mgamejp_login_user_activity_di` AS `T2`\n  ON `T1`.`suserid` = `T2`.`suserid`\nWHERE\n  `T2`.`sgamecode` = 'initiatived'\n  AND `T2`.`saccounttype` = '-100'\n  AND `T2`.`suseridtype` IN ('qq', 'wxid')\n  AND `T2`.`splattype` IN ('-100', 'PC')\n  AND `T2`.`splat` = '-100'\n  AND `T1`.`vGameAppid` = 'Crossing'"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´1æœˆå‹‡è€…ç›Ÿçº¦ç«¯æ¸¸æ´»è·ƒç©å®¶äº¤å‰å³¡è°·ç«¯æ¸¸åŠæ‰‹æ¸¸æ´»è·ƒç©å®¶\nè¾“å‡ºï¼šç©å®¶gplayerid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹:QQå·æˆ–è€…å¾®ä¿¡',\n  `suserid` TEXT COMMENT 'å¸å·',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹:qq wxid playerid',\n  `sgamecode` TEXT COMMENT 'ä¸šåŠ¡',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚æšä¸¾å€¼ä¸ºAndroid/ iOSï¼Œå–æ±‡æ€»æ—¶å–-100',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `sgameparam` TEXT COMMENT 'åœºæ¬¡',\n  `schannel` TEXT COMMENT 'ä¸å¯ç”¨å­—æ®µï¼Œç”¨æˆ·å¯ä»¥å¿½ç•¥',\n  `sip` TEXT COMMENT 'å®é™…ä¸Šæ˜¯å½“æ—¥ç™»å½•çš„æœ€å°æ—¶é—´æˆ³ï¼Œå³æœ€æ—©ç™»å½•æ—¶é—´',\n  `sclientver` TEXT COMMENT 'å®¢æˆ·ç«¯ç‰ˆæœ¬',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚ä¸å¯ç”¨',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚ä¸å¯ç”¨',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ¬¡æ•°',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ—¶é—´'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nå³¡è°·ç­›é€‰é€»è¾‘:\nsgamecode = \"initiatived\" -- ç­›é€‰å³¡è°·æ¸¸æˆ\nand saccounttype = \"-100\" -- è´¦å·ä½“ç³»ï¼Œå–-100è¡¨ç¤ºæ±‡æ€»\nand suseridtype in (\"qq\", \"wxid\") -- è´¦å·ç±»å‹ï¼Œå–qqæˆ–wxid\nand splattype in (\"-100\", \"PC\") -- å³¡è°·æ‰‹æ¸¸ç©å®¶åŠPCç«¯ç©å®¶\nand splat = \"-100\" -- å†™æ­»ä¸º-100\n\n",
  "chosen": "SELECT DISTINCT a.iuserid AS gplayerid\nFROM dws_argothek_oss_login_di a\nJOIN dim_argothek_gplayerid2qqwxid_df b ON a.iuserid = b.iuserid\nWHERE a.statis_date BETWEEN 20250101 AND 20250131\nAND b.suserid IN (\n    SELECT DISTINCT suserid\n    FROM dws_mgamejp_login_user_activity_di\n    WHERE sgamecode = 'initiatived'\n    AND saccounttype = '-100'\n    AND suseridtype IN ('qq', 'wxid')\n    AND splattype IN ('-100', 'PC')\n    AND splat = '-100'\n    AND dtstatdate BETWEEN 20250101 AND 20250131\n)\nORDER BY a.iuserid",
  "rejected": "### ç¬¬ä¸€æ­¥ï¼šç†è§£éœ€æ±‚\n\næˆ‘ä»¬è¦ç»Ÿè®¡çš„æ˜¯**2025å¹´1æœˆå‹‡è€…ç›Ÿçº¦ç«¯æ¸¸æ´»è·ƒç©å®¶ä¸­ï¼ŒåŒæ—¶åœ¨å³¡è°·ï¼ˆCross Canyonï¼‰ç«¯æ¸¸åŠæ‰‹æ¸¸æ´»è·ƒçš„ç©å®¶**ã€‚\n\næ¢å¥è¯è¯´ï¼š\n- æˆ‘ä»¬éœ€è¦ä»â€œå‹‡è€…ç›Ÿçº¦â€ç«¯æ¸¸çš„æ´»è·ƒç©å®¶ä¸­ç­›é€‰å‡ºç¬¦åˆæ¡ä»¶çš„ï¼›\n- è¿™äº›ç©å®¶è¿˜å¿…é¡»æ˜¯â€œå³¡è°·â€æ¸¸æˆä¸­æ´»è·ƒçš„ï¼›\n- å¹¶ä¸”è¿™äº›æ´»è·ƒç©å®¶å¿…é¡»åŒæ—¶å‡ºç°åœ¨â€œæ‰‹æ¸¸â€å’Œâ€œPCç«¯â€ä¸¤ä¸ªå¹³å°ä¸­ï¼›\n- æœ€ç»ˆè¾“å‡ºçš„æ˜¯è¿™äº›ç©å®¶çš„ `gplayerid`ã€‚\n\n---\n\n### ç¬¬äºŒæ­¥ï¼šåˆ†æå¯ç”¨è¡¨ç»“æ„\n\n#### è¡¨1ï¼š`dws_argothek_oss_login_di`\nè¿™ä¸ªè¡¨æ˜¯å‹‡è€…ç›Ÿçº¦ç«¯æ¸¸çš„ç™»å½•æ•°æ®ï¼ŒåŒ…å«ï¼š\n- `statis_date`: ç»Ÿè®¡æ—¶é—´\n- `iuserid`: ç”¨æˆ·ID\n- `ilogintime`: ç™»å½•æ—¶é—´\n- `iloginway`: ç™»å½•æ¸ é“ï¼ˆç”¨äºåŒºåˆ†å¹³å°ï¼‰\n\n> æ³¨æ„ï¼šæ­¤è¡¨æ²¡æœ‰ç›´æ¥æä¾› `gplayerid` å­—æ®µï¼Œä½†å¯ä»¥é€šè¿‡ `iuserid` å’Œå…¶ä»–ç»´åº¦å…³è”è·å–ã€‚\n\n#### è¡¨2ï¼š`dim_argothek_gplayerid2qqwxid_df`\nè¿™æ˜¯ä¸€ä¸ªç”¨æˆ·IDæ˜ å°„è¡¨ï¼Œä¸»è¦å­—æ®µåŒ…æ‹¬ï¼š\n- `iuserid`: åŸå§‹ç”¨æˆ·ID\n- `suserid`: æ˜ å°„åçš„è´¦å·ï¼ˆQQæˆ–å¾®ä¿¡ï¼‰\n- `vGameAppid`: æ¸¸æˆå¹³å°æ ‡è¯†ï¼ˆå¦‚â€œå‹‡è€…ç›Ÿçº¦â€ã€â€œå³¡è°·â€ç­‰ï¼‰\n- `swxid_type`: å¾®ä¿¡è¿˜æ˜¯QQç±»å‹\n- `cBitmap`: æ´»è·ƒä½å›¾ï¼ˆå¯ç”¨äºåˆ¤æ–­æŸå¤©æ˜¯å¦æ´»è·ƒï¼‰\n\n> å¯é€šè¿‡è¯¥è¡¨å°†åŸå§‹ç”¨æˆ·IDä¸å¹³å°ã€æ´»è·ƒçŠ¶æ€è¿›è¡ŒåŒ¹é…ã€‚\n\n#### è¡¨3ï¼š`dws_mgamejp_login_user_activity_di`\nè¿™æ˜¯å³¡è°·æ¸¸æˆçš„æ´»è·ƒç”¨æˆ·æ•°æ®ï¼Œå…³é”®å­—æ®µå¦‚ä¸‹ï¼š\n- `suserid`: ç”¨æˆ·IDï¼ˆQQæˆ–å¾®ä¿¡ï¼‰\n- `sgamecode`: æ¸¸æˆç¼–ç ï¼ˆéœ€ç­‰äº \"initiatived\"ï¼‰\n- `splattype`: å¹³å°ç±»å‹ï¼ˆæšä¸¾å€¼ä¸º Android / iOS / PCï¼‰\n- `splat`: å°å¹³å°ï¼ˆå†™æ­»ä¸º \"-100\"ï¼‰\n- `suseridtype`: è´¦å·ç±»å‹ï¼ˆqq æˆ– wxidï¼‰\n- `sgameparam`: åœºæ¬¡ï¼ˆå¯å¿½ç•¥ï¼‰\n- `itimes`: æ´»è·ƒæ¬¡æ•°ï¼ˆç”¨äºåˆ¤æ–­æ˜¯å¦æ´»è·ƒï¼‰\n\n> æ­¤è¡¨ç”¨æ¥åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ä¸ºå³¡è°·æ´»è·ƒç©å®¶ï¼Œå¹¶ä¸”å¯ä»¥æŒ‰å¹³å°åŒºåˆ†æ‰‹æ¸¸å’ŒPCç«¯ã€‚\n\n---\n\n### ç¬¬ä¸‰æ­¥ï¼šç¡®å®šé€»è¾‘æµç¨‹\n\næˆ‘ä»¬éœ€è¦åˆ†æ­¥éª¤æ„å»ºSQLï¼š\n\n#### Step 1ï¼šæ‰¾å‡ºå‹‡è€…ç›Ÿçº¦æ´»è·ƒç©å®¶ï¼ˆ2025å¹´1æœˆï¼‰\n- ä½¿ç”¨ `dim_argothek_gplayerid2qqwxid_df` è¡¨\n- ç­›é€‰ `vGameAppid = 'å‹‡è€…ç›Ÿçº¦'`\n- è®¾ç½® `dtstatdate` åœ¨ 2025å¹´1æœˆèŒƒå›´å†…ï¼ˆä¾‹å¦‚ 20250101 åˆ° 20250131ï¼‰\n- è·å–å¯¹åº”çš„ `iuserid`\n\n#### Step 2ï¼šæ‰¾å‡ºå³¡è°·æ´»è·ƒç©å®¶ï¼ˆ2025å¹´1æœˆï¼‰\n- ä½¿ç”¨ `dws_mgamejp_login_user_activity_di`\n- ç­›é€‰æ¡ä»¶ï¼š\n  - `sgamecode = 'initiatived'`\n  - `saccounttype = '-100'`\n  - `suseridtype IN ('qq', 'wxid')`\n  - `splat = '-100'`\n  - `dtstatdate BETWEEN 20250101 AND 20250131`\n- è·å– `suserid`ï¼ˆå³QQæˆ–å¾®ä¿¡IDï¼‰\n\n#### Step 3ï¼šåˆå¹¶ä¸¤ç»„æ•°æ®ï¼Œæ‰¾å‡ºäº¤é›†\n- å°†å‹‡è€…ç›Ÿçº¦æ´»è·ƒç©å®¶ä¸­çš„ `iuserid` æ˜ å°„æˆ `suserid`ï¼ˆQQæˆ–å¾®ä¿¡ï¼‰ï¼Œç„¶åå»å³¡è°·æ´»è·ƒç©å®¶è¡¨ä¸­æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨\n- åŒæ—¶è¦ç¡®ä¿è¯¥ç”¨æˆ·åœ¨æ‰‹æ¸¸å’ŒPCä¸Šéƒ½æœ‰æ´»è·ƒè®°å½•\n\n#### Step 4ï¼šè¾“å‡º gplayerid\n- æœ€ç»ˆè¿”å›æ»¡è¶³æ‰€æœ‰æ¡ä»¶çš„ `gplayerid`\n\n---\n\n### ç¬¬å››æ­¥ï¼šç¼–å†™SQLè¯­å¥\n\n```sql\nWITH active_players AS (\n    SELECT DISTINCT\n        i.userid AS gplayerid,\n        i.suserid,\n        i.swxid_type\n    FROM dim_argothek_gplayerid2qqwxid_df i\n    WHERE\n        i.vGameAppid = 'å‹‡è€…ç›Ÿçº¦'\n        AND i.dtstatdate BETWEEN '20250101' AND '20250131'\n),\ncanyon_active_users AS (\n    SELECT DISTINCT\n        s.suserid,\n        s.splattype\n    FROM dws_mgamejp_login_user_activity_di s\n    WHERE\n        s.sgamecode = 'initiatived'\n        AND s.saccounttype = '-100'\n        AND s.suseridtype IN ('qq', 'wxid')\n        AND s.splat = '-100'\n        AND s.dtstatdate BETWEEN 20250101 AND 20250131\n)\nSELECT DISTINCT\n    a.gplayerid\nFROM active_players a\nJOIN canyon_active_users c ON a.suserid = c.suserid\nWHERE\n    EXISTS (\n        SELECT 1 FROM canyon_active_users c1\n        WHERE c1.suserid = a.suserid AND c1.splattype = 'Android'\n    )\n    AND EXISTS (\n        SELECT 1 FROM canyon_active_users c2\n        WHERE c2.suserid = a.suserid AND c2.splattype = 'iOS'\n    );\n```\n\n---\n\n### ç¬¬äº”æ­¥ï¼šè§£é‡ŠSQLé€»è¾‘\n\n#### CTE `active_players`\n- æŸ¥è¯¢å‹‡è€…ç›Ÿçº¦æ´»è·ƒç©å®¶ï¼Œæå– `gplayerid` å’Œ `suserid`ï¼ˆå³QQæˆ–å¾®ä¿¡ IDï¼‰\n\n#### CTE `canyon_active_users`\n- æŸ¥è¯¢å³¡è°·æ´»è·ƒç©å®¶ï¼Œæå– `suserid` å’Œå…¶å¹³å°ç±»å‹ï¼ˆAndroid / iOSï¼‰\n\n#### ä¸»æŸ¥è¯¢éƒ¨åˆ†\n- æ‰¾å‡ºå‹‡è€…ç›Ÿçº¦æ´»è·ƒç©å®¶ä¸­ï¼Œåœ¨å³¡è°·æ¸¸æˆä¸­ä¹Ÿæ´»è·ƒçš„ç”¨æˆ·ï¼ˆé€šè¿‡ `suserid` å…³è”ï¼‰\n- å¹¶è¿›ä¸€æ­¥é™åˆ¶ï¼šè¯¥ç”¨æˆ·å¿…é¡»åœ¨ **Android** å’Œ **iOS** ä¸Šéƒ½æ´»è·ƒè¿‡ï¼ˆå³åŒæ—¶å±äºä¸¤ä¸ªå¹³å°ï¼‰\n\næœ€ç»ˆè¾“å‡ºï¼šæ»¡è¶³ä¸Šè¿°æ‰€æœ‰æ¡ä»¶çš„ `gplayerid`\n\n---\n\n### âœ… ç»“è®º\n\nä»¥ä¸Š SQL æŸ¥è¯¢å®Œæ•´åœ°å®ç°äº†ç”¨æˆ·éœ€æ±‚ï¼Œèƒ½å¤Ÿå‡†ç¡®æ‰¾å‡ºâ€œ2025å¹´1æœˆå‹‡è€…ç›Ÿçº¦ç«¯æ¸¸æ´»è·ƒç©å®¶ä¸­ï¼ŒåŒæ—¶åœ¨å³¡è°·æ‰‹æ¸¸å’ŒPCç«¯æ´»è·ƒâ€çš„ç©å®¶IDï¼ˆ`gplayerid`ï¼‰ã€‚"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´1æœˆå‹‡è€…ç›Ÿçº¦ç«¯æ¸¸æ´»è·ƒç©å®¶äº¤å‰å³¡è°·ç«¯æ¸¸åŠæ‰‹æ¸¸æ´»è·ƒç©å®¶\nè¾“å‡ºï¼šç©å®¶gplayerid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹:QQå·æˆ–è€…å¾®ä¿¡',\n  `suserid` TEXT COMMENT 'å¸å·',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹:qq wxid playerid',\n  `sgamecode` TEXT COMMENT 'ä¸šåŠ¡',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚æšä¸¾å€¼ä¸ºAndroid/ iOSï¼Œå–æ±‡æ€»æ—¶å–-100',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `sgameparam` TEXT COMMENT 'åœºæ¬¡',\n  `schannel` TEXT COMMENT 'ä¸å¯ç”¨å­—æ®µï¼Œç”¨æˆ·å¯ä»¥å¿½ç•¥',\n  `sip` TEXT COMMENT 'å®é™…ä¸Šæ˜¯å½“æ—¥ç™»å½•çš„æœ€å°æ—¶é—´æˆ³ï¼Œå³æœ€æ—©ç™»å½•æ—¶é—´',\n  `sclientver` TEXT COMMENT 'å®¢æˆ·ç«¯ç‰ˆæœ¬',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚ä¸å¯ç”¨',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚ä¸å¯ç”¨',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ¬¡æ•°',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ—¶é—´'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nå³¡è°·ç­›é€‰é€»è¾‘:\nsgamecode = \"initiatived\" -- ç­›é€‰å³¡è°·æ¸¸æˆ\nand saccounttype = \"-100\" -- è´¦å·ä½“ç³»ï¼Œå–-100è¡¨ç¤ºæ±‡æ€»\nand suseridtype in (\"qq\", \"wxid\") -- è´¦å·ç±»å‹ï¼Œå–qqæˆ–wxid\nand splattype in (\"-100\", \"PC\") -- å³¡è°·æ‰‹æ¸¸ç©å®¶åŠPCç«¯ç©å®¶\nand splat = \"-100\" -- å†™æ­»ä¸º-100\n\n",
  "chosen": "SELECT DISTINCT a.iuserid AS gplayerid\nFROM dws_argothek_oss_login_di a\nJOIN dim_argothek_gplayerid2qqwxid_df b ON a.iuserid = b.iuserid\nWHERE a.statis_date BETWEEN 20250101 AND 20250131\nAND b.suserid IN (\n    SELECT DISTINCT suserid\n    FROM dws_mgamejp_login_user_activity_di\n    WHERE sgamecode = 'initiatived'\n    AND saccounttype = '-100'\n    AND suseridtype IN ('qq', 'wxid')\n    AND splattype IN ('-100', 'PC')\n    AND splat = '-100'\n    AND dtstatdate BETWEEN 20250101 AND 20250131\n)\nORDER BY a.iuserid",
  "rejected": "æˆ‘éœ€è¦é€æ­¥åˆ†æè¿™ä¸ªé—®é¢˜å¹¶æ„å»ºSQLæŸ¥è¯¢ã€‚\n\né¦–å…ˆè®©æˆ‘ç†è§£ä¸€ä¸‹éœ€æ±‚ï¼š\n1. æ‰¾å‡º2025å¹´1æœˆåœ¨\"å‹‡è€…ç›Ÿçº¦\"æ¸¸æˆä¸­æ´»è·ƒçš„ç©å®¶\n2. è¿™äº›ç©å®¶è¿˜éœ€è¦åŒæ—¶åœ¨\"å³¡è°·\"ï¼ˆCross Valleyï¼‰æ¸¸æˆä¸­æ´»è·ƒ\n3. è¾“å‡ºè¿™äº›ç©å®¶çš„gplayerid\n\nè®©æˆ‘åˆ†æä¸€ä¸‹è¡¨ç»“æ„å’Œå…³è”å…³ç³»ï¼š\n\n1. `dws_argothek_oss_login_di` - è¿™æ˜¯å‹‡è€…ç›Ÿçº¦çš„ç™»å½•æ•°æ®è¡¨\n2. `dim_argothek_gplayerid2qqwxid_df` - è¿™æ˜¯ç”¨æˆ·IDæ˜ å°„è¡¨ï¼ŒåŒ…å«ç©å®¶è§’è‰²ä¿¡æ¯\n3. `dws_mgamejp_login_user_activity_di` - è¿™æ˜¯å³¡è°·æ¸¸æˆçš„æ´»è·ƒç”¨æˆ·è¡¨\n\nè®©æˆ‘å…ˆçœ‹çœ‹å¦‚ä½•ä»å³¡è°·è¡¨ä¸­è·å–æ´»è·ƒç©å®¶ï¼š\n\n```sql\nSELECT DISTINCT\n    suserid,\n    sgamecode,\n    saccounttype,\n    splattype,\n    splat\nFROM dws_mgamejp_login_user_activity_di\nWHERE \n    dtstatdate BETWEEN 20250101 AND 20250131\n    AND sgamecode = \"initiatived\"\n    AND saccounttype = \"-100\"\n    AND suseridtype IN (\"qq\", \"wxid\")\n    AND splattype IN (\"-100\", \"PC\")\n    AND splat = \"-100\"\n```\n\nç„¶åï¼Œæˆ‘éœ€è¦å°†è¿™ä¸ªç»“æœä¸å‹‡è€…ç›Ÿçº¦çš„æ´»è·ƒç©å®¶è¿›è¡Œå…³è”ï¼Œä½†æ³¨æ„ï¼šå‹‡è€…ç›Ÿçº¦çš„è¡¨æ²¡æœ‰ç›´æ¥æä¾›gplayeridï¼Œè€Œæ˜¯é€šè¿‡dimè¡¨æ¥å…³è”ã€‚ä¸è¿‡ï¼Œæˆ‘æ³¨æ„åˆ°dimè¡¨ä¸­çš„å­—æ®µæ˜¯iuseridï¼Œè¿™åº”è¯¥å°±æ˜¯å‹‡è€…ç›Ÿçº¦ä¸­çš„ç”¨æˆ·IDã€‚\n\næ‰€ä»¥æœ€ç»ˆçš„æŸ¥è¯¢åº”è¯¥æ˜¯ï¼š\n\n```sql\nSELECT DISTINCT\n    i.userid\nFROM (\n    SELECT DISTINCT\n        suserid\n    FROM dws_mgamejp_login_user_activity_di\n    WHERE \n        dtstatdate BETWEEN 20250101 AND 20250131\n        AND sgamecode = \"initiatived\"\n        AND saccounttype = \"-100\"\n        AND suseridtype IN (\"qq\", \"wxid\")\n        AND splattype IN (\"-100\", \"PC\")\n        AND splat = \"-100\"\n) AS valley_players\nJOIN dim_argothek_gplayerid2qqwxid_df AS gplayer_map\n    ON valley_players.suserid = gplayer_map.suserid\nJOIN dws_argothek_oss_login_di AS login_info\n    ON gplayer_map.iuserid = login_info.iuserid\nWHERE \n    login_info.statis_date BETWEEN 20250101 AND 20250131\n```"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´1æœˆå‹‡è€…ç›Ÿçº¦ç«¯æ¸¸æ´»è·ƒç©å®¶äº¤å‰å³¡è°·ç«¯æ¸¸åŠæ‰‹æ¸¸æ´»è·ƒç©å®¶\nè¾“å‡ºï¼šç©å®¶gplayerid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹:QQå·æˆ–è€…å¾®ä¿¡',\n  `suserid` TEXT COMMENT 'å¸å·',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹:qq wxid playerid',\n  `sgamecode` TEXT COMMENT 'ä¸šåŠ¡',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚æšä¸¾å€¼ä¸ºAndroid/ iOSï¼Œå–æ±‡æ€»æ—¶å–-100',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `sgameparam` TEXT COMMENT 'åœºæ¬¡',\n  `schannel` TEXT COMMENT 'ä¸å¯ç”¨å­—æ®µï¼Œç”¨æˆ·å¯ä»¥å¿½ç•¥',\n  `sip` TEXT COMMENT 'å®é™…ä¸Šæ˜¯å½“æ—¥ç™»å½•çš„æœ€å°æ—¶é—´æˆ³ï¼Œå³æœ€æ—©ç™»å½•æ—¶é—´',\n  `sclientver` TEXT COMMENT 'å®¢æˆ·ç«¯ç‰ˆæœ¬',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚ä¸å¯ç”¨',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚ä¸å¯ç”¨',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ¬¡æ•°',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ—¶é—´'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nå³¡è°·ç­›é€‰é€»è¾‘:\nsgamecode = \"initiatived\" -- ç­›é€‰å³¡è°·æ¸¸æˆ\nand saccounttype = \"-100\" -- è´¦å·ä½“ç³»ï¼Œå–-100è¡¨ç¤ºæ±‡æ€»\nand suseridtype in (\"qq\", \"wxid\") -- è´¦å·ç±»å‹ï¼Œå–qqæˆ–wxid\nand splattype in (\"-100\", \"PC\") -- å³¡è°·æ‰‹æ¸¸ç©å®¶åŠPCç«¯ç©å®¶\nand splat = \"-100\" -- å†™æ­»ä¸º-100\n\n",
  "chosen": "SELECT DISTINCT a.iuserid AS gplayerid\nFROM dws_argothek_oss_login_di a\nJOIN dim_argothek_gplayerid2qqwxid_df b ON a.iuserid = b.iuserid\nWHERE a.statis_date BETWEEN 20250101 AND 20250131\nAND b.suserid IN (\n    SELECT DISTINCT suserid\n    FROM dws_mgamejp_login_user_activity_di\n    WHERE sgamecode = 'initiatived'\n    AND saccounttype = '-100'\n    AND suseridtype IN ('qq', 'wxid')\n    AND splattype IN ('-100', 'PC')\n    AND splat = '-100'\n    AND dtstatdate BETWEEN 20250101 AND 20250131\n)\nORDER BY a.iuserid",
  "rejected": "### ç¬¬ä¸€æ­¥ï¼šç†è§£éœ€æ±‚\n\næˆ‘ä»¬è¦ç»Ÿè®¡çš„æ˜¯**2025å¹´1æœˆå‹‡è€…ç›Ÿçº¦ç«¯æ¸¸æ´»è·ƒç©å®¶ä¸­ï¼ŒåŒæ—¶åœ¨å³¡è°·ï¼ˆCross Canyonï¼‰æ¸¸æˆä¸­ä¹Ÿæ´»è·ƒçš„ç©å®¶**ã€‚\n\næ¢å¥è¯è¯´ï¼š\n- æˆ‘ä»¬è¦ä»â€œå‹‡è€…ç›Ÿçº¦â€ç«¯æ¸¸çš„æ´»è·ƒç©å®¶ä¸­ç­›é€‰å‡ºé‚£äº›åœ¨2025å¹´1æœˆä¹Ÿæœ‰ç™»å½•å³¡è°·æ¸¸æˆçš„ç©å®¶ã€‚\n- æœ€ç»ˆè¾“å‡ºè¿™äº›ç©å®¶çš„ `gplayerid`ã€‚\n\n---\n\n### ç¬¬äºŒæ­¥ï¼šåˆ†æè¡¨ç»“æ„ä¸å­—æ®µå«ä¹‰\n\n#### è¡¨ä¸€ï¼š`dws_argothek_oss_login_di`\nè¿™æ˜¯å‹‡è€…ç›Ÿçº¦æ¸¸æˆçš„æ•°æ®è¡¨ï¼ŒåŒ…å«ä»¥ä¸‹å…³é”®å­—æ®µï¼š\n\n| å­—æ®µå       | å«ä¹‰                         |\n|--------------|------------------------------|\n| `statis_date` | ç»Ÿè®¡æ—¶é—´                     |\n| `iuserid`     | ç”¨æˆ·ID                       |\n| `ilogintime`  | ç™»å½•æ—¶é—´                     |\n\n> è¿™å¼ è¡¨è®°å½•äº†å‹‡è€…ç›Ÿçº¦çš„ç™»å½•æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸­è·å–æ´»è·ƒç©å®¶ã€‚\n\n#### è¡¨äºŒï¼š`dim_argothek_gplayerid2qqwxid_df`\nè¿™ä¸ªæ˜¯ç”¨æˆ·ä¿¡æ¯æ˜ å°„è¡¨ï¼ŒåŒ…å«ç”¨æˆ·åœ¨ä¸åŒå¹³å°çš„ä¿¡æ¯ï¼š\n\n| å­—æ®µå         | å«ä¹‰                             |\n|----------------|----------------------------------|\n| `iuserid`      | ç”¨æˆ·ID                           |\n| `suserid`      | QQ/WX ID                         |\n| `vGameAppid`   | å¹³å°æ ‡è¯†                         |\n| `dtstatdate`   | ç»Ÿè®¡æ—¥æœŸ                         |\n\n> å¯ç”¨äºå°†å‹‡è€…ç›Ÿçº¦çš„ç”¨æˆ·IDè½¬æ¢æˆQQæˆ–WX IDã€‚\n\n#### è¡¨ä¸‰ï¼š`dws_mgamejp_login_user_activity_di`\nè¿™æ˜¯å³¡è°·æ¸¸æˆï¼ˆCross Canyonï¼‰çš„æ´»è·ƒç”¨æˆ·è¡¨ï¼š\n\n| å­—æ®µå        | å«ä¹‰                             |\n|---------------|----------------------------------|\n| `suserid`     | ç”¨æˆ·IDï¼ˆQQ æˆ– WXï¼‰               |\n| `sgamecode`   | æ¸¸æˆç¼–ç ï¼Œè¿™é‡Œä¸º \"initiatived\"   |\n| `splattype`   | å¹³å°ç±»å‹ï¼ˆPC / Android / iOSï¼‰   |\n| `splat`       | å¹³å°ï¼ˆå›ºå®šä¸º \"-100\"ï¼‰            |\n| `dtstatdate`  | ç»Ÿè®¡æ—¥æœŸ                         |\n\n> è¿™å¼ è¡¨ç”¨äºè¯†åˆ«å“ªäº›ç”¨æˆ·åœ¨å³¡è°·æ¸¸æˆä¸­æ´»è·ƒã€‚\n\n---\n\n### ç¬¬ä¸‰æ­¥ï¼šæ˜ç¡®ç­›é€‰æ¡ä»¶\n\n#### å¯¹äºå³¡è°·æ´»è·ƒç”¨æˆ·çš„ç­›é€‰é€»è¾‘å¦‚ä¸‹ï¼š\n\n```sql\nsgamecode = \"initiatived\"\nAND saccounttype = \"-100\"\nAND suseridtype IN (\"qq\", \"wxid\")\nAND splattype IN (\"-100\", \"PC\")\nAND splat = \"-100\"\n```\n\n#### å¯¹äºå‹‡è€…ç›Ÿçº¦æ´»è·ƒç©å®¶ï¼š\n\næˆ‘ä»¬éœ€è¦ä» `dws_argothek_oss_login_di` ä¸­æ‰¾å‡ºæ‰€æœ‰åœ¨ 2025 å¹´ 1 æœˆæ´»è·ƒçš„ç©å®¶ï¼Œå¹¶é€šè¿‡ `iuserid` å’Œ `dim_argothek_gplayerid2qqwxid_df` æ˜ å°„æˆå¯¹åº”çš„ `suserid`ï¼ˆå³QQæˆ–WXï¼‰ï¼Œç„¶åä¸å³¡è°·æ´»è·ƒç©å®¶åšäº¤é›†ã€‚\n\n---\n\n### ç¬¬å››æ­¥ï¼šæ„å»º SQL æŸ¥è¯¢è¯­å¥\n\n#### æ­¥éª¤ä¸€ï¼šæå–å‹‡è€…ç›Ÿçº¦åœ¨2025å¹´1æœˆæ´»è·ƒçš„ç”¨æˆ·ï¼ˆåŸºäº `dws_argothek_oss_login_di`ï¼‰\n\n```sql\nSELECT DISTINCT iuserid\nFROM dws_argothek_oss_login_di\nWHERE statis_date BETWEEN 20250101 AND 20250131\n```\n\n#### æ­¥éª¤äºŒï¼šå°†å‹‡è€…ç›Ÿçº¦çš„ç”¨æˆ·æ˜ å°„ä¸ºQQ/WX IDï¼ˆä½¿ç”¨ `dim_argothek_gplayerid2qqwxid_df`ï¼‰\n\n```sql\nSELECT DISTINCT suserid\nFROM dim_argothek_gplayerid2qqwxid_df\nWHERE iuserid IN (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_login_di\n    WHERE statis_date BETWEEN 20250101 AND 20250131\n)\n```\n\n#### æ­¥éª¤ä¸‰ï¼šç­›é€‰å‡ºè¿™äº›ç”¨æˆ·åœ¨å³¡è°·æ¸¸æˆä¸­çš„æ´»è·ƒè®°å½•ï¼ˆä½¿ç”¨ `dws_mgamejp_login_user_activity_di`ï¼‰\n\n```sql\nSELECT DISTINCT suserid\nFROM dws_mgamejp_login_user_activity_di\nWHERE sgamecode = 'initiatived'\n  AND saccounttype = '-100'\n  AND suseridtype IN ('qq', 'wxid')\n  AND splattype IN ('-100', 'PC')\n  AND splat = '-100'\n  AND dtstatdate BETWEEN 20250101 AND 20250131\n```\n\n#### æ­¥éª¤å››ï¼šæœ€ç»ˆåˆå¹¶ä¸¤ä¸ªé›†åˆï¼Œæ‰¾å‡ºäº¤é›†ï¼ˆå³æ—¢æ˜¯å‹‡è€…ç›Ÿçº¦æ´»è·ƒåˆåœ¨å³¡è°·æ´»è·ƒçš„ç”¨æˆ·ï¼‰\n\n```sql\nSELECT DISTINCT a.suserid\nFROM (\n    SELECT DISTINCT iuserid AS suserid\n    FROM dws_argothek_oss_login_di\n    WHERE statis_date BETWEEN 20250101 AND 20250131\n) AS player_ids\nINNER JOIN (\n    SELECT DISTINCT suserid\n    FROM dim_argothek_gplayerid2qqwxid_df\n    WHERE iuserid IN (\n        SELECT DISTINCT iuserid\n        FROM dws_argothek_oss_login_di\n        WHERE statis_date BETWEEN 20250101 AND 20250131\n    )\n) AS mapped_users ON player_ids.suserid = mapped_users.suserid\nINNER JOIN (\n    SELECT DISTINCT suserid\n    FROM dws_mgamejp_login_user_activity_di\n    WHERE sgamecode = 'initiatived'\n      AND saccounttype = '-100'\n      AND suseridtype IN ('qq', 'wxid')\n      AND splattype IN ('-100', 'PC')\n      AND splat = '-100'\n      AND dtstatdate BETWEEN 20250101 AND 20250131\n) AS active_users ON mapped_users.suserid = active_users.suserid;\n```\n\n---\n\n### âœ… æœ€ç»ˆ SQL æŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š\n\n```sql\nSELECT DISTINCT a.suserid\nFROM (\n    SELECT DISTINCT iuserid AS suserid\n    FROM dws_argothek_oss_login_di\n    WHERE statis_date BETWEEN 20250101 AND 20250131\n) AS player_ids\nINNER JOIN (\n    SELECT DISTINCT suserid\n    FROM dim_argothek_gplayerid2qqwxid_df\n    WHERE iuserid IN (\n        SELECT DISTINCT iuserid\n        FROM dws_argothek_oss_login_di\n        WHERE statis_date BETWEEN 20250101 AND 20250131\n    )\n) AS mapped_users ON player_ids.suserid = mapped_users.suserid\nINNER JOIN (\n    SELECT DISTINCT suserid\n    FROM dws_mgamejp_login_user_activity_di\n    WHERE sgamecode = 'initiatived'\n      AND saccounttype = '-100'\n      AND suseridtype IN ('qq', 'wxid')\n      AND splattype IN ('-100', 'PC')\n      AND splat = '-100'\n      AND dtstatdate BETWEEN 20250101 AND 20250131\n) AS active_users ON mapped_users.suserid = active_users.suserid;\n```\n\n---\n\n### ğŸ“Œ æ€»ç»“è¯´æ˜ï¼š\n\n- ä½¿ç”¨äº†ä¸‰æ¬¡å­æŸ¥è¯¢æ¥åˆ†åˆ«å¤„ç†å‹‡è€…ç›Ÿçº¦æ´»è·ƒç”¨æˆ·ã€æ˜ å°„åçš„QQ/WX IDã€ä»¥åŠå³¡è°·æ´»è·ƒç”¨æˆ·ã€‚\n- æœ€åé€šè¿‡å¤šä¸ª INNER JOIN å®ç°äº¤é›†åŒ¹é…ã€‚\n- è¾“å‡ºçš„æ˜¯æ»¡è¶³æ¡ä»¶çš„ `suserid`ï¼ˆå³ç©å®¶QQ/WX IDï¼‰ï¼Œå¦‚æœä½ éœ€è¦è¿›ä¸€æ­¥å…³è” `gplayerid`ï¼Œå¯å†åŠ å…¥å…¶ä»–ç»´åº¦è¡¨è¿›è¡Œæ˜ å°„ã€‚"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´1æœˆå‹‡è€…ç›Ÿçº¦ç«¯æ¸¸æ´»è·ƒç©å®¶äº¤å‰å³¡è°·ç«¯æ¸¸åŠæ‰‹æ¸¸æ´»è·ƒç©å®¶\nè¾“å‡ºï¼šç©å®¶gplayerid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹:QQå·æˆ–è€…å¾®ä¿¡',\n  `suserid` TEXT COMMENT 'å¸å·',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹:qq wxid playerid',\n  `sgamecode` TEXT COMMENT 'ä¸šåŠ¡',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚æšä¸¾å€¼ä¸ºAndroid/ iOSï¼Œå–æ±‡æ€»æ—¶å–-100',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `sgameparam` TEXT COMMENT 'åœºæ¬¡',\n  `schannel` TEXT COMMENT 'ä¸å¯ç”¨å­—æ®µï¼Œç”¨æˆ·å¯ä»¥å¿½ç•¥',\n  `sip` TEXT COMMENT 'å®é™…ä¸Šæ˜¯å½“æ—¥ç™»å½•çš„æœ€å°æ—¶é—´æˆ³ï¼Œå³æœ€æ—©ç™»å½•æ—¶é—´',\n  `sclientver` TEXT COMMENT 'å®¢æˆ·ç«¯ç‰ˆæœ¬',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚ä¸å¯ç”¨',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚ä¸å¯ç”¨',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ¬¡æ•°',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ—¶é—´'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nå³¡è°·ç­›é€‰é€»è¾‘:\nsgamecode = \"initiatived\" -- ç­›é€‰å³¡è°·æ¸¸æˆ\nand saccounttype = \"-100\" -- è´¦å·ä½“ç³»ï¼Œå–-100è¡¨ç¤ºæ±‡æ€»\nand suseridtype in (\"qq\", \"wxid\") -- è´¦å·ç±»å‹ï¼Œå–qqæˆ–wxid\nand splattype in (\"-100\", \"PC\") -- å³¡è°·æ‰‹æ¸¸ç©å®¶åŠPCç«¯ç©å®¶\nand splat = \"-100\" -- å†™æ­»ä¸º-100\n\n",
  "chosen": "SELECT DISTINCT a.iuserid AS gplayerid\nFROM dws_argothek_oss_login_di a\nJOIN dim_argothek_gplayerid2qqwxid_df b ON a.iuserid = b.iuserid\nWHERE a.statis_date BETWEEN 20250101 AND 20250131\nAND b.suserid IN (\n    SELECT DISTINCT suserid\n    FROM dws_mgamejp_login_user_activity_di\n    WHERE sgamecode = 'initiatived'\n    AND saccounttype = '-100'\n    AND suseridtype IN ('qq', 'wxid')\n    AND splattype IN ('-100', 'PC')\n    AND splat = '-100'\n    AND dtstatdate BETWEEN 20250101 AND 20250131\n)\nORDER BY a.iuserid",
  "rejected": "SELECT DISTINCT\n  `T1`.`suserid`\nFROM `dws_mgamejp_login_user_activity_di` AS `T1`\nINNER JOIN `dim_argothek_gplayerid2qqwxid_df` AS `T2`\n  ON `T1`.`suserid` = `T2`.`suserid`\nWHERE\n  `T1`.`sgamecode` = 'initiatived'\n  AND `T1`.`saccounttype` = '-100'\n  AND `T1`.`suseridtype` IN ('qq', 'wxid')\n  AND `T1`.`splattype` IN ('-100', 'PC')\n  AND `T1`.`splat` = '-100'\n  AND `T2`.`vGameAppid` = 'Crossing'"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025.6.12-2025.7.14å·æ‰‹æ¸¸T2æ´»è·ƒç”¨æˆ·åœ¨20250529ä¹‹å‰ç«¯æ¸¸æ³¨å†Œçš„å·ç åŒ…ã€‚\nè¾“å‡ºï¼švplayerid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dws_argothek_ce1_cbt2_vplayerid_suserid_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'æ— æ±‡æ€»',\n  `platid` BIGINT COMMENT '0 - Android,1,255',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suseridçš„ç±»å‹',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `iregway` TEXT COMMENT 'æ³¨å†Œæ¸ é“-ä¸åŒºåˆ†platid',\n  `iloginway` TEXT COMMENT 'æ´»è·ƒæ¸ é“',\n  `sourcename` TEXT COMMENT 'å¼€ç™½æ¸ é“',\n  `itag` TEXT COMMENT 'ç”¨æˆ·åˆ†å±‚æ ‡ç­¾',\n  `ilevel` BIGINT COMMENT 'æœ€æ–°ç­‰çº§',\n  `ionlinetime` TEXT COMMENT 'åœ¨çº¿æ—¶é•¿ç§’',\n  `iroundtime` TEXT COMMENT 'æ¸¸æˆæ—¶é•¿ç§’',\n  `iroundcnt` TEXT COMMENT 'å¯¹å±€æ¬¡æ•°',\n  `fps_avg` TEXT COMMENT 'å½“æ—¥å¹³å‡å¸§ç‡-gplayeridç»´åº¦',\n  `is_reg` TEXT COMMENT 'æ˜¯å¦å½“æ—¥æ–°è¿›',\n  `is_lowfps` TEXT COMMENT 'æ˜¯å¦ä½å¸§ç‡-æ–°è¿›é¦–æ—¥å¹³å‡å¸§ç‡ä¸é«˜äº40ä¸”æ²¡æœ‰å¸§ç‡æ•°æ®çš„ç”¨æˆ·ä¸è®¡å…¥',\n  `is_match` TEXT COMMENT 'æ˜¯å¦å½“æ—¥å¯¹å±€',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nç”¨æˆ·æ´»è·ƒç”¨æˆ·ç­›é€‰æ¡ä»¶ï¼š\nitag=\"T2\"\n\n",
  "chosen": "SELECT DISTINCT a.vplayerid\nFROM final_algorithm_competition.dws_argothek_ce1_cbt2_vplayerid_suserid_di a\nJOIN final_algorithm_competition.dim_argothek_gplayerid2qqwxid_df b\nON a.suserid = b.suserid\nWHERE a.dtstatdate BETWEEN '20250612' AND '20250714'\nAND a.itag = 'T2'\nAND b.iregdate < '20250529'",
  "rejected": "### ç¬¬ä¸€æ­¥: ç†è§£éœ€æ±‚\næˆ‘ä»¬è¦æ‰¾å‡ºåœ¨ **2025å¹´6æœˆ12æ—¥è‡³2025å¹´7æœˆ14æ—¥** è¿™ä¸ªæ—¶é—´æ®µå†…ï¼Œå±äº **æ‰‹æ¸¸T2æ´»è·ƒç”¨æˆ·ï¼ˆå³ `itag = 'T2'`ï¼‰** çš„ï¼Œå¹¶ä¸”è¿™äº›ç”¨æˆ·çš„ **æ³¨å†Œæ—¶é—´æ—©äº2025å¹´5æœˆ29æ—¥ï¼ˆå³ `iregdate < 20250529`ï¼‰**ï¼Œå¹¶ä¸”ä»–ä»¬æ˜¯åœ¨ **ç«¯æ¸¸å¹³å°æ³¨å†Œçš„å·ç åŒ…**ã€‚\n\nè¾“å‡ºå­—æ®µæ˜¯ `vplayerid`ã€‚\n\n---\n\n### ç¬¬äºŒæ­¥: åˆ†æè¡¨ç»“æ„ä¸å­—æ®µå«ä¹‰\n\n#### è¡¨ä¸€ï¼š`dim_argothek_gplayerid2qqwxid_df`\n- `vplayerid`: ç”¨æˆ·å”¯ä¸€æ ‡è¯†ï¼ˆå¯¹åº”é¢˜ç›®ä¸­çš„â€œå·ç åŒ…â€ï¼‰\n- `iregdate`: æ³¨å†Œæ—¥æœŸï¼ˆæ ¼å¼ä¸ºæ•´æ•°å¦‚ `20250529`ï¼‰\n- `suserid`: ç»‘å®šçš„QQ/å¾®ä¿¡IDï¼ˆç”¨äºåˆ¤æ–­æ˜¯å¦ä¸ºç«¯æ¸¸æ³¨å†Œï¼‰\n- `swxid_type`: å¾®ä¿¡æˆ–QQç±»å‹ï¼ˆå¯ä»¥ç”¨æ¥åˆ¤æ–­æ˜¯å¦æ˜¯ç«¯æ¸¸ï¼‰\n\n> æ³¨æ„ï¼šè¿™ä¸ªè¡¨æ˜¯åŸå§‹æ•°æ®ï¼Œå¯èƒ½åŒ…å«å¤šä¸ªå¹³å°çš„æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ `swxid_type` æ¥ç­›é€‰å‡ºç«¯æ¸¸æ³¨å†Œçš„ç”¨æˆ·ã€‚\n\n#### è¡¨äºŒï¼š`dws_argothek_ce1_cbt2_vplayerid_suserid_di`\n- `vplayerid`: ç”¨æˆ·å”¯ä¸€æ ‡è¯†ï¼ˆå·ç åŒ…ï¼‰\n- `iregdate`: æ³¨å†Œæ—¥æœŸ\n- `itag`: ç”¨æˆ·å±‚çº§æ ‡ç­¾ï¼Œä¾‹å¦‚ T2 æ´»è·ƒç”¨æˆ·\n- `dtstatdate`: ç»Ÿè®¡æ—¥æœŸï¼ˆæˆ‘ä»¬å…³æ³¨çš„æ˜¯ 20250612 åˆ° 20250714ï¼‰\n\n> è¿™å¼ è¡¨å·²ç»æŒ‰å¤©åšäº†èšåˆï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä»è¿™é‡Œè·å– T2 ç”¨æˆ·ä¿¡æ¯ã€‚\n\n---\n\n### ç¬¬ä¸‰æ­¥: ç¡®å®šè¿æ¥é€»è¾‘å’Œè¿‡æ»¤æ¡ä»¶\n\næˆ‘ä»¬éœ€è¦å°†ä¸¤ä¸ªè¡¨å…³è”èµ·æ¥ï¼š\n\n1. ä½¿ç”¨ `vplayerid` å…³è”ä¸¤å¼ è¡¨ã€‚\n2. åœ¨ `dws_argothek_ce1_cbt2_vplayerid_suserid_di` ä¸­ç­›é€‰å‡º `itag = 'T2'` çš„è®°å½•ã€‚\n3. åŒæ—¶ç¡®ä¿å…¶æ³¨å†Œæ—¥æœŸå°äº `20250529`ã€‚\n4. å†å» `dim_argothek_gplayerid2qqwxid_df` ä¸­ç¡®è®¤è¿™äº›ç”¨æˆ·æ˜¯å¦æ˜¯é€šè¿‡ç«¯æ¸¸æ³¨å†Œçš„ï¼ˆæ¯”å¦‚ `swxid_type='qq'` æˆ–è€…å…¶ä»–è¡¨ç¤ºç«¯æ¸¸çš„æ–¹å¼ï¼‰ã€‚\n\n---\n\n### ç¬¬å››æ­¥: ç¼–å†™ SQL æŸ¥è¯¢è¯­å¥\n\n```sql\nSELECT DISTINCT\n    t2.vplayerid\nFROM dws_argothek_ce1_cbt2_vplayerid_suserid_di AS t1\nJOIN dim_argothek_gplayerid2qqwxid_df AS t2\n    ON t1.vplayerid = t2.vplayerid\nWHERE\n    -- æ—¶é—´èŒƒå›´ï¼š2025å¹´6æœˆ12æ—¥åˆ°2025å¹´7æœˆ14æ—¥\n    t1.dtstatdate BETWEEN '20250612' AND '20250714'\n    -- T2æ´»è·ƒç”¨æˆ·\n    AND t1.itag = 'T2'\n    -- æ³¨å†Œæ—¶é—´æ—©äº2025å¹´5æœˆ29æ—¥\n    AND t1.iregdate < '20250529'\n    -- ç«¯æ¸¸æ³¨å†Œï¼ˆå‡è®¾ swxid_type='qq' è¡¨ç¤ºä¸ºç«¯æ¸¸æ³¨å†Œï¼‰\n    AND t2.swxid_type = 'qq';\n```\n\n---\n\n### ç¬¬äº”æ­¥: è§£é‡Šå…³é”®ç‚¹\n\n| æ¡ä»¶ | è¯´æ˜ |\n|------|------|\n| `t1.dtstatdate BETWEEN '20250612' AND '20250714'` | ç­›é€‰æŒ‡å®šæ—¶é—´æ®µå†…çš„æ´»è·ƒç”¨æˆ· |\n| `t1.itag = 'T2'` | ç­›é€‰ T2 å±‚çº§æ´»è·ƒç”¨æˆ· |\n| `t1.iregdate < '20250529'` | æ³¨å†Œæ—¶é—´å¿…é¡»æ—©äº 20250529 |\n| `t2.swxid_type = 'qq'` | å‡è®¾ç«¯æ¸¸æ³¨å†Œæ–¹å¼ä¸º QQ ç™»å½• |\n\n> å¦‚æœå®é™…ä¸­ `swxid_type` ä¸æ˜¯ `'qq'`ï¼Œè€Œæ˜¯åˆ«çš„å€¼ï¼ˆå¦‚ `'wx'`, `'pc'`ï¼‰ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ã€‚\n\n---\n\n### æœ€ç»ˆç­”æ¡ˆï¼ˆæ¨èå†™æ³•ï¼‰ï¼š\n\n```sql\nSELECT DISTINCT\n    t2.vplayerid\nFROM dws_argothek_ce1_cbt2_vplayerid_suserid_di AS t1\nJOIN dim_argothek_gplayerid2qqwxid_df AS t2\n    ON t1.vplayerid = t2.vplayerid\nWHERE\n    t1.dtstatdate BETWEEN '20250612' AND '20250714'\n    AND t1.itag = 'T2'\n    AND t1.iregdate < '20250529'\n    AND t2.swxid_type = 'qq';\n```"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025.6.12-2025.7.14å·æ‰‹æ¸¸T2æ´»è·ƒç”¨æˆ·åœ¨20250529ä¹‹å‰ç«¯æ¸¸æ³¨å†Œçš„å·ç åŒ…ã€‚\nè¾“å‡ºï¼švplayerid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dws_argothek_ce1_cbt2_vplayerid_suserid_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'æ— æ±‡æ€»',\n  `platid` BIGINT COMMENT '0 - Android,1,255',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suseridçš„ç±»å‹',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `iregway` TEXT COMMENT 'æ³¨å†Œæ¸ é“-ä¸åŒºåˆ†platid',\n  `iloginway` TEXT COMMENT 'æ´»è·ƒæ¸ é“',\n  `sourcename` TEXT COMMENT 'å¼€ç™½æ¸ é“',\n  `itag` TEXT COMMENT 'ç”¨æˆ·åˆ†å±‚æ ‡ç­¾',\n  `ilevel` BIGINT COMMENT 'æœ€æ–°ç­‰çº§',\n  `ionlinetime` TEXT COMMENT 'åœ¨çº¿æ—¶é•¿ç§’',\n  `iroundtime` TEXT COMMENT 'æ¸¸æˆæ—¶é•¿ç§’',\n  `iroundcnt` TEXT COMMENT 'å¯¹å±€æ¬¡æ•°',\n  `fps_avg` TEXT COMMENT 'å½“æ—¥å¹³å‡å¸§ç‡-gplayeridç»´åº¦',\n  `is_reg` TEXT COMMENT 'æ˜¯å¦å½“æ—¥æ–°è¿›',\n  `is_lowfps` TEXT COMMENT 'æ˜¯å¦ä½å¸§ç‡-æ–°è¿›é¦–æ—¥å¹³å‡å¸§ç‡ä¸é«˜äº40ä¸”æ²¡æœ‰å¸§ç‡æ•°æ®çš„ç”¨æˆ·ä¸è®¡å…¥',\n  `is_match` TEXT COMMENT 'æ˜¯å¦å½“æ—¥å¯¹å±€',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nç”¨æˆ·æ´»è·ƒç”¨æˆ·ç­›é€‰æ¡ä»¶ï¼š\nitag=\"T2\"\n\n",
  "chosen": "SELECT DISTINCT a.vplayerid\nFROM final_algorithm_competition.dws_argothek_ce1_cbt2_vplayerid_suserid_di a\nJOIN final_algorithm_competition.dim_argothek_gplayerid2qqwxid_df b\nON a.suserid = b.suserid\nWHERE a.dtstatdate BETWEEN '20250612' AND '20250714'\nAND a.itag = 'T2'\nAND b.iregdate < '20250529'",
  "rejected": "SELECT DISTINCT\n  `T2`.`vplayerid`\nFROM `dws_argothek_ce1_cbt2_vplayerid_suserid_di` AS `T2`\nWHERE\n  `T2`.`dtstatdate` BETWEEN '20250612' AND '20250714'\n  AND `T2`.`itag` = 'T2'\n  AND `T2`.`iregdate` < '20250529'\n  AND `T2`.`vplayerid` IN (\n    SELECT DISTINCT\n      `dim_argothek_gplayerid2qqwxid_df`.`suserid`\n    FROM `dim_argothek_gplayerid2qqwxid_df`\n    WHERE\n      `dim_argothek_gplayerid2qqwxid_df`.`vGameAppid` = '1000000000000000000'\n  )"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025.6.12-2025.7.14å·æ‰‹æ¸¸T2æ´»è·ƒç”¨æˆ·åœ¨20250529ä¹‹å‰ç«¯æ¸¸æ³¨å†Œçš„å·ç åŒ…ã€‚\nè¾“å‡ºï¼švplayerid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dws_argothek_ce1_cbt2_vplayerid_suserid_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'æ— æ±‡æ€»',\n  `platid` BIGINT COMMENT '0 - Android,1,255',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suseridçš„ç±»å‹',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `iregway` TEXT COMMENT 'æ³¨å†Œæ¸ é“-ä¸åŒºåˆ†platid',\n  `iloginway` TEXT COMMENT 'æ´»è·ƒæ¸ é“',\n  `sourcename` TEXT COMMENT 'å¼€ç™½æ¸ é“',\n  `itag` TEXT COMMENT 'ç”¨æˆ·åˆ†å±‚æ ‡ç­¾',\n  `ilevel` BIGINT COMMENT 'æœ€æ–°ç­‰çº§',\n  `ionlinetime` TEXT COMMENT 'åœ¨çº¿æ—¶é•¿ç§’',\n  `iroundtime` TEXT COMMENT 'æ¸¸æˆæ—¶é•¿ç§’',\n  `iroundcnt` TEXT COMMENT 'å¯¹å±€æ¬¡æ•°',\n  `fps_avg` TEXT COMMENT 'å½“æ—¥å¹³å‡å¸§ç‡-gplayeridç»´åº¦',\n  `is_reg` TEXT COMMENT 'æ˜¯å¦å½“æ—¥æ–°è¿›',\n  `is_lowfps` TEXT COMMENT 'æ˜¯å¦ä½å¸§ç‡-æ–°è¿›é¦–æ—¥å¹³å‡å¸§ç‡ä¸é«˜äº40ä¸”æ²¡æœ‰å¸§ç‡æ•°æ®çš„ç”¨æˆ·ä¸è®¡å…¥',\n  `is_match` TEXT COMMENT 'æ˜¯å¦å½“æ—¥å¯¹å±€',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nç”¨æˆ·æ´»è·ƒç”¨æˆ·ç­›é€‰æ¡ä»¶ï¼š\nitag=\"T2\"\n\n",
  "chosen": "SELECT DISTINCT a.vplayerid\nFROM final_algorithm_competition.dws_argothek_ce1_cbt2_vplayerid_suserid_di a\nJOIN final_algorithm_competition.dim_argothek_gplayerid2qqwxid_df b\nON a.suserid = b.suserid\nWHERE a.dtstatdate BETWEEN '20250612' AND '20250714'\nAND a.itag = 'T2'\nAND b.iregdate < '20250529'",
  "rejected": "å¥½çš„ï¼Œæˆ‘ä»¬æ¥ä¸€æ­¥æ­¥åˆ†æè¿™ä¸ªé—®é¢˜ï¼Œå¹¶æ„é€ å‡ºæ­£ç¡®çš„ SQL æŸ¥è¯¢è¯­å¥ã€‚\n\n---\n\n### ğŸ” ç¬¬ä¸€æ­¥ï¼šç†è§£éœ€æ±‚\n\næˆ‘ä»¬éœ€è¦ç»Ÿè®¡çš„æ˜¯ï¼š\n\n> åœ¨ **2025å¹´6æœˆ12æ—¥è‡³2025å¹´7æœˆ14æ—¥** è¿™ä¸ªæ—¶é—´æ®µå†…ï¼Œ**æ‰‹æ¸¸ T2 æ´»è·ƒç”¨æˆ·** ä¸­ï¼Œåœ¨ **2025å¹´5æœˆ29æ—¥ä¹‹å‰æ³¨å†Œè¿‡ç«¯æ¸¸è´¦å·** çš„å·ç åŒ…ï¼ˆå³ `vplayerid`ï¼‰ã€‚\n\n#### å…³é”®ç‚¹æç‚¼ï¼š\n1. æ—¶é—´èŒƒå›´ï¼š`2025-06-12 ~ 2025-07-14`\n2. ç”¨æˆ·ç±»å‹ï¼šæ‰‹æ¸¸ T2 æ´»è·ƒç”¨æˆ· â†’ æ¥è‡ªè¡¨ `dws_argothek_ce1_cbt2_vplayerid_suserid_di`\n3. æ³¨å†Œæ—¶é—´é™åˆ¶ï¼šå¿…é¡»æ˜¯ **åœ¨ 2025 å¹´ 5 æœˆ 29 æ—¥å‰æ³¨å†Œçš„ç«¯æ¸¸è´¦å·**\n   - ç«¯æ¸¸è´¦å·çš„ä¿¡æ¯å¯èƒ½å­˜å‚¨åœ¨ `dim_argothek_gplayerid2qqwxid_df` è¡¨ä¸­\n4. è¾“å‡ºå­—æ®µï¼š`vplayerid`\n\n---\n\n### ğŸ§  ç¬¬äºŒæ­¥ï¼šåˆ†æä¸¤ä¸ªå…³é”®è¡¨ç»“æ„ä¸å…³è”æ–¹å¼\n\n#### è¡¨ä¸€ï¼š`dws_argothek_ce1_cbt2_vplayerid_suserid_di`\nè¿™ä¸ªè¡¨è®°å½•äº†æ‰‹æ¸¸ç”¨æˆ·çš„æ´»è·ƒæƒ…å†µï¼š\n- å­—æ®µè¯´æ˜ï¼š\n  - `vplayerid`: æ‰‹æ¸¸ç©å®¶ IDï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ï¼‰\n  - `suserid`: å¯¹åº”çš„ QQ æˆ–å¾®ä¿¡ ID\n  - `iregdate`: æ³¨å†Œæ—¥æœŸï¼ˆæ ¼å¼å¯èƒ½æ˜¯ YYYYMMDDï¼‰\n  - `itag`: ç”¨æˆ·åˆ†å±‚æ ‡ç­¾ï¼Œæˆ‘ä»¬è¦ç­›é€‰ `itag = 'T2'`\n  - `dtstatdate`: ç»Ÿè®¡æ—¥æœŸï¼ˆç”¨äºé™å®šæ—¶é—´èŒƒå›´ï¼‰\n\n#### è¡¨äºŒï¼š`dim_argothek_gplayerid2qqwxid_df`\nè¿™ä¸ªè¡¨åŒ…å«ç”¨æˆ·åœ¨ä¸åŒå¹³å°ä¸Šçš„æ³¨å†Œä¿¡æ¯ï¼š\n- å­—æ®µè¯´æ˜ï¼š\n  - `suserid`: QQ/å¾®ä¿¡ ID\n  - `iregdate`: æ³¨å†Œæ—¥æœŸï¼ˆæ ¼å¼ä¸º YYYYMMDDï¼‰\n  - `vGameAppid`: å¹³å°æ ‡è¯†ï¼ˆå¦‚ 1000 æ˜¯ç«¯æ¸¸ï¼‰\n  - `dtstatdate`: æ•°æ®æ—¥æœŸ\n\n---\n\n### âœ… ç¬¬ä¸‰æ­¥ï¼šç¡®å®šé€»è¾‘æµç¨‹\n\n1. å…ˆä» `dws_argothek_ce1_cbt2_vplayerid_suserid_di` ä¸­æ‰¾å‡ºåœ¨æŒ‡å®šæ—¥æœŸèŒƒå›´å†…ï¼ˆ2025-06-12 è‡³ 2025-07-14ï¼‰ä¸” `itag = 'T2'` çš„æ‰€æœ‰ `vplayerid`\n2. å†å» `dim_argothek_gplayerid2qqwxid_df` ä¸­æ‰¾åˆ°è¿™äº› `vplayerid` å¯¹åº”çš„ `suserid` æ˜¯å¦åœ¨ **20250529 ä¹‹å‰æ³¨å†Œäº†ç«¯æ¸¸è´¦å·**\n   - æ³¨æ„ï¼šè¿™é‡Œéœ€è¦é€šè¿‡ `suserid` åšè¿æ¥ï¼Œå› ä¸º `vplayerid` å’Œ `suserid` æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼ˆä¸€ä¸ªç©å®¶å¯ä»¥æœ‰å¤šä¸ªç™»å½•æ–¹å¼ï¼‰\n3. æœ€ç»ˆè¾“å‡ºç¬¦åˆæ¡ä»¶çš„ `vplayerid`\n\n---\n\n### âš™ï¸ ç¬¬å››æ­¥ï¼šæ„å»º SQL æŸ¥è¯¢è¯­å¥\n\n```sql\nSELECT DISTINCT\n    t1.vplayerid\nFROM dws_argothek_ce1_cbt2_vplayerid_suserid_di AS t1\nJOIN dim_argothek_gplayerid2qqwxid_df AS t2\n    ON t1.suserid = t2.suserid\nWHERE\n    t1.dtstatdate BETWEEN '20250612' AND '20250714'\n    AND t1.itag = 'T2'\n    AND t2.iregdate < '20250529'\n    AND t2.vGameAppid = '1000'; -- å‡è®¾ 1000 è¡¨ç¤ºç«¯æ¸¸\n```\n\n---\n\n### ğŸ“Œ è§£é‡Šæ¯ä¸ªéƒ¨åˆ†çš„ä½œç”¨ï¼š\n\n| å­å¥ | å«ä¹‰ |\n|------|------|\n| `SELECT DISTINCT vplayerid` | é˜²æ­¢é‡å¤è¿”å›ç›¸åŒ vplayerid |\n| `FROM dws_argothek_ce1_cbt2_vplayerid_suserid_di AS t1` | ä¸»è¡¨ï¼Œè·å– T2 æ‰‹æ¸¸æ´»è·ƒç”¨æˆ· |\n| `JOIN dim_argothek_gplayerid2qqwxid_df AS t2` | å…³è”åˆ°ç«¯æ¸¸æ³¨å†Œä¿¡æ¯ |\n| `ON t1.suserid = t2.suserid` | ä½¿ç”¨ suserid åŒ¹é… |\n| `WHERE ...` | è¿‡æ»¤æ¡ä»¶ |\n| `t1.dtstatdate BETWEEN '20250612' AND '20250714'` | æŒ‡å®šæ—¶é—´èŒƒå›´ |\n| `t1.itag = 'T2'` | ç­›é€‰ T2 æ´»è·ƒç”¨æˆ· |\n| `t2.iregdate < '20250529'` | ç«¯æ¸¸æ³¨å†Œæ—¶é—´æ—©äº 20250529 |\n| `AND t2.vGameAppid = '1000'` | ç¡®ä¿æ˜¯ç«¯æ¸¸å¹³å° |\n\n---\n\n### ğŸ§¾ æœ€ç»ˆç»“æœè¾“å‡ºå­—æ®µï¼š\n- `vplayerid` ï¼ˆç¬¦åˆè¦æ±‚çš„æ‰‹æ¸¸ T2 æ´»è·ƒç”¨æˆ· IDï¼‰\n\n--- \n\nå¦‚æœä½ è¿˜æœ‰å…¶ä»–æ‰©å±•éœ€æ±‚ï¼Œæ¯”å¦‚æŒ‰åœ°åŒºã€ç­‰çº§ç­‰è¿›ä¸€æ­¥ç»†åˆ†ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025.6.12-2025.7.14å·æ‰‹æ¸¸T2æ´»è·ƒç”¨æˆ·åœ¨20250529ä¹‹å‰ç«¯æ¸¸æ³¨å†Œçš„å·ç åŒ…ã€‚\nè¾“å‡ºï¼švplayerid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dws_argothek_ce1_cbt2_vplayerid_suserid_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'æ— æ±‡æ€»',\n  `platid` BIGINT COMMENT '0 - Android,1,255',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suseridçš„ç±»å‹',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `iregway` TEXT COMMENT 'æ³¨å†Œæ¸ é“-ä¸åŒºåˆ†platid',\n  `iloginway` TEXT COMMENT 'æ´»è·ƒæ¸ é“',\n  `sourcename` TEXT COMMENT 'å¼€ç™½æ¸ é“',\n  `itag` TEXT COMMENT 'ç”¨æˆ·åˆ†å±‚æ ‡ç­¾',\n  `ilevel` BIGINT COMMENT 'æœ€æ–°ç­‰çº§',\n  `ionlinetime` TEXT COMMENT 'åœ¨çº¿æ—¶é•¿ç§’',\n  `iroundtime` TEXT COMMENT 'æ¸¸æˆæ—¶é•¿ç§’',\n  `iroundcnt` TEXT COMMENT 'å¯¹å±€æ¬¡æ•°',\n  `fps_avg` TEXT COMMENT 'å½“æ—¥å¹³å‡å¸§ç‡-gplayeridç»´åº¦',\n  `is_reg` TEXT COMMENT 'æ˜¯å¦å½“æ—¥æ–°è¿›',\n  `is_lowfps` TEXT COMMENT 'æ˜¯å¦ä½å¸§ç‡-æ–°è¿›é¦–æ—¥å¹³å‡å¸§ç‡ä¸é«˜äº40ä¸”æ²¡æœ‰å¸§ç‡æ•°æ®çš„ç”¨æˆ·ä¸è®¡å…¥',\n  `is_match` TEXT COMMENT 'æ˜¯å¦å½“æ—¥å¯¹å±€',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nç”¨æˆ·æ´»è·ƒç”¨æˆ·ç­›é€‰æ¡ä»¶ï¼š\nitag=\"T2\"\n\n",
  "chosen": "SELECT DISTINCT a.vplayerid\nFROM final_algorithm_competition.dws_argothek_ce1_cbt2_vplayerid_suserid_di a\nJOIN final_algorithm_competition.dim_argothek_gplayerid2qqwxid_df b\nON a.suserid = b.suserid\nWHERE a.dtstatdate BETWEEN '20250612' AND '20250714'\nAND a.itag = 'T2'\nAND b.iregdate < '20250529'",
  "rejected": "SELECT DISTINCT\n  `T2`.`vplayerid`\nFROM `dws_argothek_ce1_cbt2_vplayerid_suserid_di` AS `T2`\nWHERE\n  `T2`.`iregdate` < '20250529' AND `T2`.`dtstatdate` BETWEEN '20250612' AND '20250714' AND `T2`.`itag` = 'T2'"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025.6.12-2025.7.14å·æ‰‹æ¸¸T2æ´»è·ƒç”¨æˆ·åœ¨20250529ä¹‹å‰ç«¯æ¸¸æ³¨å†Œçš„å·ç åŒ…ã€‚\nè¾“å‡ºï¼švplayerid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dws_argothek_ce1_cbt2_vplayerid_suserid_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'æ— æ±‡æ€»',\n  `platid` BIGINT COMMENT '0 - Android,1,255',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suseridçš„ç±»å‹',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `iregway` TEXT COMMENT 'æ³¨å†Œæ¸ é“-ä¸åŒºåˆ†platid',\n  `iloginway` TEXT COMMENT 'æ´»è·ƒæ¸ é“',\n  `sourcename` TEXT COMMENT 'å¼€ç™½æ¸ é“',\n  `itag` TEXT COMMENT 'ç”¨æˆ·åˆ†å±‚æ ‡ç­¾',\n  `ilevel` BIGINT COMMENT 'æœ€æ–°ç­‰çº§',\n  `ionlinetime` TEXT COMMENT 'åœ¨çº¿æ—¶é•¿ç§’',\n  `iroundtime` TEXT COMMENT 'æ¸¸æˆæ—¶é•¿ç§’',\n  `iroundcnt` TEXT COMMENT 'å¯¹å±€æ¬¡æ•°',\n  `fps_avg` TEXT COMMENT 'å½“æ—¥å¹³å‡å¸§ç‡-gplayeridç»´åº¦',\n  `is_reg` TEXT COMMENT 'æ˜¯å¦å½“æ—¥æ–°è¿›',\n  `is_lowfps` TEXT COMMENT 'æ˜¯å¦ä½å¸§ç‡-æ–°è¿›é¦–æ—¥å¹³å‡å¸§ç‡ä¸é«˜äº40ä¸”æ²¡æœ‰å¸§ç‡æ•°æ®çš„ç”¨æˆ·ä¸è®¡å…¥',\n  `is_match` TEXT COMMENT 'æ˜¯å¦å½“æ—¥å¯¹å±€',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nç”¨æˆ·æ´»è·ƒç”¨æˆ·ç­›é€‰æ¡ä»¶ï¼š\nitag=\"T2\"\n\n",
  "chosen": "SELECT DISTINCT a.vplayerid\nFROM final_algorithm_competition.dws_argothek_ce1_cbt2_vplayerid_suserid_di a\nJOIN final_algorithm_competition.dim_argothek_gplayerid2qqwxid_df b\nON a.suserid = b.suserid\nWHERE a.dtstatdate BETWEEN '20250612' AND '20250714'\nAND a.itag = 'T2'\nAND b.iregdate < '20250529'",
  "rejected": "å¥½çš„ï¼Œæˆ‘ä»¬æ¥ä¸€æ­¥ä¸€æ­¥åœ°åˆ†æè¿™ä¸ªé—®é¢˜ï¼Œå¹¶æ„å»ºå‡ºæ­£ç¡®çš„ SQL æŸ¥è¯¢è¯­å¥ã€‚\n\n---\n\n### ğŸ” ç¬¬ä¸€æ­¥ï¼šç†è§£éœ€æ±‚\n\næˆ‘ä»¬éœ€è¦ç»Ÿè®¡çš„æ˜¯ï¼š\n\n> åœ¨ **2025å¹´6æœˆ12æ—¥è‡³2025å¹´7æœˆ14æ—¥** è¿™ä¸ªæ—¶é—´æ®µå†…ï¼Œ**æ‰‹æ¸¸ T2 æ´»è·ƒç”¨æˆ·** ä¸­ï¼Œé‚£äº›åœ¨ **2025å¹´5æœˆ29æ—¥ä¹‹å‰æ³¨å†Œè¿‡ç«¯æ¸¸è´¦å·** çš„å·ç åŒ…ï¼ˆå³ `vplayerid`ï¼‰ã€‚\n\n#### ğŸ§¾ è¾“å‡ºå­—æ®µï¼š\n- `vplayerid`\n\n---\n\n### ğŸ“Œ ç¬¬äºŒæ­¥ï¼šç†è§£è¡¨ç»“æ„ä¸å­—æ®µå«ä¹‰\n\n#### è¡¨ä¸€ï¼š`dim_argothek_gplayerid2qqwxid_df`\nè¿™æ˜¯å…³äºç©å®¶ ID å’Œå…¶å¯¹åº”çš„ QQ/å¾®ä¿¡ ID çš„æ˜ å°„å…³ç³»ã€‚å…¶ä¸­ï¼š\n- `vplayerid`: ç©å®¶çš„æ¸¸æˆ IDï¼ˆå¯èƒ½æ˜¯æ‰‹æ¸¸ï¼‰\n- `suserid`: å¯¹åº”çš„ QQ æˆ–å¾®ä¿¡ IDï¼ˆè‹¥ç»‘å®šäº†åˆ™ä¼˜å…ˆæ˜¯ QQï¼‰\n- `iregdate`: æ³¨å†Œæ—¶é—´ï¼ˆæ ¼å¼å¯èƒ½ä¸º YYYYMMDDï¼‰\n\n#### è¡¨äºŒï¼š`dws_argothek_ce1_cbt2_vplayerid_suserid_di`\nè¿™ä¸ªè¡¨ä¸­åŒ…å«ï¼š\n- `vplayerid`: ç©å®¶ IDï¼ˆæ‰‹æ¸¸ï¼‰\n- `suserid`: æ˜ å°„çš„ç¤¾äº¤è´¦å·ï¼ˆQQ/å¾®ä¿¡ï¼‰\n- `iregdate`: æ³¨å†Œæ—¥æœŸï¼ˆæ ¼å¼ä¸º YYYYMMDDï¼‰\n- `itag`: ç”¨æˆ·æ ‡ç­¾ï¼Œæ¯”å¦‚ \"T2\"\n- `dtstatdate`: ç»Ÿè®¡æ—¥æœŸï¼ˆç”¨äºç­›é€‰æ—¶é—´èŒƒå›´ï¼‰\n\n---\n\n### âœ… ç¬¬ä¸‰æ­¥ï¼šæ˜ç¡®ç­›é€‰æ¡ä»¶\n\næˆ‘ä»¬è¦æ‰¾çš„æ˜¯ï¼š\n\n1. **æ—¶é—´èŒƒå›´å†…çš„æ´»è·ƒç”¨æˆ·**\n   - `dtstatdate BETWEEN '20250612' AND '20250714'`\n\n2. **å¿…é¡»æ˜¯ T2 å±‚çº§çš„æ´»è·ƒç”¨æˆ·**\n   - `itag = 'T2'`\n\n3. **è¿™äº›ç”¨æˆ·çš„æ³¨å†Œæ—¶é—´è¦æ—©äº 2025 å¹´ 5 æœˆ 29 æ—¥**\n   - `iregdate < '20250529'`\n\n4. **å¹¶ä¸”ä»–ä»¬æ˜¯æ‰‹æ¸¸ç”¨æˆ·ï¼ˆä»è¡¨äºŒä¸­è·å–ï¼‰**\n\n---\n\n### ğŸ› ï¸ ç¬¬å››æ­¥ï¼šç¼–å†™ SQL æŸ¥è¯¢è¯­å¥\n\næˆ‘ä»¬å°†ä½¿ç”¨ `JOIN` å°†ä¸¤ä¸ªè¡¨è¿æ¥èµ·æ¥ï¼Œç­›é€‰ç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼Œæœ€ååªè¾“å‡º `vplayerid`ã€‚\n\n```sql\nSELECT DISTINCT\n    t2.vplayerid\nFROM dws_argothek_ce1_cbt2_vplayerid_suserid_di AS t2\nWHERE\n    t2.dtstatdate BETWEEN '20250612' AND '20250714'\n    AND t2.itag = 'T2'\n    AND t2.iregdate < '20250529';\n```\n\n---\n\n### ğŸ’¡ è§£é‡Šè¯´æ˜ï¼š\n\n| å­å¥ | å«ä¹‰ |\n|------|------|\n| `SELECT DISTINCT vplayerid` | å»é‡åé€‰å‡ºå”¯ä¸€çš„ `vplayerid` |\n| `FROM dws_argothek_ce1_cbt2_vplayerid_suserid_di` | ä½¿ç”¨æ‰‹æ¸¸æ´»è·ƒç”¨æˆ·æ•°æ®è¡¨ |\n| `WHERE ... BETWEEN ...` | ç­›é€‰æŒ‡å®šæ—¶é—´æ®µå†…çš„æ´»è·ƒç”¨æˆ· |\n| `AND itag = 'T2'` | åªå– T2 å±‚çº§ç”¨æˆ· |\n| `AND iregdate < '20250529'` | æ³¨å†Œæ—¶é—´åœ¨ 20250529 ä¹‹å‰ |\n\n---\n\n### âœ… æœ€ç»ˆç­”æ¡ˆï¼ˆæ¨èå†™æ³•ï¼‰ï¼š\n\n```sql\nSELECT DISTINCT\n    vplayerid\nFROM dws_argothek_ce1_cbt2_vplayerid_suserid_di\nWHERE\n    dtstatdate BETWEEN '20250612' AND '20250714'\n    AND itag = 'T2'\n    AND iregdate < '20250529';\n```\n\n--- \n\nå¦‚æœä½ è¿˜æœ‰æ›´å¤šç»´åº¦ã€æˆ–è€…éœ€è¦å…³è”å…¶ä»–è¡¨è¿›è¡Œæ›´å¤æ‚çš„åˆ†æï¼Œè¯·å‘Šè¯‰æˆ‘ï¼"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025.6.12-2025.7.14å·æ‰‹æ¸¸T2æ´»è·ƒç”¨æˆ·åœ¨20250529ä¹‹å‰ç«¯æ¸¸æ³¨å†Œçš„å·ç åŒ…ã€‚\nè¾“å‡ºï¼švplayerid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dws_argothek_ce1_cbt2_vplayerid_suserid_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'æ— æ±‡æ€»',\n  `platid` BIGINT COMMENT '0 - Android,1,255',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suseridçš„ç±»å‹',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `iregway` TEXT COMMENT 'æ³¨å†Œæ¸ é“-ä¸åŒºåˆ†platid',\n  `iloginway` TEXT COMMENT 'æ´»è·ƒæ¸ é“',\n  `sourcename` TEXT COMMENT 'å¼€ç™½æ¸ é“',\n  `itag` TEXT COMMENT 'ç”¨æˆ·åˆ†å±‚æ ‡ç­¾',\n  `ilevel` BIGINT COMMENT 'æœ€æ–°ç­‰çº§',\n  `ionlinetime` TEXT COMMENT 'åœ¨çº¿æ—¶é•¿ç§’',\n  `iroundtime` TEXT COMMENT 'æ¸¸æˆæ—¶é•¿ç§’',\n  `iroundcnt` TEXT COMMENT 'å¯¹å±€æ¬¡æ•°',\n  `fps_avg` TEXT COMMENT 'å½“æ—¥å¹³å‡å¸§ç‡-gplayeridç»´åº¦',\n  `is_reg` TEXT COMMENT 'æ˜¯å¦å½“æ—¥æ–°è¿›',\n  `is_lowfps` TEXT COMMENT 'æ˜¯å¦ä½å¸§ç‡-æ–°è¿›é¦–æ—¥å¹³å‡å¸§ç‡ä¸é«˜äº40ä¸”æ²¡æœ‰å¸§ç‡æ•°æ®çš„ç”¨æˆ·ä¸è®¡å…¥',\n  `is_match` TEXT COMMENT 'æ˜¯å¦å½“æ—¥å¯¹å±€',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nç”¨æˆ·æ´»è·ƒç”¨æˆ·ç­›é€‰æ¡ä»¶ï¼š\nitag=\"T2\"\n\n",
  "chosen": "SELECT DISTINCT a.vplayerid\nFROM final_algorithm_competition.dws_argothek_ce1_cbt2_vplayerid_suserid_di a\nJOIN final_algorithm_competition.dim_argothek_gplayerid2qqwxid_df b\nON a.suserid = b.suserid\nWHERE a.dtstatdate BETWEEN '20250612' AND '20250714'\nAND a.itag = 'T2'\nAND b.iregdate < '20250529'",
  "rejected": "### ç¬¬ä¸€æ­¥: ç†è§£éœ€æ±‚\n\næˆ‘ä»¬è¦æ‰¾å‡ºåœ¨**2025å¹´6æœˆ12æ—¥è‡³2025å¹´7æœˆ14æ—¥ä¹‹é—´æ´»è·ƒçš„T2çº§æ‰‹æ¸¸ç”¨æˆ·ï¼ˆå³ `itag = 'T2'`ï¼‰**ï¼Œå¹¶ä¸”è¿™äº›ç”¨æˆ·çš„æ³¨å†Œæ—¶é—´æ˜¯åœ¨**2025å¹´5æœˆ29æ—¥ä¹‹å‰**ã€‚æœ€ç»ˆè¾“å‡ºçš„æ˜¯è¿™äº›ç¬¦åˆæ¡ä»¶çš„ç”¨æˆ·çš„ **vplayerid**ã€‚\n\n---\n\n### ç¬¬äºŒæ­¥: åˆ†æè¡¨ç»“æ„ä¸å­—æ®µå«ä¹‰\n\n#### è¡¨1ï¼š`dws_argothek_ce1_cbt2_vplayerid_suserid_di`\nè¿™ä¸ªè¡¨ä¸­åŒ…å«ä»¥ä¸‹å…³é”®å­—æ®µï¼š\n\n| å­—æ®µå       | å«ä¹‰è¯´æ˜                         |\n|--------------|----------------------------------|\n| `vplayerid`  | ç”¨æˆ·å”¯ä¸€æ ‡è¯†ï¼ˆgplayeridï¼‰        |\n| `suserid`    | å¯¹åº”çš„å¾®ä¿¡æˆ–QQè´¦å·               |\n| `iregdate`   | æ³¨å†Œæ—¥æœŸï¼ˆæ ¼å¼ä¸ºYYYYMMDDï¼‰       |\n| `itag`       | ç”¨æˆ·åˆ†å±‚æ ‡ç­¾                     |\n| `dtstatdate` | ç»Ÿè®¡æ—¥æœŸ                         |\n\næˆ‘ä»¬éœ€è¦åœ¨è¿™ä¸ªè¡¨é‡Œç­›é€‰å‡ºï¼š\n- `dtstatdate` åœ¨èŒƒå›´ [20250612, 20250714]\n- `itag = 'T2'`\n- `iregdate < 20250529`\n\n---\n\n### ç¬¬ä¸‰æ­¥: æ„å»º SQL æŸ¥è¯¢é€»è¾‘\n\næˆ‘ä»¬åªéœ€è¦ä» `dws_argothek_ce1_cbt2_vplayerid_suserid_di` è¡¨ä¸­é€‰å‡ºæ»¡è¶³ä¸Šè¿°ä¸‰ä¸ªæ¡ä»¶çš„ `vplayerid` å³å¯ã€‚\n\næ³¨æ„ï¼š\n- `iregdate` æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ ¼å¼æ˜¯ YYYYMMDDï¼Œå› æ­¤å¯ä»¥ç›´æ¥è¿›è¡Œæ¯”è¾ƒã€‚\n- `dtstatdate` ä¹Ÿæ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼ŒåŒæ ·å¯ä»¥ç”¨äºèŒƒå›´æ¯”è¾ƒã€‚\n\n---\n\n### ç¬¬å››æ­¥: ç¼–å†™ SQL æŸ¥è¯¢è¯­å¥\n\n```sql\nSELECT DISTINCT vplayerid\nFROM dws_argothek_ce1_cbt2_vplayerid_suserid_di\nWHERE dtstatdate BETWEEN '20250612' AND '20250714'\n  AND itag = 'T2'\n  AND iregdate < '20250529';\n```\n\n---\n\n### ç¬¬äº”æ­¥: éªŒè¯ä¸è§£é‡Š\n\n- `SELECT DISTINCT vplayerid`: å»é‡åè¿”å›æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ `vplayerid`\n- `WHERE ... BETWEEN ...`: ç­›é€‰ç»Ÿè®¡æ—¥æœŸåœ¨æŒ‡å®šåŒºé—´å†…çš„è®°å½•\n- `AND itag = 'T2'`: è¿‡æ»¤å‡º T2 å±‚çº§çš„æ‰‹æ¸¸æ´»è·ƒç”¨æˆ·\n- `AND iregdate < '20250529'`: æ’é™¤åœ¨ 2025 å¹´ 5 æœˆ 29 æ—¥ä¹‹åæ³¨å†Œçš„ç”¨æˆ·\n\nâœ… æ­¤æŸ¥è¯¢å®Œå…¨ç¬¦åˆé¢˜æ„è¦æ±‚ã€‚\n\n--- \n\nå¦‚æœ‰è¿›ä¸€æ­¥æ‰©å±•éœ€æ±‚ï¼ˆå¦‚å…³è”å…¶ä»–è¡¨è·å–æ›´å¤šä¿¡æ¯ï¼‰ï¼Œè¯·ç»§ç»­æä¾›ç›¸å…³ä¿¡æ¯ã€‚"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025.7.3-2025.7.6 å¼€ç™½æ¸ é“éå†…éƒ¨ä½“éªŒå’Œä¹°é‡æµ‹è¯•ï¼Œæ’é™¤å…¨å¹³å°\næ³¨å†Œæ¸ é“ä¸ºä»¥ä¸‹ï¼Œåˆ†åˆ«çš„æ–°è¿›ç”¨æˆ·æ•°\n89903934\n89903933\n89903932\n89902725\n89902724\n89902723\n89900960\n89900961\n89900962\nè¾“å‡ºï¼šæ—¥æœŸï¼ˆ20250703ã€...ã€20250706ï¼‰ã€æ³¨å†Œæ¸ é“ã€æ–°è¿›ç”¨æˆ·æ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_ce1_cbt2_vplayerid_suserid_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'æ— æ±‡æ€»',\n  `platid` BIGINT COMMENT '0 - Android,1,255',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suseridçš„ç±»å‹',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `iregway` TEXT COMMENT 'æ³¨å†Œæ¸ é“-ä¸åŒºåˆ†platid',\n  `iloginway` TEXT COMMENT 'æ´»è·ƒæ¸ é“',\n  `sourcename` TEXT COMMENT 'å¼€ç™½æ¸ é“',\n  `itag` TEXT COMMENT 'ç”¨æˆ·åˆ†å±‚æ ‡ç­¾',\n  `ilevel` BIGINT COMMENT 'æœ€æ–°ç­‰çº§',\n  `ionlinetime` TEXT COMMENT 'åœ¨çº¿æ—¶é•¿ç§’',\n  `iroundtime` TEXT COMMENT 'æ¸¸æˆæ—¶é•¿ç§’',\n  `iroundcnt` TEXT COMMENT 'å¯¹å±€æ¬¡æ•°',\n  `fps_avg` TEXT COMMENT 'å½“æ—¥å¹³å‡å¸§ç‡-gplayeridç»´åº¦',\n  `is_reg` TEXT COMMENT 'æ˜¯å¦å½“æ—¥æ–°è¿›',\n  `is_lowfps` TEXT COMMENT 'æ˜¯å¦ä½å¸§ç‡-æ–°è¿›é¦–æ—¥å¹³å‡å¸§ç‡ä¸é«˜äº40ä¸”æ²¡æœ‰å¸§ç‡æ•°æ®çš„ç”¨æˆ·ä¸è®¡å…¥',\n  `is_match` TEXT COMMENT 'æ˜¯å¦å½“æ—¥å¯¹å±€',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\nCREATE TABLE `dwd_argothek_cbt2kaibai_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'partition fields',\n  `dteventtime` TEXT COMMENT 'dtEventTime',\n  `gplayerid` TEXT COMMENT 'gplayerid',\n  `playerid` TEXT COMMENT 'playerid',\n  `source` TEXT COMMENT 'source',\n  `sourcename` TEXT COMMENT 'sourceName',\n  `acctype` TEXT COMMENT 'acctype',\n  `platid` TEXT COMMENT 'platid',\n  `ext1` TEXT COMMENT 'ext1',\n  `ext2` TEXT COMMENT 'ext2',\n  `ext3` TEXT COMMENT 'ext3',\n  `ext4` TEXT COMMENT 'ext4',\n  `ext5` TEXT COMMENT 'ext5'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\néå†…éƒ¨ä½“éªŒå’Œä¹°é‡æµ‹è¯•ï¼šé€šè¿‡sourcenameåŒºåˆ†\næŒ‡å®šæ³¨å†Œæ¸ é“:\niregway in (\"89903934\", \"89903933\", \"89903932\", \"89902725\", \"89902724\", \"89902723\", \"89900960\", \"89900961\", \"89900962\")\n\n",
  "chosen": "SELECT \n    dtstatdate AS æ—¥æœŸ,\n    iregway AS æ³¨å†Œæ¸ é“,\n    COUNT(*) AS æ–°è¿›ç”¨æˆ·æ•°\nFROM dws_argothek_ce1_cbt2_vplayerid_suserid_di \nWHERE dtstatdate BETWEEN '20250703' AND '20250706'\n  AND iregway IN ('89903934', '89903933', '89903932', '89902725', '89902724', '89902723', '89900960', '89900961', '89900962')\n  AND iregdate = dtstatdate\n  AND sourcename = 'éå†…éƒ¨ä½“éªŒ'\nGROUP BY dtstatdate, iregway\nORDER BY dtstatdate, iregway",
  "rejected": "```sql\nSELECT\n  T1.`dtstatdate`,\n  T1.`iregway`,\n  COUNT(DISTINCT T1.`suserid`)\nFROM `dws_argothek_ce1_cbt2_vplayerid_suserid_di` AS T1\nINNER JOIN `dwd_argothek_cbt2kaibai_hi` AS T2\n  ON T1.`vplayerid` = T2.`gplayerid`\nWHERE\n  T1.`dtstatdate` BETWEEN '20250703' AND '20250706'\n  AND T1.`iregway` IN ('89903934', '89903933', '89903932', '89902725', '89902724', '89902723', '89900960', '89900961', '89900962')\n  AND T2.`sourcename` NOT LIKE '%å†…éƒ¨ä½“éªŒ%'\n  AND T2.`sourcename` NOT LIKE '%ä¹°é‡æµ‹è¯•%'\n  AND T2.`sourcename` != 'å…¨å¹³å°'\n  AND T1.`is_reg` = '1'\nGROUP BY\n  T1.`dtstatdate`,\n  T1.`iregway`\n```"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025.7.3-2025.7.6 å¼€ç™½æ¸ é“éå†…éƒ¨ä½“éªŒå’Œä¹°é‡æµ‹è¯•ï¼Œæ’é™¤å…¨å¹³å°\næ³¨å†Œæ¸ é“ä¸ºä»¥ä¸‹ï¼Œåˆ†åˆ«çš„æ–°è¿›ç”¨æˆ·æ•°\n89903934\n89903933\n89903932\n89902725\n89902724\n89902723\n89900960\n89900961\n89900962\nè¾“å‡ºï¼šæ—¥æœŸï¼ˆ20250703ã€...ã€20250706ï¼‰ã€æ³¨å†Œæ¸ é“ã€æ–°è¿›ç”¨æˆ·æ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_ce1_cbt2_vplayerid_suserid_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'æ— æ±‡æ€»',\n  `platid` BIGINT COMMENT '0 - Android,1,255',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suseridçš„ç±»å‹',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `iregway` TEXT COMMENT 'æ³¨å†Œæ¸ é“-ä¸åŒºåˆ†platid',\n  `iloginway` TEXT COMMENT 'æ´»è·ƒæ¸ é“',\n  `sourcename` TEXT COMMENT 'å¼€ç™½æ¸ é“',\n  `itag` TEXT COMMENT 'ç”¨æˆ·åˆ†å±‚æ ‡ç­¾',\n  `ilevel` BIGINT COMMENT 'æœ€æ–°ç­‰çº§',\n  `ionlinetime` TEXT COMMENT 'åœ¨çº¿æ—¶é•¿ç§’',\n  `iroundtime` TEXT COMMENT 'æ¸¸æˆæ—¶é•¿ç§’',\n  `iroundcnt` TEXT COMMENT 'å¯¹å±€æ¬¡æ•°',\n  `fps_avg` TEXT COMMENT 'å½“æ—¥å¹³å‡å¸§ç‡-gplayeridç»´åº¦',\n  `is_reg` TEXT COMMENT 'æ˜¯å¦å½“æ—¥æ–°è¿›',\n  `is_lowfps` TEXT COMMENT 'æ˜¯å¦ä½å¸§ç‡-æ–°è¿›é¦–æ—¥å¹³å‡å¸§ç‡ä¸é«˜äº40ä¸”æ²¡æœ‰å¸§ç‡æ•°æ®çš„ç”¨æˆ·ä¸è®¡å…¥',\n  `is_match` TEXT COMMENT 'æ˜¯å¦å½“æ—¥å¯¹å±€',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\nCREATE TABLE `dwd_argothek_cbt2kaibai_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'partition fields',\n  `dteventtime` TEXT COMMENT 'dtEventTime',\n  `gplayerid` TEXT COMMENT 'gplayerid',\n  `playerid` TEXT COMMENT 'playerid',\n  `source` TEXT COMMENT 'source',\n  `sourcename` TEXT COMMENT 'sourceName',\n  `acctype` TEXT COMMENT 'acctype',\n  `platid` TEXT COMMENT 'platid',\n  `ext1` TEXT COMMENT 'ext1',\n  `ext2` TEXT COMMENT 'ext2',\n  `ext3` TEXT COMMENT 'ext3',\n  `ext4` TEXT COMMENT 'ext4',\n  `ext5` TEXT COMMENT 'ext5'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\néå†…éƒ¨ä½“éªŒå’Œä¹°é‡æµ‹è¯•ï¼šé€šè¿‡sourcenameåŒºåˆ†\næŒ‡å®šæ³¨å†Œæ¸ é“:\niregway in (\"89903934\", \"89903933\", \"89903932\", \"89902725\", \"89902724\", \"89902723\", \"89900960\", \"89900961\", \"89900962\")\n\n",
  "chosen": "SELECT \n    dtstatdate AS æ—¥æœŸ,\n    iregway AS æ³¨å†Œæ¸ é“,\n    COUNT(*) AS æ–°è¿›ç”¨æˆ·æ•°\nFROM dws_argothek_ce1_cbt2_vplayerid_suserid_di \nWHERE dtstatdate BETWEEN '20250703' AND '20250706'\n  AND iregway IN ('89903934', '89903933', '89903932', '89902725', '89902724', '89902723', '89900960', '89900961', '89900962')\n  AND iregdate = dtstatdate\n  AND sourcename = 'éå†…éƒ¨ä½“éªŒ'\nGROUP BY dtstatdate, iregway\nORDER BY dtstatdate, iregway",
  "rejected": "SELECT\n  DATE_FORMAT(CAST(`t1`.`iregdate` AS TIMESTAMP), 'yyyyMMdd') AS `dtstatdate`,\n  `t1`.`iregway`,\n  COUNT(DISTINCT `t1`.`suserid`) AS `new_user_count`\nFROM `dws_argothek_ce1_cbt2_vplayerid_suserid_di` AS `t1`\nINNER JOIN `dwd_argothek_cbt2kaibai_hi` AS `t2`\n  ON `t1`.`vplayerid` = `t2`.`gplayerid`\nWHERE\n  `t1`.`iregdate` BETWEEN '2025-07-03' AND '2025-07-06'\n  AND `t1`.`iregway` IN ('89903934', '89903933', '89903932', '89902725', '89902724', '89902723', '89900960', '89900961', '89900962')\n  AND `t2`.`sourcename` NOT LIKE '%å†…éƒ¨ä½“éªŒ%'\n  AND `t2`.`sourcename` NOT LIKE '%ä¹°é‡æµ‹è¯•%'\n  AND `t2`.`sourcename` != 'å…¨å¹³å°'\nGROUP BY\n  `dtstatdate`,\n  `iregway`"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025.7.3-2025.7.6 å¼€ç™½æ¸ é“éå†…éƒ¨ä½“éªŒå’Œä¹°é‡æµ‹è¯•ï¼Œæ’é™¤å…¨å¹³å°\næ³¨å†Œæ¸ é“ä¸ºä»¥ä¸‹ï¼Œåˆ†åˆ«çš„æ–°è¿›ç”¨æˆ·æ•°\n89903934\n89903933\n89903932\n89902725\n89902724\n89902723\n89900960\n89900961\n89900962\nè¾“å‡ºï¼šæ—¥æœŸï¼ˆ20250703ã€...ã€20250706ï¼‰ã€æ³¨å†Œæ¸ é“ã€æ–°è¿›ç”¨æˆ·æ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_ce1_cbt2_vplayerid_suserid_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'æ— æ±‡æ€»',\n  `platid` BIGINT COMMENT '0 - Android,1,255',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suseridçš„ç±»å‹',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `iregway` TEXT COMMENT 'æ³¨å†Œæ¸ é“-ä¸åŒºåˆ†platid',\n  `iloginway` TEXT COMMENT 'æ´»è·ƒæ¸ é“',\n  `sourcename` TEXT COMMENT 'å¼€ç™½æ¸ é“',\n  `itag` TEXT COMMENT 'ç”¨æˆ·åˆ†å±‚æ ‡ç­¾',\n  `ilevel` BIGINT COMMENT 'æœ€æ–°ç­‰çº§',\n  `ionlinetime` TEXT COMMENT 'åœ¨çº¿æ—¶é•¿ç§’',\n  `iroundtime` TEXT COMMENT 'æ¸¸æˆæ—¶é•¿ç§’',\n  `iroundcnt` TEXT COMMENT 'å¯¹å±€æ¬¡æ•°',\n  `fps_avg` TEXT COMMENT 'å½“æ—¥å¹³å‡å¸§ç‡-gplayeridç»´åº¦',\n  `is_reg` TEXT COMMENT 'æ˜¯å¦å½“æ—¥æ–°è¿›',\n  `is_lowfps` TEXT COMMENT 'æ˜¯å¦ä½å¸§ç‡-æ–°è¿›é¦–æ—¥å¹³å‡å¸§ç‡ä¸é«˜äº40ä¸”æ²¡æœ‰å¸§ç‡æ•°æ®çš„ç”¨æˆ·ä¸è®¡å…¥',\n  `is_match` TEXT COMMENT 'æ˜¯å¦å½“æ—¥å¯¹å±€',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\nCREATE TABLE `dwd_argothek_cbt2kaibai_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'partition fields',\n  `dteventtime` TEXT COMMENT 'dtEventTime',\n  `gplayerid` TEXT COMMENT 'gplayerid',\n  `playerid` TEXT COMMENT 'playerid',\n  `source` TEXT COMMENT 'source',\n  `sourcename` TEXT COMMENT 'sourceName',\n  `acctype` TEXT COMMENT 'acctype',\n  `platid` TEXT COMMENT 'platid',\n  `ext1` TEXT COMMENT 'ext1',\n  `ext2` TEXT COMMENT 'ext2',\n  `ext3` TEXT COMMENT 'ext3',\n  `ext4` TEXT COMMENT 'ext4',\n  `ext5` TEXT COMMENT 'ext5'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\néå†…éƒ¨ä½“éªŒå’Œä¹°é‡æµ‹è¯•ï¼šé€šè¿‡sourcenameåŒºåˆ†\næŒ‡å®šæ³¨å†Œæ¸ é“:\niregway in (\"89903934\", \"89903933\", \"89903932\", \"89902725\", \"89902724\", \"89902723\", \"89900960\", \"89900961\", \"89900962\")\n\n",
  "chosen": "SELECT \n    dtstatdate AS æ—¥æœŸ,\n    iregway AS æ³¨å†Œæ¸ é“,\n    COUNT(*) AS æ–°è¿›ç”¨æˆ·æ•°\nFROM dws_argothek_ce1_cbt2_vplayerid_suserid_di \nWHERE dtstatdate BETWEEN '20250703' AND '20250706'\n  AND iregway IN ('89903934', '89903933', '89903932', '89902725', '89902724', '89902723', '89900960', '89900961', '89900962')\n  AND iregdate = dtstatdate\n  AND sourcename = 'éå†…éƒ¨ä½“éªŒ'\nGROUP BY dtstatdate, iregway\nORDER BY dtstatdate, iregway",
  "rejected": "SELECT\n  `iregdate`,\n  `iregway`,\n  COUNT(DISTINCT `suserid`)\nFROM `dws_argothek_ce1_cbt2_vplayerid_suserid_di`\nWHERE\n  `iregdate` BETWEEN '20250703' AND '20250706'\n  AND `iregway` IN ('89903934', '89903933', '89903932', '89902725', '89902724', '89902723', '89900960', '89900961', '89900962')\n  AND `sourcename` NOT LIKE '%å†…éƒ¨%'\n  AND `sourcename` NOT LIKE '%ä¹°é‡%'\n  AND `sourcename` != 'å…¨å¹³å°'\n  AND `is_reg` = '1'\nGROUP BY\n  `iregdate`,\n  `iregway`"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025.7.3-2025.7.6 å¼€ç™½æ¸ é“éå†…éƒ¨ä½“éªŒå’Œä¹°é‡æµ‹è¯•ï¼Œæ’é™¤å…¨å¹³å°\næ³¨å†Œæ¸ é“ä¸ºä»¥ä¸‹ï¼Œåˆ†åˆ«çš„æ–°è¿›ç”¨æˆ·æ•°\n89903934\n89903933\n89903932\n89902725\n89902724\n89902723\n89900960\n89900961\n89900962\nè¾“å‡ºï¼šæ—¥æœŸï¼ˆ20250703ã€...ã€20250706ï¼‰ã€æ³¨å†Œæ¸ é“ã€æ–°è¿›ç”¨æˆ·æ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_ce1_cbt2_vplayerid_suserid_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'æ— æ±‡æ€»',\n  `platid` BIGINT COMMENT '0 - Android,1,255',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suseridçš„ç±»å‹',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `iregway` TEXT COMMENT 'æ³¨å†Œæ¸ é“-ä¸åŒºåˆ†platid',\n  `iloginway` TEXT COMMENT 'æ´»è·ƒæ¸ é“',\n  `sourcename` TEXT COMMENT 'å¼€ç™½æ¸ é“',\n  `itag` TEXT COMMENT 'ç”¨æˆ·åˆ†å±‚æ ‡ç­¾',\n  `ilevel` BIGINT COMMENT 'æœ€æ–°ç­‰çº§',\n  `ionlinetime` TEXT COMMENT 'åœ¨çº¿æ—¶é•¿ç§’',\n  `iroundtime` TEXT COMMENT 'æ¸¸æˆæ—¶é•¿ç§’',\n  `iroundcnt` TEXT COMMENT 'å¯¹å±€æ¬¡æ•°',\n  `fps_avg` TEXT COMMENT 'å½“æ—¥å¹³å‡å¸§ç‡-gplayeridç»´åº¦',\n  `is_reg` TEXT COMMENT 'æ˜¯å¦å½“æ—¥æ–°è¿›',\n  `is_lowfps` TEXT COMMENT 'æ˜¯å¦ä½å¸§ç‡-æ–°è¿›é¦–æ—¥å¹³å‡å¸§ç‡ä¸é«˜äº40ä¸”æ²¡æœ‰å¸§ç‡æ•°æ®çš„ç”¨æˆ·ä¸è®¡å…¥',\n  `is_match` TEXT COMMENT 'æ˜¯å¦å½“æ—¥å¯¹å±€',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\nCREATE TABLE `dwd_argothek_cbt2kaibai_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'partition fields',\n  `dteventtime` TEXT COMMENT 'dtEventTime',\n  `gplayerid` TEXT COMMENT 'gplayerid',\n  `playerid` TEXT COMMENT 'playerid',\n  `source` TEXT COMMENT 'source',\n  `sourcename` TEXT COMMENT 'sourceName',\n  `acctype` TEXT COMMENT 'acctype',\n  `platid` TEXT COMMENT 'platid',\n  `ext1` TEXT COMMENT 'ext1',\n  `ext2` TEXT COMMENT 'ext2',\n  `ext3` TEXT COMMENT 'ext3',\n  `ext4` TEXT COMMENT 'ext4',\n  `ext5` TEXT COMMENT 'ext5'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\néå†…éƒ¨ä½“éªŒå’Œä¹°é‡æµ‹è¯•ï¼šé€šè¿‡sourcenameåŒºåˆ†\næŒ‡å®šæ³¨å†Œæ¸ é“:\niregway in (\"89903934\", \"89903933\", \"89903932\", \"89902725\", \"89902724\", \"89902723\", \"89900960\", \"89900961\", \"89900962\")\n\n",
  "chosen": "SELECT \n    dtstatdate AS æ—¥æœŸ,\n    iregway AS æ³¨å†Œæ¸ é“,\n    COUNT(*) AS æ–°è¿›ç”¨æˆ·æ•°\nFROM dws_argothek_ce1_cbt2_vplayerid_suserid_di \nWHERE dtstatdate BETWEEN '20250703' AND '20250706'\n  AND iregway IN ('89903934', '89903933', '89903932', '89902725', '89902724', '89902723', '89900960', '89900961', '89900962')\n  AND iregdate = dtstatdate\n  AND sourcename = 'éå†…éƒ¨ä½“éªŒ'\nGROUP BY dtstatdate, iregway\nORDER BY dtstatdate, iregway",
  "rejected": "```sql\nSELECT\n  T1.dtstatdate,\n  T1.iregway,\n  COUNT(DISTINCT T1.vplayerid)\nFROM (\n  SELECT\n    `dtstatdate`,\n    `vplayerid`,\n    `iregway`\n  FROM `dws_argothek_ce1_cbt2_vplayerid_suserid_di`\n  WHERE\n    `dtstatdate` BETWEEN '20250703' AND '20250706'\n    AND `iregway` IN ('89903934', '89903933', '89903932', '89902725', '89902724', '89902723', '89900960', '89900961', '89900962')\n    AND `sourcename` NOT IN ('å†…éƒ¨ä½“éªŒ', 'ä¹°é‡æµ‹è¯•')\n    AND `sourcename` != 'å…¨å¹³å°'\n    AND `is_reg` = '1'\n) AS T1\nGROUP BY\n  T1.dtstatdate,\n  T1.iregway\n```"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025.7.3-2025.7.6 å¼€ç™½æ¸ é“éå†…éƒ¨ä½“éªŒå’Œä¹°é‡æµ‹è¯•ï¼Œæ’é™¤å…¨å¹³å°\næ³¨å†Œæ¸ é“ä¸ºä»¥ä¸‹ï¼Œåˆ†åˆ«çš„æ–°è¿›ç”¨æˆ·æ•°\n89903934\n89903933\n89903932\n89902725\n89902724\n89902723\n89900960\n89900961\n89900962\nè¾“å‡ºï¼šæ—¥æœŸï¼ˆ20250703ã€...ã€20250706ï¼‰ã€æ³¨å†Œæ¸ é“ã€æ–°è¿›ç”¨æˆ·æ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_ce1_cbt2_vplayerid_suserid_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'æ— æ±‡æ€»',\n  `platid` BIGINT COMMENT '0 - Android,1,255',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suseridçš„ç±»å‹',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `iregway` TEXT COMMENT 'æ³¨å†Œæ¸ é“-ä¸åŒºåˆ†platid',\n  `iloginway` TEXT COMMENT 'æ´»è·ƒæ¸ é“',\n  `sourcename` TEXT COMMENT 'å¼€ç™½æ¸ é“',\n  `itag` TEXT COMMENT 'ç”¨æˆ·åˆ†å±‚æ ‡ç­¾',\n  `ilevel` BIGINT COMMENT 'æœ€æ–°ç­‰çº§',\n  `ionlinetime` TEXT COMMENT 'åœ¨çº¿æ—¶é•¿ç§’',\n  `iroundtime` TEXT COMMENT 'æ¸¸æˆæ—¶é•¿ç§’',\n  `iroundcnt` TEXT COMMENT 'å¯¹å±€æ¬¡æ•°',\n  `fps_avg` TEXT COMMENT 'å½“æ—¥å¹³å‡å¸§ç‡-gplayeridç»´åº¦',\n  `is_reg` TEXT COMMENT 'æ˜¯å¦å½“æ—¥æ–°è¿›',\n  `is_lowfps` TEXT COMMENT 'æ˜¯å¦ä½å¸§ç‡-æ–°è¿›é¦–æ—¥å¹³å‡å¸§ç‡ä¸é«˜äº40ä¸”æ²¡æœ‰å¸§ç‡æ•°æ®çš„ç”¨æˆ·ä¸è®¡å…¥',\n  `is_match` TEXT COMMENT 'æ˜¯å¦å½“æ—¥å¯¹å±€',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\nCREATE TABLE `dwd_argothek_cbt2kaibai_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'partition fields',\n  `dteventtime` TEXT COMMENT 'dtEventTime',\n  `gplayerid` TEXT COMMENT 'gplayerid',\n  `playerid` TEXT COMMENT 'playerid',\n  `source` TEXT COMMENT 'source',\n  `sourcename` TEXT COMMENT 'sourceName',\n  `acctype` TEXT COMMENT 'acctype',\n  `platid` TEXT COMMENT 'platid',\n  `ext1` TEXT COMMENT 'ext1',\n  `ext2` TEXT COMMENT 'ext2',\n  `ext3` TEXT COMMENT 'ext3',\n  `ext4` TEXT COMMENT 'ext4',\n  `ext5` TEXT COMMENT 'ext5'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\néå†…éƒ¨ä½“éªŒå’Œä¹°é‡æµ‹è¯•ï¼šé€šè¿‡sourcenameåŒºåˆ†\næŒ‡å®šæ³¨å†Œæ¸ é“:\niregway in (\"89903934\", \"89903933\", \"89903932\", \"89902725\", \"89902724\", \"89902723\", \"89900960\", \"89900961\", \"89900962\")\n\n",
  "chosen": "SELECT \n    dtstatdate AS æ—¥æœŸ,\n    iregway AS æ³¨å†Œæ¸ é“,\n    COUNT(*) AS æ–°è¿›ç”¨æˆ·æ•°\nFROM dws_argothek_ce1_cbt2_vplayerid_suserid_di \nWHERE dtstatdate BETWEEN '20250703' AND '20250706'\n  AND iregway IN ('89903934', '89903933', '89903932', '89902725', '89902724', '89902723', '89900960', '89900961', '89900962')\n  AND iregdate = dtstatdate\n  AND sourcename = 'éå†…éƒ¨ä½“éªŒ'\nGROUP BY dtstatdate, iregway\nORDER BY dtstatdate, iregway",
  "rejected": "æˆ‘éœ€è¦é€æ­¥åˆ†æè¿™ä¸ªé—®é¢˜å¹¶æ„å»ºæ­£ç¡®çš„SQLæŸ¥è¯¢ã€‚\n\né¦–å…ˆè®©æˆ‘ç†è§£éœ€æ±‚ï¼š\n1. ç»Ÿè®¡æ—¥æœŸèŒƒå›´ï¼š2025å¹´7æœˆ3æ—¥è‡³2025å¹´7æœˆ6æ—¥\n2. æ¡ä»¶ï¼šæ³¨å†Œæ¸ é“åœ¨æŒ‡å®šåˆ—è¡¨ä¸­\n3. æ’é™¤æ¡ä»¶ï¼šéå†…éƒ¨ä½“éªŒå’Œä¹°é‡æµ‹è¯•ï¼ˆé€šè¿‡sourcenameåˆ¤æ–­ï¼‰\n4. æ’é™¤å…¨å¹³å°\n5. è¾“å‡ºï¼šæ—¥æœŸã€æ³¨å†Œæ¸ é“ã€æ–°è¿›ç”¨æˆ·æ•°\n\nè®©æˆ‘åˆ†æè¡¨ç»“æ„ï¼š\n- `dws_argothek_ce1_cbt2_vplayerid_suserid_di` è¡¨åŒ…å«ç”¨æˆ·æ³¨å†Œä¿¡æ¯å’Œæ´»è·ƒä¿¡æ¯\n- `dwd_argothek_cbt2kaibai_hi` è¡¨åŒ…å«å¼€ç™½æ¸ é“ä¿¡æ¯\n\næˆ‘éœ€è¦ä»ä¸¤ä¸ªè¡¨ä¸­è·å–ä¿¡æ¯ï¼Œå¹¶è¿›è¡Œå…³è”ã€‚è®©æˆ‘é€æ­¥æ„å»ºæŸ¥è¯¢ï¼š\n\n```sql\nSELECT \n    DATE_FORMAT(STR_TO_DATE(t1.iregdate, '%Y%m%d'), '%Y%m%d') AS dtstatdate,\n    t1.iregway,\n    COUNT(DISTINCT t1.vplayerid) AS new_user_count\nFROM dws_argothek_ce1_cbt2_vplayerid_suserid_di t1\nLEFT JOIN dwd_argothek_cbt2kaibai_hi t2\n    ON t1.vplayerid = t2.gplayerid\nWHERE \n    t1.is_reg = '1' AND\n    t1.iregdate BETWEEN '20250703' AND '20250706' AND\n    t1.iregway IN ('89903934', '89903933', '89903932', '89902725', '89902724', '89902723', '89900960', '89900961', '89900962') AND\n    (t2.sourcename IS NULL OR NOT (t2.sourcename LIKE '%å†…éƒ¨ä½“éªŒ%' OR t2.sourcename LIKE '%ä¹°é‡æµ‹è¯•%'))\nGROUP BY \n    DATE_FORMAT(STR_TO_DATE(t1.iregdate, '%Y%m%d'), '%Y%m%d'),\n    t1.iregway\nORDER BY \n    dtstatdate,\n    t1.iregway;\n```"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025.7.3-2025.7.6 å¼€ç™½æ¸ é“éå†…éƒ¨ä½“éªŒå’Œä¹°é‡æµ‹è¯•ï¼Œæ’é™¤å…¨å¹³å°\næ³¨å†Œæ¸ é“ä¸ºä»¥ä¸‹ï¼Œåˆ†åˆ«çš„æ–°è¿›ç”¨æˆ·æ•°\n89903934\n89903933\n89903932\n89902725\n89902724\n89902723\n89900960\n89900961\n89900962\nè¾“å‡ºï¼šæ—¥æœŸï¼ˆ20250703ã€...ã€20250706ï¼‰ã€æ³¨å†Œæ¸ é“ã€æ–°è¿›ç”¨æˆ·æ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_ce1_cbt2_vplayerid_suserid_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'æ— æ±‡æ€»',\n  `platid` BIGINT COMMENT '0 - Android,1,255',\n  `vplayerid` TEXT COMMENT 'gplayerid',\n  `suserid` TEXT COMMENT 'suserid',\n  `suserid_type` TEXT COMMENT 'suseridçš„ç±»å‹',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `iregway` TEXT COMMENT 'æ³¨å†Œæ¸ é“-ä¸åŒºåˆ†platid',\n  `iloginway` TEXT COMMENT 'æ´»è·ƒæ¸ é“',\n  `sourcename` TEXT COMMENT 'å¼€ç™½æ¸ é“',\n  `itag` TEXT COMMENT 'ç”¨æˆ·åˆ†å±‚æ ‡ç­¾',\n  `ilevel` BIGINT COMMENT 'æœ€æ–°ç­‰çº§',\n  `ionlinetime` TEXT COMMENT 'åœ¨çº¿æ—¶é•¿ç§’',\n  `iroundtime` TEXT COMMENT 'æ¸¸æˆæ—¶é•¿ç§’',\n  `iroundcnt` TEXT COMMENT 'å¯¹å±€æ¬¡æ•°',\n  `fps_avg` TEXT COMMENT 'å½“æ—¥å¹³å‡å¸§ç‡-gplayeridç»´åº¦',\n  `is_reg` TEXT COMMENT 'æ˜¯å¦å½“æ—¥æ–°è¿›',\n  `is_lowfps` TEXT COMMENT 'æ˜¯å¦ä½å¸§ç‡-æ–°è¿›é¦–æ—¥å¹³å‡å¸§ç‡ä¸é«˜äº40ä¸”æ²¡æœ‰å¸§ç‡æ•°æ®çš„ç”¨æˆ·ä¸è®¡å…¥',\n  `is_match` TEXT COMMENT 'æ˜¯å¦å½“æ—¥å¯¹å±€',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\nCREATE TABLE `dwd_argothek_cbt2kaibai_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'partition fields',\n  `dteventtime` TEXT COMMENT 'dtEventTime',\n  `gplayerid` TEXT COMMENT 'gplayerid',\n  `playerid` TEXT COMMENT 'playerid',\n  `source` TEXT COMMENT 'source',\n  `sourcename` TEXT COMMENT 'sourceName',\n  `acctype` TEXT COMMENT 'acctype',\n  `platid` TEXT COMMENT 'platid',\n  `ext1` TEXT COMMENT 'ext1',\n  `ext2` TEXT COMMENT 'ext2',\n  `ext3` TEXT COMMENT 'ext3',\n  `ext4` TEXT COMMENT 'ext4',\n  `ext5` TEXT COMMENT 'ext5'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\néå†…éƒ¨ä½“éªŒå’Œä¹°é‡æµ‹è¯•ï¼šé€šè¿‡sourcenameåŒºåˆ†\næŒ‡å®šæ³¨å†Œæ¸ é“:\niregway in (\"89903934\", \"89903933\", \"89903932\", \"89902725\", \"89902724\", \"89902723\", \"89900960\", \"89900961\", \"89900962\")\n\n",
  "chosen": "SELECT \n    dtstatdate AS æ—¥æœŸ,\n    iregway AS æ³¨å†Œæ¸ é“,\n    COUNT(*) AS æ–°è¿›ç”¨æˆ·æ•°\nFROM dws_argothek_ce1_cbt2_vplayerid_suserid_di \nWHERE dtstatdate BETWEEN '20250703' AND '20250706'\n  AND iregway IN ('89903934', '89903933', '89903932', '89902725', '89902724', '89902723', '89900960', '89900961', '89900962')\n  AND iregdate = dtstatdate\n  AND sourcename = 'éå†…éƒ¨ä½“éªŒ'\nGROUP BY dtstatdate, iregway\nORDER BY dtstatdate, iregway",
  "rejected": "```sql\nWITH \nbase AS (\n    SELECT\n        `dtstatdate`,\n        `iregway`,\n        `sourcename`,\n        COUNT(DISTINCT `vplayerid`) AS `new_user_cnt`\n    FROM `dws_argothek_ce1_cbt2_vplayerid_suserid_di`\n    WHERE\n        `dtstatdate` BETWEEN '20250703' AND '20250706'\n        AND `iregway` IN ('89903934', '89903933', '89903932', '89902725', '89902724', '89902723', '89900960', '89900961', '89900962')\n        AND `sourcename` NOT LIKE '%å†…éƒ¨ä½“éªŒ%'\n        AND `sourcename` NOT LIKE '%ä¹°é‡æµ‹è¯•%'\n        AND `sourcename` != 'å…¨å¹³å°'\n        AND `is_reg` = '1'\n    GROUP BY\n        `dtstatdate`, `iregway`, `sourcename`\n),\ntmp AS (\n    SELECT\n        `dtstatdate`,\n        `iregway`,\n        `sourcename`,\n        SUM(`new_user_cnt`) OVER (PARTITION BY `dtstatdate`, `iregway`) AS `new_user_cnt`\n    FROM base\n)\nSELECT\n    `dtstatdate`,\n    `iregway`,\n    `new_user_cnt`\nFROM tmp\nORDER BY\n    `dtstatdate`,\n    `iregway`\n```"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡20250702æ‰‹æ¸¸fpsæœ€åæ´»è·ƒæ—¥æœŸä¸ºè¿‘åŠå¹´çš„ç”¨æˆ·çš„åŸå¸‚ç­‰çº§åˆ†å¸ƒã€‚\nè¾“å‡ºï¼šåŸå¸‚ç­‰çº§ï¼Œç”¨æˆ·äººæ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dim_mgamejp_account_allinfo_nf` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹ã€‚0-åˆ†æ¸¸æˆçš„playeridï¼ŒåŠæ±‡æ€»çš„qqï¼Œä¸”è¿™äº›qqéƒ½æ˜¯playeridå¯¹åº”çš„1-åˆ†æ¸¸æˆçš„playeridï¼ŒåŠæ±‡æ€»çš„wxidï¼Œä¸”è¿™äº›wxidéƒ½æ˜¯playeridå¯¹åº”çš„-100-æ±‡æ€»',\n  `suserid` TEXT COMMENT 'å¸å·ã€‚å½“å­˜å‚¨çš„æ˜¯playeridè´¦å·ç±»å‹æ—¶ï¼Œå¯¹äºæ–°æ¸¸å­˜å‚¨çš„æ˜¯gplayeridï¼Œå¯¹äºè€æ¸¸æˆå­˜å‚¨çš„æ˜¯playerid',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹ã€‚å–å€¼ä¸ºqq/wxid/playeridï¼Œæ²¡æœ‰-100',\n  `sgamecode` TEXT COMMENT 'æ¸¸æˆidã€‚å–å€¼ä¸º-100æ—¶è¡¨ç¤ºæ±‡æ€»ï¼Œå…¶å®ƒå–å€¼ä¸ºå„å•ä¸šåŠ¡çš„æ¸¸æˆidï¼Œä¾‹å¦‚å–å€¼ä¸ºstrategyæ—¶è¡¨ç¤ºè±ªæ°å¯¹å†³',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚å–å€¼ä¸º-100æ—¶è¡¨ç¤ºæ±‡æ€»ï¼Œå–å€¼ä¸ºAndroidæ—¶è¡¨ç¤ºå®‰å“å¹³å°ï¼Œå–å€¼ä¸ºiOSæ—¶è¡¨ç¤ºè‹¹æœå¹³å°',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `iregdate` BIGINT COMMENT 'æ³¨å†Œæ—¥æœŸYYYYMMDD',\n  `ilastactdate` BIGINT COMMENT 'æœ€åæ´»è·ƒæ—¥æœŸYYYYMMDD',\n  `sdayacti` TEXT COMMENT 'æœ€è¿‘65å¤©æ¯å¤©æ´»è·ƒæƒ…å†µã€‚ä»¥äºŒè¿›åˆ¶ä½å›¾å½¢å¼å­˜å‚¨ï¼Œæ¯ä¸€ä½è¡¨ç¤ºä¸€å¤©çš„æ´»è·ƒæƒ…å†µï¼Œ1è¡¨ç¤ºæ´»è·ƒï¼Œ0è¡¨ç¤ºæœªæ´»è·ƒã€‚æœ€å·¦çš„ä¸€ä½è¡¨ç¤ºTæ—¥ï¼Œä»¥æ­¤ç±»æ¨',\n  `sweekacti` TEXT COMMENT 'æœ€è¿‘60å‘¨æ´»è·ƒæƒ…å†µã€‚ç”¨æ³•åŒä¸Š',\n  `smonthacti` TEXT COMMENT 'æœ€è¿‘60æœˆæ´»è·ƒæƒ…å†µã€‚ç”¨æ³•åŒä¸Š',\n  `sgroup` TEXT COMMENT 'ç”¨æ¥æ ‡è¯†ç”¨æˆ·æ˜¯å¦ä»˜è´¹ç”¨æˆ·ï¼Œæ˜¯å¦åŒ…æœˆç”¨æˆ·ç­‰ç­‰å¤‡æ³¨ï¼šè¯¥å­—æ®µå®é™…ä¸Šè¡¨ç¤ºæ³¨å†Œçš„æ—¶é—´æˆ³ï¼Œ2018-04ä¹‹å‰ä»¥YYYYMMDDæ ¼å¼ï¼Œ2018-04ä¹‹åä»¥YYYYMMDDHHMMSSæ ¼å¼',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚åºŸå¼ƒå­—æ®µ',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚åºŸå¼ƒå­—æ®µ',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·ä»æ³¨å†Œåˆ°Tæ—¥çš„ç´¯è®¡æ´»è·ƒæ€»æ¬¡æ•°ï¼Œæ³¨æ„æ˜¯ç´¯è®¡å€¼',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·ä»æ³¨å†Œåˆ°Tæ—¥çš„ç´¯è®¡æ´»è·ƒæ€»æ—¶é—´ï¼Œæ³¨æ„æ˜¯ç´¯è®¡å€¼ï¼Œå•ä½ä¸ºç§’ï¼›å­˜åœ¨è´Ÿæ•°ï¼Œä½¿ç”¨æ—¶éœ€è¦å‰”é™¤'\n);\nCREATE TABLE `dim_uf_player_gameinfo_mf` (\n  `kp_imp_date` TEXT COMMENT 'åˆ†åŒºå­—æ®µæ ¼å¼YYYYMM',\n  `id_type` TEXT COMMENT 'è´¦å·ç±»å‹ï¼šqq/wx',\n  `userid` TEXT COMMENT 'è´¦å·',\n  `gender` BIGINT COMMENT 'æ€§åˆ«ï¼ˆ1ç”·2å¥³ï¼‰',\n  `city` TEXT COMMENT 'åŸå¸‚',\n  `province` TEXT COMMENT 'çœä»½',\n  `city_level` TEXT COMMENT 'åŸå¸‚ç­‰çº§'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nç”¨æˆ·å›ºå®šç­›é€‰é€»è¾‘:\nand saccounttype = \"-100\" -- è´¦æˆ·ç±»å‹ä¸º-100\nand suseridtype in (\"qq\",\"wxid\") -- ç”¨æˆ·ç±»å‹ä¸ºqqæˆ–wxid\nand sgamecode in (\"esports\",\"mobile_live\",\"initiatived\",\"allianceforce\",\"strategy\",\"jordass\",\"su\",\"playzone\",\"battlezone\",\"battlearena\",\"weapon\",\"playhub\",\"manager\",\"apgame\") -- æ¸¸æˆä»£ç ä¸ºæŒ‡å®šçš„æ‰‹æ¸¸fps\nand splattype = \"-100\" -- å¹³å°ç±»å‹ä¸º-100\næ´»è·ƒæ—¥æœŸé€»è¾‘:\nåŸºäºå½“å‰ç»Ÿè®¡æ—¶é—´20250702å‘å‰è®¡ç®—6ä¸ªæœˆçš„ç™»é™†æ—¥æœŸï¼Œå³ilastactdate >= \"20250104\"\nåŸå¸‚ç­‰çº§åˆ†å¸ƒï¼š\nå½“å‰æ—¶é—´ä¸º20250702ï¼ŒåŸå¸‚ç­‰çº§åˆ†å¸ƒçš„ç›¸å…³è¡¨æ˜¯æœˆè¡¨ï¼Œæ‰€ä»¥éœ€è¦å–kp_imp_date = \"202506\"çš„æ•°æ®ä½œä¸ºå…³è”æ•°æ®\n\n",
  "chosen": "SELECT \n    b.city_level,\n    COUNT(DISTINCT a.suserid) as user_count\nFROM \n    dim_mgamejp_account_allinfo_nf a\nJOIN \n    dim_uf_player_gameinfo_mf b \n    ON a.suserid = b.userid \n    AND a.suseridtype = CASE WHEN b.id_type = 'qq' THEN 'qq' ELSE 'wxid' END\n    AND b.kp_imp_date = '202506'\nWHERE \n    a.dtstatdate = 20250702\n    AND a.saccounttype = '-100'\n    AND a.suseridtype IN ('qq', 'wxid')\n    AND a.sgamecode IN ('esports','mobile_live','initiatived','allianceforce','strategy','jordass','su','playzone','battlezone','battlearena','weapon','playhub','manager','apgame')\n    AND a.splattype = '-100'\n    AND a.ilastactdate >= 20250104\nGROUP BY \n    b.city_level\nORDER BY \n    b.city_level",
  "rejected": "SELECT\n  T2.city_level,\n  COUNT(DISTINCT T1.suserid)\nFROM `dim_mgamejp_account_allinfo_nf` AS T1\nINNER JOIN `dim_uf_player_gameinfo_mf` AS T2\n  ON T1.suserid = T2.userid AND T2.kp_imp_date = \"202506\"\nWHERE\n  T1.dtstatdate = 20250702\n  AND T1.saccounttype = \"-100\"\n  AND T1.suseridtype IN (\"qq\", \"wxid\")\n  AND T1.sgamecode IN (\"esports\", \"mobile_live\", \"initiatived\", \"allianceforce\", \"strategy\", \"jordass\", \"su\", \"playzone\", \"battlezone\", \"battlearena\", \"weapon\", \"playhub\", \"manager\", \"apgame\")\n  AND T1.splattype = \"-100\"\n  AND T1.ilastactdate >= 20250104"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡20250702æ‰‹æ¸¸fpsæœ€åæ´»è·ƒæ—¥æœŸä¸ºè¿‘åŠå¹´çš„ç”¨æˆ·çš„åŸå¸‚ç­‰çº§åˆ†å¸ƒã€‚\nè¾“å‡ºï¼šåŸå¸‚ç­‰çº§ï¼Œç”¨æˆ·äººæ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dim_mgamejp_account_allinfo_nf` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹ã€‚0-åˆ†æ¸¸æˆçš„playeridï¼ŒåŠæ±‡æ€»çš„qqï¼Œä¸”è¿™äº›qqéƒ½æ˜¯playeridå¯¹åº”çš„1-åˆ†æ¸¸æˆçš„playeridï¼ŒåŠæ±‡æ€»çš„wxidï¼Œä¸”è¿™äº›wxidéƒ½æ˜¯playeridå¯¹åº”çš„-100-æ±‡æ€»',\n  `suserid` TEXT COMMENT 'å¸å·ã€‚å½“å­˜å‚¨çš„æ˜¯playeridè´¦å·ç±»å‹æ—¶ï¼Œå¯¹äºæ–°æ¸¸å­˜å‚¨çš„æ˜¯gplayeridï¼Œå¯¹äºè€æ¸¸æˆå­˜å‚¨çš„æ˜¯playerid',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹ã€‚å–å€¼ä¸ºqq/wxid/playeridï¼Œæ²¡æœ‰-100',\n  `sgamecode` TEXT COMMENT 'æ¸¸æˆidã€‚å–å€¼ä¸º-100æ—¶è¡¨ç¤ºæ±‡æ€»ï¼Œå…¶å®ƒå–å€¼ä¸ºå„å•ä¸šåŠ¡çš„æ¸¸æˆidï¼Œä¾‹å¦‚å–å€¼ä¸ºstrategyæ—¶è¡¨ç¤ºè±ªæ°å¯¹å†³',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚å–å€¼ä¸º-100æ—¶è¡¨ç¤ºæ±‡æ€»ï¼Œå–å€¼ä¸ºAndroidæ—¶è¡¨ç¤ºå®‰å“å¹³å°ï¼Œå–å€¼ä¸ºiOSæ—¶è¡¨ç¤ºè‹¹æœå¹³å°',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `iregdate` BIGINT COMMENT 'æ³¨å†Œæ—¥æœŸYYYYMMDD',\n  `ilastactdate` BIGINT COMMENT 'æœ€åæ´»è·ƒæ—¥æœŸYYYYMMDD',\n  `sdayacti` TEXT COMMENT 'æœ€è¿‘65å¤©æ¯å¤©æ´»è·ƒæƒ…å†µã€‚ä»¥äºŒè¿›åˆ¶ä½å›¾å½¢å¼å­˜å‚¨ï¼Œæ¯ä¸€ä½è¡¨ç¤ºä¸€å¤©çš„æ´»è·ƒæƒ…å†µï¼Œ1è¡¨ç¤ºæ´»è·ƒï¼Œ0è¡¨ç¤ºæœªæ´»è·ƒã€‚æœ€å·¦çš„ä¸€ä½è¡¨ç¤ºTæ—¥ï¼Œä»¥æ­¤ç±»æ¨',\n  `sweekacti` TEXT COMMENT 'æœ€è¿‘60å‘¨æ´»è·ƒæƒ…å†µã€‚ç”¨æ³•åŒä¸Š',\n  `smonthacti` TEXT COMMENT 'æœ€è¿‘60æœˆæ´»è·ƒæƒ…å†µã€‚ç”¨æ³•åŒä¸Š',\n  `sgroup` TEXT COMMENT 'ç”¨æ¥æ ‡è¯†ç”¨æˆ·æ˜¯å¦ä»˜è´¹ç”¨æˆ·ï¼Œæ˜¯å¦åŒ…æœˆç”¨æˆ·ç­‰ç­‰å¤‡æ³¨ï¼šè¯¥å­—æ®µå®é™…ä¸Šè¡¨ç¤ºæ³¨å†Œçš„æ—¶é—´æˆ³ï¼Œ2018-04ä¹‹å‰ä»¥YYYYMMDDæ ¼å¼ï¼Œ2018-04ä¹‹åä»¥YYYYMMDDHHMMSSæ ¼å¼',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚åºŸå¼ƒå­—æ®µ',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚åºŸå¼ƒå­—æ®µ',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·ä»æ³¨å†Œåˆ°Tæ—¥çš„ç´¯è®¡æ´»è·ƒæ€»æ¬¡æ•°ï¼Œæ³¨æ„æ˜¯ç´¯è®¡å€¼',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·ä»æ³¨å†Œåˆ°Tæ—¥çš„ç´¯è®¡æ´»è·ƒæ€»æ—¶é—´ï¼Œæ³¨æ„æ˜¯ç´¯è®¡å€¼ï¼Œå•ä½ä¸ºç§’ï¼›å­˜åœ¨è´Ÿæ•°ï¼Œä½¿ç”¨æ—¶éœ€è¦å‰”é™¤'\n);\nCREATE TABLE `dim_uf_player_gameinfo_mf` (\n  `kp_imp_date` TEXT COMMENT 'åˆ†åŒºå­—æ®µæ ¼å¼YYYYMM',\n  `id_type` TEXT COMMENT 'è´¦å·ç±»å‹ï¼šqq/wx',\n  `userid` TEXT COMMENT 'è´¦å·',\n  `gender` BIGINT COMMENT 'æ€§åˆ«ï¼ˆ1ç”·2å¥³ï¼‰',\n  `city` TEXT COMMENT 'åŸå¸‚',\n  `province` TEXT COMMENT 'çœä»½',\n  `city_level` TEXT COMMENT 'åŸå¸‚ç­‰çº§'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nç”¨æˆ·å›ºå®šç­›é€‰é€»è¾‘:\nand saccounttype = \"-100\" -- è´¦æˆ·ç±»å‹ä¸º-100\nand suseridtype in (\"qq\",\"wxid\") -- ç”¨æˆ·ç±»å‹ä¸ºqqæˆ–wxid\nand sgamecode in (\"esports\",\"mobile_live\",\"initiatived\",\"allianceforce\",\"strategy\",\"jordass\",\"su\",\"playzone\",\"battlezone\",\"battlearena\",\"weapon\",\"playhub\",\"manager\",\"apgame\") -- æ¸¸æˆä»£ç ä¸ºæŒ‡å®šçš„æ‰‹æ¸¸fps\nand splattype = \"-100\" -- å¹³å°ç±»å‹ä¸º-100\næ´»è·ƒæ—¥æœŸé€»è¾‘:\nåŸºäºå½“å‰ç»Ÿè®¡æ—¶é—´20250702å‘å‰è®¡ç®—6ä¸ªæœˆçš„ç™»é™†æ—¥æœŸï¼Œå³ilastactdate >= \"20250104\"\nåŸå¸‚ç­‰çº§åˆ†å¸ƒï¼š\nå½“å‰æ—¶é—´ä¸º20250702ï¼ŒåŸå¸‚ç­‰çº§åˆ†å¸ƒçš„ç›¸å…³è¡¨æ˜¯æœˆè¡¨ï¼Œæ‰€ä»¥éœ€è¦å–kp_imp_date = \"202506\"çš„æ•°æ®ä½œä¸ºå…³è”æ•°æ®\n\n",
  "chosen": "SELECT \n    b.city_level,\n    COUNT(DISTINCT a.suserid) as user_count\nFROM \n    dim_mgamejp_account_allinfo_nf a\nJOIN \n    dim_uf_player_gameinfo_mf b \n    ON a.suserid = b.userid \n    AND a.suseridtype = CASE WHEN b.id_type = 'qq' THEN 'qq' ELSE 'wxid' END\n    AND b.kp_imp_date = '202506'\nWHERE \n    a.dtstatdate = 20250702\n    AND a.saccounttype = '-100'\n    AND a.suseridtype IN ('qq', 'wxid')\n    AND a.sgamecode IN ('esports','mobile_live','initiatived','allianceforce','strategy','jordass','su','playzone','battlezone','battlearena','weapon','playhub','manager','apgame')\n    AND a.splattype = '-100'\n    AND a.ilastactdate >= 20250104\nGROUP BY \n    b.city_level\nORDER BY \n    b.city_level",
  "rejected": "SELECT\n  `city_level`,\n  COUNT(`userid`)\nFROM `dim_mgamejp_account_allinfo_nf`\nINNER JOIN `dim_uf_player_gameinfo_mf`\n  ON `dim_mgamejp_account_allinfo_nf`.`suserid` = `dim_uf_player_gameinfo_mf`.`userid`\nWHERE\n  `saccounttype` = '-100'\n  AND `suseridtype` IN ('qq', 'wxid')\n  AND `sgamecode` IN ('esports', 'mobile_live', 'initiatived', 'allianceforce', 'strategy', 'jordass', 'su', 'playzone', 'battlezone', 'battlearena', 'weapon', 'playhub', 'manager', 'apgame')\n  AND `splattype` = '-100'\n  AND `ilastactdate` >= 20250104\n  AND `kp_imp_date` = '202506'\nGROUP BY\n  `city_level`"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡20250702æ‰‹æ¸¸fpsæœ€åæ´»è·ƒæ—¥æœŸä¸ºè¿‘åŠå¹´çš„ç”¨æˆ·çš„åŸå¸‚ç­‰çº§åˆ†å¸ƒã€‚\nè¾“å‡ºï¼šåŸå¸‚ç­‰çº§ï¼Œç”¨æˆ·äººæ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dim_mgamejp_account_allinfo_nf` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹ã€‚0-åˆ†æ¸¸æˆçš„playeridï¼ŒåŠæ±‡æ€»çš„qqï¼Œä¸”è¿™äº›qqéƒ½æ˜¯playeridå¯¹åº”çš„1-åˆ†æ¸¸æˆçš„playeridï¼ŒåŠæ±‡æ€»çš„wxidï¼Œä¸”è¿™äº›wxidéƒ½æ˜¯playeridå¯¹åº”çš„-100-æ±‡æ€»',\n  `suserid` TEXT COMMENT 'å¸å·ã€‚å½“å­˜å‚¨çš„æ˜¯playeridè´¦å·ç±»å‹æ—¶ï¼Œå¯¹äºæ–°æ¸¸å­˜å‚¨çš„æ˜¯gplayeridï¼Œå¯¹äºè€æ¸¸æˆå­˜å‚¨çš„æ˜¯playerid',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹ã€‚å–å€¼ä¸ºqq/wxid/playeridï¼Œæ²¡æœ‰-100',\n  `sgamecode` TEXT COMMENT 'æ¸¸æˆidã€‚å–å€¼ä¸º-100æ—¶è¡¨ç¤ºæ±‡æ€»ï¼Œå…¶å®ƒå–å€¼ä¸ºå„å•ä¸šåŠ¡çš„æ¸¸æˆidï¼Œä¾‹å¦‚å–å€¼ä¸ºstrategyæ—¶è¡¨ç¤ºè±ªæ°å¯¹å†³',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚å–å€¼ä¸º-100æ—¶è¡¨ç¤ºæ±‡æ€»ï¼Œå–å€¼ä¸ºAndroidæ—¶è¡¨ç¤ºå®‰å“å¹³å°ï¼Œå–å€¼ä¸ºiOSæ—¶è¡¨ç¤ºè‹¹æœå¹³å°',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `iregdate` BIGINT COMMENT 'æ³¨å†Œæ—¥æœŸYYYYMMDD',\n  `ilastactdate` BIGINT COMMENT 'æœ€åæ´»è·ƒæ—¥æœŸYYYYMMDD',\n  `sdayacti` TEXT COMMENT 'æœ€è¿‘65å¤©æ¯å¤©æ´»è·ƒæƒ…å†µã€‚ä»¥äºŒè¿›åˆ¶ä½å›¾å½¢å¼å­˜å‚¨ï¼Œæ¯ä¸€ä½è¡¨ç¤ºä¸€å¤©çš„æ´»è·ƒæƒ…å†µï¼Œ1è¡¨ç¤ºæ´»è·ƒï¼Œ0è¡¨ç¤ºæœªæ´»è·ƒã€‚æœ€å·¦çš„ä¸€ä½è¡¨ç¤ºTæ—¥ï¼Œä»¥æ­¤ç±»æ¨',\n  `sweekacti` TEXT COMMENT 'æœ€è¿‘60å‘¨æ´»è·ƒæƒ…å†µã€‚ç”¨æ³•åŒä¸Š',\n  `smonthacti` TEXT COMMENT 'æœ€è¿‘60æœˆæ´»è·ƒæƒ…å†µã€‚ç”¨æ³•åŒä¸Š',\n  `sgroup` TEXT COMMENT 'ç”¨æ¥æ ‡è¯†ç”¨æˆ·æ˜¯å¦ä»˜è´¹ç”¨æˆ·ï¼Œæ˜¯å¦åŒ…æœˆç”¨æˆ·ç­‰ç­‰å¤‡æ³¨ï¼šè¯¥å­—æ®µå®é™…ä¸Šè¡¨ç¤ºæ³¨å†Œçš„æ—¶é—´æˆ³ï¼Œ2018-04ä¹‹å‰ä»¥YYYYMMDDæ ¼å¼ï¼Œ2018-04ä¹‹åä»¥YYYYMMDDHHMMSSæ ¼å¼',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚åºŸå¼ƒå­—æ®µ',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚åºŸå¼ƒå­—æ®µ',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·ä»æ³¨å†Œåˆ°Tæ—¥çš„ç´¯è®¡æ´»è·ƒæ€»æ¬¡æ•°ï¼Œæ³¨æ„æ˜¯ç´¯è®¡å€¼',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·ä»æ³¨å†Œåˆ°Tæ—¥çš„ç´¯è®¡æ´»è·ƒæ€»æ—¶é—´ï¼Œæ³¨æ„æ˜¯ç´¯è®¡å€¼ï¼Œå•ä½ä¸ºç§’ï¼›å­˜åœ¨è´Ÿæ•°ï¼Œä½¿ç”¨æ—¶éœ€è¦å‰”é™¤'\n);\nCREATE TABLE `dim_uf_player_gameinfo_mf` (\n  `kp_imp_date` TEXT COMMENT 'åˆ†åŒºå­—æ®µæ ¼å¼YYYYMM',\n  `id_type` TEXT COMMENT 'è´¦å·ç±»å‹ï¼šqq/wx',\n  `userid` TEXT COMMENT 'è´¦å·',\n  `gender` BIGINT COMMENT 'æ€§åˆ«ï¼ˆ1ç”·2å¥³ï¼‰',\n  `city` TEXT COMMENT 'åŸå¸‚',\n  `province` TEXT COMMENT 'çœä»½',\n  `city_level` TEXT COMMENT 'åŸå¸‚ç­‰çº§'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nç”¨æˆ·å›ºå®šç­›é€‰é€»è¾‘:\nand saccounttype = \"-100\" -- è´¦æˆ·ç±»å‹ä¸º-100\nand suseridtype in (\"qq\",\"wxid\") -- ç”¨æˆ·ç±»å‹ä¸ºqqæˆ–wxid\nand sgamecode in (\"esports\",\"mobile_live\",\"initiatived\",\"allianceforce\",\"strategy\",\"jordass\",\"su\",\"playzone\",\"battlezone\",\"battlearena\",\"weapon\",\"playhub\",\"manager\",\"apgame\") -- æ¸¸æˆä»£ç ä¸ºæŒ‡å®šçš„æ‰‹æ¸¸fps\nand splattype = \"-100\" -- å¹³å°ç±»å‹ä¸º-100\næ´»è·ƒæ—¥æœŸé€»è¾‘:\nåŸºäºå½“å‰ç»Ÿè®¡æ—¶é—´20250702å‘å‰è®¡ç®—6ä¸ªæœˆçš„ç™»é™†æ—¥æœŸï¼Œå³ilastactdate >= \"20250104\"\nåŸå¸‚ç­‰çº§åˆ†å¸ƒï¼š\nå½“å‰æ—¶é—´ä¸º20250702ï¼ŒåŸå¸‚ç­‰çº§åˆ†å¸ƒçš„ç›¸å…³è¡¨æ˜¯æœˆè¡¨ï¼Œæ‰€ä»¥éœ€è¦å–kp_imp_date = \"202506\"çš„æ•°æ®ä½œä¸ºå…³è”æ•°æ®\n\n",
  "chosen": "SELECT \n    b.city_level,\n    COUNT(DISTINCT a.suserid) as user_count\nFROM \n    dim_mgamejp_account_allinfo_nf a\nJOIN \n    dim_uf_player_gameinfo_mf b \n    ON a.suserid = b.userid \n    AND a.suseridtype = CASE WHEN b.id_type = 'qq' THEN 'qq' ELSE 'wxid' END\n    AND b.kp_imp_date = '202506'\nWHERE \n    a.dtstatdate = 20250702\n    AND a.saccounttype = '-100'\n    AND a.suseridtype IN ('qq', 'wxid')\n    AND a.sgamecode IN ('esports','mobile_live','initiatived','allianceforce','strategy','jordass','su','playzone','battlezone','battlearena','weapon','playhub','manager','apgame')\n    AND a.splattype = '-100'\n    AND a.ilastactdate >= 20250104\nGROUP BY \n    b.city_level\nORDER BY \n    b.city_level",
  "rejected": "SELECT\n  `T2`.`city_level`,\n  COUNT(DISTINCT `T1`.`suserid`)\nFROM `dim_mgamejp_account_allinfo_nf` AS `T1`\nINNER JOIN `dim_uf_player_gameinfo_mf` AS `T2`\n  ON `T1`.`suserid` = `T2`.`userid`\nWHERE\n  `T1`.`saccounttype` = '-100'\n  AND `T1`.`suseridtype` IN ('qq', 'wxid')\n  AND `T1`.`sgamecode` IN ('esports', 'mobile_live', 'initiatived', 'allianceforce', 'strategy', 'jordass', 'su', 'playzone', 'battlezone', 'battlearena', 'weapon', 'playhub', 'manager', 'apgame')\n  AND `T1`.`splattype` = '-100'\n  AND `T1`.`ilastactdate` >= 20250104\n  AND `T2`.`kp_imp_date` = '202506'"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡20250702æ‰‹æ¸¸fpsæœ€åæ´»è·ƒæ—¥æœŸä¸ºè¿‘åŠå¹´çš„ç”¨æˆ·çš„åŸå¸‚ç­‰çº§åˆ†å¸ƒã€‚\nè¾“å‡ºï¼šåŸå¸‚ç­‰çº§ï¼Œç”¨æˆ·äººæ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dim_mgamejp_account_allinfo_nf` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹ã€‚0-åˆ†æ¸¸æˆçš„playeridï¼ŒåŠæ±‡æ€»çš„qqï¼Œä¸”è¿™äº›qqéƒ½æ˜¯playeridå¯¹åº”çš„1-åˆ†æ¸¸æˆçš„playeridï¼ŒåŠæ±‡æ€»çš„wxidï¼Œä¸”è¿™äº›wxidéƒ½æ˜¯playeridå¯¹åº”çš„-100-æ±‡æ€»',\n  `suserid` TEXT COMMENT 'å¸å·ã€‚å½“å­˜å‚¨çš„æ˜¯playeridè´¦å·ç±»å‹æ—¶ï¼Œå¯¹äºæ–°æ¸¸å­˜å‚¨çš„æ˜¯gplayeridï¼Œå¯¹äºè€æ¸¸æˆå­˜å‚¨çš„æ˜¯playerid',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹ã€‚å–å€¼ä¸ºqq/wxid/playeridï¼Œæ²¡æœ‰-100',\n  `sgamecode` TEXT COMMENT 'æ¸¸æˆidã€‚å–å€¼ä¸º-100æ—¶è¡¨ç¤ºæ±‡æ€»ï¼Œå…¶å®ƒå–å€¼ä¸ºå„å•ä¸šåŠ¡çš„æ¸¸æˆidï¼Œä¾‹å¦‚å–å€¼ä¸ºstrategyæ—¶è¡¨ç¤ºè±ªæ°å¯¹å†³',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚å–å€¼ä¸º-100æ—¶è¡¨ç¤ºæ±‡æ€»ï¼Œå–å€¼ä¸ºAndroidæ—¶è¡¨ç¤ºå®‰å“å¹³å°ï¼Œå–å€¼ä¸ºiOSæ—¶è¡¨ç¤ºè‹¹æœå¹³å°',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `iregdate` BIGINT COMMENT 'æ³¨å†Œæ—¥æœŸYYYYMMDD',\n  `ilastactdate` BIGINT COMMENT 'æœ€åæ´»è·ƒæ—¥æœŸYYYYMMDD',\n  `sdayacti` TEXT COMMENT 'æœ€è¿‘65å¤©æ¯å¤©æ´»è·ƒæƒ…å†µã€‚ä»¥äºŒè¿›åˆ¶ä½å›¾å½¢å¼å­˜å‚¨ï¼Œæ¯ä¸€ä½è¡¨ç¤ºä¸€å¤©çš„æ´»è·ƒæƒ…å†µï¼Œ1è¡¨ç¤ºæ´»è·ƒï¼Œ0è¡¨ç¤ºæœªæ´»è·ƒã€‚æœ€å·¦çš„ä¸€ä½è¡¨ç¤ºTæ—¥ï¼Œä»¥æ­¤ç±»æ¨',\n  `sweekacti` TEXT COMMENT 'æœ€è¿‘60å‘¨æ´»è·ƒæƒ…å†µã€‚ç”¨æ³•åŒä¸Š',\n  `smonthacti` TEXT COMMENT 'æœ€è¿‘60æœˆæ´»è·ƒæƒ…å†µã€‚ç”¨æ³•åŒä¸Š',\n  `sgroup` TEXT COMMENT 'ç”¨æ¥æ ‡è¯†ç”¨æˆ·æ˜¯å¦ä»˜è´¹ç”¨æˆ·ï¼Œæ˜¯å¦åŒ…æœˆç”¨æˆ·ç­‰ç­‰å¤‡æ³¨ï¼šè¯¥å­—æ®µå®é™…ä¸Šè¡¨ç¤ºæ³¨å†Œçš„æ—¶é—´æˆ³ï¼Œ2018-04ä¹‹å‰ä»¥YYYYMMDDæ ¼å¼ï¼Œ2018-04ä¹‹åä»¥YYYYMMDDHHMMSSæ ¼å¼',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚åºŸå¼ƒå­—æ®µ',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚åºŸå¼ƒå­—æ®µ',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·ä»æ³¨å†Œåˆ°Tæ—¥çš„ç´¯è®¡æ´»è·ƒæ€»æ¬¡æ•°ï¼Œæ³¨æ„æ˜¯ç´¯è®¡å€¼',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·ä»æ³¨å†Œåˆ°Tæ—¥çš„ç´¯è®¡æ´»è·ƒæ€»æ—¶é—´ï¼Œæ³¨æ„æ˜¯ç´¯è®¡å€¼ï¼Œå•ä½ä¸ºç§’ï¼›å­˜åœ¨è´Ÿæ•°ï¼Œä½¿ç”¨æ—¶éœ€è¦å‰”é™¤'\n);\nCREATE TABLE `dim_uf_player_gameinfo_mf` (\n  `kp_imp_date` TEXT COMMENT 'åˆ†åŒºå­—æ®µæ ¼å¼YYYYMM',\n  `id_type` TEXT COMMENT 'è´¦å·ç±»å‹ï¼šqq/wx',\n  `userid` TEXT COMMENT 'è´¦å·',\n  `gender` BIGINT COMMENT 'æ€§åˆ«ï¼ˆ1ç”·2å¥³ï¼‰',\n  `city` TEXT COMMENT 'åŸå¸‚',\n  `province` TEXT COMMENT 'çœä»½',\n  `city_level` TEXT COMMENT 'åŸå¸‚ç­‰çº§'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nç”¨æˆ·å›ºå®šç­›é€‰é€»è¾‘:\nand saccounttype = \"-100\" -- è´¦æˆ·ç±»å‹ä¸º-100\nand suseridtype in (\"qq\",\"wxid\") -- ç”¨æˆ·ç±»å‹ä¸ºqqæˆ–wxid\nand sgamecode in (\"esports\",\"mobile_live\",\"initiatived\",\"allianceforce\",\"strategy\",\"jordass\",\"su\",\"playzone\",\"battlezone\",\"battlearena\",\"weapon\",\"playhub\",\"manager\",\"apgame\") -- æ¸¸æˆä»£ç ä¸ºæŒ‡å®šçš„æ‰‹æ¸¸fps\nand splattype = \"-100\" -- å¹³å°ç±»å‹ä¸º-100\næ´»è·ƒæ—¥æœŸé€»è¾‘:\nåŸºäºå½“å‰ç»Ÿè®¡æ—¶é—´20250702å‘å‰è®¡ç®—6ä¸ªæœˆçš„ç™»é™†æ—¥æœŸï¼Œå³ilastactdate >= \"20250104\"\nåŸå¸‚ç­‰çº§åˆ†å¸ƒï¼š\nå½“å‰æ—¶é—´ä¸º20250702ï¼ŒåŸå¸‚ç­‰çº§åˆ†å¸ƒçš„ç›¸å…³è¡¨æ˜¯æœˆè¡¨ï¼Œæ‰€ä»¥éœ€è¦å–kp_imp_date = \"202506\"çš„æ•°æ®ä½œä¸ºå…³è”æ•°æ®\n\n",
  "chosen": "SELECT \n    b.city_level,\n    COUNT(DISTINCT a.suserid) as user_count\nFROM \n    dim_mgamejp_account_allinfo_nf a\nJOIN \n    dim_uf_player_gameinfo_mf b \n    ON a.suserid = b.userid \n    AND a.suseridtype = CASE WHEN b.id_type = 'qq' THEN 'qq' ELSE 'wxid' END\n    AND b.kp_imp_date = '202506'\nWHERE \n    a.dtstatdate = 20250702\n    AND a.saccounttype = '-100'\n    AND a.suseridtype IN ('qq', 'wxid')\n    AND a.sgamecode IN ('esports','mobile_live','initiatived','allianceforce','strategy','jordass','su','playzone','battlezone','battlearena','weapon','playhub','manager','apgame')\n    AND a.splattype = '-100'\n    AND a.ilastactdate >= 20250104\nGROUP BY \n    b.city_level\nORDER BY \n    b.city_level",
  "rejected": "### ç¬¬ä¸€æ­¥ï¼šæ˜ç¡®éœ€æ±‚å’Œå…³é”®æ¡ä»¶\n\næˆ‘ä»¬éœ€è¦ç»Ÿè®¡åœ¨**2025å¹´7æœˆ2æ—¥**è¿™ä¸€å¤©ï¼Œ**æ‰‹æ¸¸FPSç±»æ¸¸æˆ**ä¸­ï¼Œ**æœ€åæ´»è·ƒæ—¥æœŸåœ¨è¿‡å»åŠå¹´å†…**ï¼ˆå³ `ilastactdate >= 20250104`ï¼‰çš„ç”¨æˆ·ï¼Œå…¶**åŸå¸‚ç­‰çº§åˆ†å¸ƒæƒ…å†µ**ã€‚\n\n#### ç­›é€‰æ¡ä»¶åˆ†æï¼š\n\n1. **è´¦æˆ·ç±»å‹**ï¼š\n   - `saccounttype = '-100'` è¡¨ç¤ºæ±‡æ€»è´¦æˆ·ã€‚\n\n2. **ç”¨æˆ·ç±»å‹**ï¼š\n   - `suseridtype IN ('qq', 'wxid')` è¡¨ç¤ºç”¨æˆ·è´¦å·ç±»å‹ä¸ºQQæˆ–å¾®ä¿¡ã€‚\n\n3. **æ¸¸æˆä»£ç **ï¼š\n   - `sgamecode IN ('esports', ...)` æ˜¯æ‰‹æ¸¸FPSç±»æ¸¸æˆçš„ä»£ç é›†åˆï¼ˆé¢˜ç›®ä¸­æåˆ°â€œæ‰‹æ¸¸fpsâ€ï¼‰ï¼Œå…·ä½“åŒ…æ‹¬å¤šä¸ªæ¸¸æˆä»£ç ã€‚\n\n4. **å¹³å°ç±»å‹**ï¼š\n   - `splattype = '-100'` è¡¨ç¤ºå¹³å°ç±»å‹ä¸ºæ±‡æ€»ã€‚\n\n5. **æ´»è·ƒæ—¥æœŸèŒƒå›´**ï¼š\n   - å½“å‰ç»Ÿè®¡æ—¥æœŸä¸º `20250702`ï¼Œå‘å‰æ¨ç®—åŠå¹´å³ `ilastactdate >= 20250104`ã€‚\n\n6. **åŸå¸‚ç­‰çº§ä¿¡æ¯æ¥æº**ï¼š\n   - åŸå¸‚ç­‰çº§ä¿¡æ¯æ¥è‡ª `dim_uf_player_gameinfo_mf` è¡¨ï¼Œè¯¥è¡¨æ˜¯æŒ‰æœˆåˆ†åŒºçš„ï¼Œå› æ­¤éœ€é€‰æ‹© `kp_imp_date = '202506'` çš„æ•°æ®è¿›è¡Œå…³è”ã€‚\n\n---\n\n### ç¬¬äºŒæ­¥ï¼šç¡®å®šæ¶‰åŠçš„è¡¨ä¸å­—æ®µ\n\n#### ä¸»è¡¨ï¼š\n- `dim_mgamejp_account_allinfo_nf`\n\n#### å…³è”è¡¨ï¼š\n- `dim_uf_player_gameinfo_mf`\n\n#### å­—æ®µæå–ï¼š\n- ä¸»è¡¨ä¸­ï¼š\n  - `suserid`: ç”¨æˆ·IDï¼ˆç”¨äºå…³è”ï¼‰\n  - `ilastactdate`: æœ€åæ´»è·ƒæ—¥æœŸ\n  - `sgamecode`: æ¸¸æˆä»£ç \n  - `splattype`: å¹³å°ç±»å‹\n  - `saccounttype`: è´¦å·ç±»å‹\n  - `suseridtype`: ç”¨æˆ·ç±»å‹\n\n- å…³è”è¡¨ä¸­ï¼š\n  - `userid`: ç”¨æˆ·IDï¼ˆç”¨äºå…³è”ï¼‰\n  - `city_level`: åŸå¸‚ç­‰çº§\n  - `kp_imp_date`: åˆ†åŒºå­—æ®µï¼Œåº”ä¸º `'202506'`\n\n---\n\n### ç¬¬ä¸‰æ­¥ï¼šæ„å»º SQL æŸ¥è¯¢é€»è¾‘\n\n#### æ­¥éª¤ä¸€ï¼šè¿‡æ»¤ä¸»è¡¨æ•°æ®\n- æ ¹æ®ä¸Šè¿°æ¡ä»¶ç­›é€‰å‡ºç¬¦åˆæ¡ä»¶çš„è®°å½•ã€‚\n\n#### æ­¥éª¤äºŒï¼šè¿æ¥åŸå¸‚ç­‰çº§ä¿¡æ¯\n- ä½¿ç”¨ `suserid` å’Œ `userid` è¿æ¥ `dim_uf_player_gameinfo_mf` è¡¨ï¼Œå¹¶é™å®šåˆ†åŒºå­—æ®µä¸º `'202506'`ã€‚\n\n#### æ­¥éª¤ä¸‰ï¼šèšåˆç»Ÿè®¡\n- æŒ‰ç…§ `city_level` åˆ†ç»„ï¼Œç»Ÿè®¡æ¯ä¸ªåŸå¸‚çš„ç”¨æˆ·æ•°é‡ã€‚\n\n---\n\n### ç¬¬å››æ­¥ï¼šç¼–å†™æœ€ç»ˆ SQL æŸ¥è¯¢è¯­å¥\n\n```sql\nSELECT\n  T2.city_level,\n  COUNT(DISTINCT T1.suserid) AS user_count\nFROM dim_mgamejp_account_allinfo_nf AS T1\nJOIN dim_uf_player_gameinfo_mf AS T2\n  ON T1.suserid = T2.userid\nWHERE\n  T1.dtstatdate = 20250702\n  AND T1.saccounttype = '-100'\n  AND T1.suseridtype IN ('qq', 'wxid')\n  AND T1.sgamecode IN ('esports', 'mobile_live', 'initiatived', 'allianceforce', 'strategy', 'jordass', 'su', 'playzone', 'battlezone', 'battlearena', 'weapon', 'playhub', 'manager', 'apgame')\n  AND T1.splattype = '-100'\n  AND T1.ilastactdate >= 20250104\n  AND T2.kp_imp_date = '202506'\nGROUP BY\n  T2.city_level;\n```\n\n---\n\n### ç¬¬äº”æ­¥ï¼šè§£é‡ŠæŸ¥è¯¢ç»“æ„\n\n| å­å¥ | åŠŸèƒ½è¯´æ˜ |\n|------|----------|\n| `SELECT` | è¾“å‡ºåŸå¸‚ç­‰çº§å’Œå¯¹åº”ç”¨æˆ·æ•° |\n| `FROM` | ä¸»è¡¨ `dim_mgamejp_account_allinfo_nf` |\n| `JOIN` | å·¦è¿æ¥ `dim_uf_player_gameinfo_mf` è·å–åŸå¸‚ç­‰çº§ |\n| `ON` | é€šè¿‡ `suserid = userid` å…³è”ä¸»è¡¨ä¸å‰¯è¡¨ |\n| `WHERE` | å¤šé‡ç­›é€‰æ¡ä»¶ï¼šæ—¥æœŸã€è´¦æˆ·ç±»å‹ã€æ¸¸æˆç±»å‹ç­‰ |\n| `AND T2.kp_imp_date = '202506'` | æ˜ç¡®ä½¿ç”¨ 2025 å¹´ 6 æœˆçš„åˆ†åŒºæ•°æ® |\n| `GROUP BY` | æŒ‰åŸå¸‚ç­‰çº§åˆ†ç»„ |\n| `COUNT(DISTINCT T1.suserid)` | ç»Ÿè®¡æ¯ç»„çš„ç‹¬ç«‹ç”¨æˆ·æ•°é‡ |\n\n---\n\n### âœ… æœ€ç»ˆç»“æœè¯´æ˜\n\næ­¤ SQL æŸ¥è¯¢å°†è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼ŒåŒ…å«ï¼š\n- æ¯ä¸ªåŸå¸‚çš„ç­‰çº§ï¼ˆå¦‚ä¸€çº¿åŸå¸‚ã€äºŒçº¿åŸå¸‚ç­‰ï¼‰\n- å¯¹åº”è¯¥ç­‰çº§ä¸‹çš„æ´»è·ƒç”¨æˆ·æ•°é‡ï¼ˆå»é‡åï¼‰\n\né€‚ç”¨äºå¯¹ç‰¹å®šæ—¶é—´æ®µã€ç‰¹å®šæ¸¸æˆç±»å‹ã€ç‰¹å®šæ´»è·ƒåº¦ç”¨æˆ·çš„åœ°åŸŸåˆ†å¸ƒåšç²¾ç»†åŒ–åˆ†æã€‚"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡20250702æ‰‹æ¸¸fpsæœ€åæ´»è·ƒæ—¥æœŸä¸ºè¿‘åŠå¹´çš„ç”¨æˆ·çš„åŸå¸‚ç­‰çº§åˆ†å¸ƒã€‚\nè¾“å‡ºï¼šåŸå¸‚ç­‰çº§ï¼Œç”¨æˆ·äººæ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dim_mgamejp_account_allinfo_nf` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹ã€‚0-åˆ†æ¸¸æˆçš„playeridï¼ŒåŠæ±‡æ€»çš„qqï¼Œä¸”è¿™äº›qqéƒ½æ˜¯playeridå¯¹åº”çš„1-åˆ†æ¸¸æˆçš„playeridï¼ŒåŠæ±‡æ€»çš„wxidï¼Œä¸”è¿™äº›wxidéƒ½æ˜¯playeridå¯¹åº”çš„-100-æ±‡æ€»',\n  `suserid` TEXT COMMENT 'å¸å·ã€‚å½“å­˜å‚¨çš„æ˜¯playeridè´¦å·ç±»å‹æ—¶ï¼Œå¯¹äºæ–°æ¸¸å­˜å‚¨çš„æ˜¯gplayeridï¼Œå¯¹äºè€æ¸¸æˆå­˜å‚¨çš„æ˜¯playerid',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹ã€‚å–å€¼ä¸ºqq/wxid/playeridï¼Œæ²¡æœ‰-100',\n  `sgamecode` TEXT COMMENT 'æ¸¸æˆidã€‚å–å€¼ä¸º-100æ—¶è¡¨ç¤ºæ±‡æ€»ï¼Œå…¶å®ƒå–å€¼ä¸ºå„å•ä¸šåŠ¡çš„æ¸¸æˆidï¼Œä¾‹å¦‚å–å€¼ä¸ºstrategyæ—¶è¡¨ç¤ºè±ªæ°å¯¹å†³',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚å–å€¼ä¸º-100æ—¶è¡¨ç¤ºæ±‡æ€»ï¼Œå–å€¼ä¸ºAndroidæ—¶è¡¨ç¤ºå®‰å“å¹³å°ï¼Œå–å€¼ä¸ºiOSæ—¶è¡¨ç¤ºè‹¹æœå¹³å°',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `iregdate` BIGINT COMMENT 'æ³¨å†Œæ—¥æœŸYYYYMMDD',\n  `ilastactdate` BIGINT COMMENT 'æœ€åæ´»è·ƒæ—¥æœŸYYYYMMDD',\n  `sdayacti` TEXT COMMENT 'æœ€è¿‘65å¤©æ¯å¤©æ´»è·ƒæƒ…å†µã€‚ä»¥äºŒè¿›åˆ¶ä½å›¾å½¢å¼å­˜å‚¨ï¼Œæ¯ä¸€ä½è¡¨ç¤ºä¸€å¤©çš„æ´»è·ƒæƒ…å†µï¼Œ1è¡¨ç¤ºæ´»è·ƒï¼Œ0è¡¨ç¤ºæœªæ´»è·ƒã€‚æœ€å·¦çš„ä¸€ä½è¡¨ç¤ºTæ—¥ï¼Œä»¥æ­¤ç±»æ¨',\n  `sweekacti` TEXT COMMENT 'æœ€è¿‘60å‘¨æ´»è·ƒæƒ…å†µã€‚ç”¨æ³•åŒä¸Š',\n  `smonthacti` TEXT COMMENT 'æœ€è¿‘60æœˆæ´»è·ƒæƒ…å†µã€‚ç”¨æ³•åŒä¸Š',\n  `sgroup` TEXT COMMENT 'ç”¨æ¥æ ‡è¯†ç”¨æˆ·æ˜¯å¦ä»˜è´¹ç”¨æˆ·ï¼Œæ˜¯å¦åŒ…æœˆç”¨æˆ·ç­‰ç­‰å¤‡æ³¨ï¼šè¯¥å­—æ®µå®é™…ä¸Šè¡¨ç¤ºæ³¨å†Œçš„æ—¶é—´æˆ³ï¼Œ2018-04ä¹‹å‰ä»¥YYYYMMDDæ ¼å¼ï¼Œ2018-04ä¹‹åä»¥YYYYMMDDHHMMSSæ ¼å¼',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚åºŸå¼ƒå­—æ®µ',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚åºŸå¼ƒå­—æ®µ',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·ä»æ³¨å†Œåˆ°Tæ—¥çš„ç´¯è®¡æ´»è·ƒæ€»æ¬¡æ•°ï¼Œæ³¨æ„æ˜¯ç´¯è®¡å€¼',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·ä»æ³¨å†Œåˆ°Tæ—¥çš„ç´¯è®¡æ´»è·ƒæ€»æ—¶é—´ï¼Œæ³¨æ„æ˜¯ç´¯è®¡å€¼ï¼Œå•ä½ä¸ºç§’ï¼›å­˜åœ¨è´Ÿæ•°ï¼Œä½¿ç”¨æ—¶éœ€è¦å‰”é™¤'\n);\nCREATE TABLE `dim_uf_player_gameinfo_mf` (\n  `kp_imp_date` TEXT COMMENT 'åˆ†åŒºå­—æ®µæ ¼å¼YYYYMM',\n  `id_type` TEXT COMMENT 'è´¦å·ç±»å‹ï¼šqq/wx',\n  `userid` TEXT COMMENT 'è´¦å·',\n  `gender` BIGINT COMMENT 'æ€§åˆ«ï¼ˆ1ç”·2å¥³ï¼‰',\n  `city` TEXT COMMENT 'åŸå¸‚',\n  `province` TEXT COMMENT 'çœä»½',\n  `city_level` TEXT COMMENT 'åŸå¸‚ç­‰çº§'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nç”¨æˆ·å›ºå®šç­›é€‰é€»è¾‘:\nand saccounttype = \"-100\" -- è´¦æˆ·ç±»å‹ä¸º-100\nand suseridtype in (\"qq\",\"wxid\") -- ç”¨æˆ·ç±»å‹ä¸ºqqæˆ–wxid\nand sgamecode in (\"esports\",\"mobile_live\",\"initiatived\",\"allianceforce\",\"strategy\",\"jordass\",\"su\",\"playzone\",\"battlezone\",\"battlearena\",\"weapon\",\"playhub\",\"manager\",\"apgame\") -- æ¸¸æˆä»£ç ä¸ºæŒ‡å®šçš„æ‰‹æ¸¸fps\nand splattype = \"-100\" -- å¹³å°ç±»å‹ä¸º-100\næ´»è·ƒæ—¥æœŸé€»è¾‘:\nåŸºäºå½“å‰ç»Ÿè®¡æ—¶é—´20250702å‘å‰è®¡ç®—6ä¸ªæœˆçš„ç™»é™†æ—¥æœŸï¼Œå³ilastactdate >= \"20250104\"\nåŸå¸‚ç­‰çº§åˆ†å¸ƒï¼š\nå½“å‰æ—¶é—´ä¸º20250702ï¼ŒåŸå¸‚ç­‰çº§åˆ†å¸ƒçš„ç›¸å…³è¡¨æ˜¯æœˆè¡¨ï¼Œæ‰€ä»¥éœ€è¦å–kp_imp_date = \"202506\"çš„æ•°æ®ä½œä¸ºå…³è”æ•°æ®\n\n",
  "chosen": "SELECT \n    b.city_level,\n    COUNT(DISTINCT a.suserid) as user_count\nFROM \n    dim_mgamejp_account_allinfo_nf a\nJOIN \n    dim_uf_player_gameinfo_mf b \n    ON a.suserid = b.userid \n    AND a.suseridtype = CASE WHEN b.id_type = 'qq' THEN 'qq' ELSE 'wxid' END\n    AND b.kp_imp_date = '202506'\nWHERE \n    a.dtstatdate = 20250702\n    AND a.saccounttype = '-100'\n    AND a.suseridtype IN ('qq', 'wxid')\n    AND a.sgamecode IN ('esports','mobile_live','initiatived','allianceforce','strategy','jordass','su','playzone','battlezone','battlearena','weapon','playhub','manager','apgame')\n    AND a.splattype = '-100'\n    AND a.ilastactdate >= 20250104\nGROUP BY \n    b.city_level\nORDER BY \n    b.city_level",
  "rejected": "### ç¬¬ä¸€æ­¥ï¼šæ˜ç¡®éœ€æ±‚ä¸ç›®æ ‡\n\næˆ‘ä»¬è¦ç»Ÿè®¡çš„æ˜¯åœ¨ **2025å¹´7æœˆ2æ—¥** è¿™ä¸€å¤©ï¼Œæ‰€æœ‰æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„ç”¨æˆ·ï¼š\n\n- å±äºâ€œæ‰‹æ¸¸FPSâ€ç±»åˆ«ï¼ˆå³ `sgamecode` æ˜¯æŒ‡å®šçš„æŸäº›å€¼ï¼‰\n- æœ€åæ´»è·ƒæ—¥æœŸåœ¨è¿‡å»åŠå¹´å†…ï¼ˆå³ `ilastactdate >= 20250104`ï¼‰\n- è´¦å·ç±»å‹ä¸º `qq` æˆ– `wxid`\n- è´¦å·ç±»å‹ä¸º `-100`\n\nå¹¶ä¸”æˆ‘ä»¬éœ€è¦å°†è¿™äº›ç”¨æˆ·çš„ **åŸå¸‚ç­‰çº§åˆ†å¸ƒ** ç»Ÿè®¡å‡ºæ¥ï¼Œè¾“å‡ºå¦‚ä¸‹ç»“æ„ï¼š\n\n| åŸå¸‚ç­‰çº§ | ç”¨æˆ·äººæ•° |\n|----------|----------|\n\n---\n\n### ç¬¬äºŒæ­¥ï¼šç¡®å®šæ¶‰åŠçš„è¡¨å’Œå­—æ®µ\n\n#### è¡¨ä¸€ï¼š`dim_mgamejp_account_allinfo_nf`\n\nè¿™æ˜¯ä¸»è¡¨ï¼Œç”¨äºç­›é€‰ç¬¦åˆæ¸¸æˆã€æ´»è·ƒæ—¶é—´ç­‰æ¡ä»¶çš„ç”¨æˆ·ã€‚\n\nå…³é”®å­—æ®µåŒ…æ‹¬ï¼š\n\n| å­—æ®µå         | å«ä¹‰                     |\n|----------------|--------------------------|\n| `dtstatdate`   | å½“å‰ç»Ÿè®¡æ—¥æœŸ             |\n| `saccounttype` | è´¦å·ç±»å‹                 |\n| `suserid`      | ç”¨æˆ·ID                   |\n| `suseridtype`  | ç”¨æˆ·è´¦å·ç±»å‹ï¼ˆqq/wxidï¼‰  |\n| `sgamecode`    | æ¸¸æˆç¼–ç                  |\n| `splattype`    | å¹³å°ç±»å‹                 |\n| `ilastactdate` | æœ€åæ´»è·ƒæ—¥æœŸ             |\n\n#### è¡¨äºŒï¼š`dim_uf_player_gameinfo_mf`\n\nè¿™æ˜¯ç”¨æˆ·åŸå¸‚ç­‰çº§ä¿¡æ¯è¡¨ï¼Œç”¨äºè·å–æ¯ä¸ªç”¨æˆ·çš„ `city_level`ã€‚\n\nå…³é”®å­—æ®µåŒ…æ‹¬ï¼š\n\n| å­—æ®µå        | å«ä¹‰              |\n|---------------|-------------------|\n| `kp_imp_date` | åˆ†åŒºå­—æ®µï¼ˆYYYYMMï¼‰ |\n| `userid`      | ç”¨æˆ·ID            |\n| `city_level`  | åŸå¸‚ç­‰çº§          |\n\n---\n\n### ç¬¬ä¸‰æ­¥ï¼šæ„å»º SQL æŸ¥è¯¢é€»è¾‘\n\n#### æ­¥éª¤ä¸€ï¼šè¿‡æ»¤ä¸»è¡¨ä¸­ç¬¦åˆæ¡ä»¶çš„ç”¨æˆ·\n\næˆ‘ä»¬ä» `dim_mgamejp_account_allinfo_nf` ä¸­ç­›é€‰å‡ºï¼š\n\n- `dtstatdate = 20250702`\n- `saccounttype = '-100'`\n- `suseridtype IN ('qq', 'wxid')`\n- `sgamecode IN (...)` ï¼ˆåˆ—å‡ºæ‰€æœ‰æ‰‹æ¸¸FPSæ¸¸æˆä»£ç ï¼‰\n- `splattype = '-100'`\n- `ilastactdate >= 20250104`\n\n#### æ­¥éª¤äºŒï¼šè¿æ¥åŸå¸‚ç­‰çº§è¡¨\n\nä¸ºäº†è·å–ç”¨æˆ·çš„ `city_level`ï¼Œæˆ‘ä»¬å°†ä¸Šè¿°ç»“æœä¸ `dim_uf_player_gameinfo_mf` è¡¨è¿›è¡Œè¿æ¥ï¼š\n\n- ä½¿ç”¨ `suserid = userid`\n- å¹¶ä¸” `kp_imp_date = '202506'`ï¼ˆå› ä¸ºå½“å‰æ—¶é—´ä¸º 20250702ï¼Œå–ä¸Šä¸€ä¸ªæœˆï¼‰\n\n#### æ­¥éª¤ä¸‰ï¼šç»Ÿè®¡åŸå¸‚ç­‰çº§åˆ†å¸ƒ\n\nå¯¹æœ€ç»ˆç»“æœæŒ‰ `city_level` åˆ†ç»„ï¼Œå¹¶ç»Ÿè®¡æ¯ç»„çš„äººæ•°ã€‚\n\n---\n\n### ç¬¬å››æ­¥ï¼šç¼–å†™å®Œæ•´ SQL æŸ¥è¯¢è¯­å¥\n\n```sql\nSELECT\n  T2.city_level,\n  COUNT(DISTINCT T1.suserid) AS user_count\nFROM (\n  SELECT\n    suserid,\n    ilastactdate\n  FROM dim_mgamejp_account_allinfo_nf\n  WHERE dtstatdate = 20250702\n    AND saccounttype = '-100'\n    AND suseridtype IN ('qq', 'wxid')\n    AND sgamecode IN ('esports', 'mobile_live', 'initiatived', 'allianceforce', 'strategy', 'jordass', 'su', 'playzone', 'battlezone', 'battlearena', 'weapon', 'playhub', 'manager', 'apgame')\n    AND splattype = '-100'\n    AND ilastactdate >= 20250104\n) AS T1\nJOIN (\n  SELECT\n    userid,\n    city_level\n  FROM dim_uf_player_gameinfo_mf\n  WHERE kp_imp_date = '202506'\n) AS T2\nON T1.suserid = T2.userid\nGROUP BY\n  T2.city_level;\n```\n\n---\n\n### ç¬¬äº”æ­¥ï¼šè¯´æ˜ SQL æ‰§è¡Œæµç¨‹\n\n1. **å­æŸ¥è¯¢ T1**ï¼š\n   - ç­›é€‰ä¸»è¡¨ä¸­æ»¡è¶³æ‰€æœ‰æ¡ä»¶çš„ç”¨æˆ·ï¼ˆåŒ…æ‹¬æ¸¸æˆç±»å‹ã€æ´»è·ƒæ—¶é—´ã€å¹³å°ç­‰ï¼‰ï¼Œå¹¶ä¿ç•™ `suserid` å’Œ `ilastactdate`ã€‚\n\n2. **å­æŸ¥è¯¢ T2**ï¼š\n   - è·å–åŸå¸‚ç­‰çº§è¡¨ä¸­ `kp_imp_date = '202506'` çš„è®°å½•ï¼Œæå– `userid` å’Œ `city_level`ã€‚\n\n3. **ä¸»æŸ¥è¯¢ JOIN**ï¼š\n   - å°†ä¸¤ä¸ªå­æŸ¥è¯¢é€šè¿‡ `suserid = userid` å…³è”èµ·æ¥ï¼Œè·å–åŒæ—¶æ»¡è¶³æ´»è·ƒå’ŒåŸå¸‚ç­‰çº§æ¡ä»¶çš„ç”¨æˆ·ã€‚\n\n4. **GROUP BY + COUNT**ï¼š\n   - æŒ‰ç…§ `city_level` åˆ†ç»„ï¼Œç»Ÿè®¡æ¯ç»„ç”¨æˆ·æ•°é‡ã€‚\n\n---\n\n### æœ€ç»ˆè¾“å‡ºæ ¼å¼\n\n| city_level | user_count |\n|------------|------------|\n| ä¸€çº¿åŸå¸‚     | 1000       |\n| äºŒçº¿åŸå¸‚     | 2000       |\n| ä¸‰çº¿åŸå¸‚     | 3000       |\n| å››çº¿åŸå¸‚     | 4000       |\n| å…¶ä»–       | 5000       |\n\n> âœ… æ³¨æ„ï¼šå¦‚æœæŸç±»åŸå¸‚ç­‰çº§æ²¡æœ‰ç”¨æˆ·ï¼Œåˆ™ä¸ä¼šå‡ºç°åœ¨ç»“æœä¸­ã€‚å¦‚éœ€æ˜¾ç¤ºä¸º 0ï¼Œè¯·ä½¿ç”¨ LEFT JOIN å¹¶åŠ  IFNULL å¤„ç†ã€‚"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡20250702æ‰‹æ¸¸fpsæœ€åæ´»è·ƒæ—¥æœŸä¸ºè¿‘åŠå¹´çš„ç”¨æˆ·çš„åŸå¸‚ç­‰çº§åˆ†å¸ƒã€‚\nè¾“å‡ºï¼šåŸå¸‚ç­‰çº§ï¼Œç”¨æˆ·äººæ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dim_mgamejp_account_allinfo_nf` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹ã€‚0-åˆ†æ¸¸æˆçš„playeridï¼ŒåŠæ±‡æ€»çš„qqï¼Œä¸”è¿™äº›qqéƒ½æ˜¯playeridå¯¹åº”çš„1-åˆ†æ¸¸æˆçš„playeridï¼ŒåŠæ±‡æ€»çš„wxidï¼Œä¸”è¿™äº›wxidéƒ½æ˜¯playeridå¯¹åº”çš„-100-æ±‡æ€»',\n  `suserid` TEXT COMMENT 'å¸å·ã€‚å½“å­˜å‚¨çš„æ˜¯playeridè´¦å·ç±»å‹æ—¶ï¼Œå¯¹äºæ–°æ¸¸å­˜å‚¨çš„æ˜¯gplayeridï¼Œå¯¹äºè€æ¸¸æˆå­˜å‚¨çš„æ˜¯playerid',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹ã€‚å–å€¼ä¸ºqq/wxid/playeridï¼Œæ²¡æœ‰-100',\n  `sgamecode` TEXT COMMENT 'æ¸¸æˆidã€‚å–å€¼ä¸º-100æ—¶è¡¨ç¤ºæ±‡æ€»ï¼Œå…¶å®ƒå–å€¼ä¸ºå„å•ä¸šåŠ¡çš„æ¸¸æˆidï¼Œä¾‹å¦‚å–å€¼ä¸ºstrategyæ—¶è¡¨ç¤ºè±ªæ°å¯¹å†³',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚å–å€¼ä¸º-100æ—¶è¡¨ç¤ºæ±‡æ€»ï¼Œå–å€¼ä¸ºAndroidæ—¶è¡¨ç¤ºå®‰å“å¹³å°ï¼Œå–å€¼ä¸ºiOSæ—¶è¡¨ç¤ºè‹¹æœå¹³å°',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `iregdate` BIGINT COMMENT 'æ³¨å†Œæ—¥æœŸYYYYMMDD',\n  `ilastactdate` BIGINT COMMENT 'æœ€åæ´»è·ƒæ—¥æœŸYYYYMMDD',\n  `sdayacti` TEXT COMMENT 'æœ€è¿‘65å¤©æ¯å¤©æ´»è·ƒæƒ…å†µã€‚ä»¥äºŒè¿›åˆ¶ä½å›¾å½¢å¼å­˜å‚¨ï¼Œæ¯ä¸€ä½è¡¨ç¤ºä¸€å¤©çš„æ´»è·ƒæƒ…å†µï¼Œ1è¡¨ç¤ºæ´»è·ƒï¼Œ0è¡¨ç¤ºæœªæ´»è·ƒã€‚æœ€å·¦çš„ä¸€ä½è¡¨ç¤ºTæ—¥ï¼Œä»¥æ­¤ç±»æ¨',\n  `sweekacti` TEXT COMMENT 'æœ€è¿‘60å‘¨æ´»è·ƒæƒ…å†µã€‚ç”¨æ³•åŒä¸Š',\n  `smonthacti` TEXT COMMENT 'æœ€è¿‘60æœˆæ´»è·ƒæƒ…å†µã€‚ç”¨æ³•åŒä¸Š',\n  `sgroup` TEXT COMMENT 'ç”¨æ¥æ ‡è¯†ç”¨æˆ·æ˜¯å¦ä»˜è´¹ç”¨æˆ·ï¼Œæ˜¯å¦åŒ…æœˆç”¨æˆ·ç­‰ç­‰å¤‡æ³¨ï¼šè¯¥å­—æ®µå®é™…ä¸Šè¡¨ç¤ºæ³¨å†Œçš„æ—¶é—´æˆ³ï¼Œ2018-04ä¹‹å‰ä»¥YYYYMMDDæ ¼å¼ï¼Œ2018-04ä¹‹åä»¥YYYYMMDDHHMMSSæ ¼å¼',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚åºŸå¼ƒå­—æ®µ',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚åºŸå¼ƒå­—æ®µ',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·ä»æ³¨å†Œåˆ°Tæ—¥çš„ç´¯è®¡æ´»è·ƒæ€»æ¬¡æ•°ï¼Œæ³¨æ„æ˜¯ç´¯è®¡å€¼',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·ä»æ³¨å†Œåˆ°Tæ—¥çš„ç´¯è®¡æ´»è·ƒæ€»æ—¶é—´ï¼Œæ³¨æ„æ˜¯ç´¯è®¡å€¼ï¼Œå•ä½ä¸ºç§’ï¼›å­˜åœ¨è´Ÿæ•°ï¼Œä½¿ç”¨æ—¶éœ€è¦å‰”é™¤'\n);\nCREATE TABLE `dim_uf_player_gameinfo_mf` (\n  `kp_imp_date` TEXT COMMENT 'åˆ†åŒºå­—æ®µæ ¼å¼YYYYMM',\n  `id_type` TEXT COMMENT 'è´¦å·ç±»å‹ï¼šqq/wx',\n  `userid` TEXT COMMENT 'è´¦å·',\n  `gender` BIGINT COMMENT 'æ€§åˆ«ï¼ˆ1ç”·2å¥³ï¼‰',\n  `city` TEXT COMMENT 'åŸå¸‚',\n  `province` TEXT COMMENT 'çœä»½',\n  `city_level` TEXT COMMENT 'åŸå¸‚ç­‰çº§'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nç”¨æˆ·å›ºå®šç­›é€‰é€»è¾‘:\nand saccounttype = \"-100\" -- è´¦æˆ·ç±»å‹ä¸º-100\nand suseridtype in (\"qq\",\"wxid\") -- ç”¨æˆ·ç±»å‹ä¸ºqqæˆ–wxid\nand sgamecode in (\"esports\",\"mobile_live\",\"initiatived\",\"allianceforce\",\"strategy\",\"jordass\",\"su\",\"playzone\",\"battlezone\",\"battlearena\",\"weapon\",\"playhub\",\"manager\",\"apgame\") -- æ¸¸æˆä»£ç ä¸ºæŒ‡å®šçš„æ‰‹æ¸¸fps\nand splattype = \"-100\" -- å¹³å°ç±»å‹ä¸º-100\næ´»è·ƒæ—¥æœŸé€»è¾‘:\nåŸºäºå½“å‰ç»Ÿè®¡æ—¶é—´20250702å‘å‰è®¡ç®—6ä¸ªæœˆçš„ç™»é™†æ—¥æœŸï¼Œå³ilastactdate >= \"20250104\"\nåŸå¸‚ç­‰çº§åˆ†å¸ƒï¼š\nå½“å‰æ—¶é—´ä¸º20250702ï¼ŒåŸå¸‚ç­‰çº§åˆ†å¸ƒçš„ç›¸å…³è¡¨æ˜¯æœˆè¡¨ï¼Œæ‰€ä»¥éœ€è¦å–kp_imp_date = \"202506\"çš„æ•°æ®ä½œä¸ºå…³è”æ•°æ®\n\n",
  "chosen": "SELECT \n    b.city_level,\n    COUNT(DISTINCT a.suserid) as user_count\nFROM \n    dim_mgamejp_account_allinfo_nf a\nJOIN \n    dim_uf_player_gameinfo_mf b \n    ON a.suserid = b.userid \n    AND a.suseridtype = CASE WHEN b.id_type = 'qq' THEN 'qq' ELSE 'wxid' END\n    AND b.kp_imp_date = '202506'\nWHERE \n    a.dtstatdate = 20250702\n    AND a.saccounttype = '-100'\n    AND a.suseridtype IN ('qq', 'wxid')\n    AND a.sgamecode IN ('esports','mobile_live','initiatived','allianceforce','strategy','jordass','su','playzone','battlezone','battlearena','weapon','playhub','manager','apgame')\n    AND a.splattype = '-100'\n    AND a.ilastactdate >= 20250104\nGROUP BY \n    b.city_level\nORDER BY \n    b.city_level",
  "rejected": "### ç¬¬ä¸€æ­¥ï¼šç†è§£éœ€æ±‚\n\næˆ‘ä»¬è¦ç»Ÿè®¡åœ¨ **2025å¹´7æœˆ2æ—¥** è¿™ä¸ªæ—¶é—´ç‚¹ï¼Œç¬¦åˆä»¥ä¸‹æ¡ä»¶çš„ç”¨æˆ·ï¼š\n\n- æ‰€å±æ¸¸æˆæ˜¯ **æ‰‹æ¸¸FPSç±»æ¸¸æˆ**ï¼ˆå³ `sgamecode` å±äºç‰¹å®šåˆ—è¡¨ï¼‰\n- æœ€åæ´»è·ƒæ—¶é—´åœ¨ **è¿‘åŠå¹´å†…**ï¼ˆä¹Ÿå°±æ˜¯ `ilastactdate >= 20250104`ï¼‰\n- è´¦å·ç±»å‹ä¸º `qq` æˆ– `wxid`\n- å¹³å°ç±»å‹ä¸º `-100`\n\nç„¶åæ ¹æ®è¿™äº›ç”¨æˆ·çš„ **åŸå¸‚ç­‰çº§** åˆ†ç»„ï¼Œå¹¶ç»Ÿè®¡æ¯ç»„çš„äººæ•°ã€‚\n\n---\n\n### ç¬¬äºŒæ­¥ï¼šåˆ†æè¡¨ç»“æ„å’Œå­—æ®µå«ä¹‰\n\n#### è¡¨ä¸€ï¼š`dim_mgamejp_account_allinfo_nf`\n\nè¿™ä¸ªè¡¨åŒ…å«ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ã€æ´»è·ƒæƒ…å†µç­‰ï¼š\n\n| å­—æ®µå | å«ä¹‰ |\n|--------|------|\n| `dtstatdate` | ç»Ÿè®¡æ—¥æœŸï¼ˆYYYYMMDDï¼‰ |\n| `saccounttype` | å¸å·ç±»å‹ï¼Œå…¶ä¸­ `-100` è¡¨ç¤ºæ±‡æ€» |\n| `suserid` | å¸å· |\n| `suseridtype` | å¸å·ç±»å‹ï¼Œå¦‚ `qq`, `wxid` |\n| `sgamecode` | æ¸¸æˆ ID |\n| `splattype` | å¹³å°ç±»å‹ |\n| `ilastactdate` | æœ€åæ´»è·ƒæ—¥æœŸï¼ˆYYYYMMDDï¼‰ |\n\n#### è¡¨äºŒï¼š`dim_uf_player_gameinfo_mf`\n\nè¿™æ˜¯ç”¨æˆ·çš„åŸå¸‚ç­‰çº§ä¿¡æ¯è¡¨ï¼ŒæŒ‰æœˆåˆ†åŒºï¼š\n\n| å­—æ®µå | å«ä¹‰ |\n|--------|------|\n| `kp_imp_date` | åˆ†åŒºå­—æ®µï¼Œæ ¼å¼ä¸º YYYYMMï¼Œæˆ‘ä»¬éœ€ä½¿ç”¨ `\"202506\"` |\n| `userid` | ç”¨æˆ· ID |\n| `city_level` | åŸå¸‚ç­‰çº§ |\n\n---\n\n### ç¬¬ä¸‰æ­¥ï¼šç¡®å®šç­›é€‰æ¡ä»¶\n\næˆ‘ä»¬éœ€è¦ç­›é€‰å‡ºæ»¡è¶³å¦‚ä¸‹æ¡ä»¶çš„ç”¨æˆ·ï¼š\n\n1. `dtstatdate = 20250702`\n2. `saccounttype = '-100'`\n3. `suseridtype IN ('qq', 'wxid')`\n4. `sgamecode IN (...)` ï¼ˆæŒ‡å®šçš„æ‰‹æ¸¸FPSæ¸¸æˆï¼‰\n5. `splattype = '-100'`\n6. `ilastactdate >= 20250104`\n\nå†é€šè¿‡ `suserid` å’Œ `dim_uf_player_gameinfo_mf` çš„ `userid` å…³è”ï¼Œè·å–å…¶ `city_level`ï¼Œå¹¶æŒ‰ `city_level` ç»Ÿè®¡äººæ•°ã€‚\n\n---\n\n### ç¬¬å››æ­¥ï¼šç¼–å†™ SQL æŸ¥è¯¢è¯­å¥\n\n```sql\nSELECT\n    t2.city_level,\n    COUNT(DISTINCT t1.suserid) AS user_count\nFROM dim_mgamejp_account_allinfo_nf AS t1\nJOIN dim_uf_player_gameinfo_mf AS t2\n    ON t1.suserid = t2.userid\nWHERE\n    t1.dtstatdate = 20250702\n    AND t1.saccounttype = '-100'\n    AND t1.suseridtype IN ('qq', 'wxid')\n    AND t1.sgamecode IN ('esports', 'mobile_live', 'initiatived', 'allianceforce', 'strategy', 'jordass', 'su', 'playzone', 'battlezone', 'battlearena', 'weapon', 'playhub', 'manager', 'apgame')\n    AND t1.splattype = '-100'\n    AND t1.ilastactdate >= 20250104\n    AND t2.kp_imp_date = '202506'\nGROUP BY\n    t2.city_level;\n```\n\n---\n\n### ç¬¬äº”æ­¥ï¼šè§£é‡Š SQL ç»“æ„\n\n- **ä¸»è¡¨é€‰æ‹©**ï¼šä» `dim_mgamejp_account_allinfo_nf` ä¸­é€‰å–ç¬¦åˆæ¡ä»¶çš„ç”¨æˆ·è®°å½•ã€‚\n- **è¿æ¥å­è¡¨**ï¼šä¸ `dim_uf_player_gameinfo_mf` æŒ‰ç…§ `suserid = userid` è¿›è¡Œ JOINã€‚\n- **è¿‡æ»¤æ¡ä»¶**ï¼š\n  - æ—¶é—´èŒƒå›´é™å®šä¸º `dtstatdate = 20250702`\n  - æ¸¸æˆç±»å‹é™å®šä¸ºæŒ‡å®šçš„ FPS ç±»å‹\n  - æœ€åæ´»è·ƒæ—¶é—´å¤§äºç­‰äº `20250104`\n  - ä½¿ç”¨äº†æ­£ç¡®çš„åˆ†åŒºå­—æ®µ `kp_imp_date = '202506'`\n- **èšåˆç»Ÿè®¡**ï¼šæŒ‰ç…§ `city_level` åˆ†ç»„ï¼Œç»Ÿè®¡ä¸åŒåŸå¸‚çš„ç”¨æˆ·æ•°é‡ã€‚\n\n---\n\n### âœ… æœ€ç»ˆç»“æœè¾“å‡ºæ ¼å¼\n\n| city_level | user_count |\n|------------|------------|\n| ä¸€çº¿åŸå¸‚   | 1000       |\n| äºŒçº¿åŸå¸‚   | 2000       |\n| ä¸‰çº¿åŸå¸‚   | 3000       |\n| ...        | ...        |\n\n--- \n\nå¦‚æœ‰æ›´å¤šå…·ä½“éœ€æ±‚æˆ–æ‰©å±•åœºæ™¯ï¼Œå¯ç»§ç»­ä¼˜åŒ–æ­¤æŸ¥è¯¢ã€‚"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡è¿‘30å¤©æ´»è·ƒç©å®¶æ•°ï¼Œè¿‘30å¤©æ´»è·ƒä¸”åŒæ—¶æ‹¥æœ‰å¥–æ± æ‰€æœ‰é“å…·ç©å®¶æ•°\nè¾“å‡ºï¼šè¿‘30å¤©æ´»è·ƒç©å®¶æ•°ã€è¿‘30å¤©æ´»è·ƒä¸”åŒæ—¶æ‹¥æœ‰å¥–æ± æ‰€æœ‰é“å…·ç©å®¶æ•°\nè¡¥å……è¯´æ˜ï¼š\nå½“å‰æ—¥æœŸæ—¶é—´ï¼š'20250617'\nå…¶ä¸­å¥–æ± é“å…·idä¸ºï¼š\n71d260ca-4bad-81f2-0298-44860341a7a6\n48601754-442d-98cb-2109-3fb2075500ec\na9126263-439c-7be6-d668-52a6c0c0a36f\n34ecc788-4034-71d2-a0ac-c398b8ecb2ae\n56f98991-43f8-dcc8-189e-08b7ae6c42ad\n8453f8ef-4c0b-46e2-8768-3e9e45c67a2c\n06d90274-435f-3e32-9d57-26bc228ae2e5\n8196dea4-4229-c951-13a9-088fb13b3512\n3abc330f-444a-6dfd-5863-81856ba62624\n041a43a4-46fe-dab7-c974-36bf91eab33d\n5b863cb9-4e41-ec89-69ee-49a223d05ff1\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dwd_argothek_gearrecord_df` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'appid',\n  `iareaid` TEXT COMMENT 'å¤§åŒºID',\n  `iuserid` TEXT COMMENT 'iuserid',\n  `vRoleID` TEXT COMMENT 'vRoleID',\n  `iGoodsType` TEXT COMMENT 'é“å…·ç±»å‹',\n  `iGoodsId` TEXT COMMENT 'é“å…·ID',\n  `iCount` BIGINT COMMENT 'é“å…·æ•°é‡',\n  `iCount1` BIGINT COMMENT 'é“å…·æ•°é‡ä¸”è®¢å•idä¸ä¸ºç©º',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\nCREATE TABLE `dws_argothek_oss_useractivity_df` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `iworldid` BIGINT COMMENT 'å¤§åŒºID',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `igroup` BIGINT COMMENT 'æ˜¯å¦ä»˜è´¹',\n  `iactivity` TEXT COMMENT 'ç©å®¶ç™»é™†ä½å›¾,é¦–ä½ä¸º0,æœ€é•¿100ä½,1è¡¨ç¤ºå½“å¤©æ´»è·ƒ,0è¡¨ç¤ºå½“å¤©æœªæ´»è·ƒ',\n  `iregdate` BIGINT COMMENT 'æ³¨å†Œæ—¥æœŸ,è¿™é‡Œçš„æ³¨å†Œæ—¥æœŸæ˜¯é¦–æ¬¡æ´»è·ƒæ—¥æœŸ,å¦‚æœæ³¨å†Œæ•°æ®æœ‰å•ç‹¬æ—¥å¿—è¡¨,åˆ™å¿½ç•¥æ­¤å­—æ®µ',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `iregway` BIGINT COMMENT 'æ³¨å†Œæ¸ é“',\n  `vlastlogindate` TEXT COMMENT 'æœ€åç™»å½•æ—¥æœŸ'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nè¿™å¼ è¡¨çš„iworldid = 255ä»£è¡¨ç©å®¶ç²’åº¦ï¼Œ å¥–æ± é“å…·ç­›é€‰é€»è¾‘ï¼š\niGoodsId in (\n\"71d260ca-4bad-81f2-0298-44860341a7a6\",\n\"48601754-442d-98cb-2109-3fb2075500ec\",\n\"a9126263-439c-7be6-d668-52a6c0c0a36f\",\n\"34ecc788-4034-71d2-a0ac-c398b8ecb2ae\",\n\"56f98991-43f8-dcc8-189e-08b7ae6c42ad\",\n\"8453f8ef-4c0b-46e2-8768-3e9e45c67a2c\",\n\"06d90274-435f-3e32-9d57-26bc228ae2e5\",\n\"8196dea4-4229-c951-13a9-088fb13b3512\",\n\"3abc330f-444a-6dfd-5863-81856ba62624\",\n\"041a43a4-46fe-dab7-c974-36bf91eab33d\",\n\"5b863cb9-4e41-ec89-69ee-49a223d05ff1\"\n\n",
  "chosen": "WITH active_players AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_useractivity_df\n    WHERE statis_date = 20250617\n    AND iworldid = 255\n    AND RIGHT(iactivity, 30) REGEXP '1'\n),\nplayers_with_all_items AS (\n    SELECT iuserid\n    FROM dwd_argothek_gearrecord_df\n    WHERE dtstatdate = 20250617\n    AND iGoodsId IN (\n        '71d260ca-4bad-81f2-0298-44860341a7a6',\n        '48601754-442d-98cb-2109-3fb2075500ec',\n        'a9126263-439c-7be6-d668-52a6c0c0a36f',\n        '34ecc788-4034-71d2-a0ac-c398b8ecb2ae',\n        '56f98991-43f8-dcc8-189e-08b7ae6c42ad',\n        '8453f8ef-4c0b-46e2-8768-3e9e45c67a2c',\n        '06d90274-435f-3e32-9d57-26bc228ae2e5',\n        '8196dea4-4229-c951-13a9-088fb13b3512',\n        '3abc330f-444a-6dfd-5863-81856ba62624',\n        '041a43a4-46fe-dab7-c974-36bf91eab33d',\n        '5b863cb9-4e41-ec89-69ee-49a223d05ff1'\n    )\n    GROUP BY iuserid\n    HAVING COUNT(DISTINCT iGoodsId) = 11\n)\nSELECT \n    (SELECT COUNT(*) FROM active_players) AS active_players_30_days,\n    (SELECT COUNT(*) FROM active_players ap INNER JOIN players_with_all_items pwai ON ap.iuserid = pwai.iuserid) AS active_players_with_all_items",
  "rejected": "æˆ‘éœ€è¦åˆ†æ­¥æ€è€ƒæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š\n\n1. é¦–å…ˆæ˜ç¡®éœ€æ±‚ï¼š\n   - ç»Ÿè®¡è¿‘30å¤©æ´»è·ƒç©å®¶æ•°ï¼ˆæ´»è·ƒå®šä¹‰ï¼šåœ¨æœ€è¿‘30å¤©å†…è‡³å°‘æœ‰ä¸€å¤©ç™»å½•ï¼‰\n   - ç»Ÿè®¡è¿‘30å¤©æ´»è·ƒä¸”åŒæ—¶æ‹¥æœ‰å¥–æ± æ‰€æœ‰é“å…·çš„ç©å®¶æ•°\n   - å¥–æ± é“å…·IDå·²ç»™å‡ºï¼Œå…±11ä¸ª\n\n2. ç¡®å®šä½¿ç”¨å“ªäº›è¡¨ï¼š\n   - dws_argothek_oss_useractivity_dfï¼šåŒ…å«ç©å®¶æ´»è·ƒçŠ¶æ€å’Œç™»å½•ä¿¡æ¯\n   - dwd_argothek_gearrecord_dfï¼šåŒ…å«ç©å®¶é“å…·ä¿¡æ¯\n\n3. è®¡ç®—é€»è¾‘åˆ†æï¼š\n   - å¯¹äºæ´»è·ƒç©å®¶ï¼šä»dws_argothek_oss_useractivity_dfä¸­ç­›é€‰å‡ºæ´»è·ƒç©å®¶\n   - å¯¹äºæ‹¥æœ‰æ‰€æœ‰é“å…·çš„ç©å®¶ï¼šéœ€è¦åœ¨dwd_argothek_gearrecord_dfä¸­æ‰¾å‡ºæ‹¥æœ‰æ‰€æœ‰11ä¸ªæŒ‡å®šé“å…·çš„ç©å®¶\n   - ä¸¤ä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³æ—¶ï¼Œå°±æ˜¯æˆ‘ä»¬è¦ç»Ÿè®¡çš„ç¬¬äºŒä¸ªå€¼\n\n4. æ—¶é—´èŒƒå›´å¤„ç†ï¼š\n   - å½“å‰æ—¥æœŸæ˜¯'20250617'\n   - è¿‘30å¤©æ´»è·ƒç©å®¶çš„æ—¥æœŸèŒƒå›´åº”è¯¥æ˜¯ä»20250518åˆ°20250617\n   - éœ€è¦å°†æ—¥æœŸè½¬æ¢ä¸ºæ•´æ•°æ ¼å¼è¿›è¡Œæ¯”è¾ƒ\n\nè®©æˆ‘é€æ­¥æ„å»ºSQLæŸ¥è¯¢è¯­å¥ï¼š\n\n```sql\nWITH active_players AS (\n    -- è·å–è¿‘30å¤©æ´»è·ƒç©å®¶\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_useractivity_df\n    WHERE iworldid = 255\n      AND CAST(statis_date AS DATE) >= DATE_SUB('2025-06-17', INTERVAL 29 DAY)\n      AND CAST(statis_date AS DATE) <= '2025-06-17'\n),\nplayers_with_all_items AS (\n    -- è·å–æ‹¥æœ‰æ‰€æœ‰å¥–æ± é“å…·çš„ç©å®¶\n    SELECT iuserid\n    FROM dwd_argothek_gearrecord_df\n    WHERE iGoodsId IN (\n        \"71d260ca-4bad-81f2-0298-44860341a7a6\",\n        \"48601754-442d-98cb-2109-3fb2075500ec\",\n        \"a9126263-439c-7be6-d668-52a6c0c0a36f\",\n        \"34ecc788-4034-71d2-a0ac-c398b8ecb2ae\",\n        \"56f98991-43f8-dcc8-189e-08b7ae6c42ad\",\n        \"8453f8ef-4c0b-46e2-8768-3e9e45c67a2c\",\n        \"06d90274-435f-3e32-9d57-26bc228ae2e5\",\n        \"8196dea4-4229-c951-13a9-088fb13b3512\",\n        \"3abc330f-444a-6dfd-5863-81856ba62624\",\n        \"041a43a4-46fe-dab7-c974-36bf91eab33d\",\n        \"5b863cb9-4e41-ec89-69ee-49a223d05ff1\"\n    )\n    GROUP BY iuserid\n    HAVING COUNT(DISTINCT iGoodsId) = 11\n)\nSELECT \n    (SELECT COUNT(*) FROM active_players) AS total_active_players,\n    (SELECT COUNT(*) FROM active_players WHERE iuserid IN (SELECT iuserid FROM players_with_all_items)) AS active_players_with_all_items\n```"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡è¿‘30å¤©æ´»è·ƒç©å®¶æ•°ï¼Œè¿‘30å¤©æ´»è·ƒä¸”åŒæ—¶æ‹¥æœ‰å¥–æ± æ‰€æœ‰é“å…·ç©å®¶æ•°\nè¾“å‡ºï¼šè¿‘30å¤©æ´»è·ƒç©å®¶æ•°ã€è¿‘30å¤©æ´»è·ƒä¸”åŒæ—¶æ‹¥æœ‰å¥–æ± æ‰€æœ‰é“å…·ç©å®¶æ•°\nè¡¥å……è¯´æ˜ï¼š\nå½“å‰æ—¥æœŸæ—¶é—´ï¼š'20250617'\nå…¶ä¸­å¥–æ± é“å…·idä¸ºï¼š\n71d260ca-4bad-81f2-0298-44860341a7a6\n48601754-442d-98cb-2109-3fb2075500ec\na9126263-439c-7be6-d668-52a6c0c0a36f\n34ecc788-4034-71d2-a0ac-c398b8ecb2ae\n56f98991-43f8-dcc8-189e-08b7ae6c42ad\n8453f8ef-4c0b-46e2-8768-3e9e45c67a2c\n06d90274-435f-3e32-9d57-26bc228ae2e5\n8196dea4-4229-c951-13a9-088fb13b3512\n3abc330f-444a-6dfd-5863-81856ba62624\n041a43a4-46fe-dab7-c974-36bf91eab33d\n5b863cb9-4e41-ec89-69ee-49a223d05ff1\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dwd_argothek_gearrecord_df` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'appid',\n  `iareaid` TEXT COMMENT 'å¤§åŒºID',\n  `iuserid` TEXT COMMENT 'iuserid',\n  `vRoleID` TEXT COMMENT 'vRoleID',\n  `iGoodsType` TEXT COMMENT 'é“å…·ç±»å‹',\n  `iGoodsId` TEXT COMMENT 'é“å…·ID',\n  `iCount` BIGINT COMMENT 'é“å…·æ•°é‡',\n  `iCount1` BIGINT COMMENT 'é“å…·æ•°é‡ä¸”è®¢å•idä¸ä¸ºç©º',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\nCREATE TABLE `dws_argothek_oss_useractivity_df` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `iworldid` BIGINT COMMENT 'å¤§åŒºID',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `igroup` BIGINT COMMENT 'æ˜¯å¦ä»˜è´¹',\n  `iactivity` TEXT COMMENT 'ç©å®¶ç™»é™†ä½å›¾,é¦–ä½ä¸º0,æœ€é•¿100ä½,1è¡¨ç¤ºå½“å¤©æ´»è·ƒ,0è¡¨ç¤ºå½“å¤©æœªæ´»è·ƒ',\n  `iregdate` BIGINT COMMENT 'æ³¨å†Œæ—¥æœŸ,è¿™é‡Œçš„æ³¨å†Œæ—¥æœŸæ˜¯é¦–æ¬¡æ´»è·ƒæ—¥æœŸ,å¦‚æœæ³¨å†Œæ•°æ®æœ‰å•ç‹¬æ—¥å¿—è¡¨,åˆ™å¿½ç•¥æ­¤å­—æ®µ',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `iregway` BIGINT COMMENT 'æ³¨å†Œæ¸ é“',\n  `vlastlogindate` TEXT COMMENT 'æœ€åç™»å½•æ—¥æœŸ'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nè¿™å¼ è¡¨çš„iworldid = 255ä»£è¡¨ç©å®¶ç²’åº¦ï¼Œ å¥–æ± é“å…·ç­›é€‰é€»è¾‘ï¼š\niGoodsId in (\n\"71d260ca-4bad-81f2-0298-44860341a7a6\",\n\"48601754-442d-98cb-2109-3fb2075500ec\",\n\"a9126263-439c-7be6-d668-52a6c0c0a36f\",\n\"34ecc788-4034-71d2-a0ac-c398b8ecb2ae\",\n\"56f98991-43f8-dcc8-189e-08b7ae6c42ad\",\n\"8453f8ef-4c0b-46e2-8768-3e9e45c67a2c\",\n\"06d90274-435f-3e32-9d57-26bc228ae2e5\",\n\"8196dea4-4229-c951-13a9-088fb13b3512\",\n\"3abc330f-444a-6dfd-5863-81856ba62624\",\n\"041a43a4-46fe-dab7-c974-36bf91eab33d\",\n\"5b863cb9-4e41-ec89-69ee-49a223d05ff1\"\n\n",
  "chosen": "WITH active_players AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_useractivity_df\n    WHERE statis_date = 20250617\n    AND iworldid = 255\n    AND RIGHT(iactivity, 30) REGEXP '1'\n),\nplayers_with_all_items AS (\n    SELECT iuserid\n    FROM dwd_argothek_gearrecord_df\n    WHERE dtstatdate = 20250617\n    AND iGoodsId IN (\n        '71d260ca-4bad-81f2-0298-44860341a7a6',\n        '48601754-442d-98cb-2109-3fb2075500ec',\n        'a9126263-439c-7be6-d668-52a6c0c0a36f',\n        '34ecc788-4034-71d2-a0ac-c398b8ecb2ae',\n        '56f98991-43f8-dcc8-189e-08b7ae6c42ad',\n        '8453f8ef-4c0b-46e2-8768-3e9e45c67a2c',\n        '06d90274-435f-3e32-9d57-26bc228ae2e5',\n        '8196dea4-4229-c951-13a9-088fb13b3512',\n        '3abc330f-444a-6dfd-5863-81856ba62624',\n        '041a43a4-46fe-dab7-c974-36bf91eab33d',\n        '5b863cb9-4e41-ec89-69ee-49a223d05ff1'\n    )\n    GROUP BY iuserid\n    HAVING COUNT(DISTINCT iGoodsId) = 11\n)\nSELECT \n    (SELECT COUNT(*) FROM active_players) AS active_players_30_days,\n    (SELECT COUNT(*) FROM active_players ap INNER JOIN players_with_all_items pwai ON ap.iuserid = pwai.iuserid) AS active_players_with_all_items",
  "rejected": "SELECT\n  COUNT(DISTINCT iuserid) AS active_users,\n  COUNT(DISTINCT CASE WHEN has_all_items = 1 THEN iuserid ELSE NULL END) AS active_users_with_all_items\nFROM (\n  SELECT\n    t1.iuserid,\n    CASE WHEN COUNT(DISTINCT iGoodsId) = 11 THEN 1 ELSE 0 END AS has_all_items\n  FROM `dws_argothek_oss_useractivity_df` AS t1\n  LEFT JOIN `dwd_argothek_gearrecord_df` AS t2\n    ON t1.iuserid = t2.iuserid\n  WHERE\n    t1.statis_date >= 20250518 AND t1.statis_date <= 20250617\n    AND t2.iGoodsId IN ('71d260ca-4bad-81f2-0298-44860341a7a6', '48601754-442d-98cb-2109-3fb2075500ec', 'a9126263-439c-7be6-d668-52a6c0c0a36f', '34ecc788-4034-71d2-a0ac-c398b8ecb2ae', '56f98991-43f8-dcc8-189e-08b7ae6c42ad', '8453f8ef-4c0b-46e2-8768-3e9e45c67a2c', '06d90274-435f-3e32-9d57-26bc228ae2e5', '8196dea4-4229-c951-13a9-088fb13b3512', '3abc330f-444a-6dfd-5863-81856ba62624', '041a43a4-46fe-dab7-c974-36bf91eab33d', '5b863cb9-4e41-ec89-69ee-49a223d05ff1')\n    AND t2.iareaid = 255\n  GROUP BY\n    t1.iuserid\n) AS subquery"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡è¿‘30å¤©æ´»è·ƒç©å®¶æ•°ï¼Œè¿‘30å¤©æ´»è·ƒä¸”åŒæ—¶æ‹¥æœ‰å¥–æ± æ‰€æœ‰é“å…·ç©å®¶æ•°\nè¾“å‡ºï¼šè¿‘30å¤©æ´»è·ƒç©å®¶æ•°ã€è¿‘30å¤©æ´»è·ƒä¸”åŒæ—¶æ‹¥æœ‰å¥–æ± æ‰€æœ‰é“å…·ç©å®¶æ•°\nè¡¥å……è¯´æ˜ï¼š\nå½“å‰æ—¥æœŸæ—¶é—´ï¼š'20250617'\nå…¶ä¸­å¥–æ± é“å…·idä¸ºï¼š\n71d260ca-4bad-81f2-0298-44860341a7a6\n48601754-442d-98cb-2109-3fb2075500ec\na9126263-439c-7be6-d668-52a6c0c0a36f\n34ecc788-4034-71d2-a0ac-c398b8ecb2ae\n56f98991-43f8-dcc8-189e-08b7ae6c42ad\n8453f8ef-4c0b-46e2-8768-3e9e45c67a2c\n06d90274-435f-3e32-9d57-26bc228ae2e5\n8196dea4-4229-c951-13a9-088fb13b3512\n3abc330f-444a-6dfd-5863-81856ba62624\n041a43a4-46fe-dab7-c974-36bf91eab33d\n5b863cb9-4e41-ec89-69ee-49a223d05ff1\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dwd_argothek_gearrecord_df` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'appid',\n  `iareaid` TEXT COMMENT 'å¤§åŒºID',\n  `iuserid` TEXT COMMENT 'iuserid',\n  `vRoleID` TEXT COMMENT 'vRoleID',\n  `iGoodsType` TEXT COMMENT 'é“å…·ç±»å‹',\n  `iGoodsId` TEXT COMMENT 'é“å…·ID',\n  `iCount` BIGINT COMMENT 'é“å…·æ•°é‡',\n  `iCount1` BIGINT COMMENT 'é“å…·æ•°é‡ä¸”è®¢å•idä¸ä¸ºç©º',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\nCREATE TABLE `dws_argothek_oss_useractivity_df` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `iworldid` BIGINT COMMENT 'å¤§åŒºID',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `igroup` BIGINT COMMENT 'æ˜¯å¦ä»˜è´¹',\n  `iactivity` TEXT COMMENT 'ç©å®¶ç™»é™†ä½å›¾,é¦–ä½ä¸º0,æœ€é•¿100ä½,1è¡¨ç¤ºå½“å¤©æ´»è·ƒ,0è¡¨ç¤ºå½“å¤©æœªæ´»è·ƒ',\n  `iregdate` BIGINT COMMENT 'æ³¨å†Œæ—¥æœŸ,è¿™é‡Œçš„æ³¨å†Œæ—¥æœŸæ˜¯é¦–æ¬¡æ´»è·ƒæ—¥æœŸ,å¦‚æœæ³¨å†Œæ•°æ®æœ‰å•ç‹¬æ—¥å¿—è¡¨,åˆ™å¿½ç•¥æ­¤å­—æ®µ',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `iregway` BIGINT COMMENT 'æ³¨å†Œæ¸ é“',\n  `vlastlogindate` TEXT COMMENT 'æœ€åç™»å½•æ—¥æœŸ'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nè¿™å¼ è¡¨çš„iworldid = 255ä»£è¡¨ç©å®¶ç²’åº¦ï¼Œ å¥–æ± é“å…·ç­›é€‰é€»è¾‘ï¼š\niGoodsId in (\n\"71d260ca-4bad-81f2-0298-44860341a7a6\",\n\"48601754-442d-98cb-2109-3fb2075500ec\",\n\"a9126263-439c-7be6-d668-52a6c0c0a36f\",\n\"34ecc788-4034-71d2-a0ac-c398b8ecb2ae\",\n\"56f98991-43f8-dcc8-189e-08b7ae6c42ad\",\n\"8453f8ef-4c0b-46e2-8768-3e9e45c67a2c\",\n\"06d90274-435f-3e32-9d57-26bc228ae2e5\",\n\"8196dea4-4229-c951-13a9-088fb13b3512\",\n\"3abc330f-444a-6dfd-5863-81856ba62624\",\n\"041a43a4-46fe-dab7-c974-36bf91eab33d\",\n\"5b863cb9-4e41-ec89-69ee-49a223d05ff1\"\n\n",
  "chosen": "WITH active_players AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_useractivity_df\n    WHERE statis_date = 20250617\n    AND iworldid = 255\n    AND RIGHT(iactivity, 30) REGEXP '1'\n),\nplayers_with_all_items AS (\n    SELECT iuserid\n    FROM dwd_argothek_gearrecord_df\n    WHERE dtstatdate = 20250617\n    AND iGoodsId IN (\n        '71d260ca-4bad-81f2-0298-44860341a7a6',\n        '48601754-442d-98cb-2109-3fb2075500ec',\n        'a9126263-439c-7be6-d668-52a6c0c0a36f',\n        '34ecc788-4034-71d2-a0ac-c398b8ecb2ae',\n        '56f98991-43f8-dcc8-189e-08b7ae6c42ad',\n        '8453f8ef-4c0b-46e2-8768-3e9e45c67a2c',\n        '06d90274-435f-3e32-9d57-26bc228ae2e5',\n        '8196dea4-4229-c951-13a9-088fb13b3512',\n        '3abc330f-444a-6dfd-5863-81856ba62624',\n        '041a43a4-46fe-dab7-c974-36bf91eab33d',\n        '5b863cb9-4e41-ec89-69ee-49a223d05ff1'\n    )\n    GROUP BY iuserid\n    HAVING COUNT(DISTINCT iGoodsId) = 11\n)\nSELECT \n    (SELECT COUNT(*) FROM active_players) AS active_players_30_days,\n    (SELECT COUNT(*) FROM active_players ap INNER JOIN players_with_all_items pwai ON ap.iuserid = pwai.iuserid) AS active_players_with_all_items",
  "rejected": "æˆ‘å°†é€æ­¥åˆ†æè¿™ä¸ªé—®é¢˜å¹¶æ„å»ºSQLæŸ¥è¯¢è¯­å¥ã€‚\n\né¦–å…ˆï¼Œè®©æˆ‘ç†è§£éœ€æ±‚ï¼š\n1. ç»Ÿè®¡è¿‘30å¤©æ´»è·ƒç©å®¶æ•°ï¼ˆåœ¨è¿‘30å¤©å†…è‡³å°‘æœ‰ä¸€å¤©æ´»è·ƒï¼‰\n2. ç»Ÿè®¡è¿‘30å¤©æ´»è·ƒä¸”åŒæ—¶æ‹¥æœ‰å¥–æ± æ‰€æœ‰é“å…·çš„ç©å®¶æ•°\n\nç„¶åï¼Œè®©æˆ‘åˆ†ææ•°æ®åº“ç»“æ„ï¼š\n1. `dws_argothek_oss_useractivity_df` è¡¨åŒ…å«ç©å®¶æ´»è·ƒä¿¡æ¯å’Œç­‰çº§ç­‰\n2. `dwd_argothek_gearrecord_df` è¡¨åŒ…å«é“å…·è®°å½•ä¿¡æ¯\n\nå¯¹äºæ´»è·ƒç©å®¶çš„å®šä¹‰ï¼š\n- æ´»è·ƒæ—¥æœŸèŒƒå›´æ˜¯ï¼š2025å¹´5æœˆ18æ—¥åˆ°2025å¹´6æœˆ17æ—¥ï¼ˆå…±30å¤©ï¼‰\n- æ´»è·ƒæ ‡å¿—ä½åœ¨ `iactivity` å­—æ®µä¸­ï¼Œæ¯ä½ä»£è¡¨ä¸€å¤©çš„æ´»è·ƒçŠ¶æ€\n\nå¯¹äºå¥–æ± é“å…·çš„å®šä¹‰ï¼š\n- éœ€è¦åŒæ—¶æ‹¥æœ‰11ä¸ªæŒ‡å®šçš„é“å…·ID\n\nç°åœ¨å¼€å§‹æ„å»ºSQLæŸ¥è¯¢ï¼š\n\n```sql\nWITH active_players AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_useractivity_df\n    WHERE \n        -- è¿‡æ»¤å‡ºè¿‘30å¤©æ´»è·ƒçš„ç©å®¶\n        (statis_date >= 20250518 AND statis_date <= 20250617)\n        AND iworldid = 255\n),\nplayer_with_all_items AS (\n    SELECT iuserid\n    FROM dwd_argothek_gearrecord_df\n    WHERE \n        iGoodsId IN (\n            \"71d260ca-4bad-81f2-0298-44860341a7a6\",\n            \"48601754-442d-98cb-2109-3fb2075500ec\",\n            \"a9126263-439c-7be6-d668-52a6c0c0a36f\",\n            \"34ecc788-4034-71d2-a0ac-c398b8ecb2ae\",\n            \"56f98991-43f8-dcc8-189e-08b7ae6c42ad\",\n            \"8453f8ef-4c0b-46e2-8768-3e9e45c67a2c\",\n            \"06d90274-435f-3e32-9d57-26bc228ae2e5\",\n            \"8196dea4-4229-c951-13a9-088fb13b3512\",\n            \"3abc330f-444a-6dfd-5863-81856ba62624\",\n            \"041a43a4-46fe-dab7-c974-36bf91eab33d\",\n            \"5b863cb9-4e41-ec89-69ee-49a223d05ff1\"\n        )\n        AND iworldid = 255\n    GROUP BY iuserid\n    HAVING COUNT(DISTINCT iGoodsId) = 11\n)\nSELECT \n    (SELECT COUNT(*) FROM active_players) AS active_player_count,\n    (SELECT COUNT(*) FROM player_with_all_items) AS active_player_with_all_items_count\n```"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡è¿‘30å¤©æ´»è·ƒç©å®¶æ•°ï¼Œè¿‘30å¤©æ´»è·ƒä¸”åŒæ—¶æ‹¥æœ‰å¥–æ± æ‰€æœ‰é“å…·ç©å®¶æ•°\nè¾“å‡ºï¼šè¿‘30å¤©æ´»è·ƒç©å®¶æ•°ã€è¿‘30å¤©æ´»è·ƒä¸”åŒæ—¶æ‹¥æœ‰å¥–æ± æ‰€æœ‰é“å…·ç©å®¶æ•°\nè¡¥å……è¯´æ˜ï¼š\nå½“å‰æ—¥æœŸæ—¶é—´ï¼š'20250617'\nå…¶ä¸­å¥–æ± é“å…·idä¸ºï¼š\n71d260ca-4bad-81f2-0298-44860341a7a6\n48601754-442d-98cb-2109-3fb2075500ec\na9126263-439c-7be6-d668-52a6c0c0a36f\n34ecc788-4034-71d2-a0ac-c398b8ecb2ae\n56f98991-43f8-dcc8-189e-08b7ae6c42ad\n8453f8ef-4c0b-46e2-8768-3e9e45c67a2c\n06d90274-435f-3e32-9d57-26bc228ae2e5\n8196dea4-4229-c951-13a9-088fb13b3512\n3abc330f-444a-6dfd-5863-81856ba62624\n041a43a4-46fe-dab7-c974-36bf91eab33d\n5b863cb9-4e41-ec89-69ee-49a223d05ff1\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dwd_argothek_gearrecord_df` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'appid',\n  `iareaid` TEXT COMMENT 'å¤§åŒºID',\n  `iuserid` TEXT COMMENT 'iuserid',\n  `vRoleID` TEXT COMMENT 'vRoleID',\n  `iGoodsType` TEXT COMMENT 'é“å…·ç±»å‹',\n  `iGoodsId` TEXT COMMENT 'é“å…·ID',\n  `iCount` BIGINT COMMENT 'é“å…·æ•°é‡',\n  `iCount1` BIGINT COMMENT 'é“å…·æ•°é‡ä¸”è®¢å•idä¸ä¸ºç©º',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\nCREATE TABLE `dws_argothek_oss_useractivity_df` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `iworldid` BIGINT COMMENT 'å¤§åŒºID',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `igroup` BIGINT COMMENT 'æ˜¯å¦ä»˜è´¹',\n  `iactivity` TEXT COMMENT 'ç©å®¶ç™»é™†ä½å›¾,é¦–ä½ä¸º0,æœ€é•¿100ä½,1è¡¨ç¤ºå½“å¤©æ´»è·ƒ,0è¡¨ç¤ºå½“å¤©æœªæ´»è·ƒ',\n  `iregdate` BIGINT COMMENT 'æ³¨å†Œæ—¥æœŸ,è¿™é‡Œçš„æ³¨å†Œæ—¥æœŸæ˜¯é¦–æ¬¡æ´»è·ƒæ—¥æœŸ,å¦‚æœæ³¨å†Œæ•°æ®æœ‰å•ç‹¬æ—¥å¿—è¡¨,åˆ™å¿½ç•¥æ­¤å­—æ®µ',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `iregway` BIGINT COMMENT 'æ³¨å†Œæ¸ é“',\n  `vlastlogindate` TEXT COMMENT 'æœ€åç™»å½•æ—¥æœŸ'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nè¿™å¼ è¡¨çš„iworldid = 255ä»£è¡¨ç©å®¶ç²’åº¦ï¼Œ å¥–æ± é“å…·ç­›é€‰é€»è¾‘ï¼š\niGoodsId in (\n\"71d260ca-4bad-81f2-0298-44860341a7a6\",\n\"48601754-442d-98cb-2109-3fb2075500ec\",\n\"a9126263-439c-7be6-d668-52a6c0c0a36f\",\n\"34ecc788-4034-71d2-a0ac-c398b8ecb2ae\",\n\"56f98991-43f8-dcc8-189e-08b7ae6c42ad\",\n\"8453f8ef-4c0b-46e2-8768-3e9e45c67a2c\",\n\"06d90274-435f-3e32-9d57-26bc228ae2e5\",\n\"8196dea4-4229-c951-13a9-088fb13b3512\",\n\"3abc330f-444a-6dfd-5863-81856ba62624\",\n\"041a43a4-46fe-dab7-c974-36bf91eab33d\",\n\"5b863cb9-4e41-ec89-69ee-49a223d05ff1\"\n\n",
  "chosen": "WITH active_players AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_useractivity_df\n    WHERE statis_date = 20250617\n    AND iworldid = 255\n    AND RIGHT(iactivity, 30) REGEXP '1'\n),\nplayers_with_all_items AS (\n    SELECT iuserid\n    FROM dwd_argothek_gearrecord_df\n    WHERE dtstatdate = 20250617\n    AND iGoodsId IN (\n        '71d260ca-4bad-81f2-0298-44860341a7a6',\n        '48601754-442d-98cb-2109-3fb2075500ec',\n        'a9126263-439c-7be6-d668-52a6c0c0a36f',\n        '34ecc788-4034-71d2-a0ac-c398b8ecb2ae',\n        '56f98991-43f8-dcc8-189e-08b7ae6c42ad',\n        '8453f8ef-4c0b-46e2-8768-3e9e45c67a2c',\n        '06d90274-435f-3e32-9d57-26bc228ae2e5',\n        '8196dea4-4229-c951-13a9-088fb13b3512',\n        '3abc330f-444a-6dfd-5863-81856ba62624',\n        '041a43a4-46fe-dab7-c974-36bf91eab33d',\n        '5b863cb9-4e41-ec89-69ee-49a223d05ff1'\n    )\n    GROUP BY iuserid\n    HAVING COUNT(DISTINCT iGoodsId) = 11\n)\nSELECT \n    (SELECT COUNT(*) FROM active_players) AS active_players_30_days,\n    (SELECT COUNT(*) FROM active_players ap INNER JOIN players_with_all_items pwai ON ap.iuserid = pwai.iuserid) AS active_players_with_all_items",
  "rejected": "æˆ‘å°†é€æ­¥åˆ†æè¿™ä¸ªé—®é¢˜å¹¶æ„å»ºæ­£ç¡®çš„SQLæŸ¥è¯¢ã€‚\n\né¦–å…ˆï¼Œè®©æˆ‘ç†è§£éœ€æ±‚ï¼š\n1. ç»Ÿè®¡è¿‘30å¤©æ´»è·ƒç©å®¶æ•°ï¼ˆå³åœ¨æœ€è¿‘30å¤©å†…è‡³å°‘ç™»å½•è¿‡ä¸€æ¬¡çš„ç©å®¶ï¼‰\n2. ç»Ÿè®¡è¿‘30å¤©æ´»è·ƒä¸”åŒæ—¶æ‹¥æœ‰å¥–æ± æ‰€æœ‰é“å…·çš„ç©å®¶æ•°\n\nç„¶åï¼Œæˆ‘æ¥åˆ†æè¡¨ç»“æ„å’Œå­—æ®µï¼š\n- `dws_argothek_oss_useractivity_df` è¡¨åŒ…å«ç©å®¶æ´»åŠ¨ä¿¡æ¯ï¼Œå…¶ä¸­ `iactivity` å­—æ®µè¡¨ç¤ºç©å®¶çš„ç™»å½•ä½å›¾\n- `dwd_argothek_gearrecord_df` è¡¨åŒ…å«é“å…·è®°å½•ä¿¡æ¯\n\nç”±äºå½“å‰æ—¥æœŸæ˜¯ '20250617'ï¼Œé‚£ä¹ˆè¿‘30å¤©å°±æ˜¯ä» '20250518' åˆ° '20250617'\n\næ¥ä¸‹æ¥ï¼Œæˆ‘éœ€è¦è€ƒè™‘å¦‚ä½•å¤„ç† iactivity å­—æ®µã€‚æ ¹æ®é¢˜ç›®æè¿°ï¼Œè¿™æ˜¯ä¸€ä¸ªä½å›¾ï¼Œè¡¨ç¤ºç©å®¶æ¯å¤©çš„æ´»è·ƒçŠ¶æ€ï¼Œæ¯ä¸€ä½å¯¹åº”ä¸€å¤©ï¼Œ1è¡¨ç¤ºæ´»è·ƒï¼Œ0è¡¨ç¤ºä¸æ´»è·ƒã€‚\n\nä¸ºäº†åˆ¤æ–­ä¸€ä¸ªç©å®¶åœ¨æŸä¸€å¤©æ˜¯å¦æ´»è·ƒï¼Œæˆ‘ä»¬éœ€è¦å°†æ—¥æœŸè½¬æ¢æˆä½å›¾ä¸­çš„ä½ç½®ã€‚å‡è®¾ä½å›¾æ˜¯ä»å³å¾€å·¦æ•°çš„ï¼Œé‚£ä¹ˆ '20250617' å¯¹åº”çš„æ˜¯ç¬¬0ä½ï¼Œ'20250616' å¯¹åº”ç¬¬1ä½ï¼Œä»¥æ­¤ç±»æ¨ã€‚\n\nç°åœ¨å¼€å§‹æ„å»ºSQLï¼š\n\n```sql\nSELECT \n    COUNT(DISTINCT CASE WHEN iactivity LIKE '%1%' THEN iuserid ELSE NULL END) AS active_player_count,\n    COUNT(DISTINCT CASE WHEN iuserid IN (\n        SELECT DISTINCT iuserid FROM dwd_argothek_gearrecord_df WHERE iGoodsId IN (\n            \"71d260ca-4bad-81f2-0298-44860341a7a6\",\n            \"48601754-442d-98cb-2109-3fb2075500ec\",\n            \"a9126263-439c-7be6-d668-52a6c0c0a36f\",\n            \"34ecc788-4034-71d2-a0ac-c398b8ecb2ae\",\n            \"56f98991-43f8-dcc8-189e-08b7ae6c42ad\",\n            \"8453f8ef-4c0b-46e2-8768-3e9e45c67a2c\",\n            \"06d90274-435f-3e32-9d57-26bc228ae2e5\",\n            \"8196dea4-4229-c951-13a9-088fb13b3512\",\n            \"3abc330f-444a-6dfd-5863-81856ba62624\",\n            \"041a43a4-46fe-dab7-c974-36bf91eab33d\",\n            \"5b863cb9-4e41-ec89-69ee-49a223d05ff1\"\n        ) GROUP BY iuserid HAVING COUNT(DISTINCT iGoodsId) = 11\n    ) THEN iuserid ELSE NULL END) AS active_and_having_all_items\nFROM dws_argothek_oss_useractivity_df\nWHERE iworldid = 255 AND statis_date >= 20250518 AND statis_date <= 20250617\n```\n\nè®©æˆ‘é‡æ–°æ£€æŸ¥ä¸€ä¸‹è¿™ä¸ªæŸ¥è¯¢ï¼Œå› ä¸ºå¯èƒ½æ²¡æœ‰æ­£ç¡®åœ°ä½¿ç”¨ä½å›¾æ¥åˆ¤æ–­æ´»è·ƒæƒ…å†µã€‚è€ƒè™‘åˆ°ä½å›¾çš„ç‰¹æ€§ï¼Œæˆ‘éœ€è¦æ›´ç²¾ç¡®åœ°å¤„ç†å®ƒã€‚\n\nå®é™…ä¸Šï¼Œç”±äºMySQLä¸­å¾ˆéš¾ç›´æ¥æ“ä½œä½å›¾ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡å…¶ä»–æ–¹å¼åˆ¤æ–­ã€‚è®©æˆ‘ä»¬æ¢ä¸ªæ€è·¯ï¼š\n\n```sql\nWITH active_players AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_useractivity_df\n    WHERE iworldid = 255 \n      AND statis_date BETWEEN 20250518 AND 20250617\n),\nall_items_users AS (\n    SELECT DISTINCT iuserid\n    FROM dwd_argothek_gearrecord_df\n    WHERE iGoodsId IN (\n        \"71d260ca-4bad-81f2-0298-44860341a7a6\",\n        \"48601754-442d-98cb-2109-3fb2075500ec\",\n        \"a9126263-439c-7be6-d668-52a6c0c0a36f\",\n        \"34ecc788-4034-71d2-a0ac-c398b8ecb2ae\",\n        \"56f98991-43f8-dcc8-189e-08b7ae6c42ad\",\n        \"8453f8ef-4c0b-46e2-8768-3e9e45c67a2c\",\n        \"06d90274-435f-3e32-9d57-26bc228ae2e5\",\n        \"8196dea4-4229-c951-13a9-088fb13b3512\",\n        \"3abc330f-444a-6dfd-5863-81856ba62624\",\n        \"041a43a4-46fe-dab7-c974-36bf91eab33d\",\n        \"5b863cb9-4e41-ec89-69ee-49a223d05ff1\"\n    )\n    GROUP BY iuserid\n    HAVING COUNT(DISTINCT iGoodsId) = 11\n)\nSELECT \n    (SELECT COUNT(*) FROM active_players) AS active_player_count,\n    (SELECT COUNT(*) FROM all_items_users WHERE iuserid IN (SELECT iuserid FROM active_players)) AS active_and_having_all_items\n```"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡è¿‘30å¤©æ´»è·ƒç©å®¶æ•°ï¼Œè¿‘30å¤©æ´»è·ƒä¸”åŒæ—¶æ‹¥æœ‰å¥–æ± æ‰€æœ‰é“å…·ç©å®¶æ•°\nè¾“å‡ºï¼šè¿‘30å¤©æ´»è·ƒç©å®¶æ•°ã€è¿‘30å¤©æ´»è·ƒä¸”åŒæ—¶æ‹¥æœ‰å¥–æ± æ‰€æœ‰é“å…·ç©å®¶æ•°\nè¡¥å……è¯´æ˜ï¼š\nå½“å‰æ—¥æœŸæ—¶é—´ï¼š'20250617'\nå…¶ä¸­å¥–æ± é“å…·idä¸ºï¼š\n71d260ca-4bad-81f2-0298-44860341a7a6\n48601754-442d-98cb-2109-3fb2075500ec\na9126263-439c-7be6-d668-52a6c0c0a36f\n34ecc788-4034-71d2-a0ac-c398b8ecb2ae\n56f98991-43f8-dcc8-189e-08b7ae6c42ad\n8453f8ef-4c0b-46e2-8768-3e9e45c67a2c\n06d90274-435f-3e32-9d57-26bc228ae2e5\n8196dea4-4229-c951-13a9-088fb13b3512\n3abc330f-444a-6dfd-5863-81856ba62624\n041a43a4-46fe-dab7-c974-36bf91eab33d\n5b863cb9-4e41-ec89-69ee-49a223d05ff1\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dwd_argothek_gearrecord_df` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'appid',\n  `iareaid` TEXT COMMENT 'å¤§åŒºID',\n  `iuserid` TEXT COMMENT 'iuserid',\n  `vRoleID` TEXT COMMENT 'vRoleID',\n  `iGoodsType` TEXT COMMENT 'é“å…·ç±»å‹',\n  `iGoodsId` TEXT COMMENT 'é“å…·ID',\n  `iCount` BIGINT COMMENT 'é“å…·æ•°é‡',\n  `iCount1` BIGINT COMMENT 'é“å…·æ•°é‡ä¸”è®¢å•idä¸ä¸ºç©º',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\nCREATE TABLE `dws_argothek_oss_useractivity_df` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `iworldid` BIGINT COMMENT 'å¤§åŒºID',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `igroup` BIGINT COMMENT 'æ˜¯å¦ä»˜è´¹',\n  `iactivity` TEXT COMMENT 'ç©å®¶ç™»é™†ä½å›¾,é¦–ä½ä¸º0,æœ€é•¿100ä½,1è¡¨ç¤ºå½“å¤©æ´»è·ƒ,0è¡¨ç¤ºå½“å¤©æœªæ´»è·ƒ',\n  `iregdate` BIGINT COMMENT 'æ³¨å†Œæ—¥æœŸ,è¿™é‡Œçš„æ³¨å†Œæ—¥æœŸæ˜¯é¦–æ¬¡æ´»è·ƒæ—¥æœŸ,å¦‚æœæ³¨å†Œæ•°æ®æœ‰å•ç‹¬æ—¥å¿—è¡¨,åˆ™å¿½ç•¥æ­¤å­—æ®µ',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `iregway` BIGINT COMMENT 'æ³¨å†Œæ¸ é“',\n  `vlastlogindate` TEXT COMMENT 'æœ€åç™»å½•æ—¥æœŸ'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nè¿™å¼ è¡¨çš„iworldid = 255ä»£è¡¨ç©å®¶ç²’åº¦ï¼Œ å¥–æ± é“å…·ç­›é€‰é€»è¾‘ï¼š\niGoodsId in (\n\"71d260ca-4bad-81f2-0298-44860341a7a6\",\n\"48601754-442d-98cb-2109-3fb2075500ec\",\n\"a9126263-439c-7be6-d668-52a6c0c0a36f\",\n\"34ecc788-4034-71d2-a0ac-c398b8ecb2ae\",\n\"56f98991-43f8-dcc8-189e-08b7ae6c42ad\",\n\"8453f8ef-4c0b-46e2-8768-3e9e45c67a2c\",\n\"06d90274-435f-3e32-9d57-26bc228ae2e5\",\n\"8196dea4-4229-c951-13a9-088fb13b3512\",\n\"3abc330f-444a-6dfd-5863-81856ba62624\",\n\"041a43a4-46fe-dab7-c974-36bf91eab33d\",\n\"5b863cb9-4e41-ec89-69ee-49a223d05ff1\"\n\n",
  "chosen": "WITH active_players AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_useractivity_df\n    WHERE statis_date = 20250617\n    AND iworldid = 255\n    AND RIGHT(iactivity, 30) REGEXP '1'\n),\nplayers_with_all_items AS (\n    SELECT iuserid\n    FROM dwd_argothek_gearrecord_df\n    WHERE dtstatdate = 20250617\n    AND iGoodsId IN (\n        '71d260ca-4bad-81f2-0298-44860341a7a6',\n        '48601754-442d-98cb-2109-3fb2075500ec',\n        'a9126263-439c-7be6-d668-52a6c0c0a36f',\n        '34ecc788-4034-71d2-a0ac-c398b8ecb2ae',\n        '56f98991-43f8-dcc8-189e-08b7ae6c42ad',\n        '8453f8ef-4c0b-46e2-8768-3e9e45c67a2c',\n        '06d90274-435f-3e32-9d57-26bc228ae2e5',\n        '8196dea4-4229-c951-13a9-088fb13b3512',\n        '3abc330f-444a-6dfd-5863-81856ba62624',\n        '041a43a4-46fe-dab7-c974-36bf91eab33d',\n        '5b863cb9-4e41-ec89-69ee-49a223d05ff1'\n    )\n    GROUP BY iuserid\n    HAVING COUNT(DISTINCT iGoodsId) = 11\n)\nSELECT \n    (SELECT COUNT(*) FROM active_players) AS active_players_30_days,\n    (SELECT COUNT(*) FROM active_players ap INNER JOIN players_with_all_items pwai ON ap.iuserid = pwai.iuserid) AS active_players_with_all_items",
  "rejected": "å¥½çš„ï¼Œæˆ‘ä»¬æ¥ä¸€æ­¥æ­¥åˆ†æå’Œæ„å»ºè¿™ä¸ª SQL æŸ¥è¯¢ã€‚\n\n---\n\n### ğŸ§  **ç¬¬ä¸€æ­¥ï¼šæ˜ç¡®éœ€æ±‚**\n\næˆ‘ä»¬è¦ç»Ÿè®¡ä¸¤ä¸ªæŒ‡æ ‡ï¼š\n\n1. **è¿‘30å¤©æ´»è·ƒç©å®¶æ•°**\n   - æ´»è·ƒå®šä¹‰ï¼šåœ¨æœ€è¿‘30å¤©å†…è‡³å°‘æœ‰ä¸€å¤©ç™»å½•ï¼ˆå³ `iactivity` ä¸­å¯¹åº”ä½ç½®ä¸º 1ï¼‰\n   - å½“å‰æ—¥æœŸæ˜¯ `'20250617'`ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ‰¾çš„æ˜¯ä» `'20250518'` åˆ° `'20250617'` è¿™ä¸ªæ—¶é—´æ®µå†…çš„æ´»è·ƒç©å®¶æ•°\n\n2. **è¿‘30å¤©æ´»è·ƒä¸”åŒæ—¶æ‹¥æœ‰å¥–æ± æ‰€æœ‰é“å…·çš„ç©å®¶æ•°**\n   - éœ€è¦å…ˆæ‰¾å‡ºâ€œè¿‘30å¤©æ´»è·ƒâ€çš„ç©å®¶é›†åˆ\n   - å†åœ¨è¿™ä¸ªé›†åˆä¸­ç­›é€‰å‡ºæ‹¥æœ‰å…¨éƒ¨11ç§å¥–æ± é“å…·çš„ç©å®¶ï¼ˆå³æ¯ä¸ªé“å…·çš„æ•°é‡ > 0ï¼‰\n\n---\n\n### ğŸ” **ç¬¬äºŒæ­¥ï¼šç†è§£æ•°æ®ç»“æ„**\n\n#### è¡¨ä¸€ï¼š`dws_argothek_oss_useractivity_df`\n\n- `statis_date`: ç»Ÿè®¡æ—¥æœŸï¼ˆæ•´å‹ï¼Œå¦‚ 20250617ï¼‰\n- `iworldid`: åŒºæœ IDï¼Œå€¼ä¸º 255 è¡¨ç¤ºç©å®¶ç²’åº¦\n- `iuserid`: ç”¨æˆ·å”¯ä¸€æ ‡è¯†\n- `iactivity`: ç™»å½•ä½å›¾ï¼Œé•¿åº¦æœ€å¤š 100 ä½ï¼Œæ¯ä¸€ä½ä»£è¡¨ä¸€å¤©æ˜¯å¦æ´»è·ƒï¼ˆ1 è¡¨ç¤ºæ´»è·ƒï¼‰\n- `iregdate`: æ³¨å†Œæ—¶é—´ï¼ˆé¦–æ¬¡æ´»è·ƒæ—¶é—´ï¼‰\n\n> æ³¨æ„ï¼šç”±äº `iactivity` æ˜¯å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶è½¬æ¢æˆäºŒè¿›åˆ¶ä½è¿›è¡Œåˆ¤æ–­ã€‚\n\n#### è¡¨äºŒï¼š`dwd_argothek_gearrecord_df`\n\n- `iuserid`: ç”¨æˆ· ID\n- `iGoodsId`: é“å…· ID\n- `iCount`: é“å…·æ•°é‡ï¼ˆæ³¨æ„ä¸æ˜¯ `iCount1`ï¼Œå› ä¸ºé¢˜ç›®è¯´åªè¦æ‹¥æœ‰å°±è¡Œï¼‰\n\n---\n\n### ğŸ§® **ç¬¬ä¸‰æ­¥ï¼šæ„é€  SQL æŸ¥è¯¢**\n\næˆ‘ä»¬å°†åˆ†ä¸¤éƒ¨åˆ†å®Œæˆï¼š\n\n#### âœ… ç¬¬ä¸€éƒ¨åˆ†ï¼šè·å–è¿‘30å¤©æ´»è·ƒç©å®¶æ•°\n\næˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ `iactivity` å­—æ®µï¼Œå‡è®¾å®ƒæ˜¯ä»å³å¾€å·¦è¡¨ç¤ºæœ€è¿‘çš„æ—¥æœŸï¼ˆå³ç¬¬0ä½æ˜¯ä»Šå¤©ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦æ£€æŸ¥æœ€è¿‘30å¤©æ˜¯å¦åŒ…å«è‡³å°‘ä¸€ä¸ª 1ã€‚\n\n```sql\nSELECT COUNT(DISTINCT iuserid) AS active_player_count\nFROM dws_argothek_oss_useractivity_df\nWHERE iworldid = 255\n  AND statis_date BETWEEN 20250518 AND 20250617\n  AND (\n    SUBSTR(iactivity, LENGTH(iactivity) - 0, 1) = '1' OR -- æœ€è¿‘ä¸€å¤©\n    SUBSTR(iactivity, LENGTH(iactivity) - 1, 1) = '1' OR\n    SUBSTR(iactivity, LENGTH(iactivity) - 2, 1) = '1' OR\n    ...\n    SUBSTR(iactivity, LENGTH(iactivity) - 29, 1) = '1' -- ç¬¬30å¤©\n  );\n```\n\nä½†è¿™å¤ªç¹çäº†ã€‚æ›´å¥½çš„æ–¹æ³•æ˜¯å°† `iactivity` è½¬æ¢ä¸ºä¸€ä¸ªæ•´æ•°ï¼Œç„¶åé€šè¿‡ä½è¿ç®—åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŸä¸€ä½ä¸º1ã€‚\n\nä¸è¿‡ï¼Œåœ¨ MySQL ä¸­æ²¡æœ‰å†…ç½®å‡½æ•°å¯ä»¥å®ç°è¿™ç§å¤æ‚ä½æ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬æ”¹ç”¨å¦ä¸€ç§æ–¹å¼ï¼š**ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…**ã€‚\n\n```sql\nSELECT COUNT(DISTINCT iuserid)\nFROM dws_argothek_oss_useractivity_df\nWHERE iworldid = 255\n  AND statis_date BETWEEN 20250518 AND 20250617\n  AND iactivity REGEXP '1.{0,29}$';\n```\n\nâœ… ä¸Šé¢è¿™å¥çš„æ„æ€æ˜¯ï¼šä»å­—ç¬¦ä¸²æœ«å°¾å¼€å§‹å‘å‰æ•°ä¸è¶…è¿‡30ä¸ªå­—ç¬¦çš„ä½ç½®ï¼Œåªè¦æœ‰ä¸€ä¸ªæ˜¯ `1` å°±ç®—ä½œæ´»è·ƒã€‚\n\n---\n\n#### âœ… ç¬¬äºŒéƒ¨åˆ†ï¼šè·å–è¿‘30å¤©æ´»è·ƒ + æ‹¥æœ‰å…¨éƒ¨å¥–æ± é“å…·çš„ç©å®¶æ•°\n\né¦–å…ˆï¼Œæˆ‘ä»¬æå–å‡ºè¿‘30å¤©æ´»è·ƒçš„æ‰€æœ‰ç”¨æˆ·ï¼š\n\n```sql\nWITH active_users AS (\n  SELECT DISTINCT iuserid\n  FROM dws_argothek_oss_useractivity_df\n  WHERE iworldid = 255\n    AND statis_date BETWEEN 20250518 AND 20250617\n    AND iactivity REGEXP '1.{0,29}$'\n),\n```\n\nç„¶åä» `dwd_argothek_gearrecord_df` ä¸­é€‰å‡ºè¿™äº›ç”¨æˆ·æ‹¥æœ‰çš„å¥–æ± é“å…·ï¼Œå¹¶æŒ‰ç”¨æˆ·åˆ†ç»„ç»Ÿè®¡å…¶æ‹¥æœ‰çš„é“å…·ç§ç±»æ•°æ˜¯å¦ç­‰äºæ€»æ•°ï¼ˆ11ï¼‰ï¼š\n\n```sql\npool_items AS (\n  SELECT iuserid, COUNT(DISTINCT iGoodsId) AS item_count\n  FROM dwd_argothek_gearrecord_df\n  WHERE iGoodsId IN (\n    \"71d260ca-4bad-81f2-0298-44860341a7a6\",\n    \"48601754-442d-98cb-2109-3fb2075500ec\",\n    \"a9126263-439c-7be6-d668-52a6c0c0a36f\",\n    \"34ecc788-4034-71d2-a0ac-c398b8ecb2ae\",\n    \"56f98991-43f8-dcc8-189e-08b7ae6c42ad\",\n    \"8453f8ef-4c0b-46e2-8768-3e9e45c67a2c\",\n    \"06d90274-435f-3e32-9d57-26bc228ae2e5\",\n    \"8196dea4-4229-c951-13a9-088fb13b3512\",\n    \"3abc330f-444a-6dfd-5863-81856ba62624\",\n    \"041a43a4-46fe-dab7-c974-36bf91eab33d\",\n    \"5b863cb9-4e41-ec89-69ee-49a223d05ff1\"\n  )\n  GROUP BY iuserid\n)\nSELECT\n  (SELECT COUNT(*) FROM active_users) AS total_active_players,\n  COUNT(DISTINCT pu.iuserid) AS players_with_all_pool_items\nFROM pool_items pu\nWHERE pu.item_count = 11;\n```\n\n---\n\n### ğŸ§¾ **æœ€ç»ˆå®Œæ•´ SQL æŸ¥è¯¢å¦‚ä¸‹ï¼š**\n\n```sql\nWITH active_users AS (\n  SELECT DISTINCT iuserid\n  FROM dws_argothek_oss_useractivity_df\n  WHERE iworldid = 255\n    AND statis_date BETWEEN 20250518 AND 20250617\n    AND iactivity REGEXP '1.{0,29}$'\n),\npool_items AS (\n  SELECT iuserid, COUNT(DISTINCT iGoodsId) AS item_count\n  FROM dwd_argothek_gearrecord_df\n  WHERE iGoodsId IN (\n    \"71d260ca-4bad-81f2-0298-44860341a7a6\",\n    \"48601754-442d-98cb-2109-3fb2075500ec\",\n    \"a9126263-439c-7be6-d668-52a6c0c0a36f\",\n    \"34ecc788-4034-71d2-a0ac-c398b8ecb2ae\",\n    \"56f98991-43f8-dcc8-189e-08b7ae6c42ad\",\n    \"8453f8ef-4c0b-46e2-8768-3e9e45c67a2c\",\n    \"06d90274-435f-3e32-9d57-26bc228ae2e5\",\n    \"8196dea4-4229-c951-13a9-088fb13b3512\",\n    \"3abc330f-444a-6dfd-5863-81856ba62624\",\n    \"041a43a4-46fe-dab7-c974-36bf91eab33d\",\n    \"5b863cb9-4e41-ec89-69ee-49a223d05ff1\"\n  )\n  GROUP BY iuserid\n)\nSELECT\n  (SELECT COUNT(*) FROM active_users) AS total_active_players,\n  COUNT(DISTINCT pu.iuserid) AS players_with_all_pool_items\nFROM pool_items pu\nWHERE pu.item_count = 11;\n```\n\n---\n\n### âœ… è¾“å‡ºç»“æœè¯´æ˜ï¼š\n\n| total_active_players | players_with_all_pool_items |\n|----------------------|------------------------------|\n| 12345                | 123                          |\n\n- ç¬¬ä¸€åˆ—æ˜¯è¿‘30å¤©æ´»è·ƒç©å®¶æ•°\n- ç¬¬äºŒåˆ—æ˜¯åŒæ—¶æ‹¥æœ‰å¥–æ± æ‰€æœ‰é“å…·çš„æ´»è·ƒç©å®¶æ•°\n\n--- \n\nå¦‚æœä½ å¸Œæœ›æˆ‘è¿›ä¸€æ­¥ä¼˜åŒ–æ€§èƒ½æˆ–æ”¯æŒæ›´å¤æ‚çš„åœºæ™¯ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡è¿‘30å¤©æ´»è·ƒç©å®¶æ•°ï¼Œè¿‘30å¤©æ´»è·ƒä¸”åŒæ—¶æ‹¥æœ‰å¥–æ± æ‰€æœ‰é“å…·ç©å®¶æ•°\nè¾“å‡ºï¼šè¿‘30å¤©æ´»è·ƒç©å®¶æ•°ã€è¿‘30å¤©æ´»è·ƒä¸”åŒæ—¶æ‹¥æœ‰å¥–æ± æ‰€æœ‰é“å…·ç©å®¶æ•°\nè¡¥å……è¯´æ˜ï¼š\nå½“å‰æ—¥æœŸæ—¶é—´ï¼š'20250617'\nå…¶ä¸­å¥–æ± é“å…·idä¸ºï¼š\n71d260ca-4bad-81f2-0298-44860341a7a6\n48601754-442d-98cb-2109-3fb2075500ec\na9126263-439c-7be6-d668-52a6c0c0a36f\n34ecc788-4034-71d2-a0ac-c398b8ecb2ae\n56f98991-43f8-dcc8-189e-08b7ae6c42ad\n8453f8ef-4c0b-46e2-8768-3e9e45c67a2c\n06d90274-435f-3e32-9d57-26bc228ae2e5\n8196dea4-4229-c951-13a9-088fb13b3512\n3abc330f-444a-6dfd-5863-81856ba62624\n041a43a4-46fe-dab7-c974-36bf91eab33d\n5b863cb9-4e41-ec89-69ee-49a223d05ff1\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dwd_argothek_gearrecord_df` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `vgameappid` TEXT COMMENT 'appid',\n  `iareaid` TEXT COMMENT 'å¤§åŒºID',\n  `iuserid` TEXT COMMENT 'iuserid',\n  `vRoleID` TEXT COMMENT 'vRoleID',\n  `iGoodsType` TEXT COMMENT 'é“å…·ç±»å‹',\n  `iGoodsId` TEXT COMMENT 'é“å…·ID',\n  `iCount` BIGINT COMMENT 'é“å…·æ•°é‡',\n  `iCount1` BIGINT COMMENT 'é“å…·æ•°é‡ä¸”è®¢å•idä¸ä¸ºç©º',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™'\n);\nCREATE TABLE `dws_argothek_oss_useractivity_df` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `iworldid` BIGINT COMMENT 'å¤§åŒºID',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `igroup` BIGINT COMMENT 'æ˜¯å¦ä»˜è´¹',\n  `iactivity` TEXT COMMENT 'ç©å®¶ç™»é™†ä½å›¾,é¦–ä½ä¸º0,æœ€é•¿100ä½,1è¡¨ç¤ºå½“å¤©æ´»è·ƒ,0è¡¨ç¤ºå½“å¤©æœªæ´»è·ƒ',\n  `iregdate` BIGINT COMMENT 'æ³¨å†Œæ—¥æœŸ,è¿™é‡Œçš„æ³¨å†Œæ—¥æœŸæ˜¯é¦–æ¬¡æ´»è·ƒæ—¥æœŸ,å¦‚æœæ³¨å†Œæ•°æ®æœ‰å•ç‹¬æ—¥å¿—è¡¨,åˆ™å¿½ç•¥æ­¤å­—æ®µ',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `iregway` BIGINT COMMENT 'æ³¨å†Œæ¸ é“',\n  `vlastlogindate` TEXT COMMENT 'æœ€åç™»å½•æ—¥æœŸ'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nè¿™å¼ è¡¨çš„iworldid = 255ä»£è¡¨ç©å®¶ç²’åº¦ï¼Œ å¥–æ± é“å…·ç­›é€‰é€»è¾‘ï¼š\niGoodsId in (\n\"71d260ca-4bad-81f2-0298-44860341a7a6\",\n\"48601754-442d-98cb-2109-3fb2075500ec\",\n\"a9126263-439c-7be6-d668-52a6c0c0a36f\",\n\"34ecc788-4034-71d2-a0ac-c398b8ecb2ae\",\n\"56f98991-43f8-dcc8-189e-08b7ae6c42ad\",\n\"8453f8ef-4c0b-46e2-8768-3e9e45c67a2c\",\n\"06d90274-435f-3e32-9d57-26bc228ae2e5\",\n\"8196dea4-4229-c951-13a9-088fb13b3512\",\n\"3abc330f-444a-6dfd-5863-81856ba62624\",\n\"041a43a4-46fe-dab7-c974-36bf91eab33d\",\n\"5b863cb9-4e41-ec89-69ee-49a223d05ff1\"\n\n",
  "chosen": "WITH active_players AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_useractivity_df\n    WHERE statis_date = 20250617\n    AND iworldid = 255\n    AND RIGHT(iactivity, 30) REGEXP '1'\n),\nplayers_with_all_items AS (\n    SELECT iuserid\n    FROM dwd_argothek_gearrecord_df\n    WHERE dtstatdate = 20250617\n    AND iGoodsId IN (\n        '71d260ca-4bad-81f2-0298-44860341a7a6',\n        '48601754-442d-98cb-2109-3fb2075500ec',\n        'a9126263-439c-7be6-d668-52a6c0c0a36f',\n        '34ecc788-4034-71d2-a0ac-c398b8ecb2ae',\n        '56f98991-43f8-dcc8-189e-08b7ae6c42ad',\n        '8453f8ef-4c0b-46e2-8768-3e9e45c67a2c',\n        '06d90274-435f-3e32-9d57-26bc228ae2e5',\n        '8196dea4-4229-c951-13a9-088fb13b3512',\n        '3abc330f-444a-6dfd-5863-81856ba62624',\n        '041a43a4-46fe-dab7-c974-36bf91eab33d',\n        '5b863cb9-4e41-ec89-69ee-49a223d05ff1'\n    )\n    GROUP BY iuserid\n    HAVING COUNT(DISTINCT iGoodsId) = 11\n)\nSELECT \n    (SELECT COUNT(*) FROM active_players) AS active_players_30_days,\n    (SELECT COUNT(*) FROM active_players ap INNER JOIN players_with_all_items pwai ON ap.iuserid = pwai.iuserid) AS active_players_with_all_items",
  "rejected": "SELECT\n  COUNT(DISTINCT iuserid) AS active_users,\n  COUNT(DISTINCT CASE WHEN has_all_items = 1 THEN iuserid ELSE NULL END) AS active_and_having_all_items\nFROM (\n  SELECT\n    iuserid,\n    SUM(CASE WHEN iGoodsId IN ('71d260ca-4bad-81f2-0298-44860341a7a6', '48601754-442d-98cb-2109-3fb2075500ec', 'a9126263-439c-7be6-d668-52a6c0c0a36f', '34ecc788-4034-71d2-a0ac-c398b8ecb2ae', '56f98991-43f8-dcc8-189e-08b7ae6c42ad', '8453f8ef-4c0b-46e2-8768-3e9e45c67a2c', '06d90274-435f-3e32-9d57-26bc228ae2e5', '8196dea4-4229-c951-13a9-088fb13b3512', '3abc330f-444a-6dfd-5863-81856ba62624', '041a43a4-46fe-dab7-c974-36bf91eab33d', '5b863cb9-4e41-ec89-69ee-49a223d05ff1') THEN 1 ELSE 0 END) AS item_count,\n    CASE WHEN COUNT(DISTINCT iGoodsId) = 11 THEN 1 ELSE 0 END AS has_all_items\n  FROM dwd_argothek_gearrecord_df\n  WHERE dtstatdate BETWEEN '20250517' AND '20250617'\n  GROUP BY iuserid\n) AS subquery\nJOIN (\n  SELECT\n    iuserid,\n    MAX(statis_date) AS last_login_date\n  FROM dws_argothek_oss_useractivity_df\n  WHERE iworldid = 255\n  GROUP BY iuserid\n) AS user_activity\nON subquery.iuserid = user_activity.iuserid\nWHERE user_activity.last_login_date >= 20250517"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´5æœˆä»½æ´»è·ƒä½†2025å¹´6æœˆæœªæ´»è·ƒçš„qqå·ç åŒ…\nè¾“å‡º:ç”¨æˆ·suserid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\né™å®šdim_argothek_gplayerid2qqwxid_dfçš„æ—¥æœŸä¸º\"20250610\"\n\n",
  "chosen": "WITH may_active AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_login_di\n    WHERE statis_date >= 20250501 AND statis_date <= 20250531\n),\njune_active AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_login_di\n    WHERE statis_date >= 20250601 AND statis_date <= 20250630\n)\nSELECT DISTINCT dim.suserid\nFROM may_active ma\nLEFT JOIN june_active ja ON ma.iuserid = ja.iuserid\nJOIN dim_argothek_gplayerid2qqwxid_df dim ON ma.iuserid = dim.iuserid\nWHERE ja.iuserid IS NULL\nAND dim.dtstatdate = '20250610'\nAND dim.swxid_type = 'qq'\nORDER BY dim.suserid",
  "rejected": "SELECT\n  `T1`.`suserid`\nFROM `dim_argothek_gplayerid2qqwxid_df` AS `T1`\nINNER JOIN `dws_argothek_oss_login_di` AS `T2`\n  ON `T1`.`iuserid` = `T2`.`iuserid`\nWHERE\n  `T1`.`dtstatdate` = '20250610' AND `T1`.`cBitmap` LIKE '%1%' AND `T2`.`statis_date` = 20250501"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´5æœˆä»½æ´»è·ƒä½†2025å¹´6æœˆæœªæ´»è·ƒçš„qqå·ç åŒ…\nè¾“å‡º:ç”¨æˆ·suserid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\né™å®šdim_argothek_gplayerid2qqwxid_dfçš„æ—¥æœŸä¸º\"20250610\"\n\n",
  "chosen": "WITH may_active AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_login_di\n    WHERE statis_date >= 20250501 AND statis_date <= 20250531\n),\njune_active AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_login_di\n    WHERE statis_date >= 20250601 AND statis_date <= 20250630\n)\nSELECT DISTINCT dim.suserid\nFROM may_active ma\nLEFT JOIN june_active ja ON ma.iuserid = ja.iuserid\nJOIN dim_argothek_gplayerid2qqwxid_df dim ON ma.iuserid = dim.iuserid\nWHERE ja.iuserid IS NULL\nAND dim.dtstatdate = '20250610'\nAND dim.swxid_type = 'qq'\nORDER BY dim.suserid",
  "rejected": "æˆ‘éœ€è¦é€æ­¥åˆ†æè¿™ä¸ªé—®é¢˜å¹¶æ„å»ºSQLæŸ¥è¯¢ã€‚\n\né¦–å…ˆè®©æˆ‘ç†è§£éœ€æ±‚ï¼š\n1. æ‰¾å‡ºåœ¨2025å¹´5æœˆæ´»è·ƒçš„QQå·ç \n2. è¿™äº›QQå·ç åœ¨2025å¹´6æœˆæ²¡æœ‰æ´»è·ƒè®°å½•\n3. è¾“å‡ºç”¨æˆ·çš„suseridï¼ˆå³QQå·ç ï¼‰\n\nè®©æˆ‘åˆ†æä¸€ä¸‹è¡¨ç»“æ„ï¼š\n- `dws_argothek_oss_login_di`ï¼šç™»å½•æ—¥å¿—è¡¨ï¼ŒåŒ…å«ç”¨æˆ·ç™»å½•ä¿¡æ¯\n- `dim_argothek_gplayerid2qqwxid_df`ï¼šç”¨æˆ·ä¸QQ/å¾®ä¿¡æ˜ å°„è¡¨ï¼ŒåŒ…å«æ´»è·ƒä½å›¾ä¿¡æ¯\n\nå…³é”®å­—æ®µè¯´æ˜ï¼š\n- `cBitmap`ï¼šæ´»è·ƒä½å›¾ï¼Œè¡¨ç¤ºæŸå¤©æ˜¯å¦æ´»è·ƒ\n- `dtstatdate`ï¼šç»Ÿè®¡æ—¥æœŸ\n- `suserid`ï¼šå­˜å‚¨QQ/WX IDï¼ˆå¦‚æœç»‘å®šä¼˜å…ˆQQï¼‰\n- `swxid_type`ï¼šæ ‡è¯†æ˜¯å¾®ä¿¡è¿˜æ˜¯QQç±»å‹\n\næ ¹æ®å‚è€ƒä¿¡æ¯ï¼Œé™å®šdim_argothek_gplayerid2qqwxid_dfçš„æ—¥æœŸä¸º\"20250610\"ã€‚\n\nè®©æˆ‘æ„å»ºSQLé€»è¾‘ï¼š\n1. é¦–å…ˆè·å–2025å¹´5æœˆæ´»è·ƒçš„QQå·ç ï¼ˆé€šè¿‡æ´»è·ƒä½å›¾ï¼‰\n2. ç„¶åæ’é™¤è¿™äº›QQå·ç åœ¨2025å¹´6æœˆæ´»è·ƒçš„æƒ…å†µ\n3. ç”±äºå‚è€ƒä¿¡æ¯ä¸­æŒ‡å®šæ—¥æœŸä¸º\"20250610\"ï¼Œæˆ‘éœ€è¦ä»è¿™ä¸ªæ—¥æœŸå¼€å§‹å¤„ç†\n\n```sql\nSELECT DISTINCT t1.suserid\nFROM dim_argothek_gplayerid2qqwxid_df t1\nWHERE \n    -- 2025å¹´5æœˆæ´»è·ƒ\n    (SUBSTRING(t1.cBitmap, 1, 31) LIKE '%1%' OR SUBSTRING(t1.cBitmap, 1, 31) LIKE '%1%')\n    AND \n    -- 2025å¹´6æœˆä¸æ´»è·ƒ\n    (SUBSTRING(t1.cBitmap, 32, 30) NOT LIKE '%1%' OR SUBSTRING(t1.cBitmap, 32, 30) IS NULL)\n    AND \n    -- æŒ‡å®šæ—¥æœŸä¸º20250610\n    t1.dtstatdate = '20250610'\n    AND \n    -- ç¡®ä¿æ˜¯QQç±»å‹\n    t1.swxid_type = 'qq'\n```"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´5æœˆä»½æ´»è·ƒä½†2025å¹´6æœˆæœªæ´»è·ƒçš„qqå·ç åŒ…\nè¾“å‡º:ç”¨æˆ·suserid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\né™å®šdim_argothek_gplayerid2qqwxid_dfçš„æ—¥æœŸä¸º\"20250610\"\n\n",
  "chosen": "WITH may_active AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_login_di\n    WHERE statis_date >= 20250501 AND statis_date <= 20250531\n),\njune_active AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_login_di\n    WHERE statis_date >= 20250601 AND statis_date <= 20250630\n)\nSELECT DISTINCT dim.suserid\nFROM may_active ma\nLEFT JOIN june_active ja ON ma.iuserid = ja.iuserid\nJOIN dim_argothek_gplayerid2qqwxid_df dim ON ma.iuserid = dim.iuserid\nWHERE ja.iuserid IS NULL\nAND dim.dtstatdate = '20250610'\nAND dim.swxid_type = 'qq'\nORDER BY dim.suserid",
  "rejected": "æˆ‘éœ€è¦åˆ†æè¿™ä¸ªé—®é¢˜ï¼Œæ‰¾å‡ºåœ¨2025å¹´5æœˆæ´»è·ƒä½†åœ¨2025å¹´6æœˆæ²¡æœ‰æ´»è·ƒçš„QQå·ç ã€‚\n\nè®©æˆ‘é€æ­¥æ€è€ƒï¼š\n\n1. é¦–å…ˆæ˜ç¡®æ´»è·ƒçš„å®šä¹‰ï¼šæ´»è·ƒæ˜¯æŒ‡åœ¨æŸä¸€å¤©æœ‰ç™»å½•è®°å½•ï¼Œå³å­˜åœ¨ç™»å½•è®°å½•ã€‚\n2. æ ¹æ®dim_argothek_gplayerid2qqwxid_dfè¡¨çš„cBitmapå­—æ®µï¼Œå®ƒè¡¨ç¤ºæ´»è·ƒä½å›¾ã€‚æˆ‘ä»¬éœ€è¦åˆ¤æ–­ï¼š\n   - åœ¨2025å¹´5æœˆæ˜¯å¦æœ‰æ´»è·ƒè®°å½•ï¼ˆå³cBitmapä¸­å¯¹åº”5æœˆçš„ä½ä¸º1ï¼‰\n   - åœ¨2025å¹´6æœˆæ˜¯å¦æœ‰æ´»è·ƒè®°å½•ï¼ˆå³cBitmapä¸­å¯¹åº”6æœˆçš„ä½ä¸º1ï¼‰\n3. ä»dim_argothek_gplayerid2qqwxid_dfè¡¨ä¸­ç­›é€‰å‡ºdtstatdateä¸º\"20250610\"çš„æ•°æ®ä½œä¸ºåŸºå‡†æ•°æ®\n4. ç”±äºcBitmapæ˜¯æ´»è·ƒä½å›¾ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®å…·ä½“ä½æ¥åˆ¤æ–­æ˜¯å¦æ´»è·ƒ\n5. ç”±äºé¢˜ç›®è¦æ±‚çš„æ˜¯æ´»è·ƒçš„QQå·ç åŒ…ï¼Œè€Œsuseridå­—æ®µå°±æ˜¯å­˜å‚¨äº†QQå·çš„å­—æ®µ\n\nè®©æˆ‘ç¼–å†™SQLè¯­å¥ï¼š\n```sql\nSELECT DISTINCT t1.suserid\nFROM dim_argothek_gplayerid2qqwxid_df t1\nWHERE t1.dtstatdate = \"20250610\"\nAND (CASE \n    WHEN SUBSTR(t1.cBitmap, 1, 1) = '1' THEN 1\n    ELSE 0\nEND) = 1\nAND (CASE \n    WHEN SUBSTR(t1.cBitmap, 2, 1) = '1' THEN 1\n    ELSE 0\nEND) = 0\n```"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´5æœˆä»½æ´»è·ƒä½†2025å¹´6æœˆæœªæ´»è·ƒçš„qqå·ç åŒ…\nè¾“å‡º:ç”¨æˆ·suserid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\né™å®šdim_argothek_gplayerid2qqwxid_dfçš„æ—¥æœŸä¸º\"20250610\"\n\n",
  "chosen": "WITH may_active AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_login_di\n    WHERE statis_date >= 20250501 AND statis_date <= 20250531\n),\njune_active AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_login_di\n    WHERE statis_date >= 20250601 AND statis_date <= 20250630\n)\nSELECT DISTINCT dim.suserid\nFROM may_active ma\nLEFT JOIN june_active ja ON ma.iuserid = ja.iuserid\nJOIN dim_argothek_gplayerid2qqwxid_df dim ON ma.iuserid = dim.iuserid\nWHERE ja.iuserid IS NULL\nAND dim.dtstatdate = '20250610'\nAND dim.swxid_type = 'qq'\nORDER BY dim.suserid",
  "rejected": "SELECT\n  `suserid`\nFROM `dim_argothek_gplayerid2qqwxid_df`\nWHERE\n  `dtstatdate` = '20250610' AND `cBitmap` = '0'"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´5æœˆä»½æ´»è·ƒä½†2025å¹´6æœˆæœªæ´»è·ƒçš„qqå·ç åŒ…\nè¾“å‡º:ç”¨æˆ·suserid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\né™å®šdim_argothek_gplayerid2qqwxid_dfçš„æ—¥æœŸä¸º\"20250610\"\n\n",
  "chosen": "WITH may_active AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_login_di\n    WHERE statis_date >= 20250501 AND statis_date <= 20250531\n),\njune_active AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_login_di\n    WHERE statis_date >= 20250601 AND statis_date <= 20250630\n)\nSELECT DISTINCT dim.suserid\nFROM may_active ma\nLEFT JOIN june_active ja ON ma.iuserid = ja.iuserid\nJOIN dim_argothek_gplayerid2qqwxid_df dim ON ma.iuserid = dim.iuserid\nWHERE ja.iuserid IS NULL\nAND dim.dtstatdate = '20250610'\nAND dim.swxid_type = 'qq'\nORDER BY dim.suserid",
  "rejected": "æˆ‘ä»¬é€æ­¥åˆ†æè¿™ä¸ªé—®é¢˜ï¼Œå¹¶æ„é€ å‡ºæ­£ç¡®çš„ SQL æŸ¥è¯¢è¯­å¥ã€‚\n\n---\n\n### âœ… **ç¬¬ä¸€æ­¥ï¼šç†è§£éœ€æ±‚**\n\næˆ‘ä»¬è¦æ‰¾å‡ºï¼š\n- åœ¨ **2025å¹´5æœˆ** æ´»è·ƒï¼ˆå³åœ¨è¯¥æœˆæœ‰ç™»å½•è®°å½•ï¼‰ï¼Œ\n- ä½†åœ¨ **2025å¹´6æœˆ** æ²¡æœ‰æ´»è·ƒï¼ˆå³åœ¨è¯¥æœˆæ²¡æœ‰ç™»å½•è®°å½•ï¼‰çš„ QQ å·ç åŒ…ã€‚\n\næœ€ç»ˆè¾“å‡ºçš„æ˜¯ï¼š`suserid`\n\n---\n\n### âœ… **ç¬¬äºŒæ­¥ï¼šåˆ†æè¡¨ç»“æ„ä¸å­—æ®µå«ä¹‰**\n\n#### è¡¨ä¸€ï¼š`dws_argothek_oss_login_di`\nè¿™æ˜¯æ¯æ—¥ç™»å½•è¡Œä¸ºæ•°æ®è¡¨ï¼ŒåŒ…å«ä»¥ä¸‹å…³é”®å­—æ®µï¼š\n\n| å­—æ®µå       | å«ä¹‰             |\n|--------------|------------------|\n| `statis_date` | ç»Ÿè®¡æ—¶é—´ï¼ˆæ ¼å¼å¦‚ 20250501ï¼‰ |\n| `iuserid`     | ç”¨æˆ· ID          |\n| `ilogintime`  | ç™»å½•æ—¶é—´         |\n\n#### è¡¨äºŒï¼š`dim_argothek_gplayerid2qqwxid_df`\nè¿™æ˜¯ç”¨æˆ·å¯¹åº” QQ/å¾®ä¿¡ ID çš„æ˜ å°„è¡¨ï¼Œå…³é”®å­—æ®µå¦‚ä¸‹ï¼š\n\n| å­—æ®µå        | å«ä¹‰                                       |\n|---------------|--------------------------------------------|\n| `dtstatdate`  | ç»Ÿè®¡æ—¥æœŸ                                   |\n| `suserid`     | å­˜å‚¨çš„æ˜¯ QQ æˆ–å¾®ä¿¡ IDï¼ˆè‹¥ç»‘å®šåˆ™ä¼˜å…ˆä¸º QQï¼‰ |\n| `cBitmap`     | æ´»è·ƒä½å›¾ï¼Œç”¨äºåˆ¤æ–­æŸå¤©æ˜¯å¦æ´»è·ƒ             |\n\n---\n\n### âœ… **ç¬¬ä¸‰æ­¥ï¼šæ˜ç¡®ç­›é€‰æ¡ä»¶**\n\næˆ‘ä»¬éœ€è¦ä¸¤ä¸ªè¡¨è¿›è¡Œå…³è”ï¼š\n\n#### æ¡ä»¶1ï¼šæ‰¾å‡ºåœ¨ 2025 å¹´ 5 æœˆæ´»è·ƒçš„ç”¨æˆ·\n- ä» `dim_argothek_gplayerid2qqwxid_df` ä¸­ï¼Œæ ¹æ® `dtstatdate = '20250610'` è¿™ä¸ªæ—¥æœŸï¼ˆæ³¨æ„é¢˜ç›®ä¸­è¯´â€œé™å®š dim_argothek_gplayerid2qqwxid_df çš„æ—¥æœŸä¸º '20250610'â€ï¼‰\n- ç„¶åé€šè¿‡ `cBitmap` åˆ¤æ–­å…¶åœ¨ 2025 å¹´ 5 æœˆæ˜¯å¦æœ‰æ´»è·ƒè®°å½•ï¼ˆæ¯”å¦‚æŸä¸€ä½ä¸º 1ï¼‰\n\n#### æ¡ä»¶2ï¼šæ’é™¤åœ¨ 2025 å¹´ 6 æœˆæ´»è·ƒçš„ç”¨æˆ·\n- åŒæ ·åœ°ï¼Œä½¿ç”¨ `cBitmap` åˆ¤æ–­åœ¨ 2025 å¹´ 6 æœˆæ˜¯å¦æ´»è·ƒï¼ˆæ¯”å¦‚æŸä¸€ä½ä¸º 1ï¼‰\n\n---\n\n### âœ… **ç¬¬å››æ­¥ï¼šç¡®å®šå¦‚ä½•å¤„ç† cBitmap**\n\nå‡è®¾ `cBitmap` æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯ä¸€ä½ä»£è¡¨ä¸€å¤©æ˜¯å¦æ´»è·ƒã€‚ä¾‹å¦‚ï¼š\n```\ncBitmap = \"0000000000000000000000000000000000000000000000000000000000000000\"\n```\nä»å·¦å¾€å³æ•°ç¬¬ 1~31 ä½åˆ†åˆ«è¡¨ç¤º 2025 å¹´ 1 æœˆ 1 æ—¥ ~ 1 æœˆ 31 æ—¥ï¼Œç¬¬ 32~62 ä½è¡¨ç¤º 2025 å¹´ 2 æœˆ 1 æ—¥ ~ 2 æœˆ 28 æ—¥ï¼Œä»¥æ­¤ç±»æ¨ã€‚\n\næ‰€ä»¥è¦åˆ¤æ–­æŸä¸ªæœˆæ˜¯å¦æ´»è·ƒï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼æå–ä½ï¼š\n- 2025 å¹´ 5 æœˆå…± 31 å¤©ï¼Œå…¶èµ·å§‹ä½ç½®æ˜¯ `(5 - 1) * 31 = 124`ï¼Œç»“æŸä½ç½®æ˜¯ `124 + 31 = 155`\n- æ‰€ä»¥å– `SUBSTRING(cBitmap, 125, 31)` å³å¯è·å– 2025 å¹´ 5 æœˆçš„æ´»è·ƒæƒ…å†µ\n- ç±»ä¼¼åœ°ï¼Œ2025 å¹´ 6 æœˆæ˜¯ä» `156` å¼€å§‹çš„ 30 ä½ï¼š`SUBSTRING(cBitmap, 156, 30)`\n\næˆ‘ä»¬åªéœ€åˆ¤æ–­ï¼š\n- `SUBSTRING(cBitmap, 125, 31)` æ˜¯å¦å…¨ä¸º 0ï¼ˆæ— æ´»è·ƒï¼‰\n- `SUBSTRING(cBitmap, 156, 30)` æ˜¯å¦å…¨ä¸º 0ï¼ˆæ— æ´»è·ƒï¼‰\n\nä½†æ˜¯ MySQL ä¸æ”¯æŒç›´æ¥å¯¹å­—ç¬¦ä¸²åšä½è¿ç®—ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨å¦ä¸€ç§æ–¹æ³•ï¼š\n\n#### æ–¹æ³•ï¼šå°†ä½å›¾è½¬æ¢æˆæ•°å­—ï¼Œç„¶ååˆ¤æ–­æ˜¯å¦éé›¶\n\nå¦‚æœ `cBitmap` æ˜¯ä¸€ä¸ªæ•´å‹æˆ–è€…å¯ä»¥è½¬æ¢ä¸ºæ•´å‹çš„å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ï¼š\n```sql\nCAST(SUBSTRING(cBitmap, 125, 31) AS UNSIGNED)\n```\næ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ´»è·ƒã€‚\n\nä¸è¿‡ä¸ºäº†æ›´ç›´è§‚ã€é€šç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹æ–¹å¼ï¼š\n- å‡è®¾ `cBitmap` æ˜¯ 128 ä½çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼ˆå¦‚ `'0000000000000000000000000000000000000000000000000000000000000000'`ï¼‰ï¼Œæˆ‘ä»¬åªéœ€æå–å¯¹åº”æœˆä»½çš„éƒ¨åˆ†ï¼Œçœ‹æœ‰æ²¡æœ‰è‡³å°‘ä¸€ä¸ª '1'\n\n---\n\n### âœ… **ç¬¬äº”æ­¥ï¼šæ„é€  SQL æŸ¥è¯¢**\n\næˆ‘ä»¬å¸Œæœ›æ‰¾å‡ºï¼š\n- åœ¨ 2025 å¹´ 5 æœˆæ´»è·ƒï¼ˆå³ `cBitmap` å¯¹åº”ä½ä¸Šæœ‰ 1ï¼‰\n- åœ¨ 2025 å¹´ 6 æœˆæœªæ´»è·ƒï¼ˆå³ `cBitmap` å¯¹åº”ä½ä¸Šå…¨æ˜¯ 0ï¼‰\n\n#### SQL å®ç°é€»è¾‘å¦‚ä¸‹ï¼š\n\n```sql\nSELECT DISTINCT suserid\nFROM (\n    -- ç¬¬ä¸€æ­¥ï¼šé€‰å‡ºæ‰€æœ‰åœ¨ 20250610 æ—¥æœŸä¸‹çš„ç”¨æˆ·\n    SELECT \n        suserid,\n        cBitmap\n    FROM dim_argothek_gplayerid2qqwxid_df\n    WHERE dtstatdate = '20250610'\n) t1\nWHERE\n    -- 5æœˆæ´»è·ƒï¼šæ£€æŸ¥ç¬¬125~155ä½æ˜¯å¦å«æœ‰1\n    (CASE WHEN SUBSTRING(cBitmap, 125, 31) LIKE '%1%' THEN 1 ELSE 0 END) = 1\n    AND\n    -- 6æœˆæœªæ´»è·ƒï¼šæ£€æŸ¥ç¬¬156~185ä½æ˜¯å¦å…¨ä¸º0\n    (CASE WHEN SUBSTRING(cBitmap, 156, 30) LIKE '%1%' THEN 1 ELSE 0 END) = 0;\n```\n\n---\n\n### âœ… **ç¬¬å…­æ­¥ï¼šè§£é‡Šæ¯éƒ¨åˆ†ä½œç”¨**\n\n| éƒ¨åˆ† | åŠŸèƒ½è¯´æ˜ |\n|------|----------|\n| `SELECT suserid FROM dim_argothek_gplayerid2qqwxid_df WHERE dtstatdate = '20250610'` | è·å–å½“å‰æ—¥æœŸï¼ˆ20250610ï¼‰ä¸‹çš„æ‰€æœ‰ç”¨æˆ· |\n| `SUBSTRING(cBitmap, 125, 31)` | æå– 2025 å¹´ 5 æœˆçš„æ´»è·ƒä½å›¾ |\n| `LIKE '%1%'` | åˆ¤æ–­æ˜¯å¦åŒ…å«è‡³å°‘ä¸€ä¸ªæ´»è·ƒæ ‡è®° |\n| `SUBSTRING(cBitmap, 156, 30)` | æå– 2025 å¹´ 6 æœˆçš„æ´»è·ƒä½å›¾ |\n| `NOT EXISTS` æˆ– `!= 1` | æ’é™¤æ‰ 6 æœˆæ´»è·ƒçš„ç”¨æˆ· |\n\n---\n\n### âœ… **æœ€ç»ˆ SQL æŸ¥è¯¢è¯­å¥**\n\n```sql\nSELECT DISTINCT suserid\nFROM (\n    SELECT \n        suserid,\n        cBitmap\n    FROM dim_argothek_gplayerid2qqwxid_df\n    WHERE dtstatdate = '20250610'\n) t1\nWHERE\n    (CASE WHEN SUBSTRING(cBitmap, 125, 31) LIKE '%1%' THEN 1 ELSE 0 END) = 1\n    AND\n    (CASE WHEN SUBSTRING(cBitmap, 156, 30) LIKE '%1%' THEN 1 ELSE 0 END) = 0;\n```\n\n--- \n\nå¦‚æœ‰æ›´å¤šç»†èŠ‚ï¼ˆæ¯”å¦‚ `cBitmap` å…·ä½“æ ¼å¼ï¼‰ï¼Œæ¬¢è¿è¡¥å……ï¼Œæˆ‘å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ï¼"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´5æœˆä»½æ´»è·ƒä½†2025å¹´6æœˆæœªæ´»è·ƒçš„qqå·ç åŒ…\nè¾“å‡º:ç”¨æˆ·suserid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\né™å®šdim_argothek_gplayerid2qqwxid_dfçš„æ—¥æœŸä¸º\"20250610\"\n\n",
  "chosen": "WITH may_active AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_login_di\n    WHERE statis_date >= 20250501 AND statis_date <= 20250531\n),\njune_active AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_login_di\n    WHERE statis_date >= 20250601 AND statis_date <= 20250630\n)\nSELECT DISTINCT dim.suserid\nFROM may_active ma\nLEFT JOIN june_active ja ON ma.iuserid = ja.iuserid\nJOIN dim_argothek_gplayerid2qqwxid_df dim ON ma.iuserid = dim.iuserid\nWHERE ja.iuserid IS NULL\nAND dim.dtstatdate = '20250610'\nAND dim.swxid_type = 'qq'\nORDER BY dim.suserid",
  "rejected": "æˆ‘éœ€è¦é€æ­¥åˆ†æè¿™ä¸ªé—®é¢˜å¹¶ç¼–å†™SQLæŸ¥è¯¢è¯­å¥ã€‚\n\né¦–å…ˆï¼Œè®©æˆ‘ç†è§£ä¸€ä¸‹éœ€æ±‚ï¼š\n1. æ‰¾å‡ºåœ¨2025å¹´5æœˆä»½æ´»è·ƒçš„ç”¨æˆ·\n2. è¿™äº›ç”¨æˆ·åœ¨2025å¹´6æœˆæ²¡æœ‰æ´»è·ƒ\n3. è¿”å›è¿™äº›ç”¨æˆ·çš„suseridï¼ˆå³QQå·ç ï¼‰\n\næ ¹æ®æä¾›çš„è¡¨ç»“æ„å’Œå‚è€ƒä¿¡æ¯ï¼š\n- dim_argothek_gplayerid2qqwxid_df è¡¨åŒ…å«äº†ç”¨æˆ·æ´»è·ƒä¿¡æ¯å’Œå¯¹åº”çš„suserid\n- dtstatdateå­—æ®µè¡¨ç¤ºç»Ÿè®¡æ—¥æœŸï¼Œå‚è€ƒä¿¡æ¯ä¸­æåˆ°é™å®šä¸º\"20250610\"\n- cBitmapå­—æ®µè¡¨ç¤ºæ´»è·ƒä½å›¾ï¼Œå…¶ä¸­ç¬¬1ä¸ªå­—èŠ‚ä»£è¡¨5æœˆï¼Œç¬¬2ä¸ªå­—èŠ‚ä»£è¡¨6æœˆ\n\nè®©æˆ‘åˆ†æä¸€ä¸‹å¦‚ä½•æå–æ´»è·ƒä¿¡æ¯ï¼š\n- ä»dtstatdate = \"20250610\"çš„è®°å½•ä¸­ï¼ŒcBitmapçš„ç¬¬1ä¸ªå­—èŠ‚è¡¨ç¤º5æœˆæ´»è·ƒæƒ…å†µ\n- cBitmapçš„ç¬¬2ä¸ªå­—èŠ‚è¡¨ç¤º6æœˆæ´»è·ƒæƒ…å†µ\n- éœ€è¦åˆ¤æ–­ç¬¬1ä¸ªå­—èŠ‚çš„æŸä¸€ä½æ˜¯å¦ä¸º1ï¼ˆè¡¨ç¤º5æœˆæ´»è·ƒï¼‰\n- åŒæ—¶ç¬¬2ä¸ªå­—èŠ‚çš„å¯¹åº”ä½ç½®å¿…é¡»æ˜¯0ï¼ˆè¡¨ç¤º6æœˆä¸æ´»è·ƒï¼‰\n\nç”±äºcBitmapæ˜¯å­—ç¬¦ä¸²æ ¼å¼ï¼Œæˆ‘éœ€è¦é€šè¿‡ä½è¿ç®—æ¥åˆ¤æ–­ã€‚ä¸è¿‡è€ƒè™‘åˆ°å®é™…åœºæ™¯ï¼Œè¿™é‡Œåº”è¯¥æ˜¯æŒ‰ä½å­˜å‚¨çš„ï¼Œéœ€è¦å°†cBitmapè½¬æ¢æˆäºŒè¿›åˆ¶è¿›è¡Œå¤„ç†ã€‚\n\nè®©æˆ‘å†™SQLè¯­å¥ï¼š\n\n```sql\nSELECT DISTINCT suserid\nFROM dim_argothek_gplayerid2qqwxid_df\nWHERE dtstatdate = '20250610'\nAND SUBSTRING(cBitmap, 1, 1) != '0' \nAND SUBSTRING(cBitmap, 2, 1) = '0'\n```\n\nä½†æ˜¯è¿™ä¸ªæ–¹æ³•å¯èƒ½ä¸å¤Ÿç²¾ç¡®ï¼Œå› ä¸ºcBitmapä¸­çš„æ¯ä¸€ä½éƒ½ä»£è¡¨ä¸€ä¸ªæ—¥æœŸçš„æ´»è·ƒçŠ¶æ€ã€‚è®©æˆ‘é‡æ–°æ€è€ƒï¼š\n\nå®é™…ä¸Šåº”è¯¥æŒ‰ç…§ä½æ¥åˆ¤æ–­ï¼Œæ¯”å¦‚ï¼š\n- å¦‚æœcBitmapçš„ç¬¬1ä¸ªå­—ç¬¦æ˜¯'1'ï¼Œè¯´æ˜5æœˆ1æ—¥æ´»è·ƒ\n- å¦‚æœcBitmapçš„ç¬¬2ä¸ªå­—ç¬¦æ˜¯'0'ï¼Œè¯´æ˜6æœˆ1æ—¥ä¸æ´»è·ƒ\n\nè€ƒè™‘åˆ°å®é™…ä¸šåŠ¡é€»è¾‘ï¼Œæˆ‘ä»¬å‡è®¾cBitmapçš„æ¯ä¸ªå­—ç¬¦ä»£è¡¨ä¸€å¤©çš„æ´»è·ƒçŠ¶æ€ï¼Œé‚£ä¹ˆï¼š\n\n```sql\nSELECT DISTINCT suserid\nFROM dim_argothek_gplayerid2qqwxid_df\nWHERE dtstatdate = '20250610'\nAND (\n    (SUBSTRING(cBitmap, 1, 1) != '0') OR \n    (SUBSTRING(cBitmap, 2, 1) != '0') OR \n    (SUBSTRING(cBitmap, 3, 1) != '0') OR \n    (SUBSTRING(cBitmap, 4, 1) != '0') OR \n    (SUBSTRING(cBitmap, 5, 1) != '0') OR \n    (SUBSTRING(cBitmap, 6, 1) != '0') OR \n    (SUBSTRING(cBitmap, 7, 1) != '0') OR \n    (SUBSTRING(cBitmap, 8, 1) != '0') OR \n    (SUBSTRING(cBitmap, 9, 1) != '0') OR \n    (SUBSTRING(cBitmap, 10, 1) != '0') OR \n    (SUBSTRING(cBitmap, 11, 1) != '0') OR \n    (SUBSTRING(cBitmap, 12, 1) != '0') OR \n    (SUBSTRING(cBitmap, 13, 1) != '0') OR \n    (SUBSTRING(cBitmap, 14, 1) != '0') OR \n    (SUBSTRING(cBitmap, 15, 1) != '0') OR \n    (SUBSTRING(cBitmap, 16, 1) != '0') OR \n    (SUBSTRING(cBitmap, 17, 1) != '0') OR \n    (SUBSTRING(cBitmap, 18, 1) != '0') OR \n    (SUBSTRING(cBitmap, 19, 1) != '0') OR \n    (SUBSTRING(cBitmap, 20, 1) != '0') OR \n    (SUBSTRING(cBitmap, 21, 1) != '0') OR \n    (SUBSTRING(cBitmap, 22, 1) != '0') OR \n    (SUBSTRING(cBitmap, 23, 1) != '0') OR \n    (SUBSTRING(cBitmap, 24, 1) != '0') OR \n    (SUBSTRING(cBitmap, 25, 1) != '0') OR \n    (SUBSTRING(cBitmap, 26, 1) != '0') OR \n    (SUBSTRING(cBitmap, 27, 1) != '0') OR \n    (SUBSTRING(cBitmap, 28, 1) != '0') OR \n    (SUBSTRING(cBitmap, 29, 1) != '0') OR \n    (SUBSTRING(cBitmap, 30, 1) != '0') OR \n    (SUBSTRING(cBitmap, 31, 1) != '0')\n)\nAND NOT (\n    (SUBSTRING(cBitmap, 32, 1) != '0') OR \n    (SUBSTRING(cBitmap, 33, 1) != '0') OR \n    (SUBSTRING(cBitmap, 34, 1) != '0') OR \n    (SUBSTRING(cBitmap, 35, 1) != '0') OR \n    (SUBSTRING(cBitmap, 36, 1) != '0') OR \n    (SUBSTRING(cBitmap, 37, 1) != '0') OR \n    (SUBSTRING(cBitmap, 38, 1) != '0') OR \n    (SUBSTRING(cBitmap, 39, 1) != '0') OR \n    (SUBSTRING(cBitmap, 40, 1) != '0') OR \n    (SUBSTRING(cBitmap, 41, 1) != '0') OR \n    (SUBSTRING(cBitmap, 42, 1) != '0') OR \n    (SUBSTRING(cBitmap, 43, 1) != '0') OR \n    (SUBSTRING(cBitmap, 44, 1) != '0') OR \n    (SUBSTRING(cBitmap, 45, 1) != '0') OR \n    (SUBSTRING(cBitmap, 46, 1) != '0') OR \n    (SUBSTRING(cBitmap, 47, 1) != '0') OR \n    (SUBSTRING(cBitmap, 48, 1) != '0') OR \n    (SUBSTRING(cBitmap, 49, 1) != '0') OR \n    (SUBSTRING(cBitmap, 50, 1) != '0') OR \n    (SUBSTRING(cBitmap, 51, 1) != '0') OR \n    (SUBSTRING(cBitmap, 52, 1) != '0') OR \n    (SUBSTRING(cBitmap, 53, 1) != '0') OR \n    (SUBSTRING(cBitmap, 54, 1) != '0') OR \n    (SUBSTRING(cBitmap, 55, 1) != '0') OR \n    (SUBSTRING(cBitmap, 56, 1) != '0') OR \n    (SUBSTRING(cBitmap, 57, 1) != '0') OR \n    (SUBSTRING(cBitmap, 58, 1) != '0') OR \n    (SUBSTRING(cBitmap, 59, 1) != '0') OR \n    (SUBSTRING(cBitmap, 60, 1) != '0') OR \n    (SUBSTRING(cBitmap, 61, 1) != '0') OR \n    (SUBSTRING(cBitmap, 62, 1) != '0') OR \n    (SUBSTRING(cBitmap, 63, 1) != '0') OR \n    (SUBSTRING(cBitmap, 64, 1) != '0')\n)\n```"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´5æœˆå‹‡è€…ç›Ÿçº¦æµå¤±ç”¨æˆ·ä¸­ï¼Œæµå‘å³¡è°·PCçš„ç©å®¶gplayerid\nè¾“å‡ºï¼šç©å®¶gplayerid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_useractivity_df` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `iworldid` BIGINT COMMENT 'å¤§åŒºID',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `igroup` BIGINT COMMENT 'æ˜¯å¦ä»˜è´¹',\n  `iactivity` TEXT COMMENT 'ç©å®¶ç™»é™†ä½å›¾,é¦–ä½ä¸º0,æœ€é•¿100ä½,1è¡¨ç¤ºå½“å¤©æ´»è·ƒ,0è¡¨ç¤ºå½“å¤©æœªæ´»è·ƒ',\n  `iregdate` BIGINT COMMENT 'æ³¨å†Œæ—¥æœŸ,è¿™é‡Œçš„æ³¨å†Œæ—¥æœŸæ˜¯é¦–æ¬¡æ´»è·ƒæ—¥æœŸ,å¦‚æœæ³¨å†Œæ•°æ®æœ‰å•ç‹¬æ—¥å¿—è¡¨,åˆ™å¿½ç•¥æ­¤å­—æ®µ',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `iregway` BIGINT COMMENT 'æ³¨å†Œæ¸ é“',\n  `vlastlogindate` TEXT COMMENT 'æœ€åç™»å½•æ—¥æœŸ'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹:QQå·æˆ–è€…å¾®ä¿¡',\n  `suserid` TEXT COMMENT 'å¸å·',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹:qq wxid playerid',\n  `sgamecode` TEXT COMMENT 'ä¸šåŠ¡',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚æšä¸¾å€¼ä¸ºAndroid/ iOSï¼Œå–æ±‡æ€»æ—¶å–-100',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `sgameparam` TEXT COMMENT 'åœºæ¬¡',\n  `schannel` TEXT COMMENT 'ä¸å¯ç”¨å­—æ®µï¼Œç”¨æˆ·å¯ä»¥å¿½ç•¥',\n  `sip` TEXT COMMENT 'å®é™…ä¸Šæ˜¯å½“æ—¥ç™»å½•çš„æœ€å°æ—¶é—´æˆ³ï¼Œå³æœ€æ—©ç™»å½•æ—¶é—´',\n  `sclientver` TEXT COMMENT 'å®¢æˆ·ç«¯ç‰ˆæœ¬',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚ä¸å¯ç”¨',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚ä¸å¯ç”¨',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ¬¡æ•°',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ—¶é—´'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nsgamecode = \"initiatived\" -- ç­›é€‰å³¡è°·æ¸¸æˆ\nand itimes >= 1 -- æ´»è·ƒç”¨æˆ·æ¡ä»¶\nand saccounttype = \"-100\" -- è´¦å·ä½“ç³»ï¼Œå–-100è¡¨ç¤ºæ±‡æ€»\nand suseridtype in (\"qq\", \"wxid\") -- è´¦å·ç±»å‹ï¼Œå–qqæˆ–wxid\nand splattype = \"PC\" -- å³¡è°·ç«¯æ¸¸ç©å®¶\nand splat = \"-100\" -- å†™æ­»ä¸º-100\n5æœˆæµå¤±ï¼šé™å®šINSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),1,31),'1') = 0 AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),32,31),'1') > 0\nå–20250608çš„æ•°æ®åšè´¦å·è½¬æ¢\n\n",
  "chosen": "SELECT DISTINCT churned.iuserid AS gplayerid\nFROM (\n    SELECT iuserid\n    FROM dws_argothek_oss_useractivity_df \n    WHERE statis_date = 20250531\n    AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),1,31),'1') = 0 \n    AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),32,31),'1') > 0\n) churned\nWHERE EXISTS (\n    SELECT 1\n    FROM dim_argothek_gplayerid2qqwxid_df a\n    JOIN dws_mgamejp_login_user_activity_di p ON a.suserid = p.suserid\n    WHERE a.iuserid = churned.iuserid\n    AND a.dtstatdate = '20250608'\n    AND p.sgamecode = 'initiatived'\n    AND p.saccounttype = '-100'\n    AND p.suseridtype IN ('qq','wxid')\n    AND p.splattype IN ('-100','PC')\n    AND p.splat = '-100'\n    AND p.dtstatdate BETWEEN 20250501 AND 20250531\n    AND p.itimes >= 1\n)",
  "rejected": "SELECT DISTINCT\n  `T1`.`suserid`\nFROM `dws_mgamejp_login_user_activity_di` AS `T1`\nINNER JOIN `dim_argothek_gplayerid2qqwxid_df` AS `T2`\n  ON `T1`.`suserid` = `T2`.`suserid`\nWHERE\n  `T1`.`sgamecode` = 'initiatived'\n  AND `T1`.`splattype` = 'PC'\n  AND `T1`.`splat` = '-100'\n  AND `T1`.`saccounttype` = '-100'\n  AND `T1`.`suseridtype` IN ('qq', 'wxid')\n  AND `T1`.`dtstatdate` = 20250608\n  AND `T2`.`dtstatdate` = '20250608'\n  AND `T2`.`vGameAppid` = '1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´5æœˆå‹‡è€…ç›Ÿçº¦æµå¤±ç”¨æˆ·ä¸­ï¼Œæµå‘å³¡è°·PCçš„ç©å®¶gplayerid\nè¾“å‡ºï¼šç©å®¶gplayerid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_useractivity_df` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `iworldid` BIGINT COMMENT 'å¤§åŒºID',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `igroup` BIGINT COMMENT 'æ˜¯å¦ä»˜è´¹',\n  `iactivity` TEXT COMMENT 'ç©å®¶ç™»é™†ä½å›¾,é¦–ä½ä¸º0,æœ€é•¿100ä½,1è¡¨ç¤ºå½“å¤©æ´»è·ƒ,0è¡¨ç¤ºå½“å¤©æœªæ´»è·ƒ',\n  `iregdate` BIGINT COMMENT 'æ³¨å†Œæ—¥æœŸ,è¿™é‡Œçš„æ³¨å†Œæ—¥æœŸæ˜¯é¦–æ¬¡æ´»è·ƒæ—¥æœŸ,å¦‚æœæ³¨å†Œæ•°æ®æœ‰å•ç‹¬æ—¥å¿—è¡¨,åˆ™å¿½ç•¥æ­¤å­—æ®µ',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `iregway` BIGINT COMMENT 'æ³¨å†Œæ¸ é“',\n  `vlastlogindate` TEXT COMMENT 'æœ€åç™»å½•æ—¥æœŸ'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹:QQå·æˆ–è€…å¾®ä¿¡',\n  `suserid` TEXT COMMENT 'å¸å·',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹:qq wxid playerid',\n  `sgamecode` TEXT COMMENT 'ä¸šåŠ¡',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚æšä¸¾å€¼ä¸ºAndroid/ iOSï¼Œå–æ±‡æ€»æ—¶å–-100',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `sgameparam` TEXT COMMENT 'åœºæ¬¡',\n  `schannel` TEXT COMMENT 'ä¸å¯ç”¨å­—æ®µï¼Œç”¨æˆ·å¯ä»¥å¿½ç•¥',\n  `sip` TEXT COMMENT 'å®é™…ä¸Šæ˜¯å½“æ—¥ç™»å½•çš„æœ€å°æ—¶é—´æˆ³ï¼Œå³æœ€æ—©ç™»å½•æ—¶é—´',\n  `sclientver` TEXT COMMENT 'å®¢æˆ·ç«¯ç‰ˆæœ¬',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚ä¸å¯ç”¨',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚ä¸å¯ç”¨',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ¬¡æ•°',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ—¶é—´'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nsgamecode = \"initiatived\" -- ç­›é€‰å³¡è°·æ¸¸æˆ\nand itimes >= 1 -- æ´»è·ƒç”¨æˆ·æ¡ä»¶\nand saccounttype = \"-100\" -- è´¦å·ä½“ç³»ï¼Œå–-100è¡¨ç¤ºæ±‡æ€»\nand suseridtype in (\"qq\", \"wxid\") -- è´¦å·ç±»å‹ï¼Œå–qqæˆ–wxid\nand splattype = \"PC\" -- å³¡è°·ç«¯æ¸¸ç©å®¶\nand splat = \"-100\" -- å†™æ­»ä¸º-100\n5æœˆæµå¤±ï¼šé™å®šINSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),1,31),'1') = 0 AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),32,31),'1') > 0\nå–20250608çš„æ•°æ®åšè´¦å·è½¬æ¢\n\n",
  "chosen": "SELECT DISTINCT churned.iuserid AS gplayerid\nFROM (\n    SELECT iuserid\n    FROM dws_argothek_oss_useractivity_df \n    WHERE statis_date = 20250531\n    AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),1,31),'1') = 0 \n    AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),32,31),'1') > 0\n) churned\nWHERE EXISTS (\n    SELECT 1\n    FROM dim_argothek_gplayerid2qqwxid_df a\n    JOIN dws_mgamejp_login_user_activity_di p ON a.suserid = p.suserid\n    WHERE a.iuserid = churned.iuserid\n    AND a.dtstatdate = '20250608'\n    AND p.sgamecode = 'initiatived'\n    AND p.saccounttype = '-100'\n    AND p.suseridtype IN ('qq','wxid')\n    AND p.splattype IN ('-100','PC')\n    AND p.splat = '-100'\n    AND p.dtstatdate BETWEEN 20250501 AND 20250531\n    AND p.itimes >= 1\n)",
  "rejected": "SELECT\n  `T`.`suserid`\nFROM `dws_mgamejp_login_user_activity_di` AS `T`\nWHERE\n  `T`.`sgamecode` = 'initiatived'\n  AND `T`.`splattype` = 'PC'\n  AND `T`.`splat` = '-100'\n  AND `T`.`suseridtype` IN ('qq', 'wxid')\n  AND `T`.`saccounttype` = '-100'\n  AND `T`.`itimes` >= 1\n  AND (\n    INSTR(\n      SUBSTR(\n        REVERSE(RPAD(`T`.`iactivity`, 128, '0')),\n        1,\n        31\n      ),\n      '1'\n    ) = 0\n    AND INSTR(\n      SUBSTR(\n        REVERSE(RPAD(`T`.`iactivity`, 128, '0')),\n        32,\n        31\n      ),\n      '1'\n    ) > 0\n  )\n  AND `T`.`dtstatdate` = 20250608"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´5æœˆå‹‡è€…ç›Ÿçº¦æµå¤±ç”¨æˆ·ä¸­ï¼Œæµå‘å³¡è°·PCçš„ç©å®¶gplayerid\nè¾“å‡ºï¼šç©å®¶gplayerid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_useractivity_df` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `iworldid` BIGINT COMMENT 'å¤§åŒºID',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `igroup` BIGINT COMMENT 'æ˜¯å¦ä»˜è´¹',\n  `iactivity` TEXT COMMENT 'ç©å®¶ç™»é™†ä½å›¾,é¦–ä½ä¸º0,æœ€é•¿100ä½,1è¡¨ç¤ºå½“å¤©æ´»è·ƒ,0è¡¨ç¤ºå½“å¤©æœªæ´»è·ƒ',\n  `iregdate` BIGINT COMMENT 'æ³¨å†Œæ—¥æœŸ,è¿™é‡Œçš„æ³¨å†Œæ—¥æœŸæ˜¯é¦–æ¬¡æ´»è·ƒæ—¥æœŸ,å¦‚æœæ³¨å†Œæ•°æ®æœ‰å•ç‹¬æ—¥å¿—è¡¨,åˆ™å¿½ç•¥æ­¤å­—æ®µ',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `iregway` BIGINT COMMENT 'æ³¨å†Œæ¸ é“',\n  `vlastlogindate` TEXT COMMENT 'æœ€åç™»å½•æ—¥æœŸ'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹:QQå·æˆ–è€…å¾®ä¿¡',\n  `suserid` TEXT COMMENT 'å¸å·',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹:qq wxid playerid',\n  `sgamecode` TEXT COMMENT 'ä¸šåŠ¡',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚æšä¸¾å€¼ä¸ºAndroid/ iOSï¼Œå–æ±‡æ€»æ—¶å–-100',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `sgameparam` TEXT COMMENT 'åœºæ¬¡',\n  `schannel` TEXT COMMENT 'ä¸å¯ç”¨å­—æ®µï¼Œç”¨æˆ·å¯ä»¥å¿½ç•¥',\n  `sip` TEXT COMMENT 'å®é™…ä¸Šæ˜¯å½“æ—¥ç™»å½•çš„æœ€å°æ—¶é—´æˆ³ï¼Œå³æœ€æ—©ç™»å½•æ—¶é—´',\n  `sclientver` TEXT COMMENT 'å®¢æˆ·ç«¯ç‰ˆæœ¬',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚ä¸å¯ç”¨',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚ä¸å¯ç”¨',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ¬¡æ•°',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ—¶é—´'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nsgamecode = \"initiatived\" -- ç­›é€‰å³¡è°·æ¸¸æˆ\nand itimes >= 1 -- æ´»è·ƒç”¨æˆ·æ¡ä»¶\nand saccounttype = \"-100\" -- è´¦å·ä½“ç³»ï¼Œå–-100è¡¨ç¤ºæ±‡æ€»\nand suseridtype in (\"qq\", \"wxid\") -- è´¦å·ç±»å‹ï¼Œå–qqæˆ–wxid\nand splattype = \"PC\" -- å³¡è°·ç«¯æ¸¸ç©å®¶\nand splat = \"-100\" -- å†™æ­»ä¸º-100\n5æœˆæµå¤±ï¼šé™å®šINSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),1,31),'1') = 0 AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),32,31),'1') > 0\nå–20250608çš„æ•°æ®åšè´¦å·è½¬æ¢\n\n",
  "chosen": "SELECT DISTINCT churned.iuserid AS gplayerid\nFROM (\n    SELECT iuserid\n    FROM dws_argothek_oss_useractivity_df \n    WHERE statis_date = 20250531\n    AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),1,31),'1') = 0 \n    AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),32,31),'1') > 0\n) churned\nWHERE EXISTS (\n    SELECT 1\n    FROM dim_argothek_gplayerid2qqwxid_df a\n    JOIN dws_mgamejp_login_user_activity_di p ON a.suserid = p.suserid\n    WHERE a.iuserid = churned.iuserid\n    AND a.dtstatdate = '20250608'\n    AND p.sgamecode = 'initiatived'\n    AND p.saccounttype = '-100'\n    AND p.suseridtype IN ('qq','wxid')\n    AND p.splattype IN ('-100','PC')\n    AND p.splat = '-100'\n    AND p.dtstatdate BETWEEN 20250501 AND 20250531\n    AND p.itimes >= 1\n)",
  "rejected": "æˆ‘ä»¬é€æ­¥åˆ†æå¹¶æ„å»ºSQLæŸ¥è¯¢è¯­å¥æ¥æ»¡è¶³ç”¨æˆ·éœ€æ±‚ï¼š\n\n---\n\n### ğŸ§  **ä¸€ã€æ˜ç¡®ç”¨æˆ·é—®é¢˜**\n\næˆ‘ä»¬éœ€è¦ï¼š\n> ç»Ÿè®¡ **2025å¹´5æœˆå‹‡è€…ç›Ÿçº¦æµå¤±ç”¨æˆ·ä¸­**ï¼Œæµå‘ **å³¡è°·PC** çš„ç©å®¶ `gplayerid`\n\n#### âœ… å…³é”®ä¿¡æ¯æå–ï¼š\n- æ—¶é—´èŒƒå›´ï¼š2025å¹´5æœˆï¼ˆæ³¨æ„æ˜¯â€œæµå¤±â€ï¼‰\n- æ¸¸æˆåç§°ï¼šå‹‡è€…ç›Ÿçº¦ï¼ˆå¯¹åº” `sgamecode = 'initiatived'`ï¼‰\n- å¹³å°ç±»å‹ï¼šå³¡è°·PCï¼ˆ`splattype = 'PC'`, `splat = '-100'`ï¼‰\n- ç”¨æˆ·çŠ¶æ€ï¼šæµå¤±ç”¨æˆ·ï¼ˆå³åœ¨5æœˆå†…æœªæ´»è·ƒï¼Œä½†ä¹‹å‰æœ‰æ´»è·ƒï¼‰\n- è¾“å‡ºå­—æ®µï¼š`gplayerid`ï¼ˆå³ `suserid`ï¼‰\n\n---\n\n### ğŸ“Š **äºŒã€ç†è§£è¡¨ç»“æ„ä¸å…³è”é€»è¾‘**\n\n#### 1. è¡¨ `dws_mgamejp_login_user_activity_di`\nè¿™æ˜¯æ ¸å¿ƒæ´»è·ƒåº¦ç»Ÿè®¡è¡¨ï¼ŒåŒ…å«ä»¥ä¸‹å…³é”®å­—æ®µï¼š\n| å­—æ®µå         | å«ä¹‰                     |\n|----------------|--------------------------|\n| `suserid`      | ç©å®¶è´¦å·ï¼ˆå¯èƒ½æ˜¯QQ/WXï¼‰   |\n| `suseridtype`  | è´¦å·ç±»å‹ï¼ˆqq / wxidï¼‰     |\n| `sgamecode`    | æ¸¸æˆç¼–ç                  |\n| `splattype`    | å¹³å°ç±»å‹ï¼ˆå¦‚ PCï¼‰        |\n| `splat`        | å°å¹³å°æ ‡è¯†               |\n| `itimes`       | ç™»å½•æ¬¡æ•°                 |\n\nâœ… è¿™å¼ è¡¨å¯ä»¥ç­›é€‰å‡ºç¬¦åˆæ¡ä»¶çš„æ´»è·ƒç”¨æˆ·ã€‚\n\n#### 2. è¡¨ `dws_argothek_oss_useractivity_df`\nè¿™å¼ è¡¨è®°å½•äº†ç©å®¶æ´»åŠ¨ä½å›¾ï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦æµå¤±ã€‚\n| å­—æ®µå         | å«ä¹‰                     |\n|----------------|--------------------------|\n| `iactivity`    | ç©å®¶æ´»è·ƒä½å›¾             |\n| `iregdate`     | æ³¨å†Œæ—¥æœŸï¼ˆé¦–æ¬¡æ´»è·ƒï¼‰     |\n\nâœ… åˆ¤æ–­æ˜¯å¦åœ¨5æœˆæµå¤±çš„å…³é”®å­—æ®µæ˜¯ `iactivity` å’Œ `iregdate`ã€‚\n\n#### 3. è¡¨ `dim_argothek_gplayerid2qqwxid_df`\nç”¨æ¥åšè´¦å·æ˜ å°„è½¬æ¢ï¼ŒæŠŠ `suserid` æ˜ å°„æˆ `gplayerid`ã€‚\n| å­—æ®µå         | å«ä¹‰                     |\n|----------------|--------------------------|\n| `suserid`      | åŸå§‹è´¦å·ï¼ˆQQ/WXï¼‰        |\n| `vRoleID`      | è§’è‰²ID                   |\n| `iuserid`      | ç”¨æˆ·ID                   |\n| `vGameAppid`   | æ¸¸æˆApp ID               |\n\nâœ… ç”¨äºæœ€ç»ˆè·å– `gplayerid`ã€‚\n\n---\n\n### ğŸ” **ä¸‰ã€ç¡®å®šåˆ¤æ–­â€œæµå¤±â€çš„æ ‡å‡†**\n\næ ¹æ®é¢˜ç›®æä¾›çš„å‚è€ƒä¿¡æ¯ï¼š\n```sql\n-- æµå¤±å®šä¹‰ï¼š5æœˆå†…æ²¡æœ‰æ´»è·ƒï¼Œä½†ä¹‹å‰æœ‰æ´»è·ƒ\nINSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),1,31),'1') = 0 AND \nINSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),32,31),'1') > 0\n```\n\nè¿™ä¸ªè¡¨è¾¾å¼çš„æ„æ€æ˜¯ï¼š\n- å‰31å¤©æ²¡æœ‰æ´»è·ƒï¼ˆç¬¬1~31ä½æ— 1ï¼‰\n- ç¬¬32~62ä½æœ‰æ´»è·ƒï¼ˆè‡³å°‘æœ‰ä¸€ä¸ª1ï¼‰\n\nä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ç¬¬32~62å¤©ä¹‹é—´æœ‰ç™»å½•è¡Œä¸ºï¼Œä½†åœ¨5æœˆï¼ˆå³å‰31å¤©ï¼‰æ²¡æœ‰ç™»å½•è¡Œä¸ºã€‚\n\n---\n\n### ğŸ§® **å››ã€æ„å»ºå®Œæ•´SQLé€»è¾‘**\n\n#### æ­¥éª¤ä¸€ï¼šä» `dws_mgamejp_login_user_activity_di` ä¸­æ‰¾å‡ºç¬¦åˆæ¡ä»¶çš„æ´»è·ƒç”¨æˆ·\n```sql\nSELECT DISTINCT\n  suserid,\n  suseridtype\nFROM dws_mgamejp_login_user_activity_di\nWHERE\n  sgamecode = 'initiatived' AND\n  suseridtype IN ('qq', 'wxid') AND\n  splattype = 'PC' AND\n  splat = '-100' AND\n  saccounttype = '-100' AND\n  itimes >= 1\n```\n\n#### æ­¥éª¤äºŒï¼šä» `dws_argothek_oss_useractivity_df` ä¸­ç­›é€‰å‡ºè¿™äº›ç”¨æˆ·åœ¨5æœˆæœŸé—´çš„æ´»è·ƒæƒ…å†µ\næˆ‘ä»¬è¦é€‰å‡ºé‚£äº›ï¼š\n- åœ¨å‰31å¤©æ²¡æœ‰æ´»è·ƒï¼ˆ`INSTR(...)=0`ï¼‰\n- åœ¨ç¬¬32~62å¤©æœ‰æ´»è·ƒï¼ˆ`INSTR(...)>0`ï¼‰\n\næ³¨æ„ï¼šè¿™é‡Œè¦ç¡®ä¿ `statis_date` æ˜¯åœ¨ 2025 å¹´ 5 æœˆ 1 æ—¥ä¹‹åï¼Œå¹¶ä¸” `statis_date` ä¸è¶…è¿‡ 2025 å¹´ 5 æœˆåº•ï¼ˆä¾‹å¦‚ 20250531ï¼‰\n\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™æ ·ç­›é€‰ï¼š\n```sql\nSELECT\n  iuserid,\n  iactivity\nFROM dws_argothek_oss_useractivity_df\nWHERE\n  statis_date BETWEEN 20250501 AND 20250531 AND\n  iactivity IS NOT NULL\n```\n\n#### æ­¥éª¤ä¸‰ï¼šå°†ä¸Šè¿°ä¸¤ä¸ªç»“æœè¿›è¡Œ JOINï¼ŒåŒ¹é…å‡ºç¬¦åˆæµå¤±æ¡ä»¶çš„ç”¨æˆ·\n\n#### æ­¥éª¤å››ï¼šå†é€šè¿‡ `dim_argothek_gplayerid2qqwxid_df` è·å–å¯¹åº”çš„ `gplayerid`\n\n---\n\n### ğŸ§¾ **äº”ã€æœ€ç»ˆ SQL æŸ¥è¯¢è¯­å¥**\n\n```sql\nWITH active_users AS (\n  SELECT DISTINCT\n    suserid,\n    suseridtype\n  FROM dws_mgamejp_login_user_activity_di\n  WHERE\n    sgamecode = 'initiatived' AND\n    suseridtype IN ('qq', 'wxid') AND\n    splattype = 'PC' AND\n    splat = '-100' AND\n    saccounttype = '-100' AND\n    itimes >= 1\n),\nlost_users AS (\n  SELECT\n    iuserid\n  FROM dws_argothek_oss_useractivity_df\n  WHERE\n    statis_date BETWEEN 20250501 AND 20250531 AND\n    iactivity IS NOT NULL AND\n    INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),1,31),'1') = 0 AND\n    INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),32,31),'1') > 0\n)\nSELECT DISTINCT\n  t1.vRoleID AS gplayerid\nFROM dim_argothek_gplayerid2qqwxid_df t1\nJOIN lost_users t2 ON t1.suserid = t2.iuserid\nWHERE\n  t1.dtstatdate = '20250608' AND\n  t1.vGameAppid = 'initiatived'\n```\n\n---\n\n### ğŸ“Œ **å…­ã€è¯´æ˜**\n\n- ä½¿ç”¨äº† CTE åˆ†åˆ«å¤„ç†æ´»è·ƒç”¨æˆ·å’Œæµå¤±ç”¨æˆ·\n- æœ€ç»ˆé€šè¿‡ `dim_argothek_gplayerid2qqwxid_df` è¡¨å®Œæˆè´¦å·æ˜ å°„\n- `dtstatdate = '20250608'` æ˜¯ä¸ºäº†è·å–ç‰¹å®šæ—¶é—´ç‚¹çš„æ•°æ®\n- `vGameAppid = 'initiatived'` æ˜¯åŒºåˆ†æ¸¸æˆçš„æ¡ä»¶\n\n---\n\nå¦‚æœ‰æ›´å¤šç»´åº¦æˆ–å­—æ®µéœ€è¦æ‰©å±•ï¼Œä¹Ÿå¯ä»¥ç»§ç»­è¡¥å……ã€‚"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´5æœˆå‹‡è€…ç›Ÿçº¦æµå¤±ç”¨æˆ·ä¸­ï¼Œæµå‘å³¡è°·PCçš„ç©å®¶gplayerid\nè¾“å‡ºï¼šç©å®¶gplayerid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_useractivity_df` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `iworldid` BIGINT COMMENT 'å¤§åŒºID',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `igroup` BIGINT COMMENT 'æ˜¯å¦ä»˜è´¹',\n  `iactivity` TEXT COMMENT 'ç©å®¶ç™»é™†ä½å›¾,é¦–ä½ä¸º0,æœ€é•¿100ä½,1è¡¨ç¤ºå½“å¤©æ´»è·ƒ,0è¡¨ç¤ºå½“å¤©æœªæ´»è·ƒ',\n  `iregdate` BIGINT COMMENT 'æ³¨å†Œæ—¥æœŸ,è¿™é‡Œçš„æ³¨å†Œæ—¥æœŸæ˜¯é¦–æ¬¡æ´»è·ƒæ—¥æœŸ,å¦‚æœæ³¨å†Œæ•°æ®æœ‰å•ç‹¬æ—¥å¿—è¡¨,åˆ™å¿½ç•¥æ­¤å­—æ®µ',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `iregway` BIGINT COMMENT 'æ³¨å†Œæ¸ é“',\n  `vlastlogindate` TEXT COMMENT 'æœ€åç™»å½•æ—¥æœŸ'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹:QQå·æˆ–è€…å¾®ä¿¡',\n  `suserid` TEXT COMMENT 'å¸å·',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹:qq wxid playerid',\n  `sgamecode` TEXT COMMENT 'ä¸šåŠ¡',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚æšä¸¾å€¼ä¸ºAndroid/ iOSï¼Œå–æ±‡æ€»æ—¶å–-100',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `sgameparam` TEXT COMMENT 'åœºæ¬¡',\n  `schannel` TEXT COMMENT 'ä¸å¯ç”¨å­—æ®µï¼Œç”¨æˆ·å¯ä»¥å¿½ç•¥',\n  `sip` TEXT COMMENT 'å®é™…ä¸Šæ˜¯å½“æ—¥ç™»å½•çš„æœ€å°æ—¶é—´æˆ³ï¼Œå³æœ€æ—©ç™»å½•æ—¶é—´',\n  `sclientver` TEXT COMMENT 'å®¢æˆ·ç«¯ç‰ˆæœ¬',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚ä¸å¯ç”¨',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚ä¸å¯ç”¨',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ¬¡æ•°',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ—¶é—´'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nsgamecode = \"initiatived\" -- ç­›é€‰å³¡è°·æ¸¸æˆ\nand itimes >= 1 -- æ´»è·ƒç”¨æˆ·æ¡ä»¶\nand saccounttype = \"-100\" -- è´¦å·ä½“ç³»ï¼Œå–-100è¡¨ç¤ºæ±‡æ€»\nand suseridtype in (\"qq\", \"wxid\") -- è´¦å·ç±»å‹ï¼Œå–qqæˆ–wxid\nand splattype = \"PC\" -- å³¡è°·ç«¯æ¸¸ç©å®¶\nand splat = \"-100\" -- å†™æ­»ä¸º-100\n5æœˆæµå¤±ï¼šé™å®šINSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),1,31),'1') = 0 AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),32,31),'1') > 0\nå–20250608çš„æ•°æ®åšè´¦å·è½¬æ¢\n\n",
  "chosen": "SELECT DISTINCT churned.iuserid AS gplayerid\nFROM (\n    SELECT iuserid\n    FROM dws_argothek_oss_useractivity_df \n    WHERE statis_date = 20250531\n    AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),1,31),'1') = 0 \n    AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),32,31),'1') > 0\n) churned\nWHERE EXISTS (\n    SELECT 1\n    FROM dim_argothek_gplayerid2qqwxid_df a\n    JOIN dws_mgamejp_login_user_activity_di p ON a.suserid = p.suserid\n    WHERE a.iuserid = churned.iuserid\n    AND a.dtstatdate = '20250608'\n    AND p.sgamecode = 'initiatived'\n    AND p.saccounttype = '-100'\n    AND p.suseridtype IN ('qq','wxid')\n    AND p.splattype IN ('-100','PC')\n    AND p.splat = '-100'\n    AND p.dtstatdate BETWEEN 20250501 AND 20250531\n    AND p.itimes >= 1\n)",
  "rejected": "SELECT DISTINCT\n  T1.`suserid`\nFROM `dws_mgamejp_login_user_activity_di` AS T1\nINNER JOIN `dim_argothek_gplayerid2qqwxid_df` AS T2\n  ON T1.`suserid` = T2.`suserid`\nWHERE\n  T1.`sgamecode` = 'initiatived'\n  AND T1.`splattype` = 'PC'\n  AND T1.`splat` = '-100'\n  AND T1.`saccounttype` = '-100'\n  AND T1.`suseridtype` IN ('qq', 'wxid')\n  AND T1.`dtstatdate` = 20250608\n  AND T2.`dtstatdate` = '20250608'"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´5æœˆå‹‡è€…ç›Ÿçº¦æµå¤±ç”¨æˆ·ä¸­ï¼Œæµå‘å³¡è°·PCçš„ç©å®¶gplayerid\nè¾“å‡ºï¼šç©å®¶gplayerid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_useractivity_df` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `iworldid` BIGINT COMMENT 'å¤§åŒºID',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `igroup` BIGINT COMMENT 'æ˜¯å¦ä»˜è´¹',\n  `iactivity` TEXT COMMENT 'ç©å®¶ç™»é™†ä½å›¾,é¦–ä½ä¸º0,æœ€é•¿100ä½,1è¡¨ç¤ºå½“å¤©æ´»è·ƒ,0è¡¨ç¤ºå½“å¤©æœªæ´»è·ƒ',\n  `iregdate` BIGINT COMMENT 'æ³¨å†Œæ—¥æœŸ,è¿™é‡Œçš„æ³¨å†Œæ—¥æœŸæ˜¯é¦–æ¬¡æ´»è·ƒæ—¥æœŸ,å¦‚æœæ³¨å†Œæ•°æ®æœ‰å•ç‹¬æ—¥å¿—è¡¨,åˆ™å¿½ç•¥æ­¤å­—æ®µ',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `iregway` BIGINT COMMENT 'æ³¨å†Œæ¸ é“',\n  `vlastlogindate` TEXT COMMENT 'æœ€åç™»å½•æ—¥æœŸ'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹:QQå·æˆ–è€…å¾®ä¿¡',\n  `suserid` TEXT COMMENT 'å¸å·',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹:qq wxid playerid',\n  `sgamecode` TEXT COMMENT 'ä¸šåŠ¡',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚æšä¸¾å€¼ä¸ºAndroid/ iOSï¼Œå–æ±‡æ€»æ—¶å–-100',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `sgameparam` TEXT COMMENT 'åœºæ¬¡',\n  `schannel` TEXT COMMENT 'ä¸å¯ç”¨å­—æ®µï¼Œç”¨æˆ·å¯ä»¥å¿½ç•¥',\n  `sip` TEXT COMMENT 'å®é™…ä¸Šæ˜¯å½“æ—¥ç™»å½•çš„æœ€å°æ—¶é—´æˆ³ï¼Œå³æœ€æ—©ç™»å½•æ—¶é—´',\n  `sclientver` TEXT COMMENT 'å®¢æˆ·ç«¯ç‰ˆæœ¬',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚ä¸å¯ç”¨',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚ä¸å¯ç”¨',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ¬¡æ•°',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ—¶é—´'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nsgamecode = \"initiatived\" -- ç­›é€‰å³¡è°·æ¸¸æˆ\nand itimes >= 1 -- æ´»è·ƒç”¨æˆ·æ¡ä»¶\nand saccounttype = \"-100\" -- è´¦å·ä½“ç³»ï¼Œå–-100è¡¨ç¤ºæ±‡æ€»\nand suseridtype in (\"qq\", \"wxid\") -- è´¦å·ç±»å‹ï¼Œå–qqæˆ–wxid\nand splattype = \"PC\" -- å³¡è°·ç«¯æ¸¸ç©å®¶\nand splat = \"-100\" -- å†™æ­»ä¸º-100\n5æœˆæµå¤±ï¼šé™å®šINSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),1,31),'1') = 0 AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),32,31),'1') > 0\nå–20250608çš„æ•°æ®åšè´¦å·è½¬æ¢\n\n",
  "chosen": "SELECT DISTINCT churned.iuserid AS gplayerid\nFROM (\n    SELECT iuserid\n    FROM dws_argothek_oss_useractivity_df \n    WHERE statis_date = 20250531\n    AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),1,31),'1') = 0 \n    AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),32,31),'1') > 0\n) churned\nWHERE EXISTS (\n    SELECT 1\n    FROM dim_argothek_gplayerid2qqwxid_df a\n    JOIN dws_mgamejp_login_user_activity_di p ON a.suserid = p.suserid\n    WHERE a.iuserid = churned.iuserid\n    AND a.dtstatdate = '20250608'\n    AND p.sgamecode = 'initiatived'\n    AND p.saccounttype = '-100'\n    AND p.suseridtype IN ('qq','wxid')\n    AND p.splattype IN ('-100','PC')\n    AND p.splat = '-100'\n    AND p.dtstatdate BETWEEN 20250501 AND 20250531\n    AND p.itimes >= 1\n)",
  "rejected": "æˆ‘ä»¬æ¥ä¸€æ­¥æ­¥åˆ†æå¹¶ç¼–å†™ SQL æŸ¥è¯¢è¯­å¥ï¼Œä»¥æ»¡è¶³ç”¨æˆ·éœ€æ±‚ï¼š\n\n---\n\n### ğŸ§  **ä¸€ã€ç†è§£ç”¨æˆ·é—®é¢˜**\n\n> ç»Ÿè®¡â€œ2025å¹´5æœˆå‹‡è€…ç›Ÿçº¦æµå¤±ç”¨æˆ·ä¸­ï¼Œæµå‘å³¡è°·PCçš„ç©å®¶ gplayeridâ€ã€‚\n\n#### å…³é”®ç‚¹ï¼š\n1. **æµå¤±ç”¨æˆ·å®šä¹‰**ï¼šåœ¨æŸæ®µæ—¶é—´å†…ï¼ˆå¦‚2025å¹´5æœˆï¼‰ä¸æ´»è·ƒçš„ç”¨æˆ·ã€‚\n2. **æ´»è·ƒåˆ¤æ–­ä¾æ®**ï¼š`iactivity` å­—æ®µä¸­çš„ä½å›¾ï¼Œè¡¨ç¤ºæ¯å¤©æ˜¯å¦æ´»è·ƒã€‚\n3. **æµå‘å³¡è°·PC**ï¼šéœ€ç­›é€‰å‡ºä»å‹‡è€…ç›Ÿçº¦ï¼ˆå¯èƒ½æ˜¯æŸä¸ªæ¸¸æˆæˆ–å¤§åŒºï¼‰æµå¤±åï¼Œè¿›å…¥â€œå³¡è°·â€ï¼ˆsgamecode='initiatived'ï¼‰ä¸”å¹³å°ä¸º PC çš„ç”¨æˆ·ã€‚\n4. **è¾“å‡ºç›®æ ‡**ï¼šè¿™äº›ç”¨æˆ·çš„ `gplayerid`ã€‚\n\n---\n\n### ğŸ” **äºŒã€ç†è§£æ•°æ®åº“ç»“æ„ä¸å­—æ®µå«ä¹‰**\n\n#### è¡¨ååŠå…³é”®å­—æ®µè¯´æ˜ï¼š\n\n| è¡¨å | å­—æ®µ | å«ä¹‰ |\n|------|------|------|\n| `dws_argothek_oss_useractivity_df` | `statis_date`, `iworldid`, `iuserid`, `ilevel`, `igroup`, `iactivity`, `iregdate`, `iloginway`, `iregway`, `vlastlogindate` | ç”¨æˆ·è¡Œä¸ºæ—¥å¿—è¡¨ï¼Œè®°å½•æ¯ä¸ªç”¨æˆ·æ¯æ—¥æ´»åŠ¨æƒ…å†µ |\n| `dim_argothek_gplayerid2qqwxid_df` | `suserid`, `swxid_type`, `suseridtype`, `vRoleID`, `iAreaID`, `iVersion` | ç”¨æˆ·è´¦å·æ˜ å°„è¡¨ï¼Œç”¨äºå°†ä¸åŒè´¦å·ä½“ç³»ï¼ˆQQ/WXï¼‰è½¬æ¢æˆç»Ÿä¸€çš„ `gplayerid` |\n| `dws_mgamejp_login_user_activity_di` | `saccounttype`, `suserid`, `suseridtype`, `sgamecode`, `splattype`, `splat`, `itimes` | ç™»å½•æ´»è·ƒåº¦ç»Ÿè®¡è¡¨ï¼ŒåŒ…å«ç™»å½•æ¸ é“ã€æ´»è·ƒæ¬¡æ•°ç­‰ |\n\n---\n\n### ğŸ“Œ **ä¸‰ã€æ˜ç¡®ç­›é€‰é€»è¾‘**\n\n#### 1. ç­›é€‰â€œå³¡è°·PCâ€çš„æ´»è·ƒç”¨æˆ·\næ ¹æ®å‚è€ƒä¿¡æ¯ï¼š\n```sql\nsgamecode = 'initiatived'\nAND itimes >= 1\nAND saccounttype = '-100'\nAND suseridtype IN ('qq', 'wxid')\nAND splattype = 'PC'\nAND splat = '-100'\n```\n\n#### 2. åˆ¤æ–­æ˜¯å¦æ˜¯â€œ2025å¹´5æœˆæµå¤±ç”¨æˆ·â€\nå‚è€ƒä¿¡æ¯ç»™å‡ºæµå¤±æ¡ä»¶å¦‚ä¸‹ï¼š\n```sql\nINSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),1,31),'1') = 0 AND\nINSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),32,31),'1') > 0\n```\nè¿™ä¸ªè¡¨è¾¾å¼çš„æ„æ€æ˜¯ï¼š\n- å‰31å¤©æ²¡æœ‰æ´»è·ƒï¼ˆç¬¬1~31ä½ä¸­æ— 1ï¼‰\n- ç¬¬32~62å¤©æœ‰æ´»è·ƒï¼ˆç¬¬32~62ä½ä¸­æœ‰è‡³å°‘ä¸€ä¸ª1ï¼‰\n\nå³ï¼š**æœ€è¿‘ä¸€ä¸ªæœˆæ²¡ç™»å½•ï¼Œä½†ä¸Šä¸ªæœˆæœ‰ç™»å½•**\n\n#### 3. æ—¶é—´èŒƒå›´é™åˆ¶\né¢˜ç›®è¯´â€œ2025å¹´5æœˆâ€ï¼Œæ‰€ä»¥ï¼š\n- æˆ‘ä»¬åº”é€‰æ‹© `statis_date = 20250531` æˆ– `20250501` ç­‰æ—¥æœŸè¿›è¡Œåˆ¤æ–­\n- å‚è€ƒä¿¡æ¯æåˆ°ï¼šâ€œå–20250608çš„æ•°æ®åšè´¦å·è½¬æ¢â€ï¼Œè¿™è¡¨æ˜æˆ‘ä»¬åº”ä»¥ `20250608` è¿™ä¸€å¤©çš„æ•°æ®ä½œä¸ºæœ€ç»ˆè½¬æ¢åŸºå‡†\n\n---\n\n### âœ… **å››ã€æ„å»º SQL æŸ¥è¯¢è¯­å¥**\n\næˆ‘ä»¬å°†åˆ†æ­¥éª¤å®Œæˆä»»åŠ¡ï¼š\n\n#### Step 1: è·å–ç¬¦åˆæ¡ä»¶çš„â€œå³¡è°·PCæ´»è·ƒç”¨æˆ·â€\n```sql\nSELECT DISTINCT\n    s.userid AS user_id,\n    s.suserid,\n    s.suseridtype\nFROM dws_mgamejp_login_user_activity_di s\nWHERE\n    s.sgamecode = 'initiatived'\n    AND s.itimes >= 1\n    AND s.saccounttype = '-100'\n    AND s.suseridtype IN ('qq', 'wxid')\n    AND s.splattype = 'PC'\n    AND s.splat = '-100'\n    AND s.dtstatdate = 20250608;\n```\n\n#### Step 2: å°†è¿™äº›ç”¨æˆ· ID æ˜ å°„åˆ° gplayeridï¼ˆé€šè¿‡ dim è¡¨ï¼‰\næˆ‘ä»¬éœ€è¦ä½¿ç”¨ `dim_argothek_gplayerid2qqwxid_df` è¡¨æ¥è·å–å¯¹åº”çš„ `vRoleID` æˆ– `iuserid`ï¼Œå³ gplayeridã€‚\n\n```sql\nSELECT DISTINCT\n    t.vRoleID AS gplayerid\nFROM dim_argothek_gplayerid2qqwxid_df t\nJOIN (\n    SELECT DISTINCT\n        s.suserid,\n        s.suseridtype\n    FROM dws_mgamejp_login_user_activity_di s\n    WHERE\n        s.sgamecode = 'initiatived'\n        AND s.itimes >= 1\n        AND s.saccounttype = '-100'\n        AND s.suseridtype IN ('qq', 'wxid')\n        AND s.splattype = 'PC'\n        AND s.splat = '-100'\n        AND s.dtstatdate = 20250608\n) AS active_users\nON (t.suserid = active_users.suserid AND t.swxid_type = active_users.suseridtype)\nWHERE t.dtstatdate = '20250608';\n```\n\n#### Step 3: åŠ å…¥â€œæµå¤±â€åˆ¤æ–­é€»è¾‘ï¼ˆé’ˆå¯¹2025å¹´5æœˆï¼‰\n\næˆ‘ä»¬å›åˆ°ä¸»è¡¨ `dws_argothek_oss_useractivity_df`ï¼Œæ‰¾å‡ºåœ¨2025å¹´5æœˆæœŸé—´ç¬¦åˆä»¥ä¸‹æ¡ä»¶çš„ç”¨æˆ·ï¼š\n- æœ€è¿‘ä¸€ä¸ªæœˆæ²¡ç™»å½•ï¼ˆå‰31å¤©æ— æ´»è·ƒï¼‰\n- ä¸Šä¸€ä¸ªæœˆï¼ˆç¬¬32~62å¤©ï¼‰æœ‰ç™»å½•\n\n```sql\nSELECT DISTINCT\n    t.vRoleID AS gplayerid\nFROM dim_argothek_gplayerid2qqwxid_df t\nJOIN (\n    SELECT\n        iuserid,\n        swxid_type\n    FROM dws_argothek_oss_useractivity_df\n    WHERE\n        statis_date = 20250531\n        AND ilevel >= 1\n        AND iregdate <= 20250531\n        AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),1,31),'1') = 0\n        AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),32,31),'1') > 0\n) AS lost_users\nON (t.iuserid = lost_users.iuserid AND t.swxid_type = lost_users.swxid_type)\nWHERE t.dtstatdate = '20250608';\n```\n\n---\n\n### ğŸ¯ **äº”ã€æœ€ç»ˆ SQL æŸ¥è¯¢è¯­å¥**\n\n```sql\nSELECT DISTINCT\n    t.vRoleID AS gplayerid\nFROM dim_argothek_gplayerid2qqwxid_df t\nJOIN (\n    SELECT\n        iuserid,\n        swxid_type\n    FROM dws_argothek_oss_useractivity_df\n    WHERE\n        statis_date = 20250531\n        AND ilevel >= 1\n        AND iregdate <= 20250531\n        AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),1,31),'1') = 0\n        AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),32,31),'1') > 0\n) AS lost_users\nON (t.iuserid = lost_users.iuserid AND t.swxid_type = lost_users.swxid_type)\nWHERE t.dtstatdate = '20250608';\n```\n\n---\n\n### ğŸ§¾ **å…­ã€æ€»ç»“**\n\n| æ­¥éª¤ | åŠŸèƒ½ |\n|------|------|\n| 1 | ä» `dws_argothek_oss_useractivity_df` ä¸­ç­›é€‰å‡º2025å¹´5æœˆçš„æµå¤±ç”¨æˆ· |\n| 2 | ä½¿ç”¨ `INSTR(...)` å’Œ `RPAD(...)` å®ç°ä½å›¾åˆ¤æ–­ |\n| 3 | ç”¨ `dim_argothek_gplayerid2qqwxid_df` å°†ç”¨æˆ·æ˜ å°„ä¸º `gplayerid` |\n| 4 | æœ€ç»ˆè¾“å‡ºç¬¦åˆæ¡ä»¶çš„ `gplayerid` åˆ—è¡¨ |\n\nå¦‚æœ‰æ›´å¤šå­—æ®µæˆ–ä¸šåŠ¡è§„åˆ™éœ€è¦è€ƒè™‘ï¼Œè¯·ç»§ç»­æä¾›ç»†èŠ‚ï¼"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´5æœˆå‹‡è€…ç›Ÿçº¦æµå¤±ç”¨æˆ·ä¸­ï¼Œæµå‘å³¡è°·PCçš„ç©å®¶gplayerid\nè¾“å‡ºï¼šç©å®¶gplayerid\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_useractivity_df` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸ',\n  `iworldid` BIGINT COMMENT 'å¤§åŒºID',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `igroup` BIGINT COMMENT 'æ˜¯å¦ä»˜è´¹',\n  `iactivity` TEXT COMMENT 'ç©å®¶ç™»é™†ä½å›¾,é¦–ä½ä¸º0,æœ€é•¿100ä½,1è¡¨ç¤ºå½“å¤©æ´»è·ƒ,0è¡¨ç¤ºå½“å¤©æœªæ´»è·ƒ',\n  `iregdate` BIGINT COMMENT 'æ³¨å†Œæ—¥æœŸ,è¿™é‡Œçš„æ³¨å†Œæ—¥æœŸæ˜¯é¦–æ¬¡æ´»è·ƒæ—¥æœŸ,å¦‚æœæ³¨å†Œæ•°æ®æœ‰å•ç‹¬æ—¥å¿—è¡¨,åˆ™å¿½ç•¥æ­¤å­—æ®µ',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `iregway` BIGINT COMMENT 'æ³¨å†Œæ¸ é“',\n  `vlastlogindate` TEXT COMMENT 'æœ€åç™»å½•æ—¥æœŸ'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dws_mgamejp_login_user_activity_di` (\n  `dtstatdate` BIGINT COMMENT 'ç»Ÿè®¡æ—¥æœŸYYYYMMDD',\n  `saccounttype` TEXT COMMENT 'å¸å·ç±»å‹:QQå·æˆ–è€…å¾®ä¿¡',\n  `suserid` TEXT COMMENT 'å¸å·',\n  `suseridtype` TEXT COMMENT 'å¸å·ç±»å‹:qq wxid playerid',\n  `sgamecode` TEXT COMMENT 'ä¸šåŠ¡',\n  `splattype` TEXT COMMENT 'å¹³å°ç±»å‹(å¤§å¹³å°)ã€‚æšä¸¾å€¼ä¸ºAndroid/ iOSï¼Œå–æ±‡æ€»æ—¶å–-100',\n  `splat` TEXT COMMENT 'å¹³å°(å°å¹³å°)ã€‚å¤‡æ³¨ï¼šå†™æ­»çš„-100',\n  `sgameparam` TEXT COMMENT 'åœºæ¬¡',\n  `schannel` TEXT COMMENT 'ä¸å¯ç”¨å­—æ®µï¼Œç”¨æˆ·å¯ä»¥å¿½ç•¥',\n  `sip` TEXT COMMENT 'å®é™…ä¸Šæ˜¯å½“æ—¥ç™»å½•çš„æœ€å°æ—¶é—´æˆ³ï¼Œå³æœ€æ—©ç™»å½•æ—¶é—´',\n  `sclientver` TEXT COMMENT 'å®¢æˆ·ç«¯ç‰ˆæœ¬',\n  `ilevel` BIGINT COMMENT 'ç”¨æˆ·ç­‰çº§ã€‚ä¸å¯ç”¨',\n  `iviplevel` BIGINT COMMENT 'Vipç­‰çº§ã€‚ä¸å¯ç”¨',\n  `itimes` BIGINT COMMENT 'æ´»è·ƒæ€»æ¬¡æ•°ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ¬¡æ•°',\n  `ionlinetime` BIGINT COMMENT 'æ´»è·ƒæ€»æ—¶é—´ã€‚å¤‡æ³¨ï¼šè¯¥å­—æ®µè¡¨ç¤ºç”¨æˆ·åœ¨Tæ—¥çš„å½“æ—¥æ´»è·ƒæ€»æ—¶é—´'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nsgamecode = \"initiatived\" -- ç­›é€‰å³¡è°·æ¸¸æˆ\nand itimes >= 1 -- æ´»è·ƒç”¨æˆ·æ¡ä»¶\nand saccounttype = \"-100\" -- è´¦å·ä½“ç³»ï¼Œå–-100è¡¨ç¤ºæ±‡æ€»\nand suseridtype in (\"qq\", \"wxid\") -- è´¦å·ç±»å‹ï¼Œå–qqæˆ–wxid\nand splattype = \"PC\" -- å³¡è°·ç«¯æ¸¸ç©å®¶\nand splat = \"-100\" -- å†™æ­»ä¸º-100\n5æœˆæµå¤±ï¼šé™å®šINSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),1,31),'1') = 0 AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),32,31),'1') > 0\nå–20250608çš„æ•°æ®åšè´¦å·è½¬æ¢\n\n",
  "chosen": "SELECT DISTINCT churned.iuserid AS gplayerid\nFROM (\n    SELECT iuserid\n    FROM dws_argothek_oss_useractivity_df \n    WHERE statis_date = 20250531\n    AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),1,31),'1') = 0 \n    AND INSTR(SUBSTR(REVERSE(RPAD(iactivity,128,'0')),32,31),'1') > 0\n) churned\nWHERE EXISTS (\n    SELECT 1\n    FROM dim_argothek_gplayerid2qqwxid_df a\n    JOIN dws_mgamejp_login_user_activity_di p ON a.suserid = p.suserid\n    WHERE a.iuserid = churned.iuserid\n    AND a.dtstatdate = '20250608'\n    AND p.sgamecode = 'initiatived'\n    AND p.saccounttype = '-100'\n    AND p.suseridtype IN ('qq','wxid')\n    AND p.splattype IN ('-100','PC')\n    AND p.splat = '-100'\n    AND p.dtstatdate BETWEEN 20250501 AND 20250531\n    AND p.itimes >= 1\n)",
  "rejected": "SELECT DISTINCT\n  `T1`.`suserid`\nFROM `dws_mgamejp_login_user_activity_di` AS `T1`\nINNER JOIN `dim_argothek_gplayerid2qqwxid_df` AS `T2`\n  ON `T1`.`suserid` = `T2`.`suserid`\nWHERE\n  `T1`.`sgamecode` = 'initiatived'\n  AND `T1`.`splattype` = 'PC'\n  AND `T1`.`splat` = '-100'\n  AND `T1`.`saccounttype` = '-100'\n  AND `T1`.`suseridtype` IN ('qq', 'wxid')\n  AND `T1`.`dtstatdate` = 20250608\n  AND `T2`.`dtstatdate` = '20250608'\n  AND `T2`.`vGameAppid` = '1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡20250506-20250512æœŸé—´æ¯æ—¥çš„æŒ‡å®šç½‘å§æ¸ é“å†…æ¯ä¸ªæ¸ é“æ´»è·ƒäººæ•°\nè¾“å‡ºï¼šæ—¥æœŸï¼ˆ20250506ã€...ã€20250512ï¼‰ã€æ¸ é“ã€ç©å®¶æ•°\nå…¶ä¸­ï¼šç½‘å§æ¸ é“ï¼šiloginway in (1,10,11,12,35,20,28,29,30,31,32,33,34,36)\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\n\n\n",
  "chosen": "SELECT \n    statis_date AS æ—¥æœŸ,\n    iloginway AS æ¸ é“,\n    COUNT(DISTINCT iuserid) AS ç©å®¶æ•°\nFROM dws_argothek_oss_login_di\nWHERE statis_date BETWEEN 20250506 AND 20250512\nAND iloginway IN (1,10,11,12,35,20,28,29,30,31,32,33,34,36)\nGROUP BY statis_date, iloginway\nORDER BY statis_date, iloginway",
  "rejected": "### ç¬¬ä¸€æ­¥: ç†è§£éœ€æ±‚\n\næˆ‘ä»¬éœ€è¦ç»Ÿè®¡åœ¨ç‰¹å®šæ—¥æœŸèŒƒå›´å†…ï¼ˆ2025å¹´5æœˆ6æ—¥è‡³2025å¹´5æœˆ12æ—¥ï¼‰ï¼Œç½‘å§æ¸ é“å†…æ¯å¤©æ´»è·ƒç”¨æˆ·çš„æ•°é‡ã€‚ç½‘å§æ¸ é“çš„å®šä¹‰æ˜¯ `iloginway` åœ¨ç»™å®šåˆ—è¡¨ä¸­ï¼š(1,10,11,12,35,20,28,29,30,31,32,33,34,36)ã€‚\n\n#### å…³é”®ç‚¹ï¼š\n1. **æ—¶é—´èŒƒå›´**ï¼šä» `20250506` åˆ° `20250512`\n2. **ç½‘å§æ¸ é“**ï¼š`iloginway` å±äºæŒ‡å®šé›†åˆ\n3. **æ´»è·ƒç”¨æˆ·**ï¼šåŒä¸€ç”¨æˆ·ä¸€å¤©åªè®¡ç®—ä¸€æ¬¡ï¼ˆå»é‡ï¼‰\n4. **è¾“å‡ºå­—æ®µ**ï¼š\n   - `statis_date`: ç»Ÿè®¡æ—¥æœŸï¼ˆæ ¼å¼ä¸º YYYYMMDDï¼‰\n   - `iloginway`: ç™»å½•æ¸ é“\n   - `user_count`: æ´»è·ƒç”¨æˆ·æ•°\n\n---\n\n### ç¬¬äºŒæ­¥: åˆ†æè¡¨ç»“æ„ä¸æ•°æ®\n\næˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ `dws_argothek_oss_login_di` è¡¨ï¼š\n\n| å­—æ®µå       | ç±»å‹     | å«ä¹‰             |\n|--------------|----------|------------------|\n| `statis_date` | BIGINT   | ç»Ÿè®¡æ—¶é—´         |\n| `iuserid`     | TEXT     | ç”¨æˆ·ID           |\n| `ilogintime`  | BIGINT   | ç™»å½•æ—¶é—´         |\n| `ionlinetime` | BIGINT   | åœ¨çº¿æ—¶é•¿         |\n| `ilevel`      | BIGINT   | ç©å®¶ç­‰çº§         |\n| `iplaytime`   | BIGINT   | æ¸¸æˆæ—¶é•¿         |\n| `iloginway`   | BIGINT   | ç™»å½•æ¸ é“         |\n| `ilogincount` | BIGINT   | ç™»å½•æ¬¡æ•°         |\n\næ³¨æ„ï¼š\n- `statis_date` æ˜¯æ•´æ•°ç±»å‹ï¼Œè¡¨ç¤ºæ—¥æœŸå¦‚ `20250506`\n- æ¯æ¡è®°å½•ä»£è¡¨ä¸€ä¸ªç”¨æˆ·çš„æŸæ¬¡ç™»å½•è¡Œä¸º\n\n---\n\n### ç¬¬ä¸‰æ­¥: æ„å»ºé€»è¾‘æµç¨‹\n\n#### æ­¥éª¤ä¸€ï¼šç­›é€‰ç½‘å§æ¸ é“çš„æ•°æ®\n```sql\nWHERE iloginway IN (1,10,11,12,35,20,28,29,30,31,32,33,34,36)\n```\n\n#### æ­¥éª¤äºŒï¼šé™å®šæ—¶é—´èŒƒå›´\n```sql\nAND statis_date BETWEEN 20250506 AND 20250512\n```\n\n#### æ­¥éª¤ä¸‰ï¼šæŒ‰æ—¥æœŸå’Œæ¸ é“åˆ†ç»„\n```sql\nGROUP BY statis_date, iloginway\n```\n\n#### æ­¥éª¤å››ï¼šç»Ÿè®¡æ´»è·ƒç”¨æˆ·æ•°ï¼ˆå³å»é‡åçš„ iuserid æ•°é‡ï¼‰\n```sql\nCOUNT(DISTINCT iuserid)\n```\n\n---\n\n### ç¬¬å››æ­¥: ç¼–å†™æœ€ç»ˆ SQL æŸ¥è¯¢è¯­å¥\n\n```sql\nSELECT\n  statis_date,\n  iloginway,\n  COUNT(DISTINCT iuserid) AS user_count\nFROM dws_argothek_oss_login_di\nWHERE\n  iloginway IN (1,10,11,12,35,20,28,29,30,31,32,33,34,36)\n  AND statis_date BETWEEN 20250506 AND 20250512\nGROUP BY\n  statis_date,\n  iloginway;\n```\n\n---\n\n### ç¬¬äº”æ­¥: éªŒè¯ç»“æœåˆç†æ€§\n\næ­¤æŸ¥è¯¢å°†è¿”å›å¦‚ä¸‹å½¢å¼çš„ç»“æœï¼š\n\n| statis_date | iloginway | user_count |\n|-------------|-----------|------------|\n| 20250506    | 1         | 123        |\n| 20250506    | 10        | 456        |\n| ...         | ...       | ...        |\n| 20250512    | 36        | 789        |\n\næ¯ä¸€è¡Œå¯¹åº”ä¸€ä¸ªæ—¥æœŸ + æ¸ é“ç»„åˆä¸‹çš„å”¯ä¸€ç”¨æˆ·æ•°ï¼Œç¬¦åˆé¢˜ç›®è¦æ±‚ã€‚\n\n--- \n\nâœ… **æœ€ç»ˆç­”æ¡ˆå®Œæˆï¼**"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡20250506-20250512æœŸé—´æ¯æ—¥çš„æŒ‡å®šç½‘å§æ¸ é“å†…æ¯ä¸ªæ¸ é“æ´»è·ƒäººæ•°\nè¾“å‡ºï¼šæ—¥æœŸï¼ˆ20250506ã€...ã€20250512ï¼‰ã€æ¸ é“ã€ç©å®¶æ•°\nå…¶ä¸­ï¼šç½‘å§æ¸ é“ï¼šiloginway in (1,10,11,12,35,20,28,29,30,31,32,33,34,36)\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\n\n\n",
  "chosen": "SELECT \n    statis_date AS æ—¥æœŸ,\n    iloginway AS æ¸ é“,\n    COUNT(DISTINCT iuserid) AS ç©å®¶æ•°\nFROM dws_argothek_oss_login_di\nWHERE statis_date BETWEEN 20250506 AND 20250512\nAND iloginway IN (1,10,11,12,35,20,28,29,30,31,32,33,34,36)\nGROUP BY statis_date, iloginway\nORDER BY statis_date, iloginway",
  "rejected": "SELECT\n  DATE_FORMAT(FROM_UNIXTIME(ilogintime), '%Y%m%d') AS login_date,\n  iloginway,\n  COUNT(DISTINCT iuserid) AS active_users\nFROM dws_argothek_oss_login_di\nWHERE\n  statis_date = 20250506 AND iloginway IN (1,10,11,12,35,20,28,29,30,31,32,33,34,36)\nGROUP BY\n  login_date,\n  iloginway"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡20250506-20250512æœŸé—´æ¯æ—¥çš„æŒ‡å®šç½‘å§æ¸ é“å†…æ¯ä¸ªæ¸ é“æ´»è·ƒäººæ•°\nè¾“å‡ºï¼šæ—¥æœŸï¼ˆ20250506ã€...ã€20250512ï¼‰ã€æ¸ é“ã€ç©å®¶æ•°\nå…¶ä¸­ï¼šç½‘å§æ¸ é“ï¼šiloginway in (1,10,11,12,35,20,28,29,30,31,32,33,34,36)\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\n\n\n",
  "chosen": "SELECT \n    statis_date AS æ—¥æœŸ,\n    iloginway AS æ¸ é“,\n    COUNT(DISTINCT iuserid) AS ç©å®¶æ•°\nFROM dws_argothek_oss_login_di\nWHERE statis_date BETWEEN 20250506 AND 20250512\nAND iloginway IN (1,10,11,12,35,20,28,29,30,31,32,33,34,36)\nGROUP BY statis_date, iloginway\nORDER BY statis_date, iloginway",
  "rejected": "SELECT\n  FROM_UNIXTIME(ilogintime, '%Y%m%d') AS dt,\n  CASE WHEN iloginway IN (1,10,11,12,35,20,28,29,30,31,32,33,34,36) THEN 'ç½‘å§' ELSE 'å…¶ä»–' END AS channel,\n  COUNT(DISTINCT iuserid) AS player_count\nFROM dws_argothek_oss_login_di\nWHERE\n  statis_date BETWEEN 20250506 AND 20250512\n  AND ilogintime > 0\nGROUP BY\n  dt,\n  channel"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡20250506-20250512æœŸé—´æ¯æ—¥çš„æŒ‡å®šç½‘å§æ¸ é“å†…æ¯ä¸ªæ¸ é“æ´»è·ƒäººæ•°\nè¾“å‡ºï¼šæ—¥æœŸï¼ˆ20250506ã€...ã€20250512ï¼‰ã€æ¸ é“ã€ç©å®¶æ•°\nå…¶ä¸­ï¼šç½‘å§æ¸ é“ï¼šiloginway in (1,10,11,12,35,20,28,29,30,31,32,33,34,36)\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\n\n\n",
  "chosen": "SELECT \n    statis_date AS æ—¥æœŸ,\n    iloginway AS æ¸ é“,\n    COUNT(DISTINCT iuserid) AS ç©å®¶æ•°\nFROM dws_argothek_oss_login_di\nWHERE statis_date BETWEEN 20250506 AND 20250512\nAND iloginway IN (1,10,11,12,35,20,28,29,30,31,32,33,34,36)\nGROUP BY statis_date, iloginway\nORDER BY statis_date, iloginway",
  "rejected": "SELECT\n  FROM_UNIXTIME(ilogintime, '%Y%m%d') AS statis_date,\n  iloginway,\n  COUNT(DISTINCT iuserid) AS player_count\nFROM dws_argothek_oss_login_di\nWHERE\n  iloginway IN (1,10,11,12,35,20,28,29,30,31,32,33,34,36)\n  AND ilogintime BETWEEN UNIX_TIMESTAMP('2025-05-06', '%Y-%m-%d') AND UNIX_TIMESTAMP('2025-05-12', '%Y-%m-%d')\nGROUP BY\n  statis_date,\n  iloginway"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡20250506-20250512æœŸé—´æ¯æ—¥çš„æŒ‡å®šç½‘å§æ¸ é“å†…æ¯ä¸ªæ¸ é“æ´»è·ƒäººæ•°\nè¾“å‡ºï¼šæ—¥æœŸï¼ˆ20250506ã€...ã€20250512ï¼‰ã€æ¸ é“ã€ç©å®¶æ•°\nå…¶ä¸­ï¼šç½‘å§æ¸ é“ï¼šiloginway in (1,10,11,12,35,20,28,29,30,31,32,33,34,36)\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\n\n\n",
  "chosen": "SELECT \n    statis_date AS æ—¥æœŸ,\n    iloginway AS æ¸ é“,\n    COUNT(DISTINCT iuserid) AS ç©å®¶æ•°\nFROM dws_argothek_oss_login_di\nWHERE statis_date BETWEEN 20250506 AND 20250512\nAND iloginway IN (1,10,11,12,35,20,28,29,30,31,32,33,34,36)\nGROUP BY statis_date, iloginway\nORDER BY statis_date, iloginway",
  "rejected": "SELECT\n  DATE_FORMAT(FROM_UNIXTIME(ilogintime), '%Y%m%d') AS statis_date,\n  iloginway,\n  COUNT(DISTINCT iuserid) AS player_count\nFROM dws_argothek_oss_login_di\nWHERE\n  iloginway IN (1,10,11,12,35,20,28,29,30,31,32,33,34,36)\n  AND ilogintime BETWEEN UNIX_TIMESTAMP('2025-05-06 00:00:00') AND UNIX_TIMESTAMP('2025-05-12 23:59:59')\nGROUP BY\n  statis_date,\n  iloginway"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡20250506-20250512æœŸé—´æ¯æ—¥çš„æŒ‡å®šç½‘å§æ¸ é“å†…æ¯ä¸ªæ¸ é“æ´»è·ƒäººæ•°\nè¾“å‡ºï¼šæ—¥æœŸï¼ˆ20250506ã€...ã€20250512ï¼‰ã€æ¸ é“ã€ç©å®¶æ•°\nå…¶ä¸­ï¼šç½‘å§æ¸ é“ï¼šiloginway in (1,10,11,12,35,20,28,29,30,31,32,33,34,36)\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\n\n\n",
  "chosen": "SELECT \n    statis_date AS æ—¥æœŸ,\n    iloginway AS æ¸ é“,\n    COUNT(DISTINCT iuserid) AS ç©å®¶æ•°\nFROM dws_argothek_oss_login_di\nWHERE statis_date BETWEEN 20250506 AND 20250512\nAND iloginway IN (1,10,11,12,35,20,28,29,30,31,32,33,34,36)\nGROUP BY statis_date, iloginway\nORDER BY statis_date, iloginway",
  "rejected": "SELECT\n  DATE_FORMAT(FROM_UNIXTIME(ilogintime), '%Y%m%d') AS statis_date,\n  iloginway,\n  COUNT(DISTINCT iuserid) AS player_count\nFROM dws_argothek_oss_login_di\nWHERE\n  iloginway IN (1,10,11,12,35,20,28,29,30,31,32,33,34,36)\n  AND ilogintime >= UNIX_TIMESTAMP('2025-05-06')\n  AND ilogintime < UNIX_TIMESTAMP('2025-05-13')\nGROUP BY\n  DATE_FORMAT(FROM_UNIXTIME(ilogintime), '%Y%m%d'),\n  iloginway"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´3æœˆ24æ—¥è‡³2025å¹´3æœˆ30æ—¥ï¼Œè‡³å°‘å®Œæˆè¿‡ä¸€åœºå¯¹å±€ï¼Œä¸”æ¸ é“ç™»å½•çš„ç”¨æˆ·qq\nè¾“å‡º:qq\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dwd_argothek_playermatchstats_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'partition fields',\n  `dteventtime` TEXT COMMENT 'äº‹ä»¶æ—¶é—´ - YYYY-MM-DD HH:MM:SS',\n  `ieventid` TEXT COMMENT 'äº‹ä»¶ ID',\n  `matchid` TEXT COMMENT 'å¯¹å±€ ID - æŸ¥è¯¢å¯¹å±€çš„key',\n  `vroleid` TEXT COMMENT 'å½“å‰æ—¥å¿—æ‰€ä»£è¡¨çš„ç©å®¶çš„è§’è‰² ID',\n  `wonmatch` BIGINT COMMENT 'æ˜¯å¦è·èƒœ',\n  `mapid` TEXT COMMENT 'åœ°å›¾ID',\n  `seasonid` TEXT COMMENT 'èµ›å­£ID',\n  `queueid` TEXT COMMENT 'æ¨¡å¼ID',\n  `gamestartmillis` DOUBLE COMMENT 'æ¯”èµ›å¼€å§‹æ—¶é—´(æ¯«ç§’)',\n  `gamelengthmillis` DOUBLE COMMENT 'å¯¹å±€æ—¶é•¿',\n  `teamid` TEXT COMMENT 'é˜Ÿä¼ IDï¼ŒBlueã€Red',\n  `partyid` TEXT COMMENT 'ç»„é˜Ÿæˆ¿é—´ ID',\n  `ismatchmvp` BIGINT COMMENT 'æ˜¯å¦å…¨å±€MVP',\n  `isteammvp` BIGINT COMMENT 'æ˜¯å¦é˜Ÿä¼MVP',\n  `totalscore` DOUBLE COMMENT 'æœ¬åœºæ¯”èµ›æ€»å¾—åˆ†',\n  `istopdamage` BIGINT COMMENT 'æ˜¯å¦ä¼¤å®³æœ€é«˜',\n  `istopplant` BIGINT COMMENT 'æ˜¯å¦ä¸‹åŒ…æœ€å¤š',\n  `istopdefuse` BIGINT COMMENT 'æ˜¯å¦æ‹†é™¤æ¬¡æ•°æœ€å¤š',\n  `istopkill` BIGINT COMMENT 'æ˜¯å¦å‡»æ€æ•°æœ€å¤š',\n  `istopassist` BIGINT COMMENT 'æ˜¯å¦åŠ©æ”»æ•°æœ€å¤š',\n  `totalspent` BIGINT COMMENT 'æ€»æ¶ˆè´¹',\n  `economyscore` BIGINT COMMENT 'æœ¬åœºç»æµå¾—åˆ†',\n  `killscount` DOUBLE COMMENT 'å‡»æ€æ•°',\n  `deathscount` DOUBLE COMMENT 'æ­»äº¡æ•°',\n  `assistscount` DOUBLE COMMENT 'åŠ©æ”»æ•°',\n  `clutchcount` BIGINT COMMENT 'åŠ›å…‹åƒé’§æ¬¡æ•°',\n  `acecount` BIGINT COMMENT 'ç‹ç‰Œç²¾é”æ¬¡æ•°',\n  `teamacecount` BIGINT COMMENT 'ç‹ç‰Œå°é˜Ÿæ¬¡æ•°',\n  `thriftycount` BIGINT COMMENT 'é«˜æ•ˆç«åŠ›æ¬¡æ•°',\n  `flawlesscount` BIGINT COMMENT 'å®Œç¾å›¢ç­æ¬¡æ•°',\n  `triplekillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ3æ€çš„æ¬¡æ•°',\n  `quadrakillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ4æ€çš„æ¬¡æ•°',\n  `pentakillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ5æ€çš„æ¬¡æ•°',\n  `sixkillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ6æ€(åŠä»¥ä¸Š)çš„æ¬¡æ•°',\n  `plantcount` BIGINT COMMENT 'ä¸‹åŒ…æ¬¡æ•°',\n  `defusecount` BIGINT COMMENT 'æ‹†åŒ…æ¬¡æ•°',\n  `firstkillcount` BIGINT COMMENT 'è·å¾—é¦–æ€çš„å›åˆæ¬¡æ•°',\n  `completionstate` TEXT COMMENT 'æ¯”èµ›å®Œæˆæƒ…å†µ',\n  `roundsplayed` BIGINT COMMENT 'å®é™…æ¸¸ç©å›åˆæ•°',\n  `roundswon` BIGINT COMMENT 'è·èƒœå›åˆæ•°',\n  `characterid` TEXT COMMENT 'è‹±é›„ID',\n  `totaldamage` DOUBLE COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººé€ æˆçš„æ€»ä¼¤å®³å€¼',\n  `competitivetier` BIGINT COMMENT 'æ’ä½ç­‰çº§',\n  `isplayercompleted` BIGINT COMMENT 'ç©å®¶æ˜¯å¦å®Œæˆæ¯”èµ›ï¼Œä»»ä½•æ‰çº¿ã€æŒ‚æœºä¼šè§†ä¸ºæœªå®Œæˆ',\n  `ismatchcompleted` BIGINT COMMENT 'æ¯”èµ›æ˜¯å¦å®Œæˆ',\n  `totalheadshots` DOUBLE COMMENT 'å¤´éƒ¨å‘½ä¸­æ€»æ¬¡æ•°',\n  `totalbodyshots` DOUBLE COMMENT 'èº«ä½“å‘½ä¸­æ€»æ¬¡æ•°',\n  `totallegshots` DOUBLE COMMENT 'æ‰‹éƒ¨å‘½ä¸­æ€»æ¬¡æ•°',\n  `abilitydefaultcasts` BIGINT COMMENT 'é»˜è®¤æŠ€èƒ½ä½¿ç”¨æ€»æ¬¡æ•°',\n  `ability1casts` BIGINT COMMENT 'æŠ€èƒ½Qä½¿ç”¨æ€»æ¬¡æ•°',\n  `ability2casts` BIGINT COMMENT 'æŠ€èƒ½Cä½¿ç”¨æ€»æ¬¡æ•°',\n  `ultimatecasts` BIGINT COMMENT 'å¤§æ‹›ä½¿ç”¨æ€»æ¬¡æ•°',\n  `provisioningflowid` TEXT COMMENT 'provisioningFlowId'\n);\nCREATE TABLE `dim_argothek_gplayerid_vroleid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameSvrId` TEXT COMMENT 'æœåŠ¡å™¨',\n  `vGameAppid` TEXT COMMENT 'appid',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'playerid',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'ç‰ˆæœ¬',\n  `cBitmap` TEXT COMMENT 'ä½å›¾',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ4'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\næ¸ é“ç­›é€‰æ¡ä»¶ï¼šiloginway = 3\nç”¨æˆ·IDç­›é€‰swxid_type = \"qq\" -- ç­›é€‰swxid_typeä¸º\"qq\"\n\n",
  "chosen": "SELECT DISTINCT qq_dim.suserid as qq\nFROM dws_argothek_oss_login_di login\nJOIN dim_argothek_gplayerid2qqwxid_df qq_dim \n  ON login.iuserid = qq_dim.iuserid \nWHERE login.statis_date BETWEEN 20250324 AND 20250330\n  AND login.iloginway = 3\n  AND qq_dim.swxid_type = 'qq'\n  AND qq_dim.dtstatdate = '20250330'\n  AND EXISTS (\n    SELECT 1\n    FROM dwd_argothek_playermatchstats_hi matches\n    WHERE matches.vroleid = qq_dim.vRoleID\n      AND DATE(matches.dteventtime) BETWEEN '2025-03-24' AND '2025-03-30'\n  )\nORDER BY qq_dim.suserid",
  "rejected": "SELECT\n  T1.suserid\nFROM `dim_argothek_gplayerid2qqwxid_df` AS T1\nINNER JOIN `dws_argothek_oss_login_di` AS T2\n  ON T1.iuserid = T2.iuserid\nWHERE\n  T2.statis_date BETWEEN 20250324 AND 20250330\n  AND T2.iloginway = 3\n  AND T1.swxid_type = 'qq'"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´3æœˆ24æ—¥è‡³2025å¹´3æœˆ30æ—¥ï¼Œè‡³å°‘å®Œæˆè¿‡ä¸€åœºå¯¹å±€ï¼Œä¸”æ¸ é“ç™»å½•çš„ç”¨æˆ·qq\nè¾“å‡º:qq\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dwd_argothek_playermatchstats_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'partition fields',\n  `dteventtime` TEXT COMMENT 'äº‹ä»¶æ—¶é—´ - YYYY-MM-DD HH:MM:SS',\n  `ieventid` TEXT COMMENT 'äº‹ä»¶ ID',\n  `matchid` TEXT COMMENT 'å¯¹å±€ ID - æŸ¥è¯¢å¯¹å±€çš„key',\n  `vroleid` TEXT COMMENT 'å½“å‰æ—¥å¿—æ‰€ä»£è¡¨çš„ç©å®¶çš„è§’è‰² ID',\n  `wonmatch` BIGINT COMMENT 'æ˜¯å¦è·èƒœ',\n  `mapid` TEXT COMMENT 'åœ°å›¾ID',\n  `seasonid` TEXT COMMENT 'èµ›å­£ID',\n  `queueid` TEXT COMMENT 'æ¨¡å¼ID',\n  `gamestartmillis` DOUBLE COMMENT 'æ¯”èµ›å¼€å§‹æ—¶é—´(æ¯«ç§’)',\n  `gamelengthmillis` DOUBLE COMMENT 'å¯¹å±€æ—¶é•¿',\n  `teamid` TEXT COMMENT 'é˜Ÿä¼ IDï¼ŒBlueã€Red',\n  `partyid` TEXT COMMENT 'ç»„é˜Ÿæˆ¿é—´ ID',\n  `ismatchmvp` BIGINT COMMENT 'æ˜¯å¦å…¨å±€MVP',\n  `isteammvp` BIGINT COMMENT 'æ˜¯å¦é˜Ÿä¼MVP',\n  `totalscore` DOUBLE COMMENT 'æœ¬åœºæ¯”èµ›æ€»å¾—åˆ†',\n  `istopdamage` BIGINT COMMENT 'æ˜¯å¦ä¼¤å®³æœ€é«˜',\n  `istopplant` BIGINT COMMENT 'æ˜¯å¦ä¸‹åŒ…æœ€å¤š',\n  `istopdefuse` BIGINT COMMENT 'æ˜¯å¦æ‹†é™¤æ¬¡æ•°æœ€å¤š',\n  `istopkill` BIGINT COMMENT 'æ˜¯å¦å‡»æ€æ•°æœ€å¤š',\n  `istopassist` BIGINT COMMENT 'æ˜¯å¦åŠ©æ”»æ•°æœ€å¤š',\n  `totalspent` BIGINT COMMENT 'æ€»æ¶ˆè´¹',\n  `economyscore` BIGINT COMMENT 'æœ¬åœºç»æµå¾—åˆ†',\n  `killscount` DOUBLE COMMENT 'å‡»æ€æ•°',\n  `deathscount` DOUBLE COMMENT 'æ­»äº¡æ•°',\n  `assistscount` DOUBLE COMMENT 'åŠ©æ”»æ•°',\n  `clutchcount` BIGINT COMMENT 'åŠ›å…‹åƒé’§æ¬¡æ•°',\n  `acecount` BIGINT COMMENT 'ç‹ç‰Œç²¾é”æ¬¡æ•°',\n  `teamacecount` BIGINT COMMENT 'ç‹ç‰Œå°é˜Ÿæ¬¡æ•°',\n  `thriftycount` BIGINT COMMENT 'é«˜æ•ˆç«åŠ›æ¬¡æ•°',\n  `flawlesscount` BIGINT COMMENT 'å®Œç¾å›¢ç­æ¬¡æ•°',\n  `triplekillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ3æ€çš„æ¬¡æ•°',\n  `quadrakillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ4æ€çš„æ¬¡æ•°',\n  `pentakillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ5æ€çš„æ¬¡æ•°',\n  `sixkillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ6æ€(åŠä»¥ä¸Š)çš„æ¬¡æ•°',\n  `plantcount` BIGINT COMMENT 'ä¸‹åŒ…æ¬¡æ•°',\n  `defusecount` BIGINT COMMENT 'æ‹†åŒ…æ¬¡æ•°',\n  `firstkillcount` BIGINT COMMENT 'è·å¾—é¦–æ€çš„å›åˆæ¬¡æ•°',\n  `completionstate` TEXT COMMENT 'æ¯”èµ›å®Œæˆæƒ…å†µ',\n  `roundsplayed` BIGINT COMMENT 'å®é™…æ¸¸ç©å›åˆæ•°',\n  `roundswon` BIGINT COMMENT 'è·èƒœå›åˆæ•°',\n  `characterid` TEXT COMMENT 'è‹±é›„ID',\n  `totaldamage` DOUBLE COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººé€ æˆçš„æ€»ä¼¤å®³å€¼',\n  `competitivetier` BIGINT COMMENT 'æ’ä½ç­‰çº§',\n  `isplayercompleted` BIGINT COMMENT 'ç©å®¶æ˜¯å¦å®Œæˆæ¯”èµ›ï¼Œä»»ä½•æ‰çº¿ã€æŒ‚æœºä¼šè§†ä¸ºæœªå®Œæˆ',\n  `ismatchcompleted` BIGINT COMMENT 'æ¯”èµ›æ˜¯å¦å®Œæˆ',\n  `totalheadshots` DOUBLE COMMENT 'å¤´éƒ¨å‘½ä¸­æ€»æ¬¡æ•°',\n  `totalbodyshots` DOUBLE COMMENT 'èº«ä½“å‘½ä¸­æ€»æ¬¡æ•°',\n  `totallegshots` DOUBLE COMMENT 'æ‰‹éƒ¨å‘½ä¸­æ€»æ¬¡æ•°',\n  `abilitydefaultcasts` BIGINT COMMENT 'é»˜è®¤æŠ€èƒ½ä½¿ç”¨æ€»æ¬¡æ•°',\n  `ability1casts` BIGINT COMMENT 'æŠ€èƒ½Qä½¿ç”¨æ€»æ¬¡æ•°',\n  `ability2casts` BIGINT COMMENT 'æŠ€èƒ½Cä½¿ç”¨æ€»æ¬¡æ•°',\n  `ultimatecasts` BIGINT COMMENT 'å¤§æ‹›ä½¿ç”¨æ€»æ¬¡æ•°',\n  `provisioningflowid` TEXT COMMENT 'provisioningFlowId'\n);\nCREATE TABLE `dim_argothek_gplayerid_vroleid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameSvrId` TEXT COMMENT 'æœåŠ¡å™¨',\n  `vGameAppid` TEXT COMMENT 'appid',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'playerid',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'ç‰ˆæœ¬',\n  `cBitmap` TEXT COMMENT 'ä½å›¾',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ4'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\næ¸ é“ç­›é€‰æ¡ä»¶ï¼šiloginway = 3\nç”¨æˆ·IDç­›é€‰swxid_type = \"qq\" -- ç­›é€‰swxid_typeä¸º\"qq\"\n\n",
  "chosen": "SELECT DISTINCT qq_dim.suserid as qq\nFROM dws_argothek_oss_login_di login\nJOIN dim_argothek_gplayerid2qqwxid_df qq_dim \n  ON login.iuserid = qq_dim.iuserid \nWHERE login.statis_date BETWEEN 20250324 AND 20250330\n  AND login.iloginway = 3\n  AND qq_dim.swxid_type = 'qq'\n  AND qq_dim.dtstatdate = '20250330'\n  AND EXISTS (\n    SELECT 1\n    FROM dwd_argothek_playermatchstats_hi matches\n    WHERE matches.vroleid = qq_dim.vRoleID\n      AND DATE(matches.dteventtime) BETWEEN '2025-03-24' AND '2025-03-30'\n  )\nORDER BY qq_dim.suserid",
  "rejected": "SELECT\n  T1.suserid\nFROM `dim_argothek_gplayerid2qqwxid_df` AS T1\nINNER JOIN (\n  SELECT\n    iuserid,\n    MAX(statis_date) AS max_statis_date\n  FROM `dws_argothek_oss_login_di`\n  WHERE\n    iloginway = 3\n    AND statis_date BETWEEN 20250324 AND 20250330\n  GROUP BY\n    iuserid\n) AS T2\n  ON T1.iuserid = T2.iuserid\nWHERE\n  T1.swxid_type = 'qq'"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´3æœˆ24æ—¥è‡³2025å¹´3æœˆ30æ—¥ï¼Œè‡³å°‘å®Œæˆè¿‡ä¸€åœºå¯¹å±€ï¼Œä¸”æ¸ é“ç™»å½•çš„ç”¨æˆ·qq\nè¾“å‡º:qq\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dwd_argothek_playermatchstats_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'partition fields',\n  `dteventtime` TEXT COMMENT 'äº‹ä»¶æ—¶é—´ - YYYY-MM-DD HH:MM:SS',\n  `ieventid` TEXT COMMENT 'äº‹ä»¶ ID',\n  `matchid` TEXT COMMENT 'å¯¹å±€ ID - æŸ¥è¯¢å¯¹å±€çš„key',\n  `vroleid` TEXT COMMENT 'å½“å‰æ—¥å¿—æ‰€ä»£è¡¨çš„ç©å®¶çš„è§’è‰² ID',\n  `wonmatch` BIGINT COMMENT 'æ˜¯å¦è·èƒœ',\n  `mapid` TEXT COMMENT 'åœ°å›¾ID',\n  `seasonid` TEXT COMMENT 'èµ›å­£ID',\n  `queueid` TEXT COMMENT 'æ¨¡å¼ID',\n  `gamestartmillis` DOUBLE COMMENT 'æ¯”èµ›å¼€å§‹æ—¶é—´(æ¯«ç§’)',\n  `gamelengthmillis` DOUBLE COMMENT 'å¯¹å±€æ—¶é•¿',\n  `teamid` TEXT COMMENT 'é˜Ÿä¼ IDï¼ŒBlueã€Red',\n  `partyid` TEXT COMMENT 'ç»„é˜Ÿæˆ¿é—´ ID',\n  `ismatchmvp` BIGINT COMMENT 'æ˜¯å¦å…¨å±€MVP',\n  `isteammvp` BIGINT COMMENT 'æ˜¯å¦é˜Ÿä¼MVP',\n  `totalscore` DOUBLE COMMENT 'æœ¬åœºæ¯”èµ›æ€»å¾—åˆ†',\n  `istopdamage` BIGINT COMMENT 'æ˜¯å¦ä¼¤å®³æœ€é«˜',\n  `istopplant` BIGINT COMMENT 'æ˜¯å¦ä¸‹åŒ…æœ€å¤š',\n  `istopdefuse` BIGINT COMMENT 'æ˜¯å¦æ‹†é™¤æ¬¡æ•°æœ€å¤š',\n  `istopkill` BIGINT COMMENT 'æ˜¯å¦å‡»æ€æ•°æœ€å¤š',\n  `istopassist` BIGINT COMMENT 'æ˜¯å¦åŠ©æ”»æ•°æœ€å¤š',\n  `totalspent` BIGINT COMMENT 'æ€»æ¶ˆè´¹',\n  `economyscore` BIGINT COMMENT 'æœ¬åœºç»æµå¾—åˆ†',\n  `killscount` DOUBLE COMMENT 'å‡»æ€æ•°',\n  `deathscount` DOUBLE COMMENT 'æ­»äº¡æ•°',\n  `assistscount` DOUBLE COMMENT 'åŠ©æ”»æ•°',\n  `clutchcount` BIGINT COMMENT 'åŠ›å…‹åƒé’§æ¬¡æ•°',\n  `acecount` BIGINT COMMENT 'ç‹ç‰Œç²¾é”æ¬¡æ•°',\n  `teamacecount` BIGINT COMMENT 'ç‹ç‰Œå°é˜Ÿæ¬¡æ•°',\n  `thriftycount` BIGINT COMMENT 'é«˜æ•ˆç«åŠ›æ¬¡æ•°',\n  `flawlesscount` BIGINT COMMENT 'å®Œç¾å›¢ç­æ¬¡æ•°',\n  `triplekillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ3æ€çš„æ¬¡æ•°',\n  `quadrakillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ4æ€çš„æ¬¡æ•°',\n  `pentakillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ5æ€çš„æ¬¡æ•°',\n  `sixkillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ6æ€(åŠä»¥ä¸Š)çš„æ¬¡æ•°',\n  `plantcount` BIGINT COMMENT 'ä¸‹åŒ…æ¬¡æ•°',\n  `defusecount` BIGINT COMMENT 'æ‹†åŒ…æ¬¡æ•°',\n  `firstkillcount` BIGINT COMMENT 'è·å¾—é¦–æ€çš„å›åˆæ¬¡æ•°',\n  `completionstate` TEXT COMMENT 'æ¯”èµ›å®Œæˆæƒ…å†µ',\n  `roundsplayed` BIGINT COMMENT 'å®é™…æ¸¸ç©å›åˆæ•°',\n  `roundswon` BIGINT COMMENT 'è·èƒœå›åˆæ•°',\n  `characterid` TEXT COMMENT 'è‹±é›„ID',\n  `totaldamage` DOUBLE COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººé€ æˆçš„æ€»ä¼¤å®³å€¼',\n  `competitivetier` BIGINT COMMENT 'æ’ä½ç­‰çº§',\n  `isplayercompleted` BIGINT COMMENT 'ç©å®¶æ˜¯å¦å®Œæˆæ¯”èµ›ï¼Œä»»ä½•æ‰çº¿ã€æŒ‚æœºä¼šè§†ä¸ºæœªå®Œæˆ',\n  `ismatchcompleted` BIGINT COMMENT 'æ¯”èµ›æ˜¯å¦å®Œæˆ',\n  `totalheadshots` DOUBLE COMMENT 'å¤´éƒ¨å‘½ä¸­æ€»æ¬¡æ•°',\n  `totalbodyshots` DOUBLE COMMENT 'èº«ä½“å‘½ä¸­æ€»æ¬¡æ•°',\n  `totallegshots` DOUBLE COMMENT 'æ‰‹éƒ¨å‘½ä¸­æ€»æ¬¡æ•°',\n  `abilitydefaultcasts` BIGINT COMMENT 'é»˜è®¤æŠ€èƒ½ä½¿ç”¨æ€»æ¬¡æ•°',\n  `ability1casts` BIGINT COMMENT 'æŠ€èƒ½Qä½¿ç”¨æ€»æ¬¡æ•°',\n  `ability2casts` BIGINT COMMENT 'æŠ€èƒ½Cä½¿ç”¨æ€»æ¬¡æ•°',\n  `ultimatecasts` BIGINT COMMENT 'å¤§æ‹›ä½¿ç”¨æ€»æ¬¡æ•°',\n  `provisioningflowid` TEXT COMMENT 'provisioningFlowId'\n);\nCREATE TABLE `dim_argothek_gplayerid_vroleid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameSvrId` TEXT COMMENT 'æœåŠ¡å™¨',\n  `vGameAppid` TEXT COMMENT 'appid',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'playerid',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'ç‰ˆæœ¬',\n  `cBitmap` TEXT COMMENT 'ä½å›¾',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ4'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\næ¸ é“ç­›é€‰æ¡ä»¶ï¼šiloginway = 3\nç”¨æˆ·IDç­›é€‰swxid_type = \"qq\" -- ç­›é€‰swxid_typeä¸º\"qq\"\n\n",
  "chosen": "SELECT DISTINCT qq_dim.suserid as qq\nFROM dws_argothek_oss_login_di login\nJOIN dim_argothek_gplayerid2qqwxid_df qq_dim \n  ON login.iuserid = qq_dim.iuserid \nWHERE login.statis_date BETWEEN 20250324 AND 20250330\n  AND login.iloginway = 3\n  AND qq_dim.swxid_type = 'qq'\n  AND qq_dim.dtstatdate = '20250330'\n  AND EXISTS (\n    SELECT 1\n    FROM dwd_argothek_playermatchstats_hi matches\n    WHERE matches.vroleid = qq_dim.vRoleID\n      AND DATE(matches.dteventtime) BETWEEN '2025-03-24' AND '2025-03-30'\n  )\nORDER BY qq_dim.suserid",
  "rejected": "SELECT DISTINCT\n  T1.suserid\nFROM `dim_argothek_gplayerid2qqwxid_df` AS T1\nINNER JOIN `dws_argothek_oss_login_di` AS T2\n  ON T1.iuserid = T2.iuserid\nWHERE\n  T2.statis_date BETWEEN 20250324 AND 20250330\n  AND T2.iloginway = 3\n  AND T1.swxid_type = 'qq'"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´3æœˆ24æ—¥è‡³2025å¹´3æœˆ30æ—¥ï¼Œè‡³å°‘å®Œæˆè¿‡ä¸€åœºå¯¹å±€ï¼Œä¸”æ¸ é“ç™»å½•çš„ç”¨æˆ·qq\nè¾“å‡º:qq\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dwd_argothek_playermatchstats_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'partition fields',\n  `dteventtime` TEXT COMMENT 'äº‹ä»¶æ—¶é—´ - YYYY-MM-DD HH:MM:SS',\n  `ieventid` TEXT COMMENT 'äº‹ä»¶ ID',\n  `matchid` TEXT COMMENT 'å¯¹å±€ ID - æŸ¥è¯¢å¯¹å±€çš„key',\n  `vroleid` TEXT COMMENT 'å½“å‰æ—¥å¿—æ‰€ä»£è¡¨çš„ç©å®¶çš„è§’è‰² ID',\n  `wonmatch` BIGINT COMMENT 'æ˜¯å¦è·èƒœ',\n  `mapid` TEXT COMMENT 'åœ°å›¾ID',\n  `seasonid` TEXT COMMENT 'èµ›å­£ID',\n  `queueid` TEXT COMMENT 'æ¨¡å¼ID',\n  `gamestartmillis` DOUBLE COMMENT 'æ¯”èµ›å¼€å§‹æ—¶é—´(æ¯«ç§’)',\n  `gamelengthmillis` DOUBLE COMMENT 'å¯¹å±€æ—¶é•¿',\n  `teamid` TEXT COMMENT 'é˜Ÿä¼ IDï¼ŒBlueã€Red',\n  `partyid` TEXT COMMENT 'ç»„é˜Ÿæˆ¿é—´ ID',\n  `ismatchmvp` BIGINT COMMENT 'æ˜¯å¦å…¨å±€MVP',\n  `isteammvp` BIGINT COMMENT 'æ˜¯å¦é˜Ÿä¼MVP',\n  `totalscore` DOUBLE COMMENT 'æœ¬åœºæ¯”èµ›æ€»å¾—åˆ†',\n  `istopdamage` BIGINT COMMENT 'æ˜¯å¦ä¼¤å®³æœ€é«˜',\n  `istopplant` BIGINT COMMENT 'æ˜¯å¦ä¸‹åŒ…æœ€å¤š',\n  `istopdefuse` BIGINT COMMENT 'æ˜¯å¦æ‹†é™¤æ¬¡æ•°æœ€å¤š',\n  `istopkill` BIGINT COMMENT 'æ˜¯å¦å‡»æ€æ•°æœ€å¤š',\n  `istopassist` BIGINT COMMENT 'æ˜¯å¦åŠ©æ”»æ•°æœ€å¤š',\n  `totalspent` BIGINT COMMENT 'æ€»æ¶ˆè´¹',\n  `economyscore` BIGINT COMMENT 'æœ¬åœºç»æµå¾—åˆ†',\n  `killscount` DOUBLE COMMENT 'å‡»æ€æ•°',\n  `deathscount` DOUBLE COMMENT 'æ­»äº¡æ•°',\n  `assistscount` DOUBLE COMMENT 'åŠ©æ”»æ•°',\n  `clutchcount` BIGINT COMMENT 'åŠ›å…‹åƒé’§æ¬¡æ•°',\n  `acecount` BIGINT COMMENT 'ç‹ç‰Œç²¾é”æ¬¡æ•°',\n  `teamacecount` BIGINT COMMENT 'ç‹ç‰Œå°é˜Ÿæ¬¡æ•°',\n  `thriftycount` BIGINT COMMENT 'é«˜æ•ˆç«åŠ›æ¬¡æ•°',\n  `flawlesscount` BIGINT COMMENT 'å®Œç¾å›¢ç­æ¬¡æ•°',\n  `triplekillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ3æ€çš„æ¬¡æ•°',\n  `quadrakillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ4æ€çš„æ¬¡æ•°',\n  `pentakillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ5æ€çš„æ¬¡æ•°',\n  `sixkillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ6æ€(åŠä»¥ä¸Š)çš„æ¬¡æ•°',\n  `plantcount` BIGINT COMMENT 'ä¸‹åŒ…æ¬¡æ•°',\n  `defusecount` BIGINT COMMENT 'æ‹†åŒ…æ¬¡æ•°',\n  `firstkillcount` BIGINT COMMENT 'è·å¾—é¦–æ€çš„å›åˆæ¬¡æ•°',\n  `completionstate` TEXT COMMENT 'æ¯”èµ›å®Œæˆæƒ…å†µ',\n  `roundsplayed` BIGINT COMMENT 'å®é™…æ¸¸ç©å›åˆæ•°',\n  `roundswon` BIGINT COMMENT 'è·èƒœå›åˆæ•°',\n  `characterid` TEXT COMMENT 'è‹±é›„ID',\n  `totaldamage` DOUBLE COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººé€ æˆçš„æ€»ä¼¤å®³å€¼',\n  `competitivetier` BIGINT COMMENT 'æ’ä½ç­‰çº§',\n  `isplayercompleted` BIGINT COMMENT 'ç©å®¶æ˜¯å¦å®Œæˆæ¯”èµ›ï¼Œä»»ä½•æ‰çº¿ã€æŒ‚æœºä¼šè§†ä¸ºæœªå®Œæˆ',\n  `ismatchcompleted` BIGINT COMMENT 'æ¯”èµ›æ˜¯å¦å®Œæˆ',\n  `totalheadshots` DOUBLE COMMENT 'å¤´éƒ¨å‘½ä¸­æ€»æ¬¡æ•°',\n  `totalbodyshots` DOUBLE COMMENT 'èº«ä½“å‘½ä¸­æ€»æ¬¡æ•°',\n  `totallegshots` DOUBLE COMMENT 'æ‰‹éƒ¨å‘½ä¸­æ€»æ¬¡æ•°',\n  `abilitydefaultcasts` BIGINT COMMENT 'é»˜è®¤æŠ€èƒ½ä½¿ç”¨æ€»æ¬¡æ•°',\n  `ability1casts` BIGINT COMMENT 'æŠ€èƒ½Qä½¿ç”¨æ€»æ¬¡æ•°',\n  `ability2casts` BIGINT COMMENT 'æŠ€èƒ½Cä½¿ç”¨æ€»æ¬¡æ•°',\n  `ultimatecasts` BIGINT COMMENT 'å¤§æ‹›ä½¿ç”¨æ€»æ¬¡æ•°',\n  `provisioningflowid` TEXT COMMENT 'provisioningFlowId'\n);\nCREATE TABLE `dim_argothek_gplayerid_vroleid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameSvrId` TEXT COMMENT 'æœåŠ¡å™¨',\n  `vGameAppid` TEXT COMMENT 'appid',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'playerid',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'ç‰ˆæœ¬',\n  `cBitmap` TEXT COMMENT 'ä½å›¾',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ4'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\næ¸ é“ç­›é€‰æ¡ä»¶ï¼šiloginway = 3\nç”¨æˆ·IDç­›é€‰swxid_type = \"qq\" -- ç­›é€‰swxid_typeä¸º\"qq\"\n\n",
  "chosen": "SELECT DISTINCT qq_dim.suserid as qq\nFROM dws_argothek_oss_login_di login\nJOIN dim_argothek_gplayerid2qqwxid_df qq_dim \n  ON login.iuserid = qq_dim.iuserid \nWHERE login.statis_date BETWEEN 20250324 AND 20250330\n  AND login.iloginway = 3\n  AND qq_dim.swxid_type = 'qq'\n  AND qq_dim.dtstatdate = '20250330'\n  AND EXISTS (\n    SELECT 1\n    FROM dwd_argothek_playermatchstats_hi matches\n    WHERE matches.vroleid = qq_dim.vRoleID\n      AND DATE(matches.dteventtime) BETWEEN '2025-03-24' AND '2025-03-30'\n  )\nORDER BY qq_dim.suserid",
  "rejected": "SELECT\n  T1.suserid\nFROM `dim_argothek_gplayerid2qqwxid_df` AS T1\nINNER JOIN (\n  SELECT\n    vroleid,\n    matchid,\n    dteventtime\n  FROM `dwd_argothek_playermatchstats_hi`\n  WHERE\n    `tdbank_imp_date` BETWEEN '2025-03-24' AND '2025-03-30'\n    AND `ismatchcompleted` = 1\n) AS T2\n  ON T1.vRoleID = T2.vroleid\nWHERE\n  T1.swxid_type = 'qq'\n  AND T1.dtstatdate BETWEEN '2025-03-24' AND '2025-03-30'\n  AND T1.cBitmap LIKE '%1%'\nGROUP BY\n  T1.suserid"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´3æœˆ24æ—¥è‡³2025å¹´3æœˆ30æ—¥ï¼Œè‡³å°‘å®Œæˆè¿‡ä¸€åœºå¯¹å±€ï¼Œä¸”æ¸ é“ç™»å½•çš„ç”¨æˆ·qq\nè¾“å‡º:qq\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dwd_argothek_playermatchstats_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'partition fields',\n  `dteventtime` TEXT COMMENT 'äº‹ä»¶æ—¶é—´ - YYYY-MM-DD HH:MM:SS',\n  `ieventid` TEXT COMMENT 'äº‹ä»¶ ID',\n  `matchid` TEXT COMMENT 'å¯¹å±€ ID - æŸ¥è¯¢å¯¹å±€çš„key',\n  `vroleid` TEXT COMMENT 'å½“å‰æ—¥å¿—æ‰€ä»£è¡¨çš„ç©å®¶çš„è§’è‰² ID',\n  `wonmatch` BIGINT COMMENT 'æ˜¯å¦è·èƒœ',\n  `mapid` TEXT COMMENT 'åœ°å›¾ID',\n  `seasonid` TEXT COMMENT 'èµ›å­£ID',\n  `queueid` TEXT COMMENT 'æ¨¡å¼ID',\n  `gamestartmillis` DOUBLE COMMENT 'æ¯”èµ›å¼€å§‹æ—¶é—´(æ¯«ç§’)',\n  `gamelengthmillis` DOUBLE COMMENT 'å¯¹å±€æ—¶é•¿',\n  `teamid` TEXT COMMENT 'é˜Ÿä¼ IDï¼ŒBlueã€Red',\n  `partyid` TEXT COMMENT 'ç»„é˜Ÿæˆ¿é—´ ID',\n  `ismatchmvp` BIGINT COMMENT 'æ˜¯å¦å…¨å±€MVP',\n  `isteammvp` BIGINT COMMENT 'æ˜¯å¦é˜Ÿä¼MVP',\n  `totalscore` DOUBLE COMMENT 'æœ¬åœºæ¯”èµ›æ€»å¾—åˆ†',\n  `istopdamage` BIGINT COMMENT 'æ˜¯å¦ä¼¤å®³æœ€é«˜',\n  `istopplant` BIGINT COMMENT 'æ˜¯å¦ä¸‹åŒ…æœ€å¤š',\n  `istopdefuse` BIGINT COMMENT 'æ˜¯å¦æ‹†é™¤æ¬¡æ•°æœ€å¤š',\n  `istopkill` BIGINT COMMENT 'æ˜¯å¦å‡»æ€æ•°æœ€å¤š',\n  `istopassist` BIGINT COMMENT 'æ˜¯å¦åŠ©æ”»æ•°æœ€å¤š',\n  `totalspent` BIGINT COMMENT 'æ€»æ¶ˆè´¹',\n  `economyscore` BIGINT COMMENT 'æœ¬åœºç»æµå¾—åˆ†',\n  `killscount` DOUBLE COMMENT 'å‡»æ€æ•°',\n  `deathscount` DOUBLE COMMENT 'æ­»äº¡æ•°',\n  `assistscount` DOUBLE COMMENT 'åŠ©æ”»æ•°',\n  `clutchcount` BIGINT COMMENT 'åŠ›å…‹åƒé’§æ¬¡æ•°',\n  `acecount` BIGINT COMMENT 'ç‹ç‰Œç²¾é”æ¬¡æ•°',\n  `teamacecount` BIGINT COMMENT 'ç‹ç‰Œå°é˜Ÿæ¬¡æ•°',\n  `thriftycount` BIGINT COMMENT 'é«˜æ•ˆç«åŠ›æ¬¡æ•°',\n  `flawlesscount` BIGINT COMMENT 'å®Œç¾å›¢ç­æ¬¡æ•°',\n  `triplekillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ3æ€çš„æ¬¡æ•°',\n  `quadrakillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ4æ€çš„æ¬¡æ•°',\n  `pentakillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ5æ€çš„æ¬¡æ•°',\n  `sixkillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ6æ€(åŠä»¥ä¸Š)çš„æ¬¡æ•°',\n  `plantcount` BIGINT COMMENT 'ä¸‹åŒ…æ¬¡æ•°',\n  `defusecount` BIGINT COMMENT 'æ‹†åŒ…æ¬¡æ•°',\n  `firstkillcount` BIGINT COMMENT 'è·å¾—é¦–æ€çš„å›åˆæ¬¡æ•°',\n  `completionstate` TEXT COMMENT 'æ¯”èµ›å®Œæˆæƒ…å†µ',\n  `roundsplayed` BIGINT COMMENT 'å®é™…æ¸¸ç©å›åˆæ•°',\n  `roundswon` BIGINT COMMENT 'è·èƒœå›åˆæ•°',\n  `characterid` TEXT COMMENT 'è‹±é›„ID',\n  `totaldamage` DOUBLE COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººé€ æˆçš„æ€»ä¼¤å®³å€¼',\n  `competitivetier` BIGINT COMMENT 'æ’ä½ç­‰çº§',\n  `isplayercompleted` BIGINT COMMENT 'ç©å®¶æ˜¯å¦å®Œæˆæ¯”èµ›ï¼Œä»»ä½•æ‰çº¿ã€æŒ‚æœºä¼šè§†ä¸ºæœªå®Œæˆ',\n  `ismatchcompleted` BIGINT COMMENT 'æ¯”èµ›æ˜¯å¦å®Œæˆ',\n  `totalheadshots` DOUBLE COMMENT 'å¤´éƒ¨å‘½ä¸­æ€»æ¬¡æ•°',\n  `totalbodyshots` DOUBLE COMMENT 'èº«ä½“å‘½ä¸­æ€»æ¬¡æ•°',\n  `totallegshots` DOUBLE COMMENT 'æ‰‹éƒ¨å‘½ä¸­æ€»æ¬¡æ•°',\n  `abilitydefaultcasts` BIGINT COMMENT 'é»˜è®¤æŠ€èƒ½ä½¿ç”¨æ€»æ¬¡æ•°',\n  `ability1casts` BIGINT COMMENT 'æŠ€èƒ½Qä½¿ç”¨æ€»æ¬¡æ•°',\n  `ability2casts` BIGINT COMMENT 'æŠ€èƒ½Cä½¿ç”¨æ€»æ¬¡æ•°',\n  `ultimatecasts` BIGINT COMMENT 'å¤§æ‹›ä½¿ç”¨æ€»æ¬¡æ•°',\n  `provisioningflowid` TEXT COMMENT 'provisioningFlowId'\n);\nCREATE TABLE `dim_argothek_gplayerid_vroleid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameSvrId` TEXT COMMENT 'æœåŠ¡å™¨',\n  `vGameAppid` TEXT COMMENT 'appid',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'playerid',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'ç‰ˆæœ¬',\n  `cBitmap` TEXT COMMENT 'ä½å›¾',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ4'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\næ¸ é“ç­›é€‰æ¡ä»¶ï¼šiloginway = 3\nç”¨æˆ·IDç­›é€‰swxid_type = \"qq\" -- ç­›é€‰swxid_typeä¸º\"qq\"\n\n",
  "chosen": "SELECT DISTINCT qq_dim.suserid as qq\nFROM dws_argothek_oss_login_di login\nJOIN dim_argothek_gplayerid2qqwxid_df qq_dim \n  ON login.iuserid = qq_dim.iuserid \nWHERE login.statis_date BETWEEN 20250324 AND 20250330\n  AND login.iloginway = 3\n  AND qq_dim.swxid_type = 'qq'\n  AND qq_dim.dtstatdate = '20250330'\n  AND EXISTS (\n    SELECT 1\n    FROM dwd_argothek_playermatchstats_hi matches\n    WHERE matches.vroleid = qq_dim.vRoleID\n      AND DATE(matches.dteventtime) BETWEEN '2025-03-24' AND '2025-03-30'\n  )\nORDER BY qq_dim.suserid",
  "rejected": "SELECT DISTINCT\n  T1.suserid\nFROM `dim_argothek_gplayerid2qqwxid_df` AS T1\nINNER JOIN `dws_argothek_oss_login_di` AS T2\n  ON T1.iuserid = T2.iuserid\nWHERE\n  T2.statis_date BETWEEN 20250324 AND 20250330\n  AND T2.iloginway = 3\n  AND T1.swxid_type = 'qq'"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2025å¹´3æœˆ24æ—¥è‡³2025å¹´3æœˆ30æ—¥ï¼Œè‡³å°‘å®Œæˆè¿‡ä¸€åœºå¯¹å±€ï¼Œä¸”æ¸ é“ç™»å½•çš„ç”¨æˆ·qq\nè¾“å‡º:qq\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_argothek_oss_login_di` (\n  `statis_date` BIGINT COMMENT 'ç»Ÿè®¡æ—¶é—´',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·ID',\n  `ilogintime` BIGINT COMMENT 'ç™»å½•æ—¶é—´',\n  `ionlinetime` BIGINT COMMENT 'åœ¨çº¿æ—¶é•¿',\n  `ilevel` BIGINT COMMENT 'ç©å®¶ç­‰çº§',\n  `iplaytime` BIGINT COMMENT 'æ¸¸æˆæ—¶é•¿',\n  `iloginway` BIGINT COMMENT 'ç™»å½•æ¸ é“',\n  `ilogincount` BIGINT COMMENT 'ç™»å½•æ¬¡æ•°'\n);\nCREATE TABLE `dim_argothek_gplayerid2qqwxid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameAppid` TEXT COMMENT 'å¹³å°',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'ç”¨æˆ·id',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'æœåŠ¡å™¨',\n  `cBitmap` TEXT COMMENT 'æ´»è·ƒä½å›¾',\n  `iregdate` TEXT COMMENT 'æ³¨å†Œæ—¥æœŸ',\n  `swxid_type` TEXT COMMENT 'wxæˆ–qqç±»å‹',\n  `suserid` TEXT COMMENT 'å­˜å‚¨qq/wxidå¦‚æœå¾®ä¿¡å’Œqqæœ‰ç»‘å®šå…³ç³»ä¼˜å…ˆqq',\n  `sqq` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨suserid',\n  `swxid` TEXT COMMENT 'è¯¥å­—æ®µä¸ºåºŸå¼ƒå­—æ®µï¼Œä½¿ç”¨è½¬qqæ—¶ä½¿ç”¨wxid',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `itemp3` BIGINT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `itemp4` BIGINT COMMENT 'é¢„ç•™å­—æ®µ4',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ5',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ6',\n  `vtemp3` TEXT COMMENT 'é¢„ç•™å­—æ®µ7',\n  `vtemp4` TEXT COMMENT 'é¢„ç•™å­—æ®µ8',\n  `vtemp5` TEXT COMMENT 'é¢„ç•™å­—æ®µ9'\n);\nCREATE TABLE `dwd_argothek_playermatchstats_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'partition fields',\n  `dteventtime` TEXT COMMENT 'äº‹ä»¶æ—¶é—´ - YYYY-MM-DD HH:MM:SS',\n  `ieventid` TEXT COMMENT 'äº‹ä»¶ ID',\n  `matchid` TEXT COMMENT 'å¯¹å±€ ID - æŸ¥è¯¢å¯¹å±€çš„key',\n  `vroleid` TEXT COMMENT 'å½“å‰æ—¥å¿—æ‰€ä»£è¡¨çš„ç©å®¶çš„è§’è‰² ID',\n  `wonmatch` BIGINT COMMENT 'æ˜¯å¦è·èƒœ',\n  `mapid` TEXT COMMENT 'åœ°å›¾ID',\n  `seasonid` TEXT COMMENT 'èµ›å­£ID',\n  `queueid` TEXT COMMENT 'æ¨¡å¼ID',\n  `gamestartmillis` DOUBLE COMMENT 'æ¯”èµ›å¼€å§‹æ—¶é—´(æ¯«ç§’)',\n  `gamelengthmillis` DOUBLE COMMENT 'å¯¹å±€æ—¶é•¿',\n  `teamid` TEXT COMMENT 'é˜Ÿä¼ IDï¼ŒBlueã€Red',\n  `partyid` TEXT COMMENT 'ç»„é˜Ÿæˆ¿é—´ ID',\n  `ismatchmvp` BIGINT COMMENT 'æ˜¯å¦å…¨å±€MVP',\n  `isteammvp` BIGINT COMMENT 'æ˜¯å¦é˜Ÿä¼MVP',\n  `totalscore` DOUBLE COMMENT 'æœ¬åœºæ¯”èµ›æ€»å¾—åˆ†',\n  `istopdamage` BIGINT COMMENT 'æ˜¯å¦ä¼¤å®³æœ€é«˜',\n  `istopplant` BIGINT COMMENT 'æ˜¯å¦ä¸‹åŒ…æœ€å¤š',\n  `istopdefuse` BIGINT COMMENT 'æ˜¯å¦æ‹†é™¤æ¬¡æ•°æœ€å¤š',\n  `istopkill` BIGINT COMMENT 'æ˜¯å¦å‡»æ€æ•°æœ€å¤š',\n  `istopassist` BIGINT COMMENT 'æ˜¯å¦åŠ©æ”»æ•°æœ€å¤š',\n  `totalspent` BIGINT COMMENT 'æ€»æ¶ˆè´¹',\n  `economyscore` BIGINT COMMENT 'æœ¬åœºç»æµå¾—åˆ†',\n  `killscount` DOUBLE COMMENT 'å‡»æ€æ•°',\n  `deathscount` DOUBLE COMMENT 'æ­»äº¡æ•°',\n  `assistscount` DOUBLE COMMENT 'åŠ©æ”»æ•°',\n  `clutchcount` BIGINT COMMENT 'åŠ›å…‹åƒé’§æ¬¡æ•°',\n  `acecount` BIGINT COMMENT 'ç‹ç‰Œç²¾é”æ¬¡æ•°',\n  `teamacecount` BIGINT COMMENT 'ç‹ç‰Œå°é˜Ÿæ¬¡æ•°',\n  `thriftycount` BIGINT COMMENT 'é«˜æ•ˆç«åŠ›æ¬¡æ•°',\n  `flawlesscount` BIGINT COMMENT 'å®Œç¾å›¢ç­æ¬¡æ•°',\n  `triplekillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ3æ€çš„æ¬¡æ•°',\n  `quadrakillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ4æ€çš„æ¬¡æ•°',\n  `pentakillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ5æ€çš„æ¬¡æ•°',\n  `sixkillcount` BIGINT COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººå®Œæˆ6æ€(åŠä»¥ä¸Š)çš„æ¬¡æ•°',\n  `plantcount` BIGINT COMMENT 'ä¸‹åŒ…æ¬¡æ•°',\n  `defusecount` BIGINT COMMENT 'æ‹†åŒ…æ¬¡æ•°',\n  `firstkillcount` BIGINT COMMENT 'è·å¾—é¦–æ€çš„å›åˆæ¬¡æ•°',\n  `completionstate` TEXT COMMENT 'æ¯”èµ›å®Œæˆæƒ…å†µ',\n  `roundsplayed` BIGINT COMMENT 'å®é™…æ¸¸ç©å›åˆæ•°',\n  `roundswon` BIGINT COMMENT 'è·èƒœå›åˆæ•°',\n  `characterid` TEXT COMMENT 'è‹±é›„ID',\n  `totaldamage` DOUBLE COMMENT 'æœ¬åœºæ¯”èµ›ä¸ªäººé€ æˆçš„æ€»ä¼¤å®³å€¼',\n  `competitivetier` BIGINT COMMENT 'æ’ä½ç­‰çº§',\n  `isplayercompleted` BIGINT COMMENT 'ç©å®¶æ˜¯å¦å®Œæˆæ¯”èµ›ï¼Œä»»ä½•æ‰çº¿ã€æŒ‚æœºä¼šè§†ä¸ºæœªå®Œæˆ',\n  `ismatchcompleted` BIGINT COMMENT 'æ¯”èµ›æ˜¯å¦å®Œæˆ',\n  `totalheadshots` DOUBLE COMMENT 'å¤´éƒ¨å‘½ä¸­æ€»æ¬¡æ•°',\n  `totalbodyshots` DOUBLE COMMENT 'èº«ä½“å‘½ä¸­æ€»æ¬¡æ•°',\n  `totallegshots` DOUBLE COMMENT 'æ‰‹éƒ¨å‘½ä¸­æ€»æ¬¡æ•°',\n  `abilitydefaultcasts` BIGINT COMMENT 'é»˜è®¤æŠ€èƒ½ä½¿ç”¨æ€»æ¬¡æ•°',\n  `ability1casts` BIGINT COMMENT 'æŠ€èƒ½Qä½¿ç”¨æ€»æ¬¡æ•°',\n  `ability2casts` BIGINT COMMENT 'æŠ€èƒ½Cä½¿ç”¨æ€»æ¬¡æ•°',\n  `ultimatecasts` BIGINT COMMENT 'å¤§æ‹›ä½¿ç”¨æ€»æ¬¡æ•°',\n  `provisioningflowid` TEXT COMMENT 'provisioningFlowId'\n);\nCREATE TABLE `dim_argothek_gplayerid_vroleid_df` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `vGameSvrId` TEXT COMMENT 'æœåŠ¡å™¨',\n  `vGameAppid` TEXT COMMENT 'appid',\n  `iAreaID` TEXT COMMENT 'å¤§åŒº',\n  `iuserid` TEXT COMMENT 'playerid',\n  `vRoleID` TEXT COMMENT 'è§’è‰²id',\n  `iVersion` TEXT COMMENT 'ç‰ˆæœ¬',\n  `cBitmap` TEXT COMMENT 'ä½å›¾',\n  `itemp1` BIGINT COMMENT 'é¢„ç•™å­—æ®µ1',\n  `itemp2` BIGINT COMMENT 'é¢„ç•™å­—æ®µ2',\n  `vtemp1` TEXT COMMENT 'é¢„ç•™å­—æ®µ3',\n  `vtemp2` TEXT COMMENT 'é¢„ç•™å­—æ®µ4'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\næ¸ é“ç­›é€‰æ¡ä»¶ï¼šiloginway = 3\nç”¨æˆ·IDç­›é€‰swxid_type = \"qq\" -- ç­›é€‰swxid_typeä¸º\"qq\"\n\n",
  "chosen": "SELECT DISTINCT qq_dim.suserid as qq\nFROM dws_argothek_oss_login_di login\nJOIN dim_argothek_gplayerid2qqwxid_df qq_dim \n  ON login.iuserid = qq_dim.iuserid \nWHERE login.statis_date BETWEEN 20250324 AND 20250330\n  AND login.iloginway = 3\n  AND qq_dim.swxid_type = 'qq'\n  AND qq_dim.dtstatdate = '20250330'\n  AND EXISTS (\n    SELECT 1\n    FROM dwd_argothek_playermatchstats_hi matches\n    WHERE matches.vroleid = qq_dim.vRoleID\n      AND DATE(matches.dteventtime) BETWEEN '2025-03-24' AND '2025-03-30'\n  )\nORDER BY qq_dim.suserid",
  "rejected": "SELECT DISTINCT\n  T2.suserid\nFROM (SELECT\n  iuserid,\n  ilogintime,\n  iloginway\nFROM dws_argothek_oss_login_di\nWHERE (statis_date BETWEEN 20250324 AND 20250330)\n  AND (iloginway = 3)) AS T1\nINNER JOIN dim_argothek_gplayerid2qqwxid_df AS T2\n  ON T1.iuserid = T2.iuserid\nWHERE T2.swxid_type = 'qq'"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡ï¼š2024-01-01åˆ°2024-12-16ï¼Œè´­ä¹°é˜¶æ®µå‡ºç°äº†xæ¬¡æ­¦å™¨ä»£ä¹°ï¼Œé™¤è‡ªå®šä¹‰æ¨¡å¼ã€æ–°æ‰‹ã€è®­ç»ƒåœºå¤–æ‰€æœ‰æ¨¡å¼ã€‚\nè¾“å‡ºï¼šæ­¦å™¨ä»£ä¹°æ¬¡æ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dwd_argothek_matchdetails_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'åˆ†åŒºå­—æ®µ',\n  `dteventtime` TEXT COMMENT 'AP äº‹ä»¶æ—¶é—´: YYYY-MM-DD HH:MM:SS',\n  `apeventid` TEXT COMMENT 'AP äº‹ä»¶æ ‡è¯†ç¬¦',\n  `matchid` TEXT COMMENT 'Ares åŒ¹é… ID - Ares åŒ¹é…çš„ ID å­—ç¬¦ä¸²',\n  `mapid` TEXT COMMENT 'Ares åœ°å›¾ ID - æœåŠ¡ä»£ç ä¸­ä½¿ç”¨çš„ Ares åœ°å›¾ ID',\n  `provisioningflowid` TEXT COMMENT 'é…ç½®æµç¨‹ ID - å·²é…ç½®çš„æ¸¸æˆç±»å‹ã€‚ä¾‹å¦‚ï¼šæŠ€èƒ½æµ‹è¯•ã€åŒ¹é…ç­‰',\n  `gamepodid` TEXT COMMENT 'æ¸¸æˆèŠ‚ç‚¹ ID - æ¸¸æˆèŠ‚ç‚¹çš„å­—ç¬¦ä¸²è¡¨ç¤º',\n  `gamelengthmillis` DOUBLE COMMENT 'æ¯«ç§’ - åƒåˆ†ä¹‹ä¸€ç§’çš„å•ä½',\n  `gamestartmillis` DOUBLE COMMENT 'æ¯«ç§’ - åƒåˆ†ä¹‹ä¸€ç§’çš„å•ä½',\n  `gameversion` TEXT COMMENT 'Ares æ„å»ºç‰ˆæœ¬ - Ares äºŒè¿›åˆ¶æ–‡ä»¶çš„å®Œæ•´æ„å»ºç‰ˆæœ¬',\n  `iscompleted` BIGINT COMMENT 'æ¯”èµ›å®Œæˆæ ‡å¿— - å¦‚æœæ¯”èµ›æ­£å¸¸ç»“æŸå¹¶æœ‰æ¯”èµ›ç»“æœï¼Œåˆ™ä¸º True',\n  `customgamename` TEXT COMMENT 'Ares è‡ªå®šä¹‰æ¸¸æˆåç§° - è‡ªå®šä¹‰æ¸¸æˆçš„åç§°',\n  `module` TEXT COMMENT 'Ares å°„å‡»åœºæ¨¡å— - å¯ä»¥åœ¨å°„å‡»åœºä¸­æ¸¸ç©çš„æ¨¡å—',\n  `forcepostprocessing` BIGINT COMMENT 'å¼ºåˆ¶åå¤„ç†æ ‡å¿— - å¯¹äºéœ€è¦å¯ç”¨è°ƒè¯•çš„æ¯”èµ›ï¼Œè¯¥å€¼ä¸º Trueã€‚',\n  `queueid` TEXT COMMENT 'Ares é˜Ÿåˆ— ID - Ares é˜Ÿåˆ—çš„ ID å­—ç¬¦ä¸²',\n  `seasonid` TEXT COMMENT 'èµ›å­£ ID - èµ›å­£çš„ uuid',\n  `completionstate` TEXT COMMENT 'Ares å®ŒæˆçŠ¶æ€ - æ¯”èµ›å¦‚ä½•å®Œæˆçš„å­—ç¬¦ä¸²å€¼ã€‚ä¾‹å¦‚ï¼šCompletedï¼ˆå®Œæˆï¼‰, All_Disconnectedï¼ˆå…¨éƒ¨æ–­å¼€è¿æ¥ï¼‰',\n  `ismatchsampled` BIGINT COMMENT 'æ¯”èµ›æ˜¯å¦è¢«é‡‡æ ·æ ‡å¿— - æŒ‡ç¤ºè¯¥æ¯”èµ›æ˜¯å¦è¢«é‡‡æ ·ç”¨äºé¥æµ‹',\n  `players` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapMatchDetails_players',\n  `teams` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapMatchDetails_teams',\n  `roundresults` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapMatchDetails_roundResults',\n  `platforminfoplatformtype` TEXT COMMENT 'å®¢æˆ·ç«¯å¹³å°ç±»å‹ - æ­¤äº‹ä»¶æ¥æºçš„å®¢æˆ·ç«¯å¹³å°ï¼ˆä¾‹å¦‚ï¼šMobile æˆ– PCï¼‰',\n  `platforminfoplatformos` TEXT COMMENT 'å®¢æˆ·ç«¯å¹³å°æ“ä½œç³»ç»Ÿ - æ­¤äº‹ä»¶æ¥æºçš„å®¢æˆ·ç«¯æ“ä½œç³»ç»Ÿ',\n  `aplogtotal` BIGINT COMMENT 'ç”±æ­¤ AP äº‹ä»¶ç”Ÿæˆçš„æ—¥å¿—æ€»æ•°',\n  `platformtype` TEXT COMMENT 'å®¢æˆ·ç«¯å¹³å°ç±»å‹ - æ­¤äº‹ä»¶æ¥æºçš„å®¢æˆ·ç«¯å¹³å°ï¼ˆä¾‹å¦‚ï¼šMobile æˆ– PCï¼‰',\n  `apschemaversion` TEXT COMMENT 'apSchemaVersion'\n);\nCREATE TABLE `dwd_argothek_apinventorymovementlog_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'åˆ†åŒºå­—æ®µ',\n  `dteventtime` TEXT COMMENT 'AP äº‹ä»¶æ—¶é—´: YYYY-MM-DD HH:MM:SS',\n  `apeventid` TEXT COMMENT 'AP äº‹ä»¶æ ‡è¯†ç¬¦',\n  `matchinfobranch` TEXT COMMENT 'Ares Perforce åˆ†æ”¯ - æ­¤æ„å»ºç‰ˆæœ¬çš„æ¥æºåˆ†æ”¯',\n  `matchinfochangelist` TEXT COMMENT 'Perforce å˜æ›´åˆ—è¡¨ - Perforce å˜æ›´åˆ—è¡¨ç¼–å·',\n  `matchinfogameid` BIGINT COMMENT 'Ares æ¸¸æˆ ID - Ares åŒ¹é…çš„ ID å·ï¼ˆåŸºäºå¹³å°æ—¶é—´æˆ³ä¹‹å‰ï¼‰',\n  `matchinfogamemode` TEXT COMMENT 'Ares æ¸¸æˆæ¨¡å¼ - æ­£åœ¨è¿›è¡Œçš„æ¯”èµ›ç±»å‹',\n  `matchinfomap` TEXT COMMENT 'Ares åœ°å›¾ - Ares åœ°å›¾çš„åç§°',\n  `matchinfomatchid` TEXT COMMENT 'Ares åŒ¹é… ID - Ares åŒ¹é…çš„ ID å­—ç¬¦ä¸²',\n  `matchinfoversion` TEXT COMMENT 'Ares æ„å»ºç‰ˆæœ¬ - Ares äºŒè¿›åˆ¶æ–‡ä»¶çš„å®Œæ•´æ„å»ºç‰ˆæœ¬',\n  `roundinfoattackerscore` BIGINT COMMENT 'å›åˆå¾—åˆ† - Ares åŒ¹é…çš„å›åˆå¾—åˆ†',\n  `roundinfodefenderscore` BIGINT COMMENT 'å›åˆå¾—åˆ† - Ares åŒ¹é…çš„å›åˆå¾—åˆ†',\n  `roundinfomatchtime` BIGINT COMMENT 'æ¯”èµ›æ—¶é—´ - å½“å‰æ¯”èµ›å·²è¿›è¡Œçš„æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’',\n  `roundinforoundnumber` BIGINT COMMENT 'å›åˆç¼–å· - Ares åŒ¹é…çš„å›åˆç¼–å·',\n  `roundinforoundphase` TEXT COMMENT 'Ares å›åˆé˜¶æ®µ - Ares æ¸¸æˆå›åˆçš„æ¸¸æˆé˜¶æ®µ - å€¼ï¼šBetweenRoundsï¼ˆå›åˆä¹‹é—´ï¼‰, GameEndedï¼ˆæ¸¸æˆç»“æŸï¼‰, GameStartedï¼ˆæ¸¸æˆå¼€å§‹ï¼‰, InRoundï¼ˆå›åˆä¸­ï¼‰, NotStartedï¼ˆæœªå¼€å§‹ï¼‰, RoundEndingï¼ˆå›åˆç»“æŸä¸­ï¼‰, RoundStartingï¼ˆå›åˆå¼€å§‹ä¸­ï¼‰, SwitchingTeamsï¼ˆäº¤æ¢é˜Ÿä¼ï¼‰, Invalidï¼ˆæ— æ•ˆï¼‰',\n  `roundinforoundtime` DOUBLE COMMENT 'å›åˆæ—¶é—´ - å½“å‰å›åˆå·²è¿›è¡Œçš„æ—¶é—´ï¼Œå•ä½ä¸ºç§’',\n  `playerinfocharacter` TEXT COMMENT 'Ares è§’è‰² - Ares è§’è‰²çš„åç§°',\n  `playerinfoname` TEXT COMMENT 'Ares ç©å®¶åç§° - Ares ç©å®¶çš„åç§°ï¼ˆä¸ä¸€å®šæ˜¯å¬å”¤å¸ˆåç§°ï¼‰',\n  `playerinfosubject` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO ç©å®¶ ID: Riot ç©å®¶çš„å…¨å±€å”¯ä¸€ ID',\n  `playerinfoteamid` TEXT COMMENT 'Ares é˜Ÿä¼ ID - Ares é˜Ÿä¼ ID',\n  `playerinfoside` TEXT COMMENT 'Ares æ¸¸æˆæ¨¡å¼çš„é˜µè¥ - å½“å‰ç‚¸å¼¹æ¸¸æˆæ¨¡å¼ä¸­çš„ Ares é˜µè¥ã€‚è¿™æ›¾æ˜¯ Ares é˜Ÿä¼ï¼Œä½†æˆ‘ä»¬å¸Œæœ›è½¬ç§»åˆ°èƒ½å¤Ÿè·¨æœåŠ¡å¼•ç”¨é˜Ÿä¼ä¸ºçº¢/è“ã€‚æ³¨æ„ï¼šæ­¤ç±»å‹ä¹Ÿè¢«ç”¨äºè¡¨ç¤ºé˜Ÿä¼è§’è‰²çš„å±æ€§ã€‚å› æ­¤æœ‰é¢å¤–çš„æ”¯æŒå…¶ä»–è§’è‰²çš„å€¼ï¼ˆå³ None/Any/FreeForAllï¼‰ - å€¼ï¼šAttackerï¼ˆè¿›æ”»æ–¹ï¼‰, Defenderï¼ˆé˜²å®ˆæ–¹ï¼‰, Neutralï¼ˆä¸­ç«‹ï¼‰, Unknownï¼ˆæœªçŸ¥ï¼‰, Noneï¼ˆæ— ï¼‰, Anyï¼ˆä»»æ„ï¼‰, FreeForAllï¼ˆæ··æˆ˜ï¼‰',\n  `playerinfoteamrole` TEXT COMMENT 'Ares æ¸¸æˆæ¨¡å¼çš„é˜Ÿä¼è§’è‰² - å½“å‰ç‚¸å¼¹æ¸¸æˆæ¨¡å¼ä¸­çš„ Ares é˜µè¥ã€‚è¿™æ›¾æ˜¯ Ares é˜Ÿä¼ï¼Œä½†æˆ‘ä»¬å¸Œæœ›è½¬ç§»åˆ°èƒ½å¤Ÿè·¨æœåŠ¡å¼•ç”¨é˜Ÿä¼ä¸ºçº¢/è“ã€‚æ³¨æ„ï¼šæ­¤ç±»å‹ä¹Ÿè¢«ç”¨äºè¡¨ç¤ºé˜Ÿä¼è§’è‰²çš„å±æ€§ã€‚å› æ­¤æœ‰é¢å¤–çš„æ”¯æŒå…¶ä»–è§’è‰²çš„å€¼ï¼ˆå³ None/Any/FreeForAllï¼‰ - å€¼ï¼šAttackerï¼ˆè¿›æ”»æ–¹ï¼‰, Defenderï¼ˆé˜²å®ˆæ–¹ï¼‰, Neutralï¼ˆä¸­ç«‹ï¼‰, Unknownï¼ˆæœªçŸ¥ï¼‰, Noneï¼ˆæ— ï¼‰, Anyï¼ˆä»»æ„ï¼‰, FreeForAllï¼ˆæ··æˆ˜ï¼‰',\n  `pretransactionmoney` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `pretransactionmoneyreceiver` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `pretransactionmoneysender` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `itemcost` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `startinvpriweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvpriweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvpriweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvpriweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvsecweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvsecweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvsecweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvsecweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvmeleeid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvmeleename` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvmeleetype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvmeleeavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvarmorid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvarmorname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvarmortype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvarmoravaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvabilities` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_StartInvAbilities',\n  `startinvbackpackitems` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_StartInvBackpackItems',\n  `startinvpassives` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_StartInvPassives',\n  `startinvcurequippedid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvcurequippedname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvcurequippedtype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvcurequippedavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvpriweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvpriweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvpriweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvpriweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvsecweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvsecweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvsecweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvsecweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvmeleeid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvmeleename` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvmeleetype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvmeleeavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvarmorid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvarmorname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvarmortype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvarmoravaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvabilities` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_EndInvAbilities',\n  `endinvbackpackitems` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_EndInvBackpackItems',\n  `endinvpassives` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_EndInvPassives',\n  `endinvcurequippedid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvcurequippedname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvcurequippedtype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvcurequippedavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `itemname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `itemid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `receiverid` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO ç©å®¶ ID: Riot ç©å®¶çš„å…¨å±€å”¯ä¸€ ID',\n  `senderid` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO ç©å®¶ ID: Riot ç©å®¶çš„å…¨å±€å”¯ä¸€ ID',\n  `transactiontype` TEXT COMMENT 'äº¤æ˜“ç±»å‹ - å¯é€‰å€¼ï¼š[Purchaseï¼ˆè´­ä¹°ï¼‰, PickUpï¼ˆæ‹¾å–ï¼‰, FulfillRequestï¼ˆæ»¡è¶³è¯·æ±‚ï¼‰, Dropï¼ˆä¸¢å¼ƒï¼‰, Sellï¼ˆå‡ºå”®ï¼‰, Transferï¼ˆè½¬ç§»ï¼‰, Defaultï¼ˆé»˜è®¤ï¼‰, Otherï¼ˆå…¶ä»–ï¼‰]',\n  `aplogtotal` BIGINT COMMENT 'ç”±æ­¤ AP äº‹ä»¶ç”Ÿæˆçš„æ—¥å¿—æ€»æ•°',\n  `clientplatformdetailsplatformtype` TEXT COMMENT 'clientPlatformDetailsPlatformType',\n  `clientplatformdetailsplatformmetadata` TEXT COMMENT 'clientPlatformDetailsPlatformMetadata',\n  `platformtype` TEXT COMMENT 'platformType',\n  `apschemaversion` TEXT COMMENT 'apSchemaVersion'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nprovisioningflowid = \"Matchmaking\" -- é™¤è‡ªå®šä¹‰æ¨¡å¼ã€æ–°æ‰‹ã€è®­ç»ƒåœºå¤–æ‰€æœ‰æ¨¡å¼\n\nå¯¹å±€ä»£ä¹°ç­›é€‰é€»è¾‘ï¼š\nTransactionType = \"FulfillRequest\"\n\n",
  "chosen": "SELECT COUNT(*) AS weapon_daibuy_count\nFROM final_algorithm_competition.dwd_argothek_apinventorymovementlog_hi inv\nJOIN final_algorithm_competition.dwd_argothek_matchdetails_hi match\nON inv.matchinfomatchid = match.matchid\nWHERE inv.tdbank_imp_date BETWEEN '2024010100' AND '2024121623'\nAND match.tdbank_imp_date BETWEEN '2024010100' AND '2024121623'\nAND inv.transactiontype = 'FulfillRequest'\nAND match.provisioningflowid = 'Matchmaking'",
  "rejected": "SELECT\n  COUNT(*)\nFROM `test`.`dwd_argothek_apinventorymovementlog_hi`\nWHERE\n  `transactiontype` = 'FulfillRequest'\n  AND `matchinfogamemode` != 'CustomGame'\n  AND `matchinfogamemode` != 'Newbie'\n  AND `matchinfogamemode` != 'TrainingGrounds'\n  AND `dteventtime` >= '2024-01-01 00:00:00'\n  AND `dteventtime` < '2024-12-17 00:00:00'"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡ï¼š2024-01-01åˆ°2024-12-16ï¼Œè´­ä¹°é˜¶æ®µå‡ºç°äº†xæ¬¡æ­¦å™¨ä»£ä¹°ï¼Œé™¤è‡ªå®šä¹‰æ¨¡å¼ã€æ–°æ‰‹ã€è®­ç»ƒåœºå¤–æ‰€æœ‰æ¨¡å¼ã€‚\nè¾“å‡ºï¼šæ­¦å™¨ä»£ä¹°æ¬¡æ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dwd_argothek_matchdetails_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'åˆ†åŒºå­—æ®µ',\n  `dteventtime` TEXT COMMENT 'AP äº‹ä»¶æ—¶é—´: YYYY-MM-DD HH:MM:SS',\n  `apeventid` TEXT COMMENT 'AP äº‹ä»¶æ ‡è¯†ç¬¦',\n  `matchid` TEXT COMMENT 'Ares åŒ¹é… ID - Ares åŒ¹é…çš„ ID å­—ç¬¦ä¸²',\n  `mapid` TEXT COMMENT 'Ares åœ°å›¾ ID - æœåŠ¡ä»£ç ä¸­ä½¿ç”¨çš„ Ares åœ°å›¾ ID',\n  `provisioningflowid` TEXT COMMENT 'é…ç½®æµç¨‹ ID - å·²é…ç½®çš„æ¸¸æˆç±»å‹ã€‚ä¾‹å¦‚ï¼šæŠ€èƒ½æµ‹è¯•ã€åŒ¹é…ç­‰',\n  `gamepodid` TEXT COMMENT 'æ¸¸æˆèŠ‚ç‚¹ ID - æ¸¸æˆèŠ‚ç‚¹çš„å­—ç¬¦ä¸²è¡¨ç¤º',\n  `gamelengthmillis` DOUBLE COMMENT 'æ¯«ç§’ - åƒåˆ†ä¹‹ä¸€ç§’çš„å•ä½',\n  `gamestartmillis` DOUBLE COMMENT 'æ¯«ç§’ - åƒåˆ†ä¹‹ä¸€ç§’çš„å•ä½',\n  `gameversion` TEXT COMMENT 'Ares æ„å»ºç‰ˆæœ¬ - Ares äºŒè¿›åˆ¶æ–‡ä»¶çš„å®Œæ•´æ„å»ºç‰ˆæœ¬',\n  `iscompleted` BIGINT COMMENT 'æ¯”èµ›å®Œæˆæ ‡å¿— - å¦‚æœæ¯”èµ›æ­£å¸¸ç»“æŸå¹¶æœ‰æ¯”èµ›ç»“æœï¼Œåˆ™ä¸º True',\n  `customgamename` TEXT COMMENT 'Ares è‡ªå®šä¹‰æ¸¸æˆåç§° - è‡ªå®šä¹‰æ¸¸æˆçš„åç§°',\n  `module` TEXT COMMENT 'Ares å°„å‡»åœºæ¨¡å— - å¯ä»¥åœ¨å°„å‡»åœºä¸­æ¸¸ç©çš„æ¨¡å—',\n  `forcepostprocessing` BIGINT COMMENT 'å¼ºåˆ¶åå¤„ç†æ ‡å¿— - å¯¹äºéœ€è¦å¯ç”¨è°ƒè¯•çš„æ¯”èµ›ï¼Œè¯¥å€¼ä¸º Trueã€‚',\n  `queueid` TEXT COMMENT 'Ares é˜Ÿåˆ— ID - Ares é˜Ÿåˆ—çš„ ID å­—ç¬¦ä¸²',\n  `seasonid` TEXT COMMENT 'èµ›å­£ ID - èµ›å­£çš„ uuid',\n  `completionstate` TEXT COMMENT 'Ares å®ŒæˆçŠ¶æ€ - æ¯”èµ›å¦‚ä½•å®Œæˆçš„å­—ç¬¦ä¸²å€¼ã€‚ä¾‹å¦‚ï¼šCompletedï¼ˆå®Œæˆï¼‰, All_Disconnectedï¼ˆå…¨éƒ¨æ–­å¼€è¿æ¥ï¼‰',\n  `ismatchsampled` BIGINT COMMENT 'æ¯”èµ›æ˜¯å¦è¢«é‡‡æ ·æ ‡å¿— - æŒ‡ç¤ºè¯¥æ¯”èµ›æ˜¯å¦è¢«é‡‡æ ·ç”¨äºé¥æµ‹',\n  `players` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapMatchDetails_players',\n  `teams` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapMatchDetails_teams',\n  `roundresults` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapMatchDetails_roundResults',\n  `platforminfoplatformtype` TEXT COMMENT 'å®¢æˆ·ç«¯å¹³å°ç±»å‹ - æ­¤äº‹ä»¶æ¥æºçš„å®¢æˆ·ç«¯å¹³å°ï¼ˆä¾‹å¦‚ï¼šMobile æˆ– PCï¼‰',\n  `platforminfoplatformos` TEXT COMMENT 'å®¢æˆ·ç«¯å¹³å°æ“ä½œç³»ç»Ÿ - æ­¤äº‹ä»¶æ¥æºçš„å®¢æˆ·ç«¯æ“ä½œç³»ç»Ÿ',\n  `aplogtotal` BIGINT COMMENT 'ç”±æ­¤ AP äº‹ä»¶ç”Ÿæˆçš„æ—¥å¿—æ€»æ•°',\n  `platformtype` TEXT COMMENT 'å®¢æˆ·ç«¯å¹³å°ç±»å‹ - æ­¤äº‹ä»¶æ¥æºçš„å®¢æˆ·ç«¯å¹³å°ï¼ˆä¾‹å¦‚ï¼šMobile æˆ– PCï¼‰',\n  `apschemaversion` TEXT COMMENT 'apSchemaVersion'\n);\nCREATE TABLE `dwd_argothek_apinventorymovementlog_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'åˆ†åŒºå­—æ®µ',\n  `dteventtime` TEXT COMMENT 'AP äº‹ä»¶æ—¶é—´: YYYY-MM-DD HH:MM:SS',\n  `apeventid` TEXT COMMENT 'AP äº‹ä»¶æ ‡è¯†ç¬¦',\n  `matchinfobranch` TEXT COMMENT 'Ares Perforce åˆ†æ”¯ - æ­¤æ„å»ºç‰ˆæœ¬çš„æ¥æºåˆ†æ”¯',\n  `matchinfochangelist` TEXT COMMENT 'Perforce å˜æ›´åˆ—è¡¨ - Perforce å˜æ›´åˆ—è¡¨ç¼–å·',\n  `matchinfogameid` BIGINT COMMENT 'Ares æ¸¸æˆ ID - Ares åŒ¹é…çš„ ID å·ï¼ˆåŸºäºå¹³å°æ—¶é—´æˆ³ä¹‹å‰ï¼‰',\n  `matchinfogamemode` TEXT COMMENT 'Ares æ¸¸æˆæ¨¡å¼ - æ­£åœ¨è¿›è¡Œçš„æ¯”èµ›ç±»å‹',\n  `matchinfomap` TEXT COMMENT 'Ares åœ°å›¾ - Ares åœ°å›¾çš„åç§°',\n  `matchinfomatchid` TEXT COMMENT 'Ares åŒ¹é… ID - Ares åŒ¹é…çš„ ID å­—ç¬¦ä¸²',\n  `matchinfoversion` TEXT COMMENT 'Ares æ„å»ºç‰ˆæœ¬ - Ares äºŒè¿›åˆ¶æ–‡ä»¶çš„å®Œæ•´æ„å»ºç‰ˆæœ¬',\n  `roundinfoattackerscore` BIGINT COMMENT 'å›åˆå¾—åˆ† - Ares åŒ¹é…çš„å›åˆå¾—åˆ†',\n  `roundinfodefenderscore` BIGINT COMMENT 'å›åˆå¾—åˆ† - Ares åŒ¹é…çš„å›åˆå¾—åˆ†',\n  `roundinfomatchtime` BIGINT COMMENT 'æ¯”èµ›æ—¶é—´ - å½“å‰æ¯”èµ›å·²è¿›è¡Œçš„æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’',\n  `roundinforoundnumber` BIGINT COMMENT 'å›åˆç¼–å· - Ares åŒ¹é…çš„å›åˆç¼–å·',\n  `roundinforoundphase` TEXT COMMENT 'Ares å›åˆé˜¶æ®µ - Ares æ¸¸æˆå›åˆçš„æ¸¸æˆé˜¶æ®µ - å€¼ï¼šBetweenRoundsï¼ˆå›åˆä¹‹é—´ï¼‰, GameEndedï¼ˆæ¸¸æˆç»“æŸï¼‰, GameStartedï¼ˆæ¸¸æˆå¼€å§‹ï¼‰, InRoundï¼ˆå›åˆä¸­ï¼‰, NotStartedï¼ˆæœªå¼€å§‹ï¼‰, RoundEndingï¼ˆå›åˆç»“æŸä¸­ï¼‰, RoundStartingï¼ˆå›åˆå¼€å§‹ä¸­ï¼‰, SwitchingTeamsï¼ˆäº¤æ¢é˜Ÿä¼ï¼‰, Invalidï¼ˆæ— æ•ˆï¼‰',\n  `roundinforoundtime` DOUBLE COMMENT 'å›åˆæ—¶é—´ - å½“å‰å›åˆå·²è¿›è¡Œçš„æ—¶é—´ï¼Œå•ä½ä¸ºç§’',\n  `playerinfocharacter` TEXT COMMENT 'Ares è§’è‰² - Ares è§’è‰²çš„åç§°',\n  `playerinfoname` TEXT COMMENT 'Ares ç©å®¶åç§° - Ares ç©å®¶çš„åç§°ï¼ˆä¸ä¸€å®šæ˜¯å¬å”¤å¸ˆåç§°ï¼‰',\n  `playerinfosubject` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO ç©å®¶ ID: Riot ç©å®¶çš„å…¨å±€å”¯ä¸€ ID',\n  `playerinfoteamid` TEXT COMMENT 'Ares é˜Ÿä¼ ID - Ares é˜Ÿä¼ ID',\n  `playerinfoside` TEXT COMMENT 'Ares æ¸¸æˆæ¨¡å¼çš„é˜µè¥ - å½“å‰ç‚¸å¼¹æ¸¸æˆæ¨¡å¼ä¸­çš„ Ares é˜µè¥ã€‚è¿™æ›¾æ˜¯ Ares é˜Ÿä¼ï¼Œä½†æˆ‘ä»¬å¸Œæœ›è½¬ç§»åˆ°èƒ½å¤Ÿè·¨æœåŠ¡å¼•ç”¨é˜Ÿä¼ä¸ºçº¢/è“ã€‚æ³¨æ„ï¼šæ­¤ç±»å‹ä¹Ÿè¢«ç”¨äºè¡¨ç¤ºé˜Ÿä¼è§’è‰²çš„å±æ€§ã€‚å› æ­¤æœ‰é¢å¤–çš„æ”¯æŒå…¶ä»–è§’è‰²çš„å€¼ï¼ˆå³ None/Any/FreeForAllï¼‰ - å€¼ï¼šAttackerï¼ˆè¿›æ”»æ–¹ï¼‰, Defenderï¼ˆé˜²å®ˆæ–¹ï¼‰, Neutralï¼ˆä¸­ç«‹ï¼‰, Unknownï¼ˆæœªçŸ¥ï¼‰, Noneï¼ˆæ— ï¼‰, Anyï¼ˆä»»æ„ï¼‰, FreeForAllï¼ˆæ··æˆ˜ï¼‰',\n  `playerinfoteamrole` TEXT COMMENT 'Ares æ¸¸æˆæ¨¡å¼çš„é˜Ÿä¼è§’è‰² - å½“å‰ç‚¸å¼¹æ¸¸æˆæ¨¡å¼ä¸­çš„ Ares é˜µè¥ã€‚è¿™æ›¾æ˜¯ Ares é˜Ÿä¼ï¼Œä½†æˆ‘ä»¬å¸Œæœ›è½¬ç§»åˆ°èƒ½å¤Ÿè·¨æœåŠ¡å¼•ç”¨é˜Ÿä¼ä¸ºçº¢/è“ã€‚æ³¨æ„ï¼šæ­¤ç±»å‹ä¹Ÿè¢«ç”¨äºè¡¨ç¤ºé˜Ÿä¼è§’è‰²çš„å±æ€§ã€‚å› æ­¤æœ‰é¢å¤–çš„æ”¯æŒå…¶ä»–è§’è‰²çš„å€¼ï¼ˆå³ None/Any/FreeForAllï¼‰ - å€¼ï¼šAttackerï¼ˆè¿›æ”»æ–¹ï¼‰, Defenderï¼ˆé˜²å®ˆæ–¹ï¼‰, Neutralï¼ˆä¸­ç«‹ï¼‰, Unknownï¼ˆæœªçŸ¥ï¼‰, Noneï¼ˆæ— ï¼‰, Anyï¼ˆä»»æ„ï¼‰, FreeForAllï¼ˆæ··æˆ˜ï¼‰',\n  `pretransactionmoney` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `pretransactionmoneyreceiver` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `pretransactionmoneysender` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `itemcost` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `startinvpriweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvpriweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvpriweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvpriweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvsecweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvsecweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvsecweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvsecweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvmeleeid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvmeleename` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvmeleetype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvmeleeavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvarmorid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvarmorname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvarmortype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvarmoravaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvabilities` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_StartInvAbilities',\n  `startinvbackpackitems` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_StartInvBackpackItems',\n  `startinvpassives` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_StartInvPassives',\n  `startinvcurequippedid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvcurequippedname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvcurequippedtype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvcurequippedavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvpriweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvpriweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvpriweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvpriweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvsecweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvsecweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvsecweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvsecweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvmeleeid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvmeleename` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvmeleetype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvmeleeavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvarmorid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvarmorname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvarmortype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvarmoravaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvabilities` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_EndInvAbilities',\n  `endinvbackpackitems` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_EndInvBackpackItems',\n  `endinvpassives` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_EndInvPassives',\n  `endinvcurequippedid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvcurequippedname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvcurequippedtype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvcurequippedavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `itemname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `itemid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `receiverid` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO ç©å®¶ ID: Riot ç©å®¶çš„å…¨å±€å”¯ä¸€ ID',\n  `senderid` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO ç©å®¶ ID: Riot ç©å®¶çš„å…¨å±€å”¯ä¸€ ID',\n  `transactiontype` TEXT COMMENT 'äº¤æ˜“ç±»å‹ - å¯é€‰å€¼ï¼š[Purchaseï¼ˆè´­ä¹°ï¼‰, PickUpï¼ˆæ‹¾å–ï¼‰, FulfillRequestï¼ˆæ»¡è¶³è¯·æ±‚ï¼‰, Dropï¼ˆä¸¢å¼ƒï¼‰, Sellï¼ˆå‡ºå”®ï¼‰, Transferï¼ˆè½¬ç§»ï¼‰, Defaultï¼ˆé»˜è®¤ï¼‰, Otherï¼ˆå…¶ä»–ï¼‰]',\n  `aplogtotal` BIGINT COMMENT 'ç”±æ­¤ AP äº‹ä»¶ç”Ÿæˆçš„æ—¥å¿—æ€»æ•°',\n  `clientplatformdetailsplatformtype` TEXT COMMENT 'clientPlatformDetailsPlatformType',\n  `clientplatformdetailsplatformmetadata` TEXT COMMENT 'clientPlatformDetailsPlatformMetadata',\n  `platformtype` TEXT COMMENT 'platformType',\n  `apschemaversion` TEXT COMMENT 'apSchemaVersion'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nprovisioningflowid = \"Matchmaking\" -- é™¤è‡ªå®šä¹‰æ¨¡å¼ã€æ–°æ‰‹ã€è®­ç»ƒåœºå¤–æ‰€æœ‰æ¨¡å¼\n\nå¯¹å±€ä»£ä¹°ç­›é€‰é€»è¾‘ï¼š\nTransactionType = \"FulfillRequest\"\n\n",
  "chosen": "SELECT COUNT(*) AS weapon_daibuy_count\nFROM final_algorithm_competition.dwd_argothek_apinventorymovementlog_hi inv\nJOIN final_algorithm_competition.dwd_argothek_matchdetails_hi match\nON inv.matchinfomatchid = match.matchid\nWHERE inv.tdbank_imp_date BETWEEN '2024010100' AND '2024121623'\nAND match.tdbank_imp_date BETWEEN '2024010100' AND '2024121623'\nAND inv.transactiontype = 'FulfillRequest'\nAND match.provisioningflowid = 'Matchmaking'",
  "rejected": "SELECT\n  COUNT(*)\nFROM `test`.`dwd_argothek_apinventorymovementlog_hi`\nWHERE\n  DATE_FORMAT(CAST(`dteventtime` AS DATETIME), '%Y-%m-%d') BETWEEN '2024-01-01' AND '2024-12-16'\n  AND `transactiontype` = 'FulfillRequest'\n  AND `matchinfogamemode` NOT IN ('CustomGame', 'NewPlayer', 'TrainingGround')\n  AND `provisioningflowid` = 'Matchmaking'"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡ï¼š2024-01-01åˆ°2024-12-16ï¼Œè´­ä¹°é˜¶æ®µå‡ºç°äº†xæ¬¡æ­¦å™¨ä»£ä¹°ï¼Œé™¤è‡ªå®šä¹‰æ¨¡å¼ã€æ–°æ‰‹ã€è®­ç»ƒåœºå¤–æ‰€æœ‰æ¨¡å¼ã€‚\nè¾“å‡ºï¼šæ­¦å™¨ä»£ä¹°æ¬¡æ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dwd_argothek_matchdetails_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'åˆ†åŒºå­—æ®µ',\n  `dteventtime` TEXT COMMENT 'AP äº‹ä»¶æ—¶é—´: YYYY-MM-DD HH:MM:SS',\n  `apeventid` TEXT COMMENT 'AP äº‹ä»¶æ ‡è¯†ç¬¦',\n  `matchid` TEXT COMMENT 'Ares åŒ¹é… ID - Ares åŒ¹é…çš„ ID å­—ç¬¦ä¸²',\n  `mapid` TEXT COMMENT 'Ares åœ°å›¾ ID - æœåŠ¡ä»£ç ä¸­ä½¿ç”¨çš„ Ares åœ°å›¾ ID',\n  `provisioningflowid` TEXT COMMENT 'é…ç½®æµç¨‹ ID - å·²é…ç½®çš„æ¸¸æˆç±»å‹ã€‚ä¾‹å¦‚ï¼šæŠ€èƒ½æµ‹è¯•ã€åŒ¹é…ç­‰',\n  `gamepodid` TEXT COMMENT 'æ¸¸æˆèŠ‚ç‚¹ ID - æ¸¸æˆèŠ‚ç‚¹çš„å­—ç¬¦ä¸²è¡¨ç¤º',\n  `gamelengthmillis` DOUBLE COMMENT 'æ¯«ç§’ - åƒåˆ†ä¹‹ä¸€ç§’çš„å•ä½',\n  `gamestartmillis` DOUBLE COMMENT 'æ¯«ç§’ - åƒåˆ†ä¹‹ä¸€ç§’çš„å•ä½',\n  `gameversion` TEXT COMMENT 'Ares æ„å»ºç‰ˆæœ¬ - Ares äºŒè¿›åˆ¶æ–‡ä»¶çš„å®Œæ•´æ„å»ºç‰ˆæœ¬',\n  `iscompleted` BIGINT COMMENT 'æ¯”èµ›å®Œæˆæ ‡å¿— - å¦‚æœæ¯”èµ›æ­£å¸¸ç»“æŸå¹¶æœ‰æ¯”èµ›ç»“æœï¼Œåˆ™ä¸º True',\n  `customgamename` TEXT COMMENT 'Ares è‡ªå®šä¹‰æ¸¸æˆåç§° - è‡ªå®šä¹‰æ¸¸æˆçš„åç§°',\n  `module` TEXT COMMENT 'Ares å°„å‡»åœºæ¨¡å— - å¯ä»¥åœ¨å°„å‡»åœºä¸­æ¸¸ç©çš„æ¨¡å—',\n  `forcepostprocessing` BIGINT COMMENT 'å¼ºåˆ¶åå¤„ç†æ ‡å¿— - å¯¹äºéœ€è¦å¯ç”¨è°ƒè¯•çš„æ¯”èµ›ï¼Œè¯¥å€¼ä¸º Trueã€‚',\n  `queueid` TEXT COMMENT 'Ares é˜Ÿåˆ— ID - Ares é˜Ÿåˆ—çš„ ID å­—ç¬¦ä¸²',\n  `seasonid` TEXT COMMENT 'èµ›å­£ ID - èµ›å­£çš„ uuid',\n  `completionstate` TEXT COMMENT 'Ares å®ŒæˆçŠ¶æ€ - æ¯”èµ›å¦‚ä½•å®Œæˆçš„å­—ç¬¦ä¸²å€¼ã€‚ä¾‹å¦‚ï¼šCompletedï¼ˆå®Œæˆï¼‰, All_Disconnectedï¼ˆå…¨éƒ¨æ–­å¼€è¿æ¥ï¼‰',\n  `ismatchsampled` BIGINT COMMENT 'æ¯”èµ›æ˜¯å¦è¢«é‡‡æ ·æ ‡å¿— - æŒ‡ç¤ºè¯¥æ¯”èµ›æ˜¯å¦è¢«é‡‡æ ·ç”¨äºé¥æµ‹',\n  `players` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapMatchDetails_players',\n  `teams` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapMatchDetails_teams',\n  `roundresults` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapMatchDetails_roundResults',\n  `platforminfoplatformtype` TEXT COMMENT 'å®¢æˆ·ç«¯å¹³å°ç±»å‹ - æ­¤äº‹ä»¶æ¥æºçš„å®¢æˆ·ç«¯å¹³å°ï¼ˆä¾‹å¦‚ï¼šMobile æˆ– PCï¼‰',\n  `platforminfoplatformos` TEXT COMMENT 'å®¢æˆ·ç«¯å¹³å°æ“ä½œç³»ç»Ÿ - æ­¤äº‹ä»¶æ¥æºçš„å®¢æˆ·ç«¯æ“ä½œç³»ç»Ÿ',\n  `aplogtotal` BIGINT COMMENT 'ç”±æ­¤ AP äº‹ä»¶ç”Ÿæˆçš„æ—¥å¿—æ€»æ•°',\n  `platformtype` TEXT COMMENT 'å®¢æˆ·ç«¯å¹³å°ç±»å‹ - æ­¤äº‹ä»¶æ¥æºçš„å®¢æˆ·ç«¯å¹³å°ï¼ˆä¾‹å¦‚ï¼šMobile æˆ– PCï¼‰',\n  `apschemaversion` TEXT COMMENT 'apSchemaVersion'\n);\nCREATE TABLE `dwd_argothek_apinventorymovementlog_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'åˆ†åŒºå­—æ®µ',\n  `dteventtime` TEXT COMMENT 'AP äº‹ä»¶æ—¶é—´: YYYY-MM-DD HH:MM:SS',\n  `apeventid` TEXT COMMENT 'AP äº‹ä»¶æ ‡è¯†ç¬¦',\n  `matchinfobranch` TEXT COMMENT 'Ares Perforce åˆ†æ”¯ - æ­¤æ„å»ºç‰ˆæœ¬çš„æ¥æºåˆ†æ”¯',\n  `matchinfochangelist` TEXT COMMENT 'Perforce å˜æ›´åˆ—è¡¨ - Perforce å˜æ›´åˆ—è¡¨ç¼–å·',\n  `matchinfogameid` BIGINT COMMENT 'Ares æ¸¸æˆ ID - Ares åŒ¹é…çš„ ID å·ï¼ˆåŸºäºå¹³å°æ—¶é—´æˆ³ä¹‹å‰ï¼‰',\n  `matchinfogamemode` TEXT COMMENT 'Ares æ¸¸æˆæ¨¡å¼ - æ­£åœ¨è¿›è¡Œçš„æ¯”èµ›ç±»å‹',\n  `matchinfomap` TEXT COMMENT 'Ares åœ°å›¾ - Ares åœ°å›¾çš„åç§°',\n  `matchinfomatchid` TEXT COMMENT 'Ares åŒ¹é… ID - Ares åŒ¹é…çš„ ID å­—ç¬¦ä¸²',\n  `matchinfoversion` TEXT COMMENT 'Ares æ„å»ºç‰ˆæœ¬ - Ares äºŒè¿›åˆ¶æ–‡ä»¶çš„å®Œæ•´æ„å»ºç‰ˆæœ¬',\n  `roundinfoattackerscore` BIGINT COMMENT 'å›åˆå¾—åˆ† - Ares åŒ¹é…çš„å›åˆå¾—åˆ†',\n  `roundinfodefenderscore` BIGINT COMMENT 'å›åˆå¾—åˆ† - Ares åŒ¹é…çš„å›åˆå¾—åˆ†',\n  `roundinfomatchtime` BIGINT COMMENT 'æ¯”èµ›æ—¶é—´ - å½“å‰æ¯”èµ›å·²è¿›è¡Œçš„æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’',\n  `roundinforoundnumber` BIGINT COMMENT 'å›åˆç¼–å· - Ares åŒ¹é…çš„å›åˆç¼–å·',\n  `roundinforoundphase` TEXT COMMENT 'Ares å›åˆé˜¶æ®µ - Ares æ¸¸æˆå›åˆçš„æ¸¸æˆé˜¶æ®µ - å€¼ï¼šBetweenRoundsï¼ˆå›åˆä¹‹é—´ï¼‰, GameEndedï¼ˆæ¸¸æˆç»“æŸï¼‰, GameStartedï¼ˆæ¸¸æˆå¼€å§‹ï¼‰, InRoundï¼ˆå›åˆä¸­ï¼‰, NotStartedï¼ˆæœªå¼€å§‹ï¼‰, RoundEndingï¼ˆå›åˆç»“æŸä¸­ï¼‰, RoundStartingï¼ˆå›åˆå¼€å§‹ä¸­ï¼‰, SwitchingTeamsï¼ˆäº¤æ¢é˜Ÿä¼ï¼‰, Invalidï¼ˆæ— æ•ˆï¼‰',\n  `roundinforoundtime` DOUBLE COMMENT 'å›åˆæ—¶é—´ - å½“å‰å›åˆå·²è¿›è¡Œçš„æ—¶é—´ï¼Œå•ä½ä¸ºç§’',\n  `playerinfocharacter` TEXT COMMENT 'Ares è§’è‰² - Ares è§’è‰²çš„åç§°',\n  `playerinfoname` TEXT COMMENT 'Ares ç©å®¶åç§° - Ares ç©å®¶çš„åç§°ï¼ˆä¸ä¸€å®šæ˜¯å¬å”¤å¸ˆåç§°ï¼‰',\n  `playerinfosubject` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO ç©å®¶ ID: Riot ç©å®¶çš„å…¨å±€å”¯ä¸€ ID',\n  `playerinfoteamid` TEXT COMMENT 'Ares é˜Ÿä¼ ID - Ares é˜Ÿä¼ ID',\n  `playerinfoside` TEXT COMMENT 'Ares æ¸¸æˆæ¨¡å¼çš„é˜µè¥ - å½“å‰ç‚¸å¼¹æ¸¸æˆæ¨¡å¼ä¸­çš„ Ares é˜µè¥ã€‚è¿™æ›¾æ˜¯ Ares é˜Ÿä¼ï¼Œä½†æˆ‘ä»¬å¸Œæœ›è½¬ç§»åˆ°èƒ½å¤Ÿè·¨æœåŠ¡å¼•ç”¨é˜Ÿä¼ä¸ºçº¢/è“ã€‚æ³¨æ„ï¼šæ­¤ç±»å‹ä¹Ÿè¢«ç”¨äºè¡¨ç¤ºé˜Ÿä¼è§’è‰²çš„å±æ€§ã€‚å› æ­¤æœ‰é¢å¤–çš„æ”¯æŒå…¶ä»–è§’è‰²çš„å€¼ï¼ˆå³ None/Any/FreeForAllï¼‰ - å€¼ï¼šAttackerï¼ˆè¿›æ”»æ–¹ï¼‰, Defenderï¼ˆé˜²å®ˆæ–¹ï¼‰, Neutralï¼ˆä¸­ç«‹ï¼‰, Unknownï¼ˆæœªçŸ¥ï¼‰, Noneï¼ˆæ— ï¼‰, Anyï¼ˆä»»æ„ï¼‰, FreeForAllï¼ˆæ··æˆ˜ï¼‰',\n  `playerinfoteamrole` TEXT COMMENT 'Ares æ¸¸æˆæ¨¡å¼çš„é˜Ÿä¼è§’è‰² - å½“å‰ç‚¸å¼¹æ¸¸æˆæ¨¡å¼ä¸­çš„ Ares é˜µè¥ã€‚è¿™æ›¾æ˜¯ Ares é˜Ÿä¼ï¼Œä½†æˆ‘ä»¬å¸Œæœ›è½¬ç§»åˆ°èƒ½å¤Ÿè·¨æœåŠ¡å¼•ç”¨é˜Ÿä¼ä¸ºçº¢/è“ã€‚æ³¨æ„ï¼šæ­¤ç±»å‹ä¹Ÿè¢«ç”¨äºè¡¨ç¤ºé˜Ÿä¼è§’è‰²çš„å±æ€§ã€‚å› æ­¤æœ‰é¢å¤–çš„æ”¯æŒå…¶ä»–è§’è‰²çš„å€¼ï¼ˆå³ None/Any/FreeForAllï¼‰ - å€¼ï¼šAttackerï¼ˆè¿›æ”»æ–¹ï¼‰, Defenderï¼ˆé˜²å®ˆæ–¹ï¼‰, Neutralï¼ˆä¸­ç«‹ï¼‰, Unknownï¼ˆæœªçŸ¥ï¼‰, Noneï¼ˆæ— ï¼‰, Anyï¼ˆä»»æ„ï¼‰, FreeForAllï¼ˆæ··æˆ˜ï¼‰',\n  `pretransactionmoney` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `pretransactionmoneyreceiver` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `pretransactionmoneysender` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `itemcost` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `startinvpriweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvpriweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvpriweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvpriweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvsecweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvsecweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvsecweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvsecweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvmeleeid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvmeleename` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvmeleetype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvmeleeavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvarmorid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvarmorname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvarmortype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvarmoravaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvabilities` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_StartInvAbilities',\n  `startinvbackpackitems` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_StartInvBackpackItems',\n  `startinvpassives` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_StartInvPassives',\n  `startinvcurequippedid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvcurequippedname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvcurequippedtype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvcurequippedavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvpriweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvpriweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvpriweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvpriweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvsecweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvsecweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvsecweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvsecweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvmeleeid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvmeleename` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvmeleetype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvmeleeavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvarmorid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvarmorname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvarmortype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvarmoravaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvabilities` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_EndInvAbilities',\n  `endinvbackpackitems` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_EndInvBackpackItems',\n  `endinvpassives` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_EndInvPassives',\n  `endinvcurequippedid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvcurequippedname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvcurequippedtype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvcurequippedavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `itemname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `itemid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `receiverid` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO ç©å®¶ ID: Riot ç©å®¶çš„å…¨å±€å”¯ä¸€ ID',\n  `senderid` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO ç©å®¶ ID: Riot ç©å®¶çš„å…¨å±€å”¯ä¸€ ID',\n  `transactiontype` TEXT COMMENT 'äº¤æ˜“ç±»å‹ - å¯é€‰å€¼ï¼š[Purchaseï¼ˆè´­ä¹°ï¼‰, PickUpï¼ˆæ‹¾å–ï¼‰, FulfillRequestï¼ˆæ»¡è¶³è¯·æ±‚ï¼‰, Dropï¼ˆä¸¢å¼ƒï¼‰, Sellï¼ˆå‡ºå”®ï¼‰, Transferï¼ˆè½¬ç§»ï¼‰, Defaultï¼ˆé»˜è®¤ï¼‰, Otherï¼ˆå…¶ä»–ï¼‰]',\n  `aplogtotal` BIGINT COMMENT 'ç”±æ­¤ AP äº‹ä»¶ç”Ÿæˆçš„æ—¥å¿—æ€»æ•°',\n  `clientplatformdetailsplatformtype` TEXT COMMENT 'clientPlatformDetailsPlatformType',\n  `clientplatformdetailsplatformmetadata` TEXT COMMENT 'clientPlatformDetailsPlatformMetadata',\n  `platformtype` TEXT COMMENT 'platformType',\n  `apschemaversion` TEXT COMMENT 'apSchemaVersion'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nprovisioningflowid = \"Matchmaking\" -- é™¤è‡ªå®šä¹‰æ¨¡å¼ã€æ–°æ‰‹ã€è®­ç»ƒåœºå¤–æ‰€æœ‰æ¨¡å¼\n\nå¯¹å±€ä»£ä¹°ç­›é€‰é€»è¾‘ï¼š\nTransactionType = \"FulfillRequest\"\n\n",
  "chosen": "SELECT COUNT(*) AS weapon_daibuy_count\nFROM final_algorithm_competition.dwd_argothek_apinventorymovementlog_hi inv\nJOIN final_algorithm_competition.dwd_argothek_matchdetails_hi match\nON inv.matchinfomatchid = match.matchid\nWHERE inv.tdbank_imp_date BETWEEN '2024010100' AND '2024121623'\nAND match.tdbank_imp_date BETWEEN '2024010100' AND '2024121623'\nAND inv.transactiontype = 'FulfillRequest'\nAND match.provisioningflowid = 'Matchmaking'",
  "rejected": "SELECT\n  COUNT(DISTINCT `T1`.`matchinfomatchid`)\nFROM `dwd_argothek_apinventorymovementlog_hi` AS `T1`\nINNER JOIN `dwd_argothek_matchdetails_hi` AS `T2`\n  ON `T1`.`matchinfomatchid` = `T2`.`matchid`\nWHERE\n  `T1`.`transactiontype` = 'FulfillRequest'\n  AND `T2`.`provisioningflowid` = 'Matchmaking'\n  AND DATE(`T1`.`dteventtime`) BETWEEN '2024-01-01' AND '2024-12-16'"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡ï¼š2024-01-01åˆ°2024-12-16ï¼Œè´­ä¹°é˜¶æ®µå‡ºç°äº†xæ¬¡æ­¦å™¨ä»£ä¹°ï¼Œé™¤è‡ªå®šä¹‰æ¨¡å¼ã€æ–°æ‰‹ã€è®­ç»ƒåœºå¤–æ‰€æœ‰æ¨¡å¼ã€‚\nè¾“å‡ºï¼šæ­¦å™¨ä»£ä¹°æ¬¡æ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dwd_argothek_matchdetails_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'åˆ†åŒºå­—æ®µ',\n  `dteventtime` TEXT COMMENT 'AP äº‹ä»¶æ—¶é—´: YYYY-MM-DD HH:MM:SS',\n  `apeventid` TEXT COMMENT 'AP äº‹ä»¶æ ‡è¯†ç¬¦',\n  `matchid` TEXT COMMENT 'Ares åŒ¹é… ID - Ares åŒ¹é…çš„ ID å­—ç¬¦ä¸²',\n  `mapid` TEXT COMMENT 'Ares åœ°å›¾ ID - æœåŠ¡ä»£ç ä¸­ä½¿ç”¨çš„ Ares åœ°å›¾ ID',\n  `provisioningflowid` TEXT COMMENT 'é…ç½®æµç¨‹ ID - å·²é…ç½®çš„æ¸¸æˆç±»å‹ã€‚ä¾‹å¦‚ï¼šæŠ€èƒ½æµ‹è¯•ã€åŒ¹é…ç­‰',\n  `gamepodid` TEXT COMMENT 'æ¸¸æˆèŠ‚ç‚¹ ID - æ¸¸æˆèŠ‚ç‚¹çš„å­—ç¬¦ä¸²è¡¨ç¤º',\n  `gamelengthmillis` DOUBLE COMMENT 'æ¯«ç§’ - åƒåˆ†ä¹‹ä¸€ç§’çš„å•ä½',\n  `gamestartmillis` DOUBLE COMMENT 'æ¯«ç§’ - åƒåˆ†ä¹‹ä¸€ç§’çš„å•ä½',\n  `gameversion` TEXT COMMENT 'Ares æ„å»ºç‰ˆæœ¬ - Ares äºŒè¿›åˆ¶æ–‡ä»¶çš„å®Œæ•´æ„å»ºç‰ˆæœ¬',\n  `iscompleted` BIGINT COMMENT 'æ¯”èµ›å®Œæˆæ ‡å¿— - å¦‚æœæ¯”èµ›æ­£å¸¸ç»“æŸå¹¶æœ‰æ¯”èµ›ç»“æœï¼Œåˆ™ä¸º True',\n  `customgamename` TEXT COMMENT 'Ares è‡ªå®šä¹‰æ¸¸æˆåç§° - è‡ªå®šä¹‰æ¸¸æˆçš„åç§°',\n  `module` TEXT COMMENT 'Ares å°„å‡»åœºæ¨¡å— - å¯ä»¥åœ¨å°„å‡»åœºä¸­æ¸¸ç©çš„æ¨¡å—',\n  `forcepostprocessing` BIGINT COMMENT 'å¼ºåˆ¶åå¤„ç†æ ‡å¿— - å¯¹äºéœ€è¦å¯ç”¨è°ƒè¯•çš„æ¯”èµ›ï¼Œè¯¥å€¼ä¸º Trueã€‚',\n  `queueid` TEXT COMMENT 'Ares é˜Ÿåˆ— ID - Ares é˜Ÿåˆ—çš„ ID å­—ç¬¦ä¸²',\n  `seasonid` TEXT COMMENT 'èµ›å­£ ID - èµ›å­£çš„ uuid',\n  `completionstate` TEXT COMMENT 'Ares å®ŒæˆçŠ¶æ€ - æ¯”èµ›å¦‚ä½•å®Œæˆçš„å­—ç¬¦ä¸²å€¼ã€‚ä¾‹å¦‚ï¼šCompletedï¼ˆå®Œæˆï¼‰, All_Disconnectedï¼ˆå…¨éƒ¨æ–­å¼€è¿æ¥ï¼‰',\n  `ismatchsampled` BIGINT COMMENT 'æ¯”èµ›æ˜¯å¦è¢«é‡‡æ ·æ ‡å¿— - æŒ‡ç¤ºè¯¥æ¯”èµ›æ˜¯å¦è¢«é‡‡æ ·ç”¨äºé¥æµ‹',\n  `players` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapMatchDetails_players',\n  `teams` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapMatchDetails_teams',\n  `roundresults` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapMatchDetails_roundResults',\n  `platforminfoplatformtype` TEXT COMMENT 'å®¢æˆ·ç«¯å¹³å°ç±»å‹ - æ­¤äº‹ä»¶æ¥æºçš„å®¢æˆ·ç«¯å¹³å°ï¼ˆä¾‹å¦‚ï¼šMobile æˆ– PCï¼‰',\n  `platforminfoplatformos` TEXT COMMENT 'å®¢æˆ·ç«¯å¹³å°æ“ä½œç³»ç»Ÿ - æ­¤äº‹ä»¶æ¥æºçš„å®¢æˆ·ç«¯æ“ä½œç³»ç»Ÿ',\n  `aplogtotal` BIGINT COMMENT 'ç”±æ­¤ AP äº‹ä»¶ç”Ÿæˆçš„æ—¥å¿—æ€»æ•°',\n  `platformtype` TEXT COMMENT 'å®¢æˆ·ç«¯å¹³å°ç±»å‹ - æ­¤äº‹ä»¶æ¥æºçš„å®¢æˆ·ç«¯å¹³å°ï¼ˆä¾‹å¦‚ï¼šMobile æˆ– PCï¼‰',\n  `apschemaversion` TEXT COMMENT 'apSchemaVersion'\n);\nCREATE TABLE `dwd_argothek_apinventorymovementlog_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'åˆ†åŒºå­—æ®µ',\n  `dteventtime` TEXT COMMENT 'AP äº‹ä»¶æ—¶é—´: YYYY-MM-DD HH:MM:SS',\n  `apeventid` TEXT COMMENT 'AP äº‹ä»¶æ ‡è¯†ç¬¦',\n  `matchinfobranch` TEXT COMMENT 'Ares Perforce åˆ†æ”¯ - æ­¤æ„å»ºç‰ˆæœ¬çš„æ¥æºåˆ†æ”¯',\n  `matchinfochangelist` TEXT COMMENT 'Perforce å˜æ›´åˆ—è¡¨ - Perforce å˜æ›´åˆ—è¡¨ç¼–å·',\n  `matchinfogameid` BIGINT COMMENT 'Ares æ¸¸æˆ ID - Ares åŒ¹é…çš„ ID å·ï¼ˆåŸºäºå¹³å°æ—¶é—´æˆ³ä¹‹å‰ï¼‰',\n  `matchinfogamemode` TEXT COMMENT 'Ares æ¸¸æˆæ¨¡å¼ - æ­£åœ¨è¿›è¡Œçš„æ¯”èµ›ç±»å‹',\n  `matchinfomap` TEXT COMMENT 'Ares åœ°å›¾ - Ares åœ°å›¾çš„åç§°',\n  `matchinfomatchid` TEXT COMMENT 'Ares åŒ¹é… ID - Ares åŒ¹é…çš„ ID å­—ç¬¦ä¸²',\n  `matchinfoversion` TEXT COMMENT 'Ares æ„å»ºç‰ˆæœ¬ - Ares äºŒè¿›åˆ¶æ–‡ä»¶çš„å®Œæ•´æ„å»ºç‰ˆæœ¬',\n  `roundinfoattackerscore` BIGINT COMMENT 'å›åˆå¾—åˆ† - Ares åŒ¹é…çš„å›åˆå¾—åˆ†',\n  `roundinfodefenderscore` BIGINT COMMENT 'å›åˆå¾—åˆ† - Ares åŒ¹é…çš„å›åˆå¾—åˆ†',\n  `roundinfomatchtime` BIGINT COMMENT 'æ¯”èµ›æ—¶é—´ - å½“å‰æ¯”èµ›å·²è¿›è¡Œçš„æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’',\n  `roundinforoundnumber` BIGINT COMMENT 'å›åˆç¼–å· - Ares åŒ¹é…çš„å›åˆç¼–å·',\n  `roundinforoundphase` TEXT COMMENT 'Ares å›åˆé˜¶æ®µ - Ares æ¸¸æˆå›åˆçš„æ¸¸æˆé˜¶æ®µ - å€¼ï¼šBetweenRoundsï¼ˆå›åˆä¹‹é—´ï¼‰, GameEndedï¼ˆæ¸¸æˆç»“æŸï¼‰, GameStartedï¼ˆæ¸¸æˆå¼€å§‹ï¼‰, InRoundï¼ˆå›åˆä¸­ï¼‰, NotStartedï¼ˆæœªå¼€å§‹ï¼‰, RoundEndingï¼ˆå›åˆç»“æŸä¸­ï¼‰, RoundStartingï¼ˆå›åˆå¼€å§‹ä¸­ï¼‰, SwitchingTeamsï¼ˆäº¤æ¢é˜Ÿä¼ï¼‰, Invalidï¼ˆæ— æ•ˆï¼‰',\n  `roundinforoundtime` DOUBLE COMMENT 'å›åˆæ—¶é—´ - å½“å‰å›åˆå·²è¿›è¡Œçš„æ—¶é—´ï¼Œå•ä½ä¸ºç§’',\n  `playerinfocharacter` TEXT COMMENT 'Ares è§’è‰² - Ares è§’è‰²çš„åç§°',\n  `playerinfoname` TEXT COMMENT 'Ares ç©å®¶åç§° - Ares ç©å®¶çš„åç§°ï¼ˆä¸ä¸€å®šæ˜¯å¬å”¤å¸ˆåç§°ï¼‰',\n  `playerinfosubject` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO ç©å®¶ ID: Riot ç©å®¶çš„å…¨å±€å”¯ä¸€ ID',\n  `playerinfoteamid` TEXT COMMENT 'Ares é˜Ÿä¼ ID - Ares é˜Ÿä¼ ID',\n  `playerinfoside` TEXT COMMENT 'Ares æ¸¸æˆæ¨¡å¼çš„é˜µè¥ - å½“å‰ç‚¸å¼¹æ¸¸æˆæ¨¡å¼ä¸­çš„ Ares é˜µè¥ã€‚è¿™æ›¾æ˜¯ Ares é˜Ÿä¼ï¼Œä½†æˆ‘ä»¬å¸Œæœ›è½¬ç§»åˆ°èƒ½å¤Ÿè·¨æœåŠ¡å¼•ç”¨é˜Ÿä¼ä¸ºçº¢/è“ã€‚æ³¨æ„ï¼šæ­¤ç±»å‹ä¹Ÿè¢«ç”¨äºè¡¨ç¤ºé˜Ÿä¼è§’è‰²çš„å±æ€§ã€‚å› æ­¤æœ‰é¢å¤–çš„æ”¯æŒå…¶ä»–è§’è‰²çš„å€¼ï¼ˆå³ None/Any/FreeForAllï¼‰ - å€¼ï¼šAttackerï¼ˆè¿›æ”»æ–¹ï¼‰, Defenderï¼ˆé˜²å®ˆæ–¹ï¼‰, Neutralï¼ˆä¸­ç«‹ï¼‰, Unknownï¼ˆæœªçŸ¥ï¼‰, Noneï¼ˆæ— ï¼‰, Anyï¼ˆä»»æ„ï¼‰, FreeForAllï¼ˆæ··æˆ˜ï¼‰',\n  `playerinfoteamrole` TEXT COMMENT 'Ares æ¸¸æˆæ¨¡å¼çš„é˜Ÿä¼è§’è‰² - å½“å‰ç‚¸å¼¹æ¸¸æˆæ¨¡å¼ä¸­çš„ Ares é˜µè¥ã€‚è¿™æ›¾æ˜¯ Ares é˜Ÿä¼ï¼Œä½†æˆ‘ä»¬å¸Œæœ›è½¬ç§»åˆ°èƒ½å¤Ÿè·¨æœåŠ¡å¼•ç”¨é˜Ÿä¼ä¸ºçº¢/è“ã€‚æ³¨æ„ï¼šæ­¤ç±»å‹ä¹Ÿè¢«ç”¨äºè¡¨ç¤ºé˜Ÿä¼è§’è‰²çš„å±æ€§ã€‚å› æ­¤æœ‰é¢å¤–çš„æ”¯æŒå…¶ä»–è§’è‰²çš„å€¼ï¼ˆå³ None/Any/FreeForAllï¼‰ - å€¼ï¼šAttackerï¼ˆè¿›æ”»æ–¹ï¼‰, Defenderï¼ˆé˜²å®ˆæ–¹ï¼‰, Neutralï¼ˆä¸­ç«‹ï¼‰, Unknownï¼ˆæœªçŸ¥ï¼‰, Noneï¼ˆæ— ï¼‰, Anyï¼ˆä»»æ„ï¼‰, FreeForAllï¼ˆæ··æˆ˜ï¼‰',\n  `pretransactionmoney` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `pretransactionmoneyreceiver` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `pretransactionmoneysender` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `itemcost` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `startinvpriweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvpriweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvpriweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvpriweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvsecweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvsecweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvsecweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvsecweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvmeleeid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvmeleename` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvmeleetype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvmeleeavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvarmorid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvarmorname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvarmortype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvarmoravaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvabilities` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_StartInvAbilities',\n  `startinvbackpackitems` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_StartInvBackpackItems',\n  `startinvpassives` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_StartInvPassives',\n  `startinvcurequippedid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvcurequippedname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvcurequippedtype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvcurequippedavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvpriweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvpriweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvpriweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvpriweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvsecweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvsecweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvsecweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvsecweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvmeleeid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvmeleename` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvmeleetype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvmeleeavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvarmorid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvarmorname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvarmortype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvarmoravaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvabilities` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_EndInvAbilities',\n  `endinvbackpackitems` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_EndInvBackpackItems',\n  `endinvpassives` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_EndInvPassives',\n  `endinvcurequippedid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvcurequippedname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvcurequippedtype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvcurequippedavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `itemname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `itemid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `receiverid` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO ç©å®¶ ID: Riot ç©å®¶çš„å…¨å±€å”¯ä¸€ ID',\n  `senderid` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO ç©å®¶ ID: Riot ç©å®¶çš„å…¨å±€å”¯ä¸€ ID',\n  `transactiontype` TEXT COMMENT 'äº¤æ˜“ç±»å‹ - å¯é€‰å€¼ï¼š[Purchaseï¼ˆè´­ä¹°ï¼‰, PickUpï¼ˆæ‹¾å–ï¼‰, FulfillRequestï¼ˆæ»¡è¶³è¯·æ±‚ï¼‰, Dropï¼ˆä¸¢å¼ƒï¼‰, Sellï¼ˆå‡ºå”®ï¼‰, Transferï¼ˆè½¬ç§»ï¼‰, Defaultï¼ˆé»˜è®¤ï¼‰, Otherï¼ˆå…¶ä»–ï¼‰]',\n  `aplogtotal` BIGINT COMMENT 'ç”±æ­¤ AP äº‹ä»¶ç”Ÿæˆçš„æ—¥å¿—æ€»æ•°',\n  `clientplatformdetailsplatformtype` TEXT COMMENT 'clientPlatformDetailsPlatformType',\n  `clientplatformdetailsplatformmetadata` TEXT COMMENT 'clientPlatformDetailsPlatformMetadata',\n  `platformtype` TEXT COMMENT 'platformType',\n  `apschemaversion` TEXT COMMENT 'apSchemaVersion'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nprovisioningflowid = \"Matchmaking\" -- é™¤è‡ªå®šä¹‰æ¨¡å¼ã€æ–°æ‰‹ã€è®­ç»ƒåœºå¤–æ‰€æœ‰æ¨¡å¼\n\nå¯¹å±€ä»£ä¹°ç­›é€‰é€»è¾‘ï¼š\nTransactionType = \"FulfillRequest\"\n\n",
  "chosen": "SELECT COUNT(*) AS weapon_daibuy_count\nFROM final_algorithm_competition.dwd_argothek_apinventorymovementlog_hi inv\nJOIN final_algorithm_competition.dwd_argothek_matchdetails_hi match\nON inv.matchinfomatchid = match.matchid\nWHERE inv.tdbank_imp_date BETWEEN '2024010100' AND '2024121623'\nAND match.tdbank_imp_date BETWEEN '2024010100' AND '2024121623'\nAND inv.transactiontype = 'FulfillRequest'\nAND match.provisioningflowid = 'Matchmaking'",
  "rejected": "SELECT\n  COUNT(DISTINCT `matchinfomatchid`)\nFROM `dwd_argothek_apinventorymovementlog_hi`\nWHERE\n  DATE(`dteventtime`) BETWEEN '2024-01-01' AND '2024-12-16'\n  AND `transactiontype` = 'FulfillRequest'\n  AND `matchinfogamemode` NOT IN ('CustomGame', 'NewPlayer', 'TrainingGround')"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡ï¼š2024-01-01åˆ°2024-12-16ï¼Œè´­ä¹°é˜¶æ®µå‡ºç°äº†xæ¬¡æ­¦å™¨ä»£ä¹°ï¼Œé™¤è‡ªå®šä¹‰æ¨¡å¼ã€æ–°æ‰‹ã€è®­ç»ƒåœºå¤–æ‰€æœ‰æ¨¡å¼ã€‚\nè¾“å‡ºï¼šæ­¦å™¨ä»£ä¹°æ¬¡æ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dwd_argothek_matchdetails_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'åˆ†åŒºå­—æ®µ',\n  `dteventtime` TEXT COMMENT 'AP äº‹ä»¶æ—¶é—´: YYYY-MM-DD HH:MM:SS',\n  `apeventid` TEXT COMMENT 'AP äº‹ä»¶æ ‡è¯†ç¬¦',\n  `matchid` TEXT COMMENT 'Ares åŒ¹é… ID - Ares åŒ¹é…çš„ ID å­—ç¬¦ä¸²',\n  `mapid` TEXT COMMENT 'Ares åœ°å›¾ ID - æœåŠ¡ä»£ç ä¸­ä½¿ç”¨çš„ Ares åœ°å›¾ ID',\n  `provisioningflowid` TEXT COMMENT 'é…ç½®æµç¨‹ ID - å·²é…ç½®çš„æ¸¸æˆç±»å‹ã€‚ä¾‹å¦‚ï¼šæŠ€èƒ½æµ‹è¯•ã€åŒ¹é…ç­‰',\n  `gamepodid` TEXT COMMENT 'æ¸¸æˆèŠ‚ç‚¹ ID - æ¸¸æˆèŠ‚ç‚¹çš„å­—ç¬¦ä¸²è¡¨ç¤º',\n  `gamelengthmillis` DOUBLE COMMENT 'æ¯«ç§’ - åƒåˆ†ä¹‹ä¸€ç§’çš„å•ä½',\n  `gamestartmillis` DOUBLE COMMENT 'æ¯«ç§’ - åƒåˆ†ä¹‹ä¸€ç§’çš„å•ä½',\n  `gameversion` TEXT COMMENT 'Ares æ„å»ºç‰ˆæœ¬ - Ares äºŒè¿›åˆ¶æ–‡ä»¶çš„å®Œæ•´æ„å»ºç‰ˆæœ¬',\n  `iscompleted` BIGINT COMMENT 'æ¯”èµ›å®Œæˆæ ‡å¿— - å¦‚æœæ¯”èµ›æ­£å¸¸ç»“æŸå¹¶æœ‰æ¯”èµ›ç»“æœï¼Œåˆ™ä¸º True',\n  `customgamename` TEXT COMMENT 'Ares è‡ªå®šä¹‰æ¸¸æˆåç§° - è‡ªå®šä¹‰æ¸¸æˆçš„åç§°',\n  `module` TEXT COMMENT 'Ares å°„å‡»åœºæ¨¡å— - å¯ä»¥åœ¨å°„å‡»åœºä¸­æ¸¸ç©çš„æ¨¡å—',\n  `forcepostprocessing` BIGINT COMMENT 'å¼ºåˆ¶åå¤„ç†æ ‡å¿— - å¯¹äºéœ€è¦å¯ç”¨è°ƒè¯•çš„æ¯”èµ›ï¼Œè¯¥å€¼ä¸º Trueã€‚',\n  `queueid` TEXT COMMENT 'Ares é˜Ÿåˆ— ID - Ares é˜Ÿåˆ—çš„ ID å­—ç¬¦ä¸²',\n  `seasonid` TEXT COMMENT 'èµ›å­£ ID - èµ›å­£çš„ uuid',\n  `completionstate` TEXT COMMENT 'Ares å®ŒæˆçŠ¶æ€ - æ¯”èµ›å¦‚ä½•å®Œæˆçš„å­—ç¬¦ä¸²å€¼ã€‚ä¾‹å¦‚ï¼šCompletedï¼ˆå®Œæˆï¼‰, All_Disconnectedï¼ˆå…¨éƒ¨æ–­å¼€è¿æ¥ï¼‰',\n  `ismatchsampled` BIGINT COMMENT 'æ¯”èµ›æ˜¯å¦è¢«é‡‡æ ·æ ‡å¿— - æŒ‡ç¤ºè¯¥æ¯”èµ›æ˜¯å¦è¢«é‡‡æ ·ç”¨äºé¥æµ‹',\n  `players` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapMatchDetails_players',\n  `teams` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapMatchDetails_teams',\n  `roundresults` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapMatchDetails_roundResults',\n  `platforminfoplatformtype` TEXT COMMENT 'å®¢æˆ·ç«¯å¹³å°ç±»å‹ - æ­¤äº‹ä»¶æ¥æºçš„å®¢æˆ·ç«¯å¹³å°ï¼ˆä¾‹å¦‚ï¼šMobile æˆ– PCï¼‰',\n  `platforminfoplatformos` TEXT COMMENT 'å®¢æˆ·ç«¯å¹³å°æ“ä½œç³»ç»Ÿ - æ­¤äº‹ä»¶æ¥æºçš„å®¢æˆ·ç«¯æ“ä½œç³»ç»Ÿ',\n  `aplogtotal` BIGINT COMMENT 'ç”±æ­¤ AP äº‹ä»¶ç”Ÿæˆçš„æ—¥å¿—æ€»æ•°',\n  `platformtype` TEXT COMMENT 'å®¢æˆ·ç«¯å¹³å°ç±»å‹ - æ­¤äº‹ä»¶æ¥æºçš„å®¢æˆ·ç«¯å¹³å°ï¼ˆä¾‹å¦‚ï¼šMobile æˆ– PCï¼‰',\n  `apschemaversion` TEXT COMMENT 'apSchemaVersion'\n);\nCREATE TABLE `dwd_argothek_apinventorymovementlog_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'åˆ†åŒºå­—æ®µ',\n  `dteventtime` TEXT COMMENT 'AP äº‹ä»¶æ—¶é—´: YYYY-MM-DD HH:MM:SS',\n  `apeventid` TEXT COMMENT 'AP äº‹ä»¶æ ‡è¯†ç¬¦',\n  `matchinfobranch` TEXT COMMENT 'Ares Perforce åˆ†æ”¯ - æ­¤æ„å»ºç‰ˆæœ¬çš„æ¥æºåˆ†æ”¯',\n  `matchinfochangelist` TEXT COMMENT 'Perforce å˜æ›´åˆ—è¡¨ - Perforce å˜æ›´åˆ—è¡¨ç¼–å·',\n  `matchinfogameid` BIGINT COMMENT 'Ares æ¸¸æˆ ID - Ares åŒ¹é…çš„ ID å·ï¼ˆåŸºäºå¹³å°æ—¶é—´æˆ³ä¹‹å‰ï¼‰',\n  `matchinfogamemode` TEXT COMMENT 'Ares æ¸¸æˆæ¨¡å¼ - æ­£åœ¨è¿›è¡Œçš„æ¯”èµ›ç±»å‹',\n  `matchinfomap` TEXT COMMENT 'Ares åœ°å›¾ - Ares åœ°å›¾çš„åç§°',\n  `matchinfomatchid` TEXT COMMENT 'Ares åŒ¹é… ID - Ares åŒ¹é…çš„ ID å­—ç¬¦ä¸²',\n  `matchinfoversion` TEXT COMMENT 'Ares æ„å»ºç‰ˆæœ¬ - Ares äºŒè¿›åˆ¶æ–‡ä»¶çš„å®Œæ•´æ„å»ºç‰ˆæœ¬',\n  `roundinfoattackerscore` BIGINT COMMENT 'å›åˆå¾—åˆ† - Ares åŒ¹é…çš„å›åˆå¾—åˆ†',\n  `roundinfodefenderscore` BIGINT COMMENT 'å›åˆå¾—åˆ† - Ares åŒ¹é…çš„å›åˆå¾—åˆ†',\n  `roundinfomatchtime` BIGINT COMMENT 'æ¯”èµ›æ—¶é—´ - å½“å‰æ¯”èµ›å·²è¿›è¡Œçš„æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’',\n  `roundinforoundnumber` BIGINT COMMENT 'å›åˆç¼–å· - Ares åŒ¹é…çš„å›åˆç¼–å·',\n  `roundinforoundphase` TEXT COMMENT 'Ares å›åˆé˜¶æ®µ - Ares æ¸¸æˆå›åˆçš„æ¸¸æˆé˜¶æ®µ - å€¼ï¼šBetweenRoundsï¼ˆå›åˆä¹‹é—´ï¼‰, GameEndedï¼ˆæ¸¸æˆç»“æŸï¼‰, GameStartedï¼ˆæ¸¸æˆå¼€å§‹ï¼‰, InRoundï¼ˆå›åˆä¸­ï¼‰, NotStartedï¼ˆæœªå¼€å§‹ï¼‰, RoundEndingï¼ˆå›åˆç»“æŸä¸­ï¼‰, RoundStartingï¼ˆå›åˆå¼€å§‹ä¸­ï¼‰, SwitchingTeamsï¼ˆäº¤æ¢é˜Ÿä¼ï¼‰, Invalidï¼ˆæ— æ•ˆï¼‰',\n  `roundinforoundtime` DOUBLE COMMENT 'å›åˆæ—¶é—´ - å½“å‰å›åˆå·²è¿›è¡Œçš„æ—¶é—´ï¼Œå•ä½ä¸ºç§’',\n  `playerinfocharacter` TEXT COMMENT 'Ares è§’è‰² - Ares è§’è‰²çš„åç§°',\n  `playerinfoname` TEXT COMMENT 'Ares ç©å®¶åç§° - Ares ç©å®¶çš„åç§°ï¼ˆä¸ä¸€å®šæ˜¯å¬å”¤å¸ˆåç§°ï¼‰',\n  `playerinfosubject` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO ç©å®¶ ID: Riot ç©å®¶çš„å…¨å±€å”¯ä¸€ ID',\n  `playerinfoteamid` TEXT COMMENT 'Ares é˜Ÿä¼ ID - Ares é˜Ÿä¼ ID',\n  `playerinfoside` TEXT COMMENT 'Ares æ¸¸æˆæ¨¡å¼çš„é˜µè¥ - å½“å‰ç‚¸å¼¹æ¸¸æˆæ¨¡å¼ä¸­çš„ Ares é˜µè¥ã€‚è¿™æ›¾æ˜¯ Ares é˜Ÿä¼ï¼Œä½†æˆ‘ä»¬å¸Œæœ›è½¬ç§»åˆ°èƒ½å¤Ÿè·¨æœåŠ¡å¼•ç”¨é˜Ÿä¼ä¸ºçº¢/è“ã€‚æ³¨æ„ï¼šæ­¤ç±»å‹ä¹Ÿè¢«ç”¨äºè¡¨ç¤ºé˜Ÿä¼è§’è‰²çš„å±æ€§ã€‚å› æ­¤æœ‰é¢å¤–çš„æ”¯æŒå…¶ä»–è§’è‰²çš„å€¼ï¼ˆå³ None/Any/FreeForAllï¼‰ - å€¼ï¼šAttackerï¼ˆè¿›æ”»æ–¹ï¼‰, Defenderï¼ˆé˜²å®ˆæ–¹ï¼‰, Neutralï¼ˆä¸­ç«‹ï¼‰, Unknownï¼ˆæœªçŸ¥ï¼‰, Noneï¼ˆæ— ï¼‰, Anyï¼ˆä»»æ„ï¼‰, FreeForAllï¼ˆæ··æˆ˜ï¼‰',\n  `playerinfoteamrole` TEXT COMMENT 'Ares æ¸¸æˆæ¨¡å¼çš„é˜Ÿä¼è§’è‰² - å½“å‰ç‚¸å¼¹æ¸¸æˆæ¨¡å¼ä¸­çš„ Ares é˜µè¥ã€‚è¿™æ›¾æ˜¯ Ares é˜Ÿä¼ï¼Œä½†æˆ‘ä»¬å¸Œæœ›è½¬ç§»åˆ°èƒ½å¤Ÿè·¨æœåŠ¡å¼•ç”¨é˜Ÿä¼ä¸ºçº¢/è“ã€‚æ³¨æ„ï¼šæ­¤ç±»å‹ä¹Ÿè¢«ç”¨äºè¡¨ç¤ºé˜Ÿä¼è§’è‰²çš„å±æ€§ã€‚å› æ­¤æœ‰é¢å¤–çš„æ”¯æŒå…¶ä»–è§’è‰²çš„å€¼ï¼ˆå³ None/Any/FreeForAllï¼‰ - å€¼ï¼šAttackerï¼ˆè¿›æ”»æ–¹ï¼‰, Defenderï¼ˆé˜²å®ˆæ–¹ï¼‰, Neutralï¼ˆä¸­ç«‹ï¼‰, Unknownï¼ˆæœªçŸ¥ï¼‰, Noneï¼ˆæ— ï¼‰, Anyï¼ˆä»»æ„ï¼‰, FreeForAllï¼ˆæ··æˆ˜ï¼‰',\n  `pretransactionmoney` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `pretransactionmoneyreceiver` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `pretransactionmoneysender` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `itemcost` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `startinvpriweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvpriweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvpriweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvpriweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvsecweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvsecweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvsecweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvsecweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvmeleeid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvmeleename` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvmeleetype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvmeleeavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvarmorid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvarmorname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvarmortype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvarmoravaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvabilities` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_StartInvAbilities',\n  `startinvbackpackitems` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_StartInvBackpackItems',\n  `startinvpassives` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_StartInvPassives',\n  `startinvcurequippedid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvcurequippedname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvcurequippedtype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvcurequippedavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvpriweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvpriweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvpriweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvpriweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvsecweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvsecweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvsecweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvsecweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvmeleeid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvmeleename` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvmeleetype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvmeleeavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvarmorid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvarmorname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvarmortype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvarmoravaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvabilities` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_EndInvAbilities',\n  `endinvbackpackitems` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_EndInvBackpackItems',\n  `endinvpassives` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_EndInvPassives',\n  `endinvcurequippedid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvcurequippedname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvcurequippedtype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvcurequippedavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `itemname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `itemid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `receiverid` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO ç©å®¶ ID: Riot ç©å®¶çš„å…¨å±€å”¯ä¸€ ID',\n  `senderid` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO ç©å®¶ ID: Riot ç©å®¶çš„å…¨å±€å”¯ä¸€ ID',\n  `transactiontype` TEXT COMMENT 'äº¤æ˜“ç±»å‹ - å¯é€‰å€¼ï¼š[Purchaseï¼ˆè´­ä¹°ï¼‰, PickUpï¼ˆæ‹¾å–ï¼‰, FulfillRequestï¼ˆæ»¡è¶³è¯·æ±‚ï¼‰, Dropï¼ˆä¸¢å¼ƒï¼‰, Sellï¼ˆå‡ºå”®ï¼‰, Transferï¼ˆè½¬ç§»ï¼‰, Defaultï¼ˆé»˜è®¤ï¼‰, Otherï¼ˆå…¶ä»–ï¼‰]',\n  `aplogtotal` BIGINT COMMENT 'ç”±æ­¤ AP äº‹ä»¶ç”Ÿæˆçš„æ—¥å¿—æ€»æ•°',\n  `clientplatformdetailsplatformtype` TEXT COMMENT 'clientPlatformDetailsPlatformType',\n  `clientplatformdetailsplatformmetadata` TEXT COMMENT 'clientPlatformDetailsPlatformMetadata',\n  `platformtype` TEXT COMMENT 'platformType',\n  `apschemaversion` TEXT COMMENT 'apSchemaVersion'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nprovisioningflowid = \"Matchmaking\" -- é™¤è‡ªå®šä¹‰æ¨¡å¼ã€æ–°æ‰‹ã€è®­ç»ƒåœºå¤–æ‰€æœ‰æ¨¡å¼\n\nå¯¹å±€ä»£ä¹°ç­›é€‰é€»è¾‘ï¼š\nTransactionType = \"FulfillRequest\"\n\n",
  "chosen": "SELECT COUNT(*) AS weapon_daibuy_count\nFROM final_algorithm_competition.dwd_argothek_apinventorymovementlog_hi inv\nJOIN final_algorithm_competition.dwd_argothek_matchdetails_hi match\nON inv.matchinfomatchid = match.matchid\nWHERE inv.tdbank_imp_date BETWEEN '2024010100' AND '2024121623'\nAND match.tdbank_imp_date BETWEEN '2024010100' AND '2024121623'\nAND inv.transactiontype = 'FulfillRequest'\nAND match.provisioningflowid = 'Matchmaking'",
  "rejected": "SELECT\n  COUNT(*)\nFROM `dwd_argothek_apinventorymovementlog_hi`\nWHERE\n  `transactiontype` = 'FulfillRequest'\n  AND `matchinfogamemode` NOT IN ('CustomGame', 'Tutorial', 'TrainingGround')\n  AND `dteventtime` BETWEEN '2024-01-01' AND '2024-12-16'\n  AND `tdbank_imp_date` BETWEEN '2024-01-01' AND '2024-12-16'"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡ï¼š2024-01-01åˆ°2024-12-16ï¼Œè´­ä¹°é˜¶æ®µå‡ºç°äº†xæ¬¡æ­¦å™¨ä»£ä¹°ï¼Œé™¤è‡ªå®šä¹‰æ¨¡å¼ã€æ–°æ‰‹ã€è®­ç»ƒåœºå¤–æ‰€æœ‰æ¨¡å¼ã€‚\nè¾“å‡ºï¼šæ­¦å™¨ä»£ä¹°æ¬¡æ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dwd_argothek_matchdetails_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'åˆ†åŒºå­—æ®µ',\n  `dteventtime` TEXT COMMENT 'AP äº‹ä»¶æ—¶é—´: YYYY-MM-DD HH:MM:SS',\n  `apeventid` TEXT COMMENT 'AP äº‹ä»¶æ ‡è¯†ç¬¦',\n  `matchid` TEXT COMMENT 'Ares åŒ¹é… ID - Ares åŒ¹é…çš„ ID å­—ç¬¦ä¸²',\n  `mapid` TEXT COMMENT 'Ares åœ°å›¾ ID - æœåŠ¡ä»£ç ä¸­ä½¿ç”¨çš„ Ares åœ°å›¾ ID',\n  `provisioningflowid` TEXT COMMENT 'é…ç½®æµç¨‹ ID - å·²é…ç½®çš„æ¸¸æˆç±»å‹ã€‚ä¾‹å¦‚ï¼šæŠ€èƒ½æµ‹è¯•ã€åŒ¹é…ç­‰',\n  `gamepodid` TEXT COMMENT 'æ¸¸æˆèŠ‚ç‚¹ ID - æ¸¸æˆèŠ‚ç‚¹çš„å­—ç¬¦ä¸²è¡¨ç¤º',\n  `gamelengthmillis` DOUBLE COMMENT 'æ¯«ç§’ - åƒåˆ†ä¹‹ä¸€ç§’çš„å•ä½',\n  `gamestartmillis` DOUBLE COMMENT 'æ¯«ç§’ - åƒåˆ†ä¹‹ä¸€ç§’çš„å•ä½',\n  `gameversion` TEXT COMMENT 'Ares æ„å»ºç‰ˆæœ¬ - Ares äºŒè¿›åˆ¶æ–‡ä»¶çš„å®Œæ•´æ„å»ºç‰ˆæœ¬',\n  `iscompleted` BIGINT COMMENT 'æ¯”èµ›å®Œæˆæ ‡å¿— - å¦‚æœæ¯”èµ›æ­£å¸¸ç»“æŸå¹¶æœ‰æ¯”èµ›ç»“æœï¼Œåˆ™ä¸º True',\n  `customgamename` TEXT COMMENT 'Ares è‡ªå®šä¹‰æ¸¸æˆåç§° - è‡ªå®šä¹‰æ¸¸æˆçš„åç§°',\n  `module` TEXT COMMENT 'Ares å°„å‡»åœºæ¨¡å— - å¯ä»¥åœ¨å°„å‡»åœºä¸­æ¸¸ç©çš„æ¨¡å—',\n  `forcepostprocessing` BIGINT COMMENT 'å¼ºåˆ¶åå¤„ç†æ ‡å¿— - å¯¹äºéœ€è¦å¯ç”¨è°ƒè¯•çš„æ¯”èµ›ï¼Œè¯¥å€¼ä¸º Trueã€‚',\n  `queueid` TEXT COMMENT 'Ares é˜Ÿåˆ— ID - Ares é˜Ÿåˆ—çš„ ID å­—ç¬¦ä¸²',\n  `seasonid` TEXT COMMENT 'èµ›å­£ ID - èµ›å­£çš„ uuid',\n  `completionstate` TEXT COMMENT 'Ares å®ŒæˆçŠ¶æ€ - æ¯”èµ›å¦‚ä½•å®Œæˆçš„å­—ç¬¦ä¸²å€¼ã€‚ä¾‹å¦‚ï¼šCompletedï¼ˆå®Œæˆï¼‰, All_Disconnectedï¼ˆå…¨éƒ¨æ–­å¼€è¿æ¥ï¼‰',\n  `ismatchsampled` BIGINT COMMENT 'æ¯”èµ›æ˜¯å¦è¢«é‡‡æ ·æ ‡å¿— - æŒ‡ç¤ºè¯¥æ¯”èµ›æ˜¯å¦è¢«é‡‡æ ·ç”¨äºé¥æµ‹',\n  `players` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapMatchDetails_players',\n  `teams` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapMatchDetails_teams',\n  `roundresults` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapMatchDetails_roundResults',\n  `platforminfoplatformtype` TEXT COMMENT 'å®¢æˆ·ç«¯å¹³å°ç±»å‹ - æ­¤äº‹ä»¶æ¥æºçš„å®¢æˆ·ç«¯å¹³å°ï¼ˆä¾‹å¦‚ï¼šMobile æˆ– PCï¼‰',\n  `platforminfoplatformos` TEXT COMMENT 'å®¢æˆ·ç«¯å¹³å°æ“ä½œç³»ç»Ÿ - æ­¤äº‹ä»¶æ¥æºçš„å®¢æˆ·ç«¯æ“ä½œç³»ç»Ÿ',\n  `aplogtotal` BIGINT COMMENT 'ç”±æ­¤ AP äº‹ä»¶ç”Ÿæˆçš„æ—¥å¿—æ€»æ•°',\n  `platformtype` TEXT COMMENT 'å®¢æˆ·ç«¯å¹³å°ç±»å‹ - æ­¤äº‹ä»¶æ¥æºçš„å®¢æˆ·ç«¯å¹³å°ï¼ˆä¾‹å¦‚ï¼šMobile æˆ– PCï¼‰',\n  `apschemaversion` TEXT COMMENT 'apSchemaVersion'\n);\nCREATE TABLE `dwd_argothek_apinventorymovementlog_hi` (\n  `tdbank_imp_date` TEXT COMMENT 'åˆ†åŒºå­—æ®µ',\n  `dteventtime` TEXT COMMENT 'AP äº‹ä»¶æ—¶é—´: YYYY-MM-DD HH:MM:SS',\n  `apeventid` TEXT COMMENT 'AP äº‹ä»¶æ ‡è¯†ç¬¦',\n  `matchinfobranch` TEXT COMMENT 'Ares Perforce åˆ†æ”¯ - æ­¤æ„å»ºç‰ˆæœ¬çš„æ¥æºåˆ†æ”¯',\n  `matchinfochangelist` TEXT COMMENT 'Perforce å˜æ›´åˆ—è¡¨ - Perforce å˜æ›´åˆ—è¡¨ç¼–å·',\n  `matchinfogameid` BIGINT COMMENT 'Ares æ¸¸æˆ ID - Ares åŒ¹é…çš„ ID å·ï¼ˆåŸºäºå¹³å°æ—¶é—´æˆ³ä¹‹å‰ï¼‰',\n  `matchinfogamemode` TEXT COMMENT 'Ares æ¸¸æˆæ¨¡å¼ - æ­£åœ¨è¿›è¡Œçš„æ¯”èµ›ç±»å‹',\n  `matchinfomap` TEXT COMMENT 'Ares åœ°å›¾ - Ares åœ°å›¾çš„åç§°',\n  `matchinfomatchid` TEXT COMMENT 'Ares åŒ¹é… ID - Ares åŒ¹é…çš„ ID å­—ç¬¦ä¸²',\n  `matchinfoversion` TEXT COMMENT 'Ares æ„å»ºç‰ˆæœ¬ - Ares äºŒè¿›åˆ¶æ–‡ä»¶çš„å®Œæ•´æ„å»ºç‰ˆæœ¬',\n  `roundinfoattackerscore` BIGINT COMMENT 'å›åˆå¾—åˆ† - Ares åŒ¹é…çš„å›åˆå¾—åˆ†',\n  `roundinfodefenderscore` BIGINT COMMENT 'å›åˆå¾—åˆ† - Ares åŒ¹é…çš„å›åˆå¾—åˆ†',\n  `roundinfomatchtime` BIGINT COMMENT 'æ¯”èµ›æ—¶é—´ - å½“å‰æ¯”èµ›å·²è¿›è¡Œçš„æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’',\n  `roundinforoundnumber` BIGINT COMMENT 'å›åˆç¼–å· - Ares åŒ¹é…çš„å›åˆç¼–å·',\n  `roundinforoundphase` TEXT COMMENT 'Ares å›åˆé˜¶æ®µ - Ares æ¸¸æˆå›åˆçš„æ¸¸æˆé˜¶æ®µ - å€¼ï¼šBetweenRoundsï¼ˆå›åˆä¹‹é—´ï¼‰, GameEndedï¼ˆæ¸¸æˆç»“æŸï¼‰, GameStartedï¼ˆæ¸¸æˆå¼€å§‹ï¼‰, InRoundï¼ˆå›åˆä¸­ï¼‰, NotStartedï¼ˆæœªå¼€å§‹ï¼‰, RoundEndingï¼ˆå›åˆç»“æŸä¸­ï¼‰, RoundStartingï¼ˆå›åˆå¼€å§‹ä¸­ï¼‰, SwitchingTeamsï¼ˆäº¤æ¢é˜Ÿä¼ï¼‰, Invalidï¼ˆæ— æ•ˆï¼‰',\n  `roundinforoundtime` DOUBLE COMMENT 'å›åˆæ—¶é—´ - å½“å‰å›åˆå·²è¿›è¡Œçš„æ—¶é—´ï¼Œå•ä½ä¸ºç§’',\n  `playerinfocharacter` TEXT COMMENT 'Ares è§’è‰² - Ares è§’è‰²çš„åç§°',\n  `playerinfoname` TEXT COMMENT 'Ares ç©å®¶åç§° - Ares ç©å®¶çš„åç§°ï¼ˆä¸ä¸€å®šæ˜¯å¬å”¤å¸ˆåç§°ï¼‰',\n  `playerinfosubject` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO ç©å®¶ ID: Riot ç©å®¶çš„å…¨å±€å”¯ä¸€ ID',\n  `playerinfoteamid` TEXT COMMENT 'Ares é˜Ÿä¼ ID - Ares é˜Ÿä¼ ID',\n  `playerinfoside` TEXT COMMENT 'Ares æ¸¸æˆæ¨¡å¼çš„é˜µè¥ - å½“å‰ç‚¸å¼¹æ¸¸æˆæ¨¡å¼ä¸­çš„ Ares é˜µè¥ã€‚è¿™æ›¾æ˜¯ Ares é˜Ÿä¼ï¼Œä½†æˆ‘ä»¬å¸Œæœ›è½¬ç§»åˆ°èƒ½å¤Ÿè·¨æœåŠ¡å¼•ç”¨é˜Ÿä¼ä¸ºçº¢/è“ã€‚æ³¨æ„ï¼šæ­¤ç±»å‹ä¹Ÿè¢«ç”¨äºè¡¨ç¤ºé˜Ÿä¼è§’è‰²çš„å±æ€§ã€‚å› æ­¤æœ‰é¢å¤–çš„æ”¯æŒå…¶ä»–è§’è‰²çš„å€¼ï¼ˆå³ None/Any/FreeForAllï¼‰ - å€¼ï¼šAttackerï¼ˆè¿›æ”»æ–¹ï¼‰, Defenderï¼ˆé˜²å®ˆæ–¹ï¼‰, Neutralï¼ˆä¸­ç«‹ï¼‰, Unknownï¼ˆæœªçŸ¥ï¼‰, Noneï¼ˆæ— ï¼‰, Anyï¼ˆä»»æ„ï¼‰, FreeForAllï¼ˆæ··æˆ˜ï¼‰',\n  `playerinfoteamrole` TEXT COMMENT 'Ares æ¸¸æˆæ¨¡å¼çš„é˜Ÿä¼è§’è‰² - å½“å‰ç‚¸å¼¹æ¸¸æˆæ¨¡å¼ä¸­çš„ Ares é˜µè¥ã€‚è¿™æ›¾æ˜¯ Ares é˜Ÿä¼ï¼Œä½†æˆ‘ä»¬å¸Œæœ›è½¬ç§»åˆ°èƒ½å¤Ÿè·¨æœåŠ¡å¼•ç”¨é˜Ÿä¼ä¸ºçº¢/è“ã€‚æ³¨æ„ï¼šæ­¤ç±»å‹ä¹Ÿè¢«ç”¨äºè¡¨ç¤ºé˜Ÿä¼è§’è‰²çš„å±æ€§ã€‚å› æ­¤æœ‰é¢å¤–çš„æ”¯æŒå…¶ä»–è§’è‰²çš„å€¼ï¼ˆå³ None/Any/FreeForAllï¼‰ - å€¼ï¼šAttackerï¼ˆè¿›æ”»æ–¹ï¼‰, Defenderï¼ˆé˜²å®ˆæ–¹ï¼‰, Neutralï¼ˆä¸­ç«‹ï¼‰, Unknownï¼ˆæœªçŸ¥ï¼‰, Noneï¼ˆæ— ï¼‰, Anyï¼ˆä»»æ„ï¼‰, FreeForAllï¼ˆæ··æˆ˜ï¼‰',\n  `pretransactionmoney` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `pretransactionmoneyreceiver` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `pretransactionmoneysender` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `itemcost` BIGINT COMMENT 'Ares æ¸¸æˆè´§å¸ - Ares æ¸¸æˆå†…è´§å¸çš„æ•°é‡',\n  `startinvpriweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvpriweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvpriweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvpriweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvsecweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvsecweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvsecweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvsecweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvmeleeid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvmeleename` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvmeleetype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvmeleeavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvarmorid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvarmorname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvarmortype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvarmoravaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `startinvabilities` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_StartInvAbilities',\n  `startinvbackpackitems` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_StartInvBackpackItems',\n  `startinvpassives` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_StartInvPassives',\n  `startinvcurequippedid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `startinvcurequippedname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `startinvcurequippedtype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `startinvcurequippedavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvpriweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvpriweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvpriweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvpriweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvsecweaponid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvsecweaponname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvsecweapontype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvsecweaponavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvmeleeid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvmeleename` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvmeleetype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvmeleeavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvarmorid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvarmorname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvarmortype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvarmoravaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `endinvabilities` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_EndInvAbilities',\n  `endinvbackpackitems` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_EndInvBackpackItems',\n  `endinvpassives` TEXT COMMENT 'AP å­æ ‡è¯†ç¬¦ï¼ŒæŒ‡å‘å­ç»“æ„ï¼šapInventoryChangeEvent_EndInvPassives',\n  `endinvcurequippedid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `endinvcurequippedname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `endinvcurequippedtype` TEXT COMMENT 'ç‰©å“ç±»å‹ - ç‰©å“çš„ç±»å‹',\n  `endinvcurequippedavaamt` DOUBLE COMMENT 'Ares èµ„æºæ•°é‡ - æŠ€èƒ½çš„å……èƒ½æ¬¡æ•°ã€æ­¦å™¨çš„å­å¼¹æ•°å’ŒæŠ¤ç”²çš„ç”Ÿå‘½å€¼',\n  `itemname` TEXT COMMENT 'ç‰©å“åç§° - ç‰©å“åç§°',\n  `itemid` TEXT COMMENT 'ç‰©å“ ID - ç‰©å“æ ‡è¯†ç¬¦',\n  `receiverid` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO ç©å®¶ ID: Riot ç©å®¶çš„å…¨å±€å”¯ä¸€ ID',\n  `senderid` TEXT COMMENT 'RSO PUUID - RFC 0214g - RSO ç©å®¶ ID: Riot ç©å®¶çš„å…¨å±€å”¯ä¸€ ID',\n  `transactiontype` TEXT COMMENT 'äº¤æ˜“ç±»å‹ - å¯é€‰å€¼ï¼š[Purchaseï¼ˆè´­ä¹°ï¼‰, PickUpï¼ˆæ‹¾å–ï¼‰, FulfillRequestï¼ˆæ»¡è¶³è¯·æ±‚ï¼‰, Dropï¼ˆä¸¢å¼ƒï¼‰, Sellï¼ˆå‡ºå”®ï¼‰, Transferï¼ˆè½¬ç§»ï¼‰, Defaultï¼ˆé»˜è®¤ï¼‰, Otherï¼ˆå…¶ä»–ï¼‰]',\n  `aplogtotal` BIGINT COMMENT 'ç”±æ­¤ AP äº‹ä»¶ç”Ÿæˆçš„æ—¥å¿—æ€»æ•°',\n  `clientplatformdetailsplatformtype` TEXT COMMENT 'clientPlatformDetailsPlatformType',\n  `clientplatformdetailsplatformmetadata` TEXT COMMENT 'clientPlatformDetailsPlatformMetadata',\n  `platformtype` TEXT COMMENT 'platformType',\n  `apschemaversion` TEXT COMMENT 'apSchemaVersion'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nprovisioningflowid = \"Matchmaking\" -- é™¤è‡ªå®šä¹‰æ¨¡å¼ã€æ–°æ‰‹ã€è®­ç»ƒåœºå¤–æ‰€æœ‰æ¨¡å¼\n\nå¯¹å±€ä»£ä¹°ç­›é€‰é€»è¾‘ï¼š\nTransactionType = \"FulfillRequest\"\n\n",
  "chosen": "SELECT COUNT(*) AS weapon_daibuy_count\nFROM final_algorithm_competition.dwd_argothek_apinventorymovementlog_hi inv\nJOIN final_algorithm_competition.dwd_argothek_matchdetails_hi match\nON inv.matchinfomatchid = match.matchid\nWHERE inv.tdbank_imp_date BETWEEN '2024010100' AND '2024121623'\nAND match.tdbank_imp_date BETWEEN '2024010100' AND '2024121623'\nAND inv.transactiontype = 'FulfillRequest'\nAND match.provisioningflowid = 'Matchmaking'",
  "rejected": "SELECT\n  COUNT(DISTINCT `T1`.`matchinfomatchid`)\nFROM `dwd_argothek_apinventorymovementlog_hi` AS `T1`\nINNER JOIN `dwd_argothek_matchdetails_hi` AS `T2`\n  ON `T1`.`matchinfomatchid` = `T2`.`matchid`\nWHERE\n  `T1`.`transactiontype` = 'FulfillRequest'\n  AND `T2`.`provisioningflowid` = 'Matchmaking'\n  AND `T2`.`dteventtime` >= '2024-01-01 00:00:00'\n  AND `T2`.`dteventtime` < '2024-12-17 00:00:00'"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡20250217-20250318åä½œå¹³å°æ´»è·ƒä½†æ˜¯æ²¡æœ‰åœ¨åä½œç©æ³•æ´»è·ƒç”¨æˆ·çš„ä¸»ç©ç©æ³•åˆ†å¸ƒ\nè¾“å‡ºï¼šä¸»ç©ç©æ³•ï¼ˆä¼ ç»Ÿæ¨¡å¼ã€ä¼‘é—²æ¨¡å¼ã€...ã€ç”Ÿå­˜æ¨¡å¼ï¼‰ã€äººæ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_jordass_matchlog_stat_di` (\n  `dtstatdate` TEXT COMMENT 'åˆ†åŒºï¼Œå‚ä¸ä¹å›­æ—¥æœŸï¼Œæ ¼å¼YYYYMMDD',\n  `vgameappid` TEXT COMMENT 'è´¦å·ä½“ç³»ï¼šwx:å¾®ä¿¡ï¼Œqqï¼šæ‰‹Q',\n  `platid` BIGINT COMMENT 'ç³»ç»Ÿå¹³å°ï¼š0:IOS,1:Android255:æ‰€æœ‰å¹³å°',\n  `vplayerid` TEXT COMMENT 'ç©å®¶ID',\n  `imode` BIGINT COMMENT 'ä¹å›­å­ç©æ³•ï¼š\t255-æ‰€æœ‰ç©æ³•ï¼Œç”¨æˆ·é—®é¢˜æœªæåˆ°æ˜ç¡®çš„å­ç©æ³•æ—¶ï¼Œé»˜è®¤ä¸ºæ‰€æœ‰ç©æ³•\t1282371711108385024-è·‘é…·ï¼šæˆç¥ä¹‹è·¯\t1281086178576044544-ä¼ åª’ç¾¤å²›\t1305619333337074432-ç‹‚çƒ­æ´¾å¯¹\t1251206313870885120-ç ºåˆƒè¿åŠ¨ä¼š5.0\t1313754433693158656-æ‰‹çƒç‰¹æ”»ï¼ˆåŸè¶³çƒæ¸¸æˆï¼‰\t1296730563346958080-ç›”ä»”æ³¡æ³¡å°é˜Ÿ\t1294279575841283072-å¤ºå®è¡ŒåŠ¨\t1310822585431254784-æ¡¥æ¢äº‰å¤º\t1278160113246405632-ç ºåˆƒå¤§äº¨\t1313047366167692288-é€†è½¬å¹³åº•é”…\t1298874468735655936-æˆ˜è½¦çªè¢­\t1278948391311645952-èƒ½é‡äº‰å¤ºæˆ˜\t1295942084687041792-è¶£å‘³é£ç›˜\t1282101477461985024-ç›”ä»”æ€»åŠ¨å‘˜\t1278144466094392064-é»‘äº”æ¨¡æ‹Ÿå™¨\t1313046652157690624-ç›”ä»”æ–—é­”ç‹ï¼ˆåŸç›”ä»”å¤§ä¹±æ–—ï¼‰\t1289446028099979264-ä½£å…µé˜µçº¿\t1309453077449826304-æ˜Ÿæ˜Ÿäº‰å¤ºæˆ˜ï¼ˆåŸåï¼šé‡‘å¸å¤§ä½œæˆ˜ï¼‰\t1298445174154728192-åœè½¦å¤§ä½œæˆ˜\t1294211358396518400-ç‰¹æŠ€å¤§ä¹±æ–—\t1280302176000803840-å§åº•è¡ŒåŠ¨\t1307095884553538304-\"è¶…çº§éšåŒ¿ï¼ˆåŸå¹¿é˜”å¤©åœ°éšåŒ¿æ¨¡å¼ï¼‰\"\t1297394991875754752-å®ˆå«ç”Ÿå‘½çº¿\t1278170390282112000-æ˜Ÿçƒå®ˆæŠ¤è€…\t1287652322611036928-æ‹¼å›¾ç‹‚æ¬¢\t1273928195100380928-ç‰¹ç§å…µè®­ç»ƒ\t1300845150154531840-æ˜Ÿä¹‹ç»§æ‰¿è€…\t1302344773925865984-å½©è‰²äº‰å¤ºæˆ˜\t1296062239742105856-æŠ±å›¢å†²å†²å†²\t1281781308570207232-ç‹™å‡»ç²¾è‹±',\n  `teamnum` BIGINT COMMENT 'ç»„é˜Ÿäººæ•°',\n  `icnt` BIGINT COMMENT 'å¯¹å±€æ¬¡æ•°',\n  `itemp1` BIGINT COMMENT 'å¯¹å±€æ—¶é•¿',\n  `itemp2` BIGINT COMMENT 'itemp2',\n  `vtemp1` TEXT COMMENT 'vtemp1',\n  `vtemp2` TEXT COMMENT 'vtemp2'\n);\nCREATE TABLE `dwd_jordass_buttonpress_pre_di` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `dteventtime` TEXT,\n  `vgameappid` TEXT,\n  `platid` BIGINT COMMENT 'æ¸¸æˆAPPID',\n  `izoneareaid` BIGINT COMMENT 'ios 0/android 1',\n  `vplayerid` TEXT,\n  `uid` TEXT COMMENT 'è§’è‰²UID',\n  `buttontype` TEXT COMMENT 'æŒ‰é’®ä»£å·ä»¥åˆ†å·åˆ†éš”',\n  `param1` TEXT COMMENT 'é™„åŠ å‚æ•°1ä»¥åˆ†å·åˆ†éš”',\n  `param2` TEXT COMMENT 'é™„åŠ å‚æ•°2ä»¥åˆ†å·åˆ†éš”',\n  `param3` TEXT COMMENT 'é™„åŠ å‚æ•°3ä»¥åˆ†å·åˆ†éš”',\n  `param4` TEXT COMMENT 'é™„åŠ å‚æ•°4ä»¥åˆ†å·åˆ†éš”',\n  `param5` TEXT COMMENT 'é™„åŠ å‚æ•°5ä»¥åˆ†å·åˆ†éš”',\n  `param6` TEXT COMMENT 'é™„åŠ å‚æ•°6ä»¥åˆ†å·åˆ†éš”',\n  `unixtime` TEXT,\n  `ugcmarea` TEXT\n);\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸæ ¼å¼YYYYMMDD',\n  `vgameappid` TEXT COMMENT 'è´¦å·ä½“ç³»ï¼šwx:å¾®ä¿¡ï¼Œqqï¼šæ‰‹Q',\n  `platid` BIGINT COMMENT 'ç³»ç»Ÿå¹³å°ï¼š0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT 'ç©å®¶ID',\n  `mode` BIGINT COMMENT 'æ¨¡å¼ID',\n  `modename` TEXT COMMENT 'æ¨¡å¼åç§°',\n  `submode` BIGINT COMMENT 'å­æ¨¡å¼ID',\n  `submodename` TEXT COMMENT 'å­æ¨¡å¼åç§°',\n  `map` BIGINT COMMENT 'åœ°å›¾ID',\n  `mapname` TEXT COMMENT 'åœ°å›¾åç§°',\n  `seasonid` BIGINT COMMENT 'èµ›å­£ID',\n  `seasonname` TEXT COMMENT 'èµ›å­£åç§°',\n  `roundcnt` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ•°',\n  `roundtime` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ—¶é•¿(ç§’)',\n  `survivaltime` BIGINT COMMENT 'å½“æ—¥å­˜æ´»æ—¶é•¿(ç§’)',\n  `firstroundtime` TEXT COMMENT 'å½“æ—¥é¦–æ¬¡å¯¹å±€æ—¶é—´',\n  `device_type` BIGINT COMMENT 'è®¾å¤‡ç±»å‹'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nä¸»ç©å®šä¹‰ï¼šç”¨æˆ·ç´¯è®¡å¯¹å±€æ—¶é•¿æœ€å¤šçš„ç©æ³•ï¼›\nç©æ³•å– modename in ('ä¼ ç»Ÿæ¨¡å¼','ä¼‘é—²æ¨¡å¼','ç»„é˜Ÿç«æŠ€','é¢†åœ°','ä¹å›­','å¹¿é˜”å¤©åœ°','åˆ›æ„åˆ›ä½œé—´','ç”Ÿå­˜æ¨¡å¼')\nåä½œå¹³å°æ´»è·ƒï¼šugcmbuttonclickä¸­çš„ç©å®¶ï¼›\nåä½œç©æ³•æ´»è·ƒï¼švtemp1='åä½œ'  çš„ç©æ³•è®°å½•\n\n",
  "chosen": "WITH collab_platform_users AS (\n    -- Users active on collaboration platform\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_buttonpress_pre_di \n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n),\ncollab_gameplay_users AS (\n    -- Users active in collaboration gameplay\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_matchlog_stat_di \n    WHERE dtstatdate BETWEEN '20250217' AND '20250318' \n    AND vtemp1 = 'åä½œ'\n),\ntarget_users AS (\n    -- Users active on collaboration platform but not in collaboration gameplay\n    SELECT cpu.vplayerid\n    FROM collab_platform_users cpu\n    LEFT JOIN collab_gameplay_users cgu ON cpu.vplayerid = cgu.vplayerid\n    WHERE cgu.vplayerid IS NULL\n),\nuser_mode_time AS (\n    -- Calculate total play time per user per mode\n    SELECT \n        vplayerid, \n        modename, \n        SUM(roundtime) as total_time\n    FROM dws_jordass_mode_roundrecord_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n    AND modename IN ('ä¼ ç»Ÿæ¨¡å¼','ä¼‘é—²æ¨¡å¼','ç»„é˜Ÿç«æŠ€','é¢†åœ°','ä¹å›­','å¹¿é˜”å¤©åœ°','åˆ›æ„åˆ›ä½œé—´','ç”Ÿå­˜æ¨¡å¼')\n    GROUP BY vplayerid, modename\n),\nuser_main_mode AS (\n    -- Rank modes by time for each user and select the top one\n    SELECT \n        vplayerid,\n        modename,\n        ROW_NUMBER() OVER (PARTITION BY vplayerid ORDER BY total_time DESC) as rn\n    FROM user_mode_time\n)\n-- Count users by their main play mode\nSELECT \n    modename as ä¸»ç©ç©æ³•,\n    COUNT(*) as äººæ•°\nFROM user_main_mode umm\nJOIN target_users tu ON umm.vplayerid = tu.vplayerid\nWHERE rn = 1\nGROUP BY modename\nORDER BY äººæ•° DESC;",
  "rejected": "æˆ‘éœ€è¦é€æ­¥åˆ†æè¿™ä¸ªé—®é¢˜å¹¶æ„å»ºSQLæŸ¥è¯¢ã€‚\n\né¦–å…ˆè®©æˆ‘ç†è§£éœ€æ±‚ï¼š\n1. æ‰¾å‡ºåœ¨åä½œå¹³å°æ´»è·ƒä½†ä¸åœ¨åä½œç©æ³•æ´»è·ƒçš„ç”¨æˆ·\n2. ç»Ÿè®¡è¿™äº›ç”¨æˆ·çš„ä¸»ç©ç©æ³•åˆ†å¸ƒ\n3. ä¸»ç©å®šä¹‰æ˜¯ç´¯è®¡å¯¹å±€æ—¶é•¿æœ€å¤šçš„ç©æ³•\n4. ç©æ³•èŒƒå›´é™å®šä¸ºï¼šä¼ ç»Ÿæ¨¡å¼ã€ä¼‘é—²æ¨¡å¼ã€ç»„é˜Ÿç«æŠ€ã€é¢†åœ°ã€ä¹å›­ã€å¹¿é˜”å¤©åœ°ã€åˆ›æ„åˆ›ä½œé—´ã€ç”Ÿå­˜æ¨¡å¼\n\nè®©æˆ‘å…ˆåˆ†æå„ä¸ªè¡¨çš„ä½œç”¨ï¼š\n- dws_jordass_matchlog_stat_diï¼šåŒ…å«ç©å®¶å¯¹å±€æ•°æ®\n- dwd_jordass_buttonpress_pre_diï¼šåŒ…å«æŒ‰é’®ç‚¹å‡»æ•°æ®ï¼Œç”¨äºåˆ¤æ–­åä½œå¹³å°æ´»è·ƒç”¨æˆ·\n- dws_jordass_mode_roundrecord_diï¼šåŒ…å«æ¨¡å¼å’Œå¯¹å±€è®°å½•ï¼Œç”¨äºåˆ¤æ–­åä½œç©æ³•æ´»è·ƒç”¨æˆ·\n\nç°åœ¨å¼€å§‹æ„å»ºSQLï¼š\n\n```sql\nWITH active_users AS (\n    -- åä½œå¹³å°æ´»è·ƒç”¨æˆ·\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_buttonpress_pre_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n),\ncoop_active_users AS (\n    -- åä½œç©æ³•æ´»è·ƒç”¨æˆ·\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_matchlog_stat_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n      AND vtemp1 = 'åä½œ'\n),\nnon_coop_users AS (\n    -- åä½œå¹³å°æ´»è·ƒä½†ä¸æ˜¯åä½œç©æ³•æ´»è·ƒçš„ç”¨æˆ·\n    SELECT a.vplayerid\n    FROM active_users a\n    LEFT JOIN coop_active_users c ON a.vplayerid = c.vplayerid\n    WHERE c.vplayerid IS NULL\n),\nmain_modes AS (\n    -- è®¡ç®—æ¯ä¸ªç”¨æˆ·çš„ä¸»ç©ç©æ³•\n    SELECT \n        vplayerid,\n        modename,\n        SUM(roundtime) as total_time,\n        ROW_NUMBER() OVER (PARTITION BY vplayerid ORDER BY SUM(roundtime) DESC) as rn\n    FROM dws_jordass_mode_roundrecord_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n      AND vplayerid IN (SELECT vplayerid FROM non_coop_users)\n      AND modename IN ('ä¼ ç»Ÿæ¨¡å¼', 'ä¼‘é—²æ¨¡å¼', 'ç»„é˜Ÿç«æŠ€', 'é¢†åœ°', 'ä¹å›­', 'å¹¿é˜”å¤©åœ°', 'åˆ›æ„åˆ›ä½œé—´', 'ç”Ÿå­˜æ¨¡å¼')\n    GROUP BY vplayerid, modename\n)\nSELECT \n    modename as ä¸»ç©ç©æ³•,\n    COUNT(DISTINCT vplayerid) as äººæ•°\nFROM main_modes\nWHERE rn = 1\nGROUP BY modename\nORDER BY äººæ•° DESC;\n```"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡20250217-20250318åä½œå¹³å°æ´»è·ƒä½†æ˜¯æ²¡æœ‰åœ¨åä½œç©æ³•æ´»è·ƒç”¨æˆ·çš„ä¸»ç©ç©æ³•åˆ†å¸ƒ\nè¾“å‡ºï¼šä¸»ç©ç©æ³•ï¼ˆä¼ ç»Ÿæ¨¡å¼ã€ä¼‘é—²æ¨¡å¼ã€...ã€ç”Ÿå­˜æ¨¡å¼ï¼‰ã€äººæ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_jordass_matchlog_stat_di` (\n  `dtstatdate` TEXT COMMENT 'åˆ†åŒºï¼Œå‚ä¸ä¹å›­æ—¥æœŸï¼Œæ ¼å¼YYYYMMDD',\n  `vgameappid` TEXT COMMENT 'è´¦å·ä½“ç³»ï¼šwx:å¾®ä¿¡ï¼Œqqï¼šæ‰‹Q',\n  `platid` BIGINT COMMENT 'ç³»ç»Ÿå¹³å°ï¼š0:IOS,1:Android255:æ‰€æœ‰å¹³å°',\n  `vplayerid` TEXT COMMENT 'ç©å®¶ID',\n  `imode` BIGINT COMMENT 'ä¹å›­å­ç©æ³•ï¼š\t255-æ‰€æœ‰ç©æ³•ï¼Œç”¨æˆ·é—®é¢˜æœªæåˆ°æ˜ç¡®çš„å­ç©æ³•æ—¶ï¼Œé»˜è®¤ä¸ºæ‰€æœ‰ç©æ³•\t1282371711108385024-è·‘é…·ï¼šæˆç¥ä¹‹è·¯\t1281086178576044544-ä¼ åª’ç¾¤å²›\t1305619333337074432-ç‹‚çƒ­æ´¾å¯¹\t1251206313870885120-ç ºåˆƒè¿åŠ¨ä¼š5.0\t1313754433693158656-æ‰‹çƒç‰¹æ”»ï¼ˆåŸè¶³çƒæ¸¸æˆï¼‰\t1296730563346958080-ç›”ä»”æ³¡æ³¡å°é˜Ÿ\t1294279575841283072-å¤ºå®è¡ŒåŠ¨\t1310822585431254784-æ¡¥æ¢äº‰å¤º\t1278160113246405632-ç ºåˆƒå¤§äº¨\t1313047366167692288-é€†è½¬å¹³åº•é”…\t1298874468735655936-æˆ˜è½¦çªè¢­\t1278948391311645952-èƒ½é‡äº‰å¤ºæˆ˜\t1295942084687041792-è¶£å‘³é£ç›˜\t1282101477461985024-ç›”ä»”æ€»åŠ¨å‘˜\t1278144466094392064-é»‘äº”æ¨¡æ‹Ÿå™¨\t1313046652157690624-ç›”ä»”æ–—é­”ç‹ï¼ˆåŸç›”ä»”å¤§ä¹±æ–—ï¼‰\t1289446028099979264-ä½£å…µé˜µçº¿\t1309453077449826304-æ˜Ÿæ˜Ÿäº‰å¤ºæˆ˜ï¼ˆåŸåï¼šé‡‘å¸å¤§ä½œæˆ˜ï¼‰\t1298445174154728192-åœè½¦å¤§ä½œæˆ˜\t1294211358396518400-ç‰¹æŠ€å¤§ä¹±æ–—\t1280302176000803840-å§åº•è¡ŒåŠ¨\t1307095884553538304-\"è¶…çº§éšåŒ¿ï¼ˆåŸå¹¿é˜”å¤©åœ°éšåŒ¿æ¨¡å¼ï¼‰\"\t1297394991875754752-å®ˆå«ç”Ÿå‘½çº¿\t1278170390282112000-æ˜Ÿçƒå®ˆæŠ¤è€…\t1287652322611036928-æ‹¼å›¾ç‹‚æ¬¢\t1273928195100380928-ç‰¹ç§å…µè®­ç»ƒ\t1300845150154531840-æ˜Ÿä¹‹ç»§æ‰¿è€…\t1302344773925865984-å½©è‰²äº‰å¤ºæˆ˜\t1296062239742105856-æŠ±å›¢å†²å†²å†²\t1281781308570207232-ç‹™å‡»ç²¾è‹±',\n  `teamnum` BIGINT COMMENT 'ç»„é˜Ÿäººæ•°',\n  `icnt` BIGINT COMMENT 'å¯¹å±€æ¬¡æ•°',\n  `itemp1` BIGINT COMMENT 'å¯¹å±€æ—¶é•¿',\n  `itemp2` BIGINT COMMENT 'itemp2',\n  `vtemp1` TEXT COMMENT 'vtemp1',\n  `vtemp2` TEXT COMMENT 'vtemp2'\n);\nCREATE TABLE `dwd_jordass_buttonpress_pre_di` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `dteventtime` TEXT,\n  `vgameappid` TEXT,\n  `platid` BIGINT COMMENT 'æ¸¸æˆAPPID',\n  `izoneareaid` BIGINT COMMENT 'ios 0/android 1',\n  `vplayerid` TEXT,\n  `uid` TEXT COMMENT 'è§’è‰²UID',\n  `buttontype` TEXT COMMENT 'æŒ‰é’®ä»£å·ä»¥åˆ†å·åˆ†éš”',\n  `param1` TEXT COMMENT 'é™„åŠ å‚æ•°1ä»¥åˆ†å·åˆ†éš”',\n  `param2` TEXT COMMENT 'é™„åŠ å‚æ•°2ä»¥åˆ†å·åˆ†éš”',\n  `param3` TEXT COMMENT 'é™„åŠ å‚æ•°3ä»¥åˆ†å·åˆ†éš”',\n  `param4` TEXT COMMENT 'é™„åŠ å‚æ•°4ä»¥åˆ†å·åˆ†éš”',\n  `param5` TEXT COMMENT 'é™„åŠ å‚æ•°5ä»¥åˆ†å·åˆ†éš”',\n  `param6` TEXT COMMENT 'é™„åŠ å‚æ•°6ä»¥åˆ†å·åˆ†éš”',\n  `unixtime` TEXT,\n  `ugcmarea` TEXT\n);\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸæ ¼å¼YYYYMMDD',\n  `vgameappid` TEXT COMMENT 'è´¦å·ä½“ç³»ï¼šwx:å¾®ä¿¡ï¼Œqqï¼šæ‰‹Q',\n  `platid` BIGINT COMMENT 'ç³»ç»Ÿå¹³å°ï¼š0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT 'ç©å®¶ID',\n  `mode` BIGINT COMMENT 'æ¨¡å¼ID',\n  `modename` TEXT COMMENT 'æ¨¡å¼åç§°',\n  `submode` BIGINT COMMENT 'å­æ¨¡å¼ID',\n  `submodename` TEXT COMMENT 'å­æ¨¡å¼åç§°',\n  `map` BIGINT COMMENT 'åœ°å›¾ID',\n  `mapname` TEXT COMMENT 'åœ°å›¾åç§°',\n  `seasonid` BIGINT COMMENT 'èµ›å­£ID',\n  `seasonname` TEXT COMMENT 'èµ›å­£åç§°',\n  `roundcnt` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ•°',\n  `roundtime` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ—¶é•¿(ç§’)',\n  `survivaltime` BIGINT COMMENT 'å½“æ—¥å­˜æ´»æ—¶é•¿(ç§’)',\n  `firstroundtime` TEXT COMMENT 'å½“æ—¥é¦–æ¬¡å¯¹å±€æ—¶é—´',\n  `device_type` BIGINT COMMENT 'è®¾å¤‡ç±»å‹'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nä¸»ç©å®šä¹‰ï¼šç”¨æˆ·ç´¯è®¡å¯¹å±€æ—¶é•¿æœ€å¤šçš„ç©æ³•ï¼›\nç©æ³•å– modename in ('ä¼ ç»Ÿæ¨¡å¼','ä¼‘é—²æ¨¡å¼','ç»„é˜Ÿç«æŠ€','é¢†åœ°','ä¹å›­','å¹¿é˜”å¤©åœ°','åˆ›æ„åˆ›ä½œé—´','ç”Ÿå­˜æ¨¡å¼')\nåä½œå¹³å°æ´»è·ƒï¼šugcmbuttonclickä¸­çš„ç©å®¶ï¼›\nåä½œç©æ³•æ´»è·ƒï¼švtemp1='åä½œ'  çš„ç©æ³•è®°å½•\n\n",
  "chosen": "WITH collab_platform_users AS (\n    -- Users active on collaboration platform\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_buttonpress_pre_di \n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n),\ncollab_gameplay_users AS (\n    -- Users active in collaboration gameplay\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_matchlog_stat_di \n    WHERE dtstatdate BETWEEN '20250217' AND '20250318' \n    AND vtemp1 = 'åä½œ'\n),\ntarget_users AS (\n    -- Users active on collaboration platform but not in collaboration gameplay\n    SELECT cpu.vplayerid\n    FROM collab_platform_users cpu\n    LEFT JOIN collab_gameplay_users cgu ON cpu.vplayerid = cgu.vplayerid\n    WHERE cgu.vplayerid IS NULL\n),\nuser_mode_time AS (\n    -- Calculate total play time per user per mode\n    SELECT \n        vplayerid, \n        modename, \n        SUM(roundtime) as total_time\n    FROM dws_jordass_mode_roundrecord_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n    AND modename IN ('ä¼ ç»Ÿæ¨¡å¼','ä¼‘é—²æ¨¡å¼','ç»„é˜Ÿç«æŠ€','é¢†åœ°','ä¹å›­','å¹¿é˜”å¤©åœ°','åˆ›æ„åˆ›ä½œé—´','ç”Ÿå­˜æ¨¡å¼')\n    GROUP BY vplayerid, modename\n),\nuser_main_mode AS (\n    -- Rank modes by time for each user and select the top one\n    SELECT \n        vplayerid,\n        modename,\n        ROW_NUMBER() OVER (PARTITION BY vplayerid ORDER BY total_time DESC) as rn\n    FROM user_mode_time\n)\n-- Count users by their main play mode\nSELECT \n    modename as ä¸»ç©ç©æ³•,\n    COUNT(*) as äººæ•°\nFROM user_main_mode umm\nJOIN target_users tu ON umm.vplayerid = tu.vplayerid\nWHERE rn = 1\nGROUP BY modename\nORDER BY äººæ•° DESC;",
  "rejected": "æˆ‘ä»¬æ¥ä¸€æ­¥æ­¥åˆ†æè¿™ä¸ªå¤æ‚çš„SQLéœ€æ±‚ï¼Œå¹¶æ„é€ å‡ºæœ€ç»ˆçš„æŸ¥è¯¢è¯­å¥ã€‚\n\n---\n\n## ğŸ§  **ä¸€ã€ç†è§£é¢˜ç›®è¦æ±‚**\n\n### âœ… éœ€æ±‚ç›®æ ‡ï¼š\n> ç»Ÿè®¡**2025å¹´2æœˆ17æ—¥ - 2025å¹´3æœˆ18æ—¥ä¹‹é—´**ï¼Œåœ¨â€œåä½œå¹³å°â€ä¸Šæ´»è·ƒä½†**æ²¡æœ‰åœ¨â€œåä½œç©æ³•â€ä¸­æ´»è·ƒ**çš„ç”¨æˆ·ä¸­ï¼Œä»–ä»¬çš„**ä¸»ç©ç©æ³•åˆ†å¸ƒæƒ…å†µï¼ˆå³æ¯ä¸ªç©æ³•çš„äººæ•°ï¼‰**\n\n---\n\n## ğŸ” **äºŒã€å…³é”®æ¦‚å¿µè§£é‡Šä¸è¡¨ç»“æ„å…³è”**\n\n### 1. â€œåä½œå¹³å°æ´»è·ƒâ€çš„å®šä¹‰ï¼š\næ ¹æ®å‚è€ƒä¿¡æ¯ï¼š  \n> åä½œå¹³å°æ´»è·ƒ = `dwd_jordass_buttonpress_pre_di` è¡¨ä¸­æœ‰ç‚¹å‡»è®°å½•çš„ç©å®¶ï¼ˆå³å­˜åœ¨ `buttontype` æˆ–å…¶ä»–å­—æ®µï¼‰\n\næ‰€ä»¥æˆ‘ä»¬ä»è¿™å¼ è¡¨ç­›é€‰å‡ºæ´»è·ƒç”¨æˆ·ã€‚\n\n### 2. â€œåä½œç©æ³•æ´»è·ƒâ€çš„å®šä¹‰ï¼š\n> åä½œç©æ³•æ´»è·ƒ = `dws_jordass_matchlog_stat_di` ä¸­ `vtemp1='åä½œ'` çš„ç©æ³•è®°å½•\n\nå› æ­¤æˆ‘ä»¬éœ€è¦è¿‡æ»¤æ‰è¿™äº›ç©å®¶ã€‚\n\n### 3. â€œä¸»ç©ç©æ³•â€çš„å®šä¹‰ï¼š\n> ç”¨æˆ·ç´¯è®¡å¯¹å±€æ—¶é•¿æœ€å¤šçš„ç©æ³•ï¼ˆå³ `modename`ï¼‰  \n\næˆ‘ä»¬ä½¿ç”¨ `dws_jordass_mode_roundrecord_di` è¡¨æ¥è·å–ç©å®¶çš„ç©æ³•æ—¶é•¿å’Œç©æ³•åç§°ã€‚\n\n---\n\n## ğŸ“Š **ä¸‰ã€æ•°æ®æ¥æºä¸å¤„ç†é€»è¾‘æ¢³ç†**\n\n### æ­¥éª¤ä¸€ï¼šæ‰¾å‡ºâ€œåä½œå¹³å°æ´»è·ƒâ€ç”¨æˆ·ï¼ˆæ¥è‡ª `dwd_jordass_buttonpress_pre_di`ï¼‰\n```sql\nSELECT DISTINCT vplayerid\nFROM dwd_jordass_buttonpress_pre_di\nWHERE dtstatdate BETWEEN '20250217' AND '20250318'\n```\n\n### æ­¥éª¤äºŒï¼šæ‰¾å‡ºâ€œåä½œç©æ³•æ´»è·ƒâ€ç”¨æˆ·ï¼ˆæ¥è‡ª `dws_jordass_matchlog_stat_di`ï¼‰\n```sql\nSELECT DISTINCT vplayerid\nFROM dws_jordass_matchlog_stat_di\nWHERE dtstatdate BETWEEN '20250217' AND '20250318'\nAND vtemp1 = 'åä½œ'\n```\n\n### æ­¥éª¤ä¸‰ï¼šç­›é€‰å‡ºâ€œå¹³å°æ´»è·ƒä½†ä¸æ˜¯åä½œç©æ³•æ´»è·ƒâ€çš„ç”¨æˆ·\n```sql\nSELECT vplayerid\nFROM dwd_jordass_buttonpress_pre_di\nWHERE dtstatdate BETWEEN '20250217' AND '20250318'\nEXCEPT\nSELECT vplayerid\nFROM dws_jordass_matchlog_stat_di\nWHERE dtstatdate BETWEEN '20250217' AND '20250318'\nAND vtemp1 = 'åä½œ'\n```\n\n> æ³¨æ„ï¼šMySQL ä¸æ”¯æŒ EXCEPTï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å†™ä¸º LEFT JOIN + IS NULL æˆ–ä½¿ç”¨ NOT EXISTS å­æŸ¥è¯¢ã€‚\n\n### æ­¥éª¤å››ï¼šæ‰¾å‡ºè¿™äº›ç”¨æˆ·çš„ä¸»ç©ç©æ³•ï¼ˆå³å¯¹å±€æ—¶é•¿æœ€é•¿çš„é‚£ä¸ªç©æ³•ï¼‰\n\næˆ‘ä»¬è¦ä» `dws_jordass_mode_roundrecord_di` ä¸­è·å–æ¯ä¸ªç”¨æˆ·çš„ç©æ³•ä¿¡æ¯ï¼Œå¹¶æŒ‰ç©æ³•åç§°åˆ†ç»„ï¼Œè®¡ç®—æ€»æ—¶é•¿ï¼Œç„¶åé€‰å‡ºæœ€å¤§å€¼ä½œä¸ºä¸»ç©ã€‚\n\n#### ç­›é€‰ç©æ³•èŒƒå›´ï¼š\n```sql\nmodename IN ('ä¼ ç»Ÿæ¨¡å¼', 'ä¼‘é—²æ¨¡å¼', 'ç»„é˜Ÿç«æŠ€', 'é¢†åœ°', 'ä¹å›­', 'å¹¿é˜”å¤©åœ°', 'åˆ›æ„åˆ›ä½œé—´', 'ç”Ÿå­˜æ¨¡å¼')\n```\n\n---\n\n## ğŸ§± **å››ã€æ„å»ºæœ€ç»ˆ SQL æŸ¥è¯¢**\n\næˆ‘ä»¬å°†ä»¥ä¸Šæ­¥éª¤æ•´åˆä¸ºä¸€ä¸ªå®Œæ•´çš„ SQL æŸ¥è¯¢ï¼š\n\n```sql\nWITH active_users AS (\n    -- å¹³å°æ´»è·ƒç”¨æˆ·ï¼ˆæ’é™¤åä½œç©æ³•æ´»è·ƒç”¨æˆ·ï¼‰\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_buttonpress_pre_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n    AND vplayerid NOT IN (\n        SELECT DISTINCT vplayerid\n        FROM dws_jordass_matchlog_stat_di\n        WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n        AND vtemp1 = 'åä½œ'\n    )\n),\nmain_modes AS (\n    -- æ¯ä¸ªç”¨æˆ·çš„ä¸»ç©ç©æ³•ï¼ˆæŒ‰ç´¯è®¡æ—¶é•¿æ’åºï¼‰\n    SELECT\n        vplayerid,\n        modename,\n        SUM(roundtime) AS total_time\n    FROM dws_jordass_mode_roundrecord_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n      AND modename IN ('ä¼ ç»Ÿæ¨¡å¼', 'ä¼‘é—²æ¨¡å¼', 'ç»„é˜Ÿç«æŠ€', 'é¢†åœ°', 'ä¹å›­', 'å¹¿é˜”å¤©åœ°', 'åˆ›æ„åˆ›ä½œé—´', 'ç”Ÿå­˜æ¨¡å¼')\n    GROUP BY vplayerid, modename\n),\nranked_modes AS (\n    -- å¯¹æ¯ä¸ªç”¨æˆ·æŒ‰æ€»æ—¶é•¿æ’å\n    SELECT\n        vplayerid,\n        modename,\n        ROW_NUMBER() OVER (PARTITION BY vplayerid ORDER BY total_time DESC) AS rn\n    FROM main_modes\n)\n-- æœ€ç»ˆè¾“å‡ºï¼šä¸»ç©ç©æ³• + äººæ•°\nSELECT\n    rm.modename AS ä¸»ç©ç©æ³•,\n    COUNT(rm.vplayerid) AS äººæ•°\nFROM ranked_modes rm\nJOIN active_users au ON rm.vplayerid = au.vplayerid\nWHERE rm.rn = 1\nGROUP BY rm.modename;\n```\n\n---\n\n## ğŸ§¾ **äº”ã€è¯´æ˜æ€»ç»“**\n\n| æ­¥éª¤ | åŠŸèƒ½ |\n|------|------|\n| `active_users` | è·å–å¹³å°æ´»è·ƒä¸”éåä½œç©æ³•æ´»è·ƒçš„ç”¨æˆ· |\n| `main_modes` | è®¡ç®—æ¯ä¸ªç”¨æˆ·åœ¨å„ç©æ³•ä¸‹çš„ç´¯è®¡å¯¹å±€æ—¶é•¿ |\n| `ranked_modes` | ä¸ºæ¯ä½ç”¨æˆ·æŒ‰æ—¶é•¿æ’åºï¼Œé€‰å‡ºä¸»ç©ç©æ³• |\n| æœ€ç»ˆ SELECT | è¾“å‡ºä¸»ç©ç©æ³•åŠå…¶å¯¹åº”äººæ•° |\n\n---\n\nå¦‚éœ€è¿›ä¸€æ­¥ä¼˜åŒ–æ€§èƒ½æˆ–è°ƒæ•´ç©æ³•åˆ—è¡¨ï¼Œè¯·å‘ŠçŸ¥ï¼"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡20250217-20250318åä½œå¹³å°æ´»è·ƒä½†æ˜¯æ²¡æœ‰åœ¨åä½œç©æ³•æ´»è·ƒç”¨æˆ·çš„ä¸»ç©ç©æ³•åˆ†å¸ƒ\nè¾“å‡ºï¼šä¸»ç©ç©æ³•ï¼ˆä¼ ç»Ÿæ¨¡å¼ã€ä¼‘é—²æ¨¡å¼ã€...ã€ç”Ÿå­˜æ¨¡å¼ï¼‰ã€äººæ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_jordass_matchlog_stat_di` (\n  `dtstatdate` TEXT COMMENT 'åˆ†åŒºï¼Œå‚ä¸ä¹å›­æ—¥æœŸï¼Œæ ¼å¼YYYYMMDD',\n  `vgameappid` TEXT COMMENT 'è´¦å·ä½“ç³»ï¼šwx:å¾®ä¿¡ï¼Œqqï¼šæ‰‹Q',\n  `platid` BIGINT COMMENT 'ç³»ç»Ÿå¹³å°ï¼š0:IOS,1:Android255:æ‰€æœ‰å¹³å°',\n  `vplayerid` TEXT COMMENT 'ç©å®¶ID',\n  `imode` BIGINT COMMENT 'ä¹å›­å­ç©æ³•ï¼š\t255-æ‰€æœ‰ç©æ³•ï¼Œç”¨æˆ·é—®é¢˜æœªæåˆ°æ˜ç¡®çš„å­ç©æ³•æ—¶ï¼Œé»˜è®¤ä¸ºæ‰€æœ‰ç©æ³•\t1282371711108385024-è·‘é…·ï¼šæˆç¥ä¹‹è·¯\t1281086178576044544-ä¼ åª’ç¾¤å²›\t1305619333337074432-ç‹‚çƒ­æ´¾å¯¹\t1251206313870885120-ç ºåˆƒè¿åŠ¨ä¼š5.0\t1313754433693158656-æ‰‹çƒç‰¹æ”»ï¼ˆåŸè¶³çƒæ¸¸æˆï¼‰\t1296730563346958080-ç›”ä»”æ³¡æ³¡å°é˜Ÿ\t1294279575841283072-å¤ºå®è¡ŒåŠ¨\t1310822585431254784-æ¡¥æ¢äº‰å¤º\t1278160113246405632-ç ºåˆƒå¤§äº¨\t1313047366167692288-é€†è½¬å¹³åº•é”…\t1298874468735655936-æˆ˜è½¦çªè¢­\t1278948391311645952-èƒ½é‡äº‰å¤ºæˆ˜\t1295942084687041792-è¶£å‘³é£ç›˜\t1282101477461985024-ç›”ä»”æ€»åŠ¨å‘˜\t1278144466094392064-é»‘äº”æ¨¡æ‹Ÿå™¨\t1313046652157690624-ç›”ä»”æ–—é­”ç‹ï¼ˆåŸç›”ä»”å¤§ä¹±æ–—ï¼‰\t1289446028099979264-ä½£å…µé˜µçº¿\t1309453077449826304-æ˜Ÿæ˜Ÿäº‰å¤ºæˆ˜ï¼ˆåŸåï¼šé‡‘å¸å¤§ä½œæˆ˜ï¼‰\t1298445174154728192-åœè½¦å¤§ä½œæˆ˜\t1294211358396518400-ç‰¹æŠ€å¤§ä¹±æ–—\t1280302176000803840-å§åº•è¡ŒåŠ¨\t1307095884553538304-\"è¶…çº§éšåŒ¿ï¼ˆåŸå¹¿é˜”å¤©åœ°éšåŒ¿æ¨¡å¼ï¼‰\"\t1297394991875754752-å®ˆå«ç”Ÿå‘½çº¿\t1278170390282112000-æ˜Ÿçƒå®ˆæŠ¤è€…\t1287652322611036928-æ‹¼å›¾ç‹‚æ¬¢\t1273928195100380928-ç‰¹ç§å…µè®­ç»ƒ\t1300845150154531840-æ˜Ÿä¹‹ç»§æ‰¿è€…\t1302344773925865984-å½©è‰²äº‰å¤ºæˆ˜\t1296062239742105856-æŠ±å›¢å†²å†²å†²\t1281781308570207232-ç‹™å‡»ç²¾è‹±',\n  `teamnum` BIGINT COMMENT 'ç»„é˜Ÿäººæ•°',\n  `icnt` BIGINT COMMENT 'å¯¹å±€æ¬¡æ•°',\n  `itemp1` BIGINT COMMENT 'å¯¹å±€æ—¶é•¿',\n  `itemp2` BIGINT COMMENT 'itemp2',\n  `vtemp1` TEXT COMMENT 'vtemp1',\n  `vtemp2` TEXT COMMENT 'vtemp2'\n);\nCREATE TABLE `dwd_jordass_buttonpress_pre_di` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `dteventtime` TEXT,\n  `vgameappid` TEXT,\n  `platid` BIGINT COMMENT 'æ¸¸æˆAPPID',\n  `izoneareaid` BIGINT COMMENT 'ios 0/android 1',\n  `vplayerid` TEXT,\n  `uid` TEXT COMMENT 'è§’è‰²UID',\n  `buttontype` TEXT COMMENT 'æŒ‰é’®ä»£å·ä»¥åˆ†å·åˆ†éš”',\n  `param1` TEXT COMMENT 'é™„åŠ å‚æ•°1ä»¥åˆ†å·åˆ†éš”',\n  `param2` TEXT COMMENT 'é™„åŠ å‚æ•°2ä»¥åˆ†å·åˆ†éš”',\n  `param3` TEXT COMMENT 'é™„åŠ å‚æ•°3ä»¥åˆ†å·åˆ†éš”',\n  `param4` TEXT COMMENT 'é™„åŠ å‚æ•°4ä»¥åˆ†å·åˆ†éš”',\n  `param5` TEXT COMMENT 'é™„åŠ å‚æ•°5ä»¥åˆ†å·åˆ†éš”',\n  `param6` TEXT COMMENT 'é™„åŠ å‚æ•°6ä»¥åˆ†å·åˆ†éš”',\n  `unixtime` TEXT,\n  `ugcmarea` TEXT\n);\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸæ ¼å¼YYYYMMDD',\n  `vgameappid` TEXT COMMENT 'è´¦å·ä½“ç³»ï¼šwx:å¾®ä¿¡ï¼Œqqï¼šæ‰‹Q',\n  `platid` BIGINT COMMENT 'ç³»ç»Ÿå¹³å°ï¼š0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT 'ç©å®¶ID',\n  `mode` BIGINT COMMENT 'æ¨¡å¼ID',\n  `modename` TEXT COMMENT 'æ¨¡å¼åç§°',\n  `submode` BIGINT COMMENT 'å­æ¨¡å¼ID',\n  `submodename` TEXT COMMENT 'å­æ¨¡å¼åç§°',\n  `map` BIGINT COMMENT 'åœ°å›¾ID',\n  `mapname` TEXT COMMENT 'åœ°å›¾åç§°',\n  `seasonid` BIGINT COMMENT 'èµ›å­£ID',\n  `seasonname` TEXT COMMENT 'èµ›å­£åç§°',\n  `roundcnt` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ•°',\n  `roundtime` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ—¶é•¿(ç§’)',\n  `survivaltime` BIGINT COMMENT 'å½“æ—¥å­˜æ´»æ—¶é•¿(ç§’)',\n  `firstroundtime` TEXT COMMENT 'å½“æ—¥é¦–æ¬¡å¯¹å±€æ—¶é—´',\n  `device_type` BIGINT COMMENT 'è®¾å¤‡ç±»å‹'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nä¸»ç©å®šä¹‰ï¼šç”¨æˆ·ç´¯è®¡å¯¹å±€æ—¶é•¿æœ€å¤šçš„ç©æ³•ï¼›\nç©æ³•å– modename in ('ä¼ ç»Ÿæ¨¡å¼','ä¼‘é—²æ¨¡å¼','ç»„é˜Ÿç«æŠ€','é¢†åœ°','ä¹å›­','å¹¿é˜”å¤©åœ°','åˆ›æ„åˆ›ä½œé—´','ç”Ÿå­˜æ¨¡å¼')\nåä½œå¹³å°æ´»è·ƒï¼šugcmbuttonclickä¸­çš„ç©å®¶ï¼›\nåä½œç©æ³•æ´»è·ƒï¼švtemp1='åä½œ'  çš„ç©æ³•è®°å½•\n\n",
  "chosen": "WITH collab_platform_users AS (\n    -- Users active on collaboration platform\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_buttonpress_pre_di \n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n),\ncollab_gameplay_users AS (\n    -- Users active in collaboration gameplay\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_matchlog_stat_di \n    WHERE dtstatdate BETWEEN '20250217' AND '20250318' \n    AND vtemp1 = 'åä½œ'\n),\ntarget_users AS (\n    -- Users active on collaboration platform but not in collaboration gameplay\n    SELECT cpu.vplayerid\n    FROM collab_platform_users cpu\n    LEFT JOIN collab_gameplay_users cgu ON cpu.vplayerid = cgu.vplayerid\n    WHERE cgu.vplayerid IS NULL\n),\nuser_mode_time AS (\n    -- Calculate total play time per user per mode\n    SELECT \n        vplayerid, \n        modename, \n        SUM(roundtime) as total_time\n    FROM dws_jordass_mode_roundrecord_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n    AND modename IN ('ä¼ ç»Ÿæ¨¡å¼','ä¼‘é—²æ¨¡å¼','ç»„é˜Ÿç«æŠ€','é¢†åœ°','ä¹å›­','å¹¿é˜”å¤©åœ°','åˆ›æ„åˆ›ä½œé—´','ç”Ÿå­˜æ¨¡å¼')\n    GROUP BY vplayerid, modename\n),\nuser_main_mode AS (\n    -- Rank modes by time for each user and select the top one\n    SELECT \n        vplayerid,\n        modename,\n        ROW_NUMBER() OVER (PARTITION BY vplayerid ORDER BY total_time DESC) as rn\n    FROM user_mode_time\n)\n-- Count users by their main play mode\nSELECT \n    modename as ä¸»ç©ç©æ³•,\n    COUNT(*) as äººæ•°\nFROM user_main_mode umm\nJOIN target_users tu ON umm.vplayerid = tu.vplayerid\nWHERE rn = 1\nGROUP BY modename\nORDER BY äººæ•° DESC;",
  "rejected": "æˆ‘ä»¬æ¥ä¸€æ­¥æ­¥åˆ†æè¿™ä¸ªé—®é¢˜ï¼Œå¹¶ç¼–å†™å‡ºæ­£ç¡®çš„ SQL æŸ¥è¯¢è¯­å¥ã€‚\n\n---\n\n## ğŸ” **ç¬¬ä¸€æ­¥ï¼šç†è§£éœ€æ±‚**\n\næˆ‘ä»¬è¦ç»Ÿè®¡çš„æ˜¯ï¼š\n\n> åœ¨æŸä¸ªæ—¶é—´æ®µå†…ï¼ˆ2025å¹´2æœˆ17æ—¥ åˆ° 2025å¹´3æœˆ18æ—¥ï¼‰ï¼Œ  \n> åœ¨â€œåä½œå¹³å°â€ä¸Šæ´»è·ƒçš„ç”¨æˆ·ä¸­ï¼Œ  \n> ä½†**æ²¡æœ‰åœ¨â€œåä½œç©æ³•â€ä¸­æ´»è·ƒçš„ç”¨æˆ·**ï¼Œ  \n> è¿™äº›äººçš„â€œä¸»ç©ç©æ³•â€çš„åˆ†å¸ƒæƒ…å†µã€‚\n\n### âœ… è¾“å‡ºå­—æ®µï¼š\n- ä¸»ç©ç©æ³•ï¼ˆmodenameï¼‰\n- äººæ•°\n\n---\n\n## ğŸ§  **ç¬¬äºŒæ­¥ï¼šç¡®å®šæ¶‰åŠè¡¨å’Œå…³é”®å­—æ®µ**\n\n### 1. åä½œå¹³å°æ´»è·ƒç”¨æˆ·ï¼ˆæ¥è‡ª `dwd_jordass_buttonpress_pre_di`ï¼‰\n\n```sql\nSELECT DISTINCT vplayerid\nFROM dwd_jordass_buttonpress_pre_di\nWHERE dtstatdate BETWEEN '20250217' AND '20250318'\n```\n\n> è¿™æ˜¯åä½œå¹³å°æ´»è·ƒçš„ç”¨æˆ·åˆ—è¡¨ã€‚\n\n---\n\n### 2. åä½œç©æ³•æ´»è·ƒç”¨æˆ·ï¼ˆæ¥è‡ª `dws_jordass_matchlog_stat_di`ï¼‰\n\n```sql\nSELECT DISTINCT vplayerid\nFROM dws_jordass_matchlog_stat_di\nWHERE dtstatdate BETWEEN '20250217' AND '20250318'\nAND vtemp1 = 'åä½œ'\n```\n\n> è¿™æ˜¯åä½œç©æ³•æ´»è·ƒçš„ç”¨æˆ·åˆ—è¡¨ã€‚\n\n---\n\n### 3. ç”¨æˆ·çš„ä¸»ç©ç©æ³•ï¼ˆæ¥è‡ª `dws_jordass_mode_roundrecord_di`ï¼‰\n\næˆ‘ä»¬éœ€è¦æ‰¾å‡ºæ¯ä¸ªç”¨æˆ·åœ¨è¯¥æ—¶é—´æ®µå†…çš„**ç´¯è®¡å¯¹å±€æ—¶é•¿æœ€é•¿çš„ç©æ³•**ï¼ˆå³ä¸»ç©ç©æ³•ï¼‰ã€‚\n\n#### ğŸ‘‡ ä» `dws_jordass_mode_roundrecord_di` ä¸­æå–ï¼š\n\n```sql\nSELECT\n    vplayerid,\n    modename,\n    SUM(roundtime) AS total_time\nFROM dws_jordass_mode_roundrecord_di\nWHERE dtstatdate BETWEEN '20250217' AND '20250318'\nGROUP BY vplayerid, modename\nORDER BY vplayerid, total_time DESC\n```\n\nç„¶åå¯¹æ¯ä¸ª vplayerid å–ç¬¬ä¸€æ¡ï¼ˆå³ä¸»ç©ç©æ³•ï¼‰\n\n---\n\n## ğŸ› ï¸ **ç¬¬ä¸‰æ­¥ï¼šæ•´åˆé€»è¾‘**\n\næˆ‘ä»¬å…ˆè·å–åä½œå¹³å°æ´»è·ƒç”¨æˆ·ï¼ˆAï¼‰ï¼Œå†æ’é™¤æ‰åä½œç©æ³•æ´»è·ƒç”¨æˆ·ï¼ˆBï¼‰ï¼Œç„¶åä»å‰©ä¸‹çš„ç”¨æˆ·ä¸­é€‰å‡ºä»–ä»¬çš„ä¸»ç©ç©æ³•ã€‚\n\n---\n\n## ğŸ“Œ **æœ€ç»ˆ SQL æŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š**\n\n```sql\nWITH active_users_in_coop_platform AS (\n    -- åä½œå¹³å°æ´»è·ƒç”¨æˆ·\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_buttonpress_pre_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n),\nactive_users_in_coop_mode AS (\n    -- åä½œç©æ³•æ´»è·ƒç”¨æˆ·\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_matchlog_stat_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n    AND vtemp1 = 'åä½œ'\n),\nmain_modes AS (\n    -- æ¯ä¸ªç”¨æˆ·çš„ä¸»ç©ç©æ³•ï¼ˆæŒ‰ç´¯è®¡å¯¹å±€æ—¶é•¿æ’åºï¼‰\n    SELECT\n        vplayerid,\n        modename,\n        SUM(roundtime) AS total_time\n    FROM dws_jordass_mode_roundrecord_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n      AND modename IN ('ä¼ ç»Ÿæ¨¡å¼', 'ä¼‘é—²æ¨¡å¼', 'ç»„é˜Ÿç«æŠ€', 'é¢†åœ°', 'ä¹å›­', 'å¹¿é˜”å¤©åœ°', 'åˆ›æ„åˆ›ä½œé—´', 'ç”Ÿå­˜æ¨¡å¼')\n    GROUP BY vplayerid, modename\n),\nranked_modes AS (\n    -- æ¯ä¸ªç”¨æˆ·åªä¿ç•™ä¸»ç©ç©æ³•ï¼ˆå³ roundtime æœ€å¤§çš„ï¼‰\n    SELECT\n        vplayerid,\n        modename,\n        ROW_NUMBER() OVER (PARTITION BY vplayerid ORDER BY total_time DESC) AS rn\n    FROM main_modes\n)\n-- æœ€ç»ˆç»“æœï¼šç­›é€‰å‡ºåä½œå¹³å°æ´»è·ƒä½†ä¸æ˜¯åä½œç©æ³•æ´»è·ƒçš„ç”¨æˆ·ï¼Œå†æŸ¥å…¶ä¸»ç©ç©æ³•\nSELECT\n    rm.modename AS ä¸»ç©ç©æ³•,\n    COUNT(DISTINCT rm.vplayerid) AS äººæ•°\nFROM ranked_modes rm\nJOIN active_users_in_coop_platform a ON rm.vplayerid = a.vplayerid\nLEFT JOIN active_users_in_coop_mode b ON rm.vplayerid = b.vplayerid\nWHERE b.vplayerid IS NULL\nGROUP BY rm.modename;\n```\n\n---\n\n## ğŸ§¾ **è¯´æ˜æ€»ç»“**\n\n| æ­¥éª¤ | å†…å®¹ |\n|------|------|\n| ç¬¬ä¸€æ­¥ | ç­›é€‰åä½œå¹³å°æ´»è·ƒç”¨æˆ· |\n| ç¬¬äºŒæ­¥ | ç­›é€‰åä½œç©æ³•æ´»è·ƒç”¨æˆ· |\n| ç¬¬ä¸‰æ­¥ | è®¡ç®—æ¯ä¸ªç”¨æˆ·ä¸»ç©ç©æ³•ï¼ˆæŒ‰ç´¯è®¡å¯¹å±€æ—¶é•¿ï¼‰ |\n| ç¬¬å››æ­¥ | æ’é™¤åä½œç©æ³•æ´»è·ƒç”¨æˆ·åï¼Œç»Ÿè®¡å‰©ä½™ç”¨æˆ·çš„ä¸»ç©ç©æ³•åˆ†å¸ƒ |\n\n---\n\nå¦‚éœ€æ‰©å±•æˆ–ä¼˜åŒ–ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡20250217-20250318åä½œå¹³å°æ´»è·ƒä½†æ˜¯æ²¡æœ‰åœ¨åä½œç©æ³•æ´»è·ƒç”¨æˆ·çš„ä¸»ç©ç©æ³•åˆ†å¸ƒ\nè¾“å‡ºï¼šä¸»ç©ç©æ³•ï¼ˆä¼ ç»Ÿæ¨¡å¼ã€ä¼‘é—²æ¨¡å¼ã€...ã€ç”Ÿå­˜æ¨¡å¼ï¼‰ã€äººæ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_jordass_matchlog_stat_di` (\n  `dtstatdate` TEXT COMMENT 'åˆ†åŒºï¼Œå‚ä¸ä¹å›­æ—¥æœŸï¼Œæ ¼å¼YYYYMMDD',\n  `vgameappid` TEXT COMMENT 'è´¦å·ä½“ç³»ï¼šwx:å¾®ä¿¡ï¼Œqqï¼šæ‰‹Q',\n  `platid` BIGINT COMMENT 'ç³»ç»Ÿå¹³å°ï¼š0:IOS,1:Android255:æ‰€æœ‰å¹³å°',\n  `vplayerid` TEXT COMMENT 'ç©å®¶ID',\n  `imode` BIGINT COMMENT 'ä¹å›­å­ç©æ³•ï¼š\t255-æ‰€æœ‰ç©æ³•ï¼Œç”¨æˆ·é—®é¢˜æœªæåˆ°æ˜ç¡®çš„å­ç©æ³•æ—¶ï¼Œé»˜è®¤ä¸ºæ‰€æœ‰ç©æ³•\t1282371711108385024-è·‘é…·ï¼šæˆç¥ä¹‹è·¯\t1281086178576044544-ä¼ åª’ç¾¤å²›\t1305619333337074432-ç‹‚çƒ­æ´¾å¯¹\t1251206313870885120-ç ºåˆƒè¿åŠ¨ä¼š5.0\t1313754433693158656-æ‰‹çƒç‰¹æ”»ï¼ˆåŸè¶³çƒæ¸¸æˆï¼‰\t1296730563346958080-ç›”ä»”æ³¡æ³¡å°é˜Ÿ\t1294279575841283072-å¤ºå®è¡ŒåŠ¨\t1310822585431254784-æ¡¥æ¢äº‰å¤º\t1278160113246405632-ç ºåˆƒå¤§äº¨\t1313047366167692288-é€†è½¬å¹³åº•é”…\t1298874468735655936-æˆ˜è½¦çªè¢­\t1278948391311645952-èƒ½é‡äº‰å¤ºæˆ˜\t1295942084687041792-è¶£å‘³é£ç›˜\t1282101477461985024-ç›”ä»”æ€»åŠ¨å‘˜\t1278144466094392064-é»‘äº”æ¨¡æ‹Ÿå™¨\t1313046652157690624-ç›”ä»”æ–—é­”ç‹ï¼ˆåŸç›”ä»”å¤§ä¹±æ–—ï¼‰\t1289446028099979264-ä½£å…µé˜µçº¿\t1309453077449826304-æ˜Ÿæ˜Ÿäº‰å¤ºæˆ˜ï¼ˆåŸåï¼šé‡‘å¸å¤§ä½œæˆ˜ï¼‰\t1298445174154728192-åœè½¦å¤§ä½œæˆ˜\t1294211358396518400-ç‰¹æŠ€å¤§ä¹±æ–—\t1280302176000803840-å§åº•è¡ŒåŠ¨\t1307095884553538304-\"è¶…çº§éšåŒ¿ï¼ˆåŸå¹¿é˜”å¤©åœ°éšåŒ¿æ¨¡å¼ï¼‰\"\t1297394991875754752-å®ˆå«ç”Ÿå‘½çº¿\t1278170390282112000-æ˜Ÿçƒå®ˆæŠ¤è€…\t1287652322611036928-æ‹¼å›¾ç‹‚æ¬¢\t1273928195100380928-ç‰¹ç§å…µè®­ç»ƒ\t1300845150154531840-æ˜Ÿä¹‹ç»§æ‰¿è€…\t1302344773925865984-å½©è‰²äº‰å¤ºæˆ˜\t1296062239742105856-æŠ±å›¢å†²å†²å†²\t1281781308570207232-ç‹™å‡»ç²¾è‹±',\n  `teamnum` BIGINT COMMENT 'ç»„é˜Ÿäººæ•°',\n  `icnt` BIGINT COMMENT 'å¯¹å±€æ¬¡æ•°',\n  `itemp1` BIGINT COMMENT 'å¯¹å±€æ—¶é•¿',\n  `itemp2` BIGINT COMMENT 'itemp2',\n  `vtemp1` TEXT COMMENT 'vtemp1',\n  `vtemp2` TEXT COMMENT 'vtemp2'\n);\nCREATE TABLE `dwd_jordass_buttonpress_pre_di` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `dteventtime` TEXT,\n  `vgameappid` TEXT,\n  `platid` BIGINT COMMENT 'æ¸¸æˆAPPID',\n  `izoneareaid` BIGINT COMMENT 'ios 0/android 1',\n  `vplayerid` TEXT,\n  `uid` TEXT COMMENT 'è§’è‰²UID',\n  `buttontype` TEXT COMMENT 'æŒ‰é’®ä»£å·ä»¥åˆ†å·åˆ†éš”',\n  `param1` TEXT COMMENT 'é™„åŠ å‚æ•°1ä»¥åˆ†å·åˆ†éš”',\n  `param2` TEXT COMMENT 'é™„åŠ å‚æ•°2ä»¥åˆ†å·åˆ†éš”',\n  `param3` TEXT COMMENT 'é™„åŠ å‚æ•°3ä»¥åˆ†å·åˆ†éš”',\n  `param4` TEXT COMMENT 'é™„åŠ å‚æ•°4ä»¥åˆ†å·åˆ†éš”',\n  `param5` TEXT COMMENT 'é™„åŠ å‚æ•°5ä»¥åˆ†å·åˆ†éš”',\n  `param6` TEXT COMMENT 'é™„åŠ å‚æ•°6ä»¥åˆ†å·åˆ†éš”',\n  `unixtime` TEXT,\n  `ugcmarea` TEXT\n);\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸæ ¼å¼YYYYMMDD',\n  `vgameappid` TEXT COMMENT 'è´¦å·ä½“ç³»ï¼šwx:å¾®ä¿¡ï¼Œqqï¼šæ‰‹Q',\n  `platid` BIGINT COMMENT 'ç³»ç»Ÿå¹³å°ï¼š0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT 'ç©å®¶ID',\n  `mode` BIGINT COMMENT 'æ¨¡å¼ID',\n  `modename` TEXT COMMENT 'æ¨¡å¼åç§°',\n  `submode` BIGINT COMMENT 'å­æ¨¡å¼ID',\n  `submodename` TEXT COMMENT 'å­æ¨¡å¼åç§°',\n  `map` BIGINT COMMENT 'åœ°å›¾ID',\n  `mapname` TEXT COMMENT 'åœ°å›¾åç§°',\n  `seasonid` BIGINT COMMENT 'èµ›å­£ID',\n  `seasonname` TEXT COMMENT 'èµ›å­£åç§°',\n  `roundcnt` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ•°',\n  `roundtime` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ—¶é•¿(ç§’)',\n  `survivaltime` BIGINT COMMENT 'å½“æ—¥å­˜æ´»æ—¶é•¿(ç§’)',\n  `firstroundtime` TEXT COMMENT 'å½“æ—¥é¦–æ¬¡å¯¹å±€æ—¶é—´',\n  `device_type` BIGINT COMMENT 'è®¾å¤‡ç±»å‹'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nä¸»ç©å®šä¹‰ï¼šç”¨æˆ·ç´¯è®¡å¯¹å±€æ—¶é•¿æœ€å¤šçš„ç©æ³•ï¼›\nç©æ³•å– modename in ('ä¼ ç»Ÿæ¨¡å¼','ä¼‘é—²æ¨¡å¼','ç»„é˜Ÿç«æŠ€','é¢†åœ°','ä¹å›­','å¹¿é˜”å¤©åœ°','åˆ›æ„åˆ›ä½œé—´','ç”Ÿå­˜æ¨¡å¼')\nåä½œå¹³å°æ´»è·ƒï¼šugcmbuttonclickä¸­çš„ç©å®¶ï¼›\nåä½œç©æ³•æ´»è·ƒï¼švtemp1='åä½œ'  çš„ç©æ³•è®°å½•\n\n",
  "chosen": "WITH collab_platform_users AS (\n    -- Users active on collaboration platform\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_buttonpress_pre_di \n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n),\ncollab_gameplay_users AS (\n    -- Users active in collaboration gameplay\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_matchlog_stat_di \n    WHERE dtstatdate BETWEEN '20250217' AND '20250318' \n    AND vtemp1 = 'åä½œ'\n),\ntarget_users AS (\n    -- Users active on collaboration platform but not in collaboration gameplay\n    SELECT cpu.vplayerid\n    FROM collab_platform_users cpu\n    LEFT JOIN collab_gameplay_users cgu ON cpu.vplayerid = cgu.vplayerid\n    WHERE cgu.vplayerid IS NULL\n),\nuser_mode_time AS (\n    -- Calculate total play time per user per mode\n    SELECT \n        vplayerid, \n        modename, \n        SUM(roundtime) as total_time\n    FROM dws_jordass_mode_roundrecord_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n    AND modename IN ('ä¼ ç»Ÿæ¨¡å¼','ä¼‘é—²æ¨¡å¼','ç»„é˜Ÿç«æŠ€','é¢†åœ°','ä¹å›­','å¹¿é˜”å¤©åœ°','åˆ›æ„åˆ›ä½œé—´','ç”Ÿå­˜æ¨¡å¼')\n    GROUP BY vplayerid, modename\n),\nuser_main_mode AS (\n    -- Rank modes by time for each user and select the top one\n    SELECT \n        vplayerid,\n        modename,\n        ROW_NUMBER() OVER (PARTITION BY vplayerid ORDER BY total_time DESC) as rn\n    FROM user_mode_time\n)\n-- Count users by their main play mode\nSELECT \n    modename as ä¸»ç©ç©æ³•,\n    COUNT(*) as äººæ•°\nFROM user_main_mode umm\nJOIN target_users tu ON umm.vplayerid = tu.vplayerid\nWHERE rn = 1\nGROUP BY modename\nORDER BY äººæ•° DESC;",
  "rejected": "æˆ‘éœ€è¦é€æ­¥åˆ†æè¿™ä¸ªé—®é¢˜å¹¶æ„å»ºSQLæŸ¥è¯¢ã€‚\n\né¦–å…ˆè®©æˆ‘ç†è§£éœ€æ±‚ï¼š\n1. æ‰¾å‡ºåœ¨åä½œå¹³å°æ´»è·ƒä½†æ²¡æœ‰åœ¨åä½œç©æ³•æ´»è·ƒçš„ç”¨æˆ·\n2. ç»Ÿè®¡è¿™äº›ç”¨æˆ·çš„ä¸»ç©ç©æ³•åˆ†å¸ƒ\n3. ä¸»ç©å®šä¹‰æ˜¯ç´¯è®¡å¯¹å±€æ—¶é•¿æœ€å¤šçš„ç©æ³•\n4. ç©æ³•èŒƒå›´é™å®šåœ¨ç‰¹å®šçš„å‡ ç§æ¨¡å¼ä¸­\n\nè®©æˆ‘åˆ†æå„ä¸ªè¡¨çš„ä½œç”¨ï¼š\n- dws_jordass_matchlog_stat_di: åŒ…å«ç©å®¶å¯¹å±€è®°å½•å’Œç©æ³•ä¿¡æ¯\n- dwd_jordass_buttonpress_pre_di: åŒ…å«æŒ‰é’®ç‚¹å‡»è¡Œä¸ºè®°å½•ï¼Œç”¨äºåˆ¤æ–­åä½œå¹³å°æ´»è·ƒç”¨æˆ·\n- dws_jordass_mode_roundrecord_di: åŒ…å«ç©å®¶å¯¹å±€è®°å½•å’Œç©æ³•ä¿¡æ¯\n\næˆ‘éœ€è¦å…ˆæ‰¾å‡ºåä½œå¹³å°æ´»è·ƒç”¨æˆ·ï¼Œç„¶åæ’é™¤åä½œç©æ³•æ´»è·ƒç”¨æˆ·ï¼Œå†ç»Ÿè®¡å‰©ä½™ç”¨æˆ·çš„ä¸»ç©ç©æ³•ã€‚\n\n```sql\nWITH active_users AS (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_buttonpress_pre_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n),\ncooperation_active_users AS (\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_matchlog_stat_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n      AND vtemp1 = 'åä½œ'\n),\nnon_cooperation_users AS (\n    SELECT vplayerid\n    FROM active_users\n    WHERE vplayerid NOT IN (SELECT vplayerid FROM cooperation_active_users)\n),\nmain_modes AS (\n    SELECT \n        vplayerid,\n        modename,\n        SUM(roundtime) as total_time,\n        ROW_NUMBER() OVER (PARTITION BY vplayerid ORDER BY SUM(roundtime) DESC) as rn\n    FROM dws_jordass_mode_roundrecord_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n      AND modename IN ('ä¼ ç»Ÿæ¨¡å¼', 'ä¼‘é—²æ¨¡å¼', 'ç»„é˜Ÿç«æŠ€', 'é¢†åœ°', 'ä¹å›­', 'å¹¿é˜”å¤©åœ°', 'åˆ›æ„åˆ›ä½œé—´', 'ç”Ÿå­˜æ¨¡å¼')\n      AND vplayerid IN (SELECT vplayerid FROM non_cooperation_users)\n    GROUP BY vplayerid, modename\n)\nSELECT \n    modename,\n    COUNT(DISTINCT vplayerid) as user_count\nFROM main_modes\nWHERE rn = 1\nGROUP BY modename\nORDER BY user_count DESC;\n```"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡20250217-20250318åä½œå¹³å°æ´»è·ƒä½†æ˜¯æ²¡æœ‰åœ¨åä½œç©æ³•æ´»è·ƒç”¨æˆ·çš„ä¸»ç©ç©æ³•åˆ†å¸ƒ\nè¾“å‡ºï¼šä¸»ç©ç©æ³•ï¼ˆä¼ ç»Ÿæ¨¡å¼ã€ä¼‘é—²æ¨¡å¼ã€...ã€ç”Ÿå­˜æ¨¡å¼ï¼‰ã€äººæ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_jordass_matchlog_stat_di` (\n  `dtstatdate` TEXT COMMENT 'åˆ†åŒºï¼Œå‚ä¸ä¹å›­æ—¥æœŸï¼Œæ ¼å¼YYYYMMDD',\n  `vgameappid` TEXT COMMENT 'è´¦å·ä½“ç³»ï¼šwx:å¾®ä¿¡ï¼Œqqï¼šæ‰‹Q',\n  `platid` BIGINT COMMENT 'ç³»ç»Ÿå¹³å°ï¼š0:IOS,1:Android255:æ‰€æœ‰å¹³å°',\n  `vplayerid` TEXT COMMENT 'ç©å®¶ID',\n  `imode` BIGINT COMMENT 'ä¹å›­å­ç©æ³•ï¼š\t255-æ‰€æœ‰ç©æ³•ï¼Œç”¨æˆ·é—®é¢˜æœªæåˆ°æ˜ç¡®çš„å­ç©æ³•æ—¶ï¼Œé»˜è®¤ä¸ºæ‰€æœ‰ç©æ³•\t1282371711108385024-è·‘é…·ï¼šæˆç¥ä¹‹è·¯\t1281086178576044544-ä¼ åª’ç¾¤å²›\t1305619333337074432-ç‹‚çƒ­æ´¾å¯¹\t1251206313870885120-ç ºåˆƒè¿åŠ¨ä¼š5.0\t1313754433693158656-æ‰‹çƒç‰¹æ”»ï¼ˆåŸè¶³çƒæ¸¸æˆï¼‰\t1296730563346958080-ç›”ä»”æ³¡æ³¡å°é˜Ÿ\t1294279575841283072-å¤ºå®è¡ŒåŠ¨\t1310822585431254784-æ¡¥æ¢äº‰å¤º\t1278160113246405632-ç ºåˆƒå¤§äº¨\t1313047366167692288-é€†è½¬å¹³åº•é”…\t1298874468735655936-æˆ˜è½¦çªè¢­\t1278948391311645952-èƒ½é‡äº‰å¤ºæˆ˜\t1295942084687041792-è¶£å‘³é£ç›˜\t1282101477461985024-ç›”ä»”æ€»åŠ¨å‘˜\t1278144466094392064-é»‘äº”æ¨¡æ‹Ÿå™¨\t1313046652157690624-ç›”ä»”æ–—é­”ç‹ï¼ˆåŸç›”ä»”å¤§ä¹±æ–—ï¼‰\t1289446028099979264-ä½£å…µé˜µçº¿\t1309453077449826304-æ˜Ÿæ˜Ÿäº‰å¤ºæˆ˜ï¼ˆåŸåï¼šé‡‘å¸å¤§ä½œæˆ˜ï¼‰\t1298445174154728192-åœè½¦å¤§ä½œæˆ˜\t1294211358396518400-ç‰¹æŠ€å¤§ä¹±æ–—\t1280302176000803840-å§åº•è¡ŒåŠ¨\t1307095884553538304-\"è¶…çº§éšåŒ¿ï¼ˆåŸå¹¿é˜”å¤©åœ°éšåŒ¿æ¨¡å¼ï¼‰\"\t1297394991875754752-å®ˆå«ç”Ÿå‘½çº¿\t1278170390282112000-æ˜Ÿçƒå®ˆæŠ¤è€…\t1287652322611036928-æ‹¼å›¾ç‹‚æ¬¢\t1273928195100380928-ç‰¹ç§å…µè®­ç»ƒ\t1300845150154531840-æ˜Ÿä¹‹ç»§æ‰¿è€…\t1302344773925865984-å½©è‰²äº‰å¤ºæˆ˜\t1296062239742105856-æŠ±å›¢å†²å†²å†²\t1281781308570207232-ç‹™å‡»ç²¾è‹±',\n  `teamnum` BIGINT COMMENT 'ç»„é˜Ÿäººæ•°',\n  `icnt` BIGINT COMMENT 'å¯¹å±€æ¬¡æ•°',\n  `itemp1` BIGINT COMMENT 'å¯¹å±€æ—¶é•¿',\n  `itemp2` BIGINT COMMENT 'itemp2',\n  `vtemp1` TEXT COMMENT 'vtemp1',\n  `vtemp2` TEXT COMMENT 'vtemp2'\n);\nCREATE TABLE `dwd_jordass_buttonpress_pre_di` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `dteventtime` TEXT,\n  `vgameappid` TEXT,\n  `platid` BIGINT COMMENT 'æ¸¸æˆAPPID',\n  `izoneareaid` BIGINT COMMENT 'ios 0/android 1',\n  `vplayerid` TEXT,\n  `uid` TEXT COMMENT 'è§’è‰²UID',\n  `buttontype` TEXT COMMENT 'æŒ‰é’®ä»£å·ä»¥åˆ†å·åˆ†éš”',\n  `param1` TEXT COMMENT 'é™„åŠ å‚æ•°1ä»¥åˆ†å·åˆ†éš”',\n  `param2` TEXT COMMENT 'é™„åŠ å‚æ•°2ä»¥åˆ†å·åˆ†éš”',\n  `param3` TEXT COMMENT 'é™„åŠ å‚æ•°3ä»¥åˆ†å·åˆ†éš”',\n  `param4` TEXT COMMENT 'é™„åŠ å‚æ•°4ä»¥åˆ†å·åˆ†éš”',\n  `param5` TEXT COMMENT 'é™„åŠ å‚æ•°5ä»¥åˆ†å·åˆ†éš”',\n  `param6` TEXT COMMENT 'é™„åŠ å‚æ•°6ä»¥åˆ†å·åˆ†éš”',\n  `unixtime` TEXT,\n  `ugcmarea` TEXT\n);\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸæ ¼å¼YYYYMMDD',\n  `vgameappid` TEXT COMMENT 'è´¦å·ä½“ç³»ï¼šwx:å¾®ä¿¡ï¼Œqqï¼šæ‰‹Q',\n  `platid` BIGINT COMMENT 'ç³»ç»Ÿå¹³å°ï¼š0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT 'ç©å®¶ID',\n  `mode` BIGINT COMMENT 'æ¨¡å¼ID',\n  `modename` TEXT COMMENT 'æ¨¡å¼åç§°',\n  `submode` BIGINT COMMENT 'å­æ¨¡å¼ID',\n  `submodename` TEXT COMMENT 'å­æ¨¡å¼åç§°',\n  `map` BIGINT COMMENT 'åœ°å›¾ID',\n  `mapname` TEXT COMMENT 'åœ°å›¾åç§°',\n  `seasonid` BIGINT COMMENT 'èµ›å­£ID',\n  `seasonname` TEXT COMMENT 'èµ›å­£åç§°',\n  `roundcnt` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ•°',\n  `roundtime` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ—¶é•¿(ç§’)',\n  `survivaltime` BIGINT COMMENT 'å½“æ—¥å­˜æ´»æ—¶é•¿(ç§’)',\n  `firstroundtime` TEXT COMMENT 'å½“æ—¥é¦–æ¬¡å¯¹å±€æ—¶é—´',\n  `device_type` BIGINT COMMENT 'è®¾å¤‡ç±»å‹'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nä¸»ç©å®šä¹‰ï¼šç”¨æˆ·ç´¯è®¡å¯¹å±€æ—¶é•¿æœ€å¤šçš„ç©æ³•ï¼›\nç©æ³•å– modename in ('ä¼ ç»Ÿæ¨¡å¼','ä¼‘é—²æ¨¡å¼','ç»„é˜Ÿç«æŠ€','é¢†åœ°','ä¹å›­','å¹¿é˜”å¤©åœ°','åˆ›æ„åˆ›ä½œé—´','ç”Ÿå­˜æ¨¡å¼')\nåä½œå¹³å°æ´»è·ƒï¼šugcmbuttonclickä¸­çš„ç©å®¶ï¼›\nåä½œç©æ³•æ´»è·ƒï¼švtemp1='åä½œ'  çš„ç©æ³•è®°å½•\n\n",
  "chosen": "WITH collab_platform_users AS (\n    -- Users active on collaboration platform\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_buttonpress_pre_di \n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n),\ncollab_gameplay_users AS (\n    -- Users active in collaboration gameplay\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_matchlog_stat_di \n    WHERE dtstatdate BETWEEN '20250217' AND '20250318' \n    AND vtemp1 = 'åä½œ'\n),\ntarget_users AS (\n    -- Users active on collaboration platform but not in collaboration gameplay\n    SELECT cpu.vplayerid\n    FROM collab_platform_users cpu\n    LEFT JOIN collab_gameplay_users cgu ON cpu.vplayerid = cgu.vplayerid\n    WHERE cgu.vplayerid IS NULL\n),\nuser_mode_time AS (\n    -- Calculate total play time per user per mode\n    SELECT \n        vplayerid, \n        modename, \n        SUM(roundtime) as total_time\n    FROM dws_jordass_mode_roundrecord_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n    AND modename IN ('ä¼ ç»Ÿæ¨¡å¼','ä¼‘é—²æ¨¡å¼','ç»„é˜Ÿç«æŠ€','é¢†åœ°','ä¹å›­','å¹¿é˜”å¤©åœ°','åˆ›æ„åˆ›ä½œé—´','ç”Ÿå­˜æ¨¡å¼')\n    GROUP BY vplayerid, modename\n),\nuser_main_mode AS (\n    -- Rank modes by time for each user and select the top one\n    SELECT \n        vplayerid,\n        modename,\n        ROW_NUMBER() OVER (PARTITION BY vplayerid ORDER BY total_time DESC) as rn\n    FROM user_mode_time\n)\n-- Count users by their main play mode\nSELECT \n    modename as ä¸»ç©ç©æ³•,\n    COUNT(*) as äººæ•°\nFROM user_main_mode umm\nJOIN target_users tu ON umm.vplayerid = tu.vplayerid\nWHERE rn = 1\nGROUP BY modename\nORDER BY äººæ•° DESC;",
  "rejected": "æˆ‘ä»¬æ¥ä¸€æ­¥æ­¥åˆ†æå’Œç¼–å†™ SQL æŸ¥è¯¢è¯­å¥ï¼Œä»¥æ»¡è¶³ç”¨æˆ·éœ€æ±‚ã€‚\n\n---\n\n## ğŸ” **ä¸€ã€ç†è§£ç”¨æˆ·é—®é¢˜**\n\n### âœ… éœ€æ±‚ç›®æ ‡ï¼š\n> ç»Ÿè®¡ **2025å¹´2æœˆ17æ—¥ - 2025å¹´3æœˆ18æ—¥** è¿™ä¸ªæ—¶é—´æ®µå†…ï¼Œåœ¨â€œåä½œå¹³å°â€ä¸Šæ´»è·ƒä½†æ²¡æœ‰åœ¨â€œåä½œç©æ³•â€ä¸­æ´»è·ƒçš„ç”¨æˆ·çš„â€œä¸»ç©ç©æ³•â€åˆ†å¸ƒæƒ…å†µã€‚  \n> è¾“å‡ºå­—æ®µï¼š  \n> - ä¸»ç©ç©æ³•ï¼ˆä¾‹å¦‚ï¼šä¼ ç»Ÿæ¨¡å¼ã€ä¼‘é—²æ¨¡å¼ç­‰ï¼‰  \n> - å¯¹åº”çš„äººæ•°  \n\n---\n\n## ğŸ§  **äºŒã€å…³é”®æ¦‚å¿µä¸è¡¨ç»“æ„è§£æ**\n\n### 1. åä½œå¹³å°æ´»è·ƒç”¨æˆ·å®šä¹‰ï¼š\næ¥è‡ªè¡¨ `dwd_jordass_buttonpress_pre_di` ä¸­çš„ `buttontype` å­—æ®µï¼Œåªè¦è¯¥ç”¨æˆ·åœ¨è¿™ä¸ªè¡¨ä¸­æœ‰è®°å½•ï¼ˆå³å‚ä¸äº†æŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼‰ï¼Œå°±è®¤ä¸ºæ˜¯â€œåä½œå¹³å°æ´»è·ƒâ€ã€‚\n\n### 2. åä½œç©æ³•æ´»è·ƒç”¨æˆ·å®šä¹‰ï¼š\næ¥è‡ªè¡¨ `dws_jordass_matchlog_stat_di` ä¸­ï¼Œå½“ `vtemp1 = 'åä½œ'` æ—¶ï¼Œè¡¨ç¤ºè¯¥ç”¨æˆ·åœ¨â€œåä½œç©æ³•â€ä¸­æ´»è·ƒã€‚\n\n### 3. ä¸»ç©ç©æ³•å®šä¹‰ï¼š\næ ¹æ® `dws_jordass_mode_roundrecord_di` è¡¨ä¸­çš„æ•°æ®ï¼Œç”¨æˆ·åœ¨ä¸åŒç©æ³•ä¸‹çš„å¯¹å±€æ—¶é•¿ï¼ˆ`roundtime`ï¼‰è¿›è¡ŒåŠ æ€»ï¼Œæ‰¾å‡ºå…¶ä¸­ç´¯è®¡æ—¶é•¿æœ€é•¿çš„é‚£ä¸ªç©æ³•ä½œä¸ºå…¶â€œä¸»ç©ç©æ³•â€ã€‚\n\n---\n\n## ğŸ“Œ **ä¸‰ã€é€»è¾‘æ­¥éª¤æ‹†è§£**\n\næˆ‘ä»¬éœ€è¦åšä»¥ä¸‹å‡ æ­¥ï¼š\n\n### Step 1: ç­›é€‰å‡ºåä½œå¹³å°æ´»è·ƒç”¨æˆ·ï¼ˆå³åœ¨ `dwd_jordass_buttonpress_pre_di` ä¸­æœ‰è®°å½•ï¼‰\n\n```sql\nSELECT DISTINCT vplayerid\nFROM dwd_jordass_buttonpress_pre_di\nWHERE dtstatdate BETWEEN '20250217' AND '20250318'\n```\n\n### Step 2: ç­›é€‰å‡ºåä½œç©æ³•æ´»è·ƒç”¨æˆ·ï¼ˆå³åœ¨ `dws_jordass_matchlog_stat_di` ä¸­ `vtemp1 = 'åä½œ'`ï¼‰\n\n```sql\nSELECT DISTINCT vplayerid\nFROM dws_jordass_matchlog_stat_di\nWHERE dtstatdate BETWEEN '20250217' AND '20250318'\nAND vtemp1 = 'åä½œ'\n```\n\n### Step 3: æ‰¾å‡ºâ€œåä½œå¹³å°æ´»è·ƒä½†æœªåœ¨åä½œç©æ³•æ´»è·ƒâ€çš„ç”¨æˆ·é›†åˆ\n\n```sql\n-- æ´»è·ƒç”¨æˆ·\nWITH active_users AS (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_buttonpress_pre_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n),\n-- åä½œç©æ³•æ´»è·ƒç”¨æˆ·\ncoop_active_users AS (\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_matchlog_stat_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n    AND vtemp1 = 'åä½œ'\n)\n-- æ’é™¤åä½œç©æ³•æ´»è·ƒç”¨æˆ·åçš„å¹³å°æ´»è·ƒç”¨æˆ·\nSELECT a.vplayerid\nFROM active_users a\nLEFT JOIN coop_active_users c ON a.vplayerid = c.vplayerid\nWHERE c.vplayerid IS NULL;\n```\n\n### Step 4: è·å–è¿™äº›ç”¨æˆ·çš„ä¸»ç©ç©æ³•ï¼ˆåŸºäº roundtime æœ€å¤§çš„ç©æ³•ï¼‰\n\nä½¿ç”¨ `dws_jordass_mode_roundrecord_di` è¡¨æ¥è®¡ç®—æ¯ä¸ªç”¨æˆ·å„ä¸ªç©æ³•çš„æ€»å¯¹å±€æ—¶é•¿ï¼Œå¹¶æ‰¾å‡ºä¸»ç©ç©æ³•ã€‚\n\n```sql\nWITH active_users AS (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_buttonpress_pre_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n),\ncoop_active_users AS (\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_matchlog_stat_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n    AND vtemp1 = 'åä½œ'\n),\nnon_coop_active_users AS (\n    SELECT a.vplayerid\n    FROM active_users a\n    LEFT JOIN coop_active_users c ON a.vplayerid = c.vplayerid\n    WHERE c.vplayerid IS NULL\n),\nuser_modes AS (\n    SELECT\n        vplayerid,\n        modename,\n        SUM(roundtime) AS total_time\n    FROM dws_jordass_mode_roundrecord_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n      AND modename IN ('ä¼ ç»Ÿæ¨¡å¼', 'ä¼‘é—²æ¨¡å¼', 'ç»„é˜Ÿç«æŠ€', 'é¢†åœ°', 'ä¹å›­', 'å¹¿é˜”å¤©åœ°', 'åˆ›æ„åˆ›ä½œé—´', 'ç”Ÿå­˜æ¨¡å¼')\n    GROUP BY vplayerid, modename\n),\nranked_modes AS (\n    SELECT\n        vplayerid,\n        modename,\n        ROW_NUMBER() OVER (PARTITION BY vplayerid ORDER BY total_time DESC) AS rn\n    FROM user_modes\n)\nSELECT\n    rm.modename,\n    COUNT(DISTINCT rm.vplayerid) AS user_count\nFROM ranked_modes rm\nJOIN non_coop_active_users n ON rm.vplayerid = n.vplayerid\nWHERE rm.rn = 1\nGROUP BY rm.modename;\n```\n\n---\n\n## âœ… **å››ã€æœ€ç»ˆå®Œæ•´ SQL æŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š**\n\n```sql\nWITH active_users AS (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_buttonpress_pre_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n),\ncoop_active_users AS (\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_matchlog_stat_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n    AND vtemp1 = 'åä½œ'\n),\nnon_coop_active_users AS (\n    SELECT a.vplayerid\n    FROM active_users a\n    LEFT JOIN coop_active_users c ON a.vplayerid = c.vplayerid\n    WHERE c.vplayerid IS NULL\n),\nuser_modes AS (\n    SELECT\n        vplayerid,\n        modename,\n        SUM(roundtime) AS total_time\n    FROM dws_jordass_mode_roundrecord_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n      AND modename IN ('ä¼ ç»Ÿæ¨¡å¼', 'ä¼‘é—²æ¨¡å¼', 'ç»„é˜Ÿç«æŠ€', 'é¢†åœ°', 'ä¹å›­', 'å¹¿é˜”å¤©åœ°', 'åˆ›æ„åˆ›ä½œé—´', 'ç”Ÿå­˜æ¨¡å¼')\n    GROUP BY vplayerid, modename\n),\nranked_modes AS (\n    SELECT\n        vplayerid,\n        modename,\n        ROW_NUMBER() OVER (PARTITION BY vplayerid ORDER BY total_time DESC) AS rn\n    FROM user_modes\n)\nSELECT\n    rm.modename,\n    COUNT(DISTINCT rm.vplayerid) AS user_count\nFROM ranked_modes rm\nJOIN non_coop_active_users n ON rm.vplayerid = n.vplayerid\nWHERE rm.rn = 1\nGROUP BY rm.modename;\n```\n\n---\n\n## ğŸ§¾ **äº”ã€è¾“å‡ºè¯´æ˜**\n\n| modename       | user_count |\n|----------------|------------|\n| ä¼ ç»Ÿæ¨¡å¼       | 1234       |\n| ä¼‘é—²æ¨¡å¼       | 5678       |\n| ...            | ...        |\n\nè¿™ä¸ªç»“æœå°†å±•ç¤ºç¬¦åˆæ¡ä»¶çš„ç”¨æˆ·ç¾¤ä½“ä¸­ï¼Œä»–ä»¬çš„â€œä¸»ç©ç©æ³•â€åˆ†å¸ƒæƒ…å†µåŠå¯¹åº”äººæ•°ã€‚\n\nå¦‚éœ€è¿›ä¸€æ­¥ä¼˜åŒ–æ€§èƒ½æˆ–æ·»åŠ æ›´å¤šç»´åº¦ï¼Œè¯·å‘ŠçŸ¥ï¼"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡20250217-20250318åä½œå¹³å°æ´»è·ƒä½†æ˜¯æ²¡æœ‰åœ¨åä½œç©æ³•æ´»è·ƒç”¨æˆ·çš„ä¸»ç©ç©æ³•åˆ†å¸ƒ\nè¾“å‡ºï¼šä¸»ç©ç©æ³•ï¼ˆä¼ ç»Ÿæ¨¡å¼ã€ä¼‘é—²æ¨¡å¼ã€...ã€ç”Ÿå­˜æ¨¡å¼ï¼‰ã€äººæ•°\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_jordass_matchlog_stat_di` (\n  `dtstatdate` TEXT COMMENT 'åˆ†åŒºï¼Œå‚ä¸ä¹å›­æ—¥æœŸï¼Œæ ¼å¼YYYYMMDD',\n  `vgameappid` TEXT COMMENT 'è´¦å·ä½“ç³»ï¼šwx:å¾®ä¿¡ï¼Œqqï¼šæ‰‹Q',\n  `platid` BIGINT COMMENT 'ç³»ç»Ÿå¹³å°ï¼š0:IOS,1:Android255:æ‰€æœ‰å¹³å°',\n  `vplayerid` TEXT COMMENT 'ç©å®¶ID',\n  `imode` BIGINT COMMENT 'ä¹å›­å­ç©æ³•ï¼š\t255-æ‰€æœ‰ç©æ³•ï¼Œç”¨æˆ·é—®é¢˜æœªæåˆ°æ˜ç¡®çš„å­ç©æ³•æ—¶ï¼Œé»˜è®¤ä¸ºæ‰€æœ‰ç©æ³•\t1282371711108385024-è·‘é…·ï¼šæˆç¥ä¹‹è·¯\t1281086178576044544-ä¼ åª’ç¾¤å²›\t1305619333337074432-ç‹‚çƒ­æ´¾å¯¹\t1251206313870885120-ç ºåˆƒè¿åŠ¨ä¼š5.0\t1313754433693158656-æ‰‹çƒç‰¹æ”»ï¼ˆåŸè¶³çƒæ¸¸æˆï¼‰\t1296730563346958080-ç›”ä»”æ³¡æ³¡å°é˜Ÿ\t1294279575841283072-å¤ºå®è¡ŒåŠ¨\t1310822585431254784-æ¡¥æ¢äº‰å¤º\t1278160113246405632-ç ºåˆƒå¤§äº¨\t1313047366167692288-é€†è½¬å¹³åº•é”…\t1298874468735655936-æˆ˜è½¦çªè¢­\t1278948391311645952-èƒ½é‡äº‰å¤ºæˆ˜\t1295942084687041792-è¶£å‘³é£ç›˜\t1282101477461985024-ç›”ä»”æ€»åŠ¨å‘˜\t1278144466094392064-é»‘äº”æ¨¡æ‹Ÿå™¨\t1313046652157690624-ç›”ä»”æ–—é­”ç‹ï¼ˆåŸç›”ä»”å¤§ä¹±æ–—ï¼‰\t1289446028099979264-ä½£å…µé˜µçº¿\t1309453077449826304-æ˜Ÿæ˜Ÿäº‰å¤ºæˆ˜ï¼ˆåŸåï¼šé‡‘å¸å¤§ä½œæˆ˜ï¼‰\t1298445174154728192-åœè½¦å¤§ä½œæˆ˜\t1294211358396518400-ç‰¹æŠ€å¤§ä¹±æ–—\t1280302176000803840-å§åº•è¡ŒåŠ¨\t1307095884553538304-\"è¶…çº§éšåŒ¿ï¼ˆåŸå¹¿é˜”å¤©åœ°éšåŒ¿æ¨¡å¼ï¼‰\"\t1297394991875754752-å®ˆå«ç”Ÿå‘½çº¿\t1278170390282112000-æ˜Ÿçƒå®ˆæŠ¤è€…\t1287652322611036928-æ‹¼å›¾ç‹‚æ¬¢\t1273928195100380928-ç‰¹ç§å…µè®­ç»ƒ\t1300845150154531840-æ˜Ÿä¹‹ç»§æ‰¿è€…\t1302344773925865984-å½©è‰²äº‰å¤ºæˆ˜\t1296062239742105856-æŠ±å›¢å†²å†²å†²\t1281781308570207232-ç‹™å‡»ç²¾è‹±',\n  `teamnum` BIGINT COMMENT 'ç»„é˜Ÿäººæ•°',\n  `icnt` BIGINT COMMENT 'å¯¹å±€æ¬¡æ•°',\n  `itemp1` BIGINT COMMENT 'å¯¹å±€æ—¶é•¿',\n  `itemp2` BIGINT COMMENT 'itemp2',\n  `vtemp1` TEXT COMMENT 'vtemp1',\n  `vtemp2` TEXT COMMENT 'vtemp2'\n);\nCREATE TABLE `dwd_jordass_buttonpress_pre_di` (\n  `dtstatdate` TEXT COMMENT 'æ—¥æœŸ',\n  `dteventtime` TEXT,\n  `vgameappid` TEXT,\n  `platid` BIGINT COMMENT 'æ¸¸æˆAPPID',\n  `izoneareaid` BIGINT COMMENT 'ios 0/android 1',\n  `vplayerid` TEXT,\n  `uid` TEXT COMMENT 'è§’è‰²UID',\n  `buttontype` TEXT COMMENT 'æŒ‰é’®ä»£å·ä»¥åˆ†å·åˆ†éš”',\n  `param1` TEXT COMMENT 'é™„åŠ å‚æ•°1ä»¥åˆ†å·åˆ†éš”',\n  `param2` TEXT COMMENT 'é™„åŠ å‚æ•°2ä»¥åˆ†å·åˆ†éš”',\n  `param3` TEXT COMMENT 'é™„åŠ å‚æ•°3ä»¥åˆ†å·åˆ†éš”',\n  `param4` TEXT COMMENT 'é™„åŠ å‚æ•°4ä»¥åˆ†å·åˆ†éš”',\n  `param5` TEXT COMMENT 'é™„åŠ å‚æ•°5ä»¥åˆ†å·åˆ†éš”',\n  `param6` TEXT COMMENT 'é™„åŠ å‚æ•°6ä»¥åˆ†å·åˆ†éš”',\n  `unixtime` TEXT,\n  `ugcmarea` TEXT\n);\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸæ ¼å¼YYYYMMDD',\n  `vgameappid` TEXT COMMENT 'è´¦å·ä½“ç³»ï¼šwx:å¾®ä¿¡ï¼Œqqï¼šæ‰‹Q',\n  `platid` BIGINT COMMENT 'ç³»ç»Ÿå¹³å°ï¼š0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT 'ç©å®¶ID',\n  `mode` BIGINT COMMENT 'æ¨¡å¼ID',\n  `modename` TEXT COMMENT 'æ¨¡å¼åç§°',\n  `submode` BIGINT COMMENT 'å­æ¨¡å¼ID',\n  `submodename` TEXT COMMENT 'å­æ¨¡å¼åç§°',\n  `map` BIGINT COMMENT 'åœ°å›¾ID',\n  `mapname` TEXT COMMENT 'åœ°å›¾åç§°',\n  `seasonid` BIGINT COMMENT 'èµ›å­£ID',\n  `seasonname` TEXT COMMENT 'èµ›å­£åç§°',\n  `roundcnt` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ•°',\n  `roundtime` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ—¶é•¿(ç§’)',\n  `survivaltime` BIGINT COMMENT 'å½“æ—¥å­˜æ´»æ—¶é•¿(ç§’)',\n  `firstroundtime` TEXT COMMENT 'å½“æ—¥é¦–æ¬¡å¯¹å±€æ—¶é—´',\n  `device_type` BIGINT COMMENT 'è®¾å¤‡ç±»å‹'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\nä¸»ç©å®šä¹‰ï¼šç”¨æˆ·ç´¯è®¡å¯¹å±€æ—¶é•¿æœ€å¤šçš„ç©æ³•ï¼›\nç©æ³•å– modename in ('ä¼ ç»Ÿæ¨¡å¼','ä¼‘é—²æ¨¡å¼','ç»„é˜Ÿç«æŠ€','é¢†åœ°','ä¹å›­','å¹¿é˜”å¤©åœ°','åˆ›æ„åˆ›ä½œé—´','ç”Ÿå­˜æ¨¡å¼')\nåä½œå¹³å°æ´»è·ƒï¼šugcmbuttonclickä¸­çš„ç©å®¶ï¼›\nåä½œç©æ³•æ´»è·ƒï¼švtemp1='åä½œ'  çš„ç©æ³•è®°å½•\n\n",
  "chosen": "WITH collab_platform_users AS (\n    -- Users active on collaboration platform\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_buttonpress_pre_di \n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n),\ncollab_gameplay_users AS (\n    -- Users active in collaboration gameplay\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_matchlog_stat_di \n    WHERE dtstatdate BETWEEN '20250217' AND '20250318' \n    AND vtemp1 = 'åä½œ'\n),\ntarget_users AS (\n    -- Users active on collaboration platform but not in collaboration gameplay\n    SELECT cpu.vplayerid\n    FROM collab_platform_users cpu\n    LEFT JOIN collab_gameplay_users cgu ON cpu.vplayerid = cgu.vplayerid\n    WHERE cgu.vplayerid IS NULL\n),\nuser_mode_time AS (\n    -- Calculate total play time per user per mode\n    SELECT \n        vplayerid, \n        modename, \n        SUM(roundtime) as total_time\n    FROM dws_jordass_mode_roundrecord_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n    AND modename IN ('ä¼ ç»Ÿæ¨¡å¼','ä¼‘é—²æ¨¡å¼','ç»„é˜Ÿç«æŠ€','é¢†åœ°','ä¹å›­','å¹¿é˜”å¤©åœ°','åˆ›æ„åˆ›ä½œé—´','ç”Ÿå­˜æ¨¡å¼')\n    GROUP BY vplayerid, modename\n),\nuser_main_mode AS (\n    -- Rank modes by time for each user and select the top one\n    SELECT \n        vplayerid,\n        modename,\n        ROW_NUMBER() OVER (PARTITION BY vplayerid ORDER BY total_time DESC) as rn\n    FROM user_mode_time\n)\n-- Count users by their main play mode\nSELECT \n    modename as ä¸»ç©ç©æ³•,\n    COUNT(*) as äººæ•°\nFROM user_main_mode umm\nJOIN target_users tu ON umm.vplayerid = tu.vplayerid\nWHERE rn = 1\nGROUP BY modename\nORDER BY äººæ•° DESC;",
  "rejected": "æˆ‘å°†é€æ­¥åˆ†æè¿™ä¸ªé—®é¢˜å¹¶æ„å»ºSQLæŸ¥è¯¢è¯­å¥ã€‚\n\né¦–å…ˆï¼Œè®©æˆ‘ç†è§£éœ€æ±‚ï¼š\n1. æ‰¾å‡ºåœ¨åä½œå¹³å°æ´»è·ƒä½†ä¸åœ¨åä½œç©æ³•æ´»è·ƒçš„ç”¨æˆ·\n2. ç»Ÿè®¡è¿™äº›ç”¨æˆ·çš„ä¸»ç©ç©æ³•åˆ†å¸ƒ\n3. ä¸»ç©å®šä¹‰æ˜¯ç´¯è®¡å¯¹å±€æ—¶é•¿æœ€å¤šçš„ç©æ³•\n4. ç©æ³•èŒƒå›´é™å®šä¸ºç‰¹å®šçš„å‡ ç§æ¨¡å¼\n\nè®©æˆ‘åˆ†æå„ä¸ªè¡¨çš„ä½œç”¨ï¼š\n- dws_jordass_matchlog_stat_di: åŒ…å«ç©å®¶å¯¹å±€è®°å½•å’Œç©æ³•ä¿¡æ¯\n- dwd_jordass_buttonpress_pre_di: åŒ…å«æŒ‰é’®ç‚¹å‡»è¡Œä¸ºæ•°æ®ï¼Œç”¨äºåˆ¤æ–­åä½œå¹³å°æ´»è·ƒç”¨æˆ·\n- dws_jordass_mode_roundrecord_di: åŒ…å«æ¨¡å¼å’Œåœ°å›¾ä¿¡æ¯\n\n```sql\nWITH \n-- ç¬¬ä¸€æ­¥ï¼šæ‰¾å‡ºåä½œå¹³å°æ´»è·ƒç”¨æˆ·ï¼ˆé€šè¿‡æŒ‰é’®ç‚¹å‡»è®°å½•ï¼‰\nactive_users_in_platform AS (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_buttonpress_pre_di\n),\n\n-- ç¬¬äºŒæ­¥ï¼šæ‰¾å‡ºåä½œç©æ³•æ´»è·ƒç”¨æˆ·ï¼ˆvtemp1='åä½œ'ï¼‰\nactive_users_in_coop_game AS (\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_matchlog_stat_di\n    WHERE vtemp1 = 'åä½œ'\n),\n\n-- ç¬¬ä¸‰æ­¥ï¼šæ‰¾å‡ºåœ¨åä½œå¹³å°æ´»è·ƒä½†ä¸åœ¨åä½œç©æ³•æ´»è·ƒçš„ç”¨æˆ·\ninactive_users_in_coop_game AS (\n    SELECT vplayerid\n    FROM active_users_in_platform\n    WHERE vplayerid NOT IN (SELECT vplayerid FROM active_users_in_coop_game)\n),\n\n-- ç¬¬å››æ­¥ï¼šè®¡ç®—æ¯ä¸ªç”¨æˆ·åœ¨æŒ‡å®šç©æ³•ä¸‹çš„å¯¹å±€æ—¶é•¿\nuser_play_time_by_mode AS (\n    SELECT \n        a.vplayerid,\n        b.modename,\n        SUM(a.icnt) as total_rounds,\n        SUM(a.itemp1) as total_play_time\n    FROM dws_jordass_matchlog_stat_di a\n    JOIN dws_jordass_mode_roundrecord_di b\n        ON a.vplayerid = b.vplayerid AND a.imode = b.mode\n    WHERE a.dtstatdate BETWEEN '20250217' AND '20250318'\n        AND a.vplayerid IN (SELECT vplayerid FROM inactive_users_in_coop_game)\n        AND b.modename IN ('ä¼ ç»Ÿæ¨¡å¼', 'ä¼‘é—²æ¨¡å¼', 'ç»„é˜Ÿç«æŠ€', 'é¢†åœ°', 'ä¹å›­', 'å¹¿é˜”å¤©åœ°', 'åˆ›æ„åˆ›ä½œé—´', 'ç”Ÿå­˜æ¨¡å¼')\n    GROUP BY a.vplayerid, b.modename\n),\n\n-- ç¬¬äº”æ­¥ï¼šæ‰¾å‡ºæ¯ä¸ªç”¨æˆ·çš„ä¸»ç©ç©æ³•ï¼ˆç´¯è®¡å¯¹å±€æ—¶é•¿æœ€å¤šï¼‰\nprimary_modes AS (\n    SELECT \n        vplayerid,\n        modename\n    FROM (\n        SELECT \n            vplayerid,\n            modename,\n            ROW_NUMBER() OVER (PARTITION BY vplayerid ORDER BY total_play_time DESC) as rn\n        FROM user_play_time_by_mode\n    ) ranked\n    WHERE rn = 1\n)\n\n-- æœ€ç»ˆè¾“å‡ºç»“æœ\nSELECT \n    modename,\n    COUNT(DISTINCT vplayerid) as count\nFROM primary_modes\nGROUP BY modename\nORDER BY count DESC;\n```"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2023/1/14-2023/1/28\n2024/2/2-2024/2/16\n2025/1/21-2025/2/4\næ¯å¤©æ‰€æœ‰ç©æ³•çš„å‚ä¸äººæ•°ï¼Œæ€»æ—¶é•¿\nè¾“å‡ºï¼šæ—¥æœŸï¼ˆ20230101ã€20230102ã€...ã€20230128ã€20240202ã€...ã€20250204ï¼‰ï¼Œå‚ä¸äººæ•°ï¼Œæ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸæ ¼å¼YYYYMMDD',\n  `vgameappid` TEXT COMMENT 'è´¦å·ä½“ç³»ï¼šwx:å¾®ä¿¡ï¼Œqqï¼šæ‰‹Q',\n  `platid` BIGINT COMMENT 'ç³»ç»Ÿå¹³å°ï¼š0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT 'ç©å®¶ID',\n  `mode` BIGINT COMMENT 'æ¨¡å¼ID',\n  `modename` TEXT COMMENT 'æ¨¡å¼åç§°',\n  `submode` BIGINT COMMENT 'å­æ¨¡å¼ID',\n  `submodename` TEXT COMMENT 'å­æ¨¡å¼åç§°',\n  `map` BIGINT COMMENT 'åœ°å›¾ID',\n  `mapname` TEXT COMMENT 'åœ°å›¾åç§°',\n  `seasonid` BIGINT COMMENT 'èµ›å­£ID',\n  `seasonname` TEXT COMMENT 'èµ›å­£åç§°',\n  `roundcnt` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ•°',\n  `roundtime` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ—¶é•¿(ç§’)',\n  `survivaltime` BIGINT COMMENT 'å½“æ—¥å­˜æ´»æ—¶é•¿(ç§’)',\n  `firstroundtime` TEXT COMMENT 'å½“æ—¥é¦–æ¬¡å¯¹å±€æ—¶é—´',\n  `device_type` BIGINT COMMENT 'è®¾å¤‡ç±»å‹'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\n\n\n",
  "chosen": "SELECT \n    dtstatdate AS æ—¥æœŸ,\n    COUNT(DISTINCT vplayerid) AS å‚ä¸äººæ•°,\n    SUM(roundtime)/60 AS æ—¶é•¿_åˆ†é’Ÿ\nFROM dws_jordass_mode_roundrecord_di\nWHERE \n    (dtstatdate BETWEEN 20230114 AND 20230128) OR\n    (dtstatdate BETWEEN 20240202 AND 20240216) OR\n    (dtstatdate BETWEEN 20250121 AND 20250204)\nGROUP BY dtstatdate\nORDER BY dtstatdate",
  "rejected": "### ç¬¬ä¸€æ­¥ï¼šç†è§£éœ€æ±‚\n\næˆ‘ä»¬è¦ç»Ÿè®¡**ç‰¹å®šæ—¶é—´æ®µå†…æ¯å¤©æ‰€æœ‰ç©æ³•çš„å‚ä¸äººæ•°å’Œæ€»æ—¶é•¿**ã€‚å…·ä½“æ¥è¯´ï¼š\n\n- æ—¶é—´æ®µåŒ…æ‹¬ï¼š\n  - 2023å¹´1æœˆ14æ—¥ è‡³ 2023å¹´1æœˆ28æ—¥\n  - 2024å¹´2æœˆ2æ—¥ è‡³ 2024å¹´2æœˆ16æ—¥\n  - 2025å¹´1æœˆ21æ—¥ è‡³ 2025å¹´2æœˆ4æ—¥\n- æ¯å¤©è¦ç»Ÿè®¡ï¼š\n  - å‚ä¸äººæ•°ï¼ˆå³ä¸åŒç©å®¶æ•°é‡ï¼‰\n  - æ€»æ—¶é•¿ï¼ˆå•ä½ä¸ºåˆ†é’Ÿï¼‰\n- è¾“å‡ºå­—æ®µï¼š\n  - æ—¥æœŸï¼ˆæ ¼å¼ä¸º `YYYYMMDD` å¦‚ `20230114`ï¼‰\n  - å‚ä¸äººæ•°\n  - æ€»æ—¶é•¿ï¼ˆå•ä½ä¸ºåˆ†é’Ÿï¼‰\n\n---\n\n### ç¬¬äºŒæ­¥ï¼šåˆ†æè¡¨ç»“æ„ä¸å­—æ®µå«ä¹‰\n\næˆ‘ä»¬ä½¿ç”¨çš„æ˜¯è¡¨ `dws_jordass_mode_roundrecord_di`ï¼Œå…¶ä¸»è¦å­—æ®µå¦‚ä¸‹ï¼š\n\n| å­—æ®µå | å«ä¹‰ |\n|--------|------|\n| `dtstatdate` | ç»Ÿè®¡æ—¥æœŸï¼Œæ ¼å¼ä¸º `YYYYMMDD` |\n| `vplayerid` | ç©å®¶ ID |\n| `roundtime` | å½“æ—¥å¯¹å±€æ—¶é•¿ï¼ˆå•ä½æ˜¯ç§’ï¼‰ |\n\næˆ‘ä»¬éœ€è¦æŒ‰å¤©åˆ†ç»„ï¼Œå¹¶è®¡ç®—æ¯ä¸ªæ—¥æœŸä¸‹çš„ï¼š\n- ä¸åŒç©å®¶æ•°ï¼ˆå‚ä¸äººæ•°ï¼‰\n- æ‰€æœ‰ç©å®¶çš„ roundtime çš„æ€»å’Œï¼ˆå•ä½è½¬æˆåˆ†é’Ÿï¼‰\n\n---\n\n### ç¬¬ä¸‰æ­¥ï¼šæ„é€  SQL æŸ¥è¯¢é€»è¾‘\n\n#### 1. ç­›é€‰æŒ‡å®šæ—¥æœŸèŒƒå›´çš„æ•°æ®\n\næˆ‘ä»¬å°†ä½¿ç”¨ `IN` æˆ–è€… `BETWEEN` æ¥ç­›é€‰ç¬¦åˆæ¡ä»¶çš„æ—¥æœŸã€‚\n\n```sql\nWHERE dtstatdate IN (\n    '20230114', '20230115', ..., '20230128',\n    '20240202', '20240203', ..., '20240216',\n    '20250121', '20250122', ..., '20250204'\n)\n```\n\n> æ³¨æ„ï¼šè¿™é‡Œå¯ä»¥ä½¿ç”¨ `DATE()` å‡½æ•°æˆ–è€…ç›´æ¥æ‹¼æ¥å­—ç¬¦ä¸²æ¥æ„é€ å®Œæ•´æ—¥æœŸåˆ—è¡¨ã€‚\n\n#### 2. åˆ†ç»„èšåˆ\n\næŒ‰ç…§ `dtstatdate` è¿›è¡Œåˆ†ç»„ï¼š\n\n```sql\nGROUP BY dtstatdate\n```\n\nç„¶åè¿›è¡Œä»¥ä¸‹æ“ä½œï¼š\n\n- è®¡ç®—å‚ä¸äººæ•°ï¼š`COUNT(DISTINCT vplayerid)`\n- è®¡ç®—æ€»æ—¶é•¿ï¼ˆå•ä½ä¸ºåˆ†é’Ÿï¼‰ï¼š`SUM(roundtime) / 60`\n\n#### 3. æœ€ç»ˆ SQL ç»“æ„\n\n```sql\nSELECT\n  dtstatdate AS date,\n  COUNT(DISTINCT vplayerid) AS participant_count,\n  SUM(roundtime) / 60 AS total_duration_minutes\nFROM dws_jordass_mode_roundrecord_di\nWHERE dtstatdate IN (\n  -- æ’å…¥æ‰€æœ‰ç›®æ ‡æ—¥æœŸ\n  '20230114','20230115','20230116','20230117','20230118','20230119','20230120',\n  '20230121','20230122','20230123','20230124','20230125','20230126','20230127',\n  '20230128','20240202','20240203','20240204','20240205','20240206','20240207',\n  '20240208','20240209','20240210','20240211','20240212','20240213','20240214',\n  '20240215','20240216','20250121','20250122','20250123','20250124','20250125',\n  '20250126','20250127','20250128','20250129','20250130','20250131','20250201',\n  '20250202','20250203','20250204'\n)\nGROUP BY dtstatdate;\n```\n\n---\n\n### ç¬¬å››æ­¥ï¼šä¼˜åŒ–å»ºè®®ï¼ˆå¯é€‰ï¼‰\n\nå¦‚æœè¿™äº›æ—¥æœŸéå¸¸å›ºå®šä¸”é¢‘ç¹ä½¿ç”¨ï¼Œå¯ä»¥åœ¨åº”ç”¨å±‚é¢„å…ˆç”Ÿæˆä¸€ä¸ªä¸´æ—¶è¡¨æˆ–è§†å›¾ï¼Œæ¯”å¦‚ï¼š\n\n```sql\nCREATE VIEW daily_stats_view AS\nSELECT\n  dtstatdate,\n  COUNT(DISTINCT vplayerid) AS participant_count,\n  SUM(roundtime) / 60 AS total_duration_minutes\nFROM dws_jordass_mode_roundrecord_di\nWHERE dtstatdate IN (\n  '20230114','20230115', ..., '20250204'\n)\nGROUP BY dtstatdate;\n```\n\nè¿™æ ·å¯ä»¥ç›´æ¥é€šè¿‡ `SELECT * FROM daily_stats_view;` è·å–ç»“æœã€‚\n\n---\n\n### âœ… æœ€ç»ˆç­”æ¡ˆï¼ˆå®Œæ•´ SQLï¼‰ï¼š\n\n```sql\nSELECT\n  dtstatdate AS date,\n  COUNT(DISTINCT vplayerid) AS participant_count,\n  SUM(roundtime) / 60 AS total_duration_minutes\nFROM dws_jordass_mode_roundrecord_di\nWHERE dtstatdate IN (\n  '20230114','20230115','20230116','20230117','20230118','20230119','20230120',\n  '20230121','20230122','20230123','20230124','20230125','20230126','20230127',\n  '20230128','20240202','20240203','20240204','20240205','20240206','20240207',\n  '20240208','20240209','20240210','20240211','20240212','20240213','20240214',\n  '20240215','20240216','20250121','20250122','20250123','20250124','20250125',\n  '20250126','20250127','20250128','20250129','20250130','20250131','20250201',\n  '20250202','20250203','20250204'\n)\nGROUP BY dtstatdate;\n```"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2023/1/14-2023/1/28\n2024/2/2-2024/2/16\n2025/1/21-2025/2/4\næ¯å¤©æ‰€æœ‰ç©æ³•çš„å‚ä¸äººæ•°ï¼Œæ€»æ—¶é•¿\nè¾“å‡ºï¼šæ—¥æœŸï¼ˆ20230101ã€20230102ã€...ã€20230128ã€20240202ã€...ã€20250204ï¼‰ï¼Œå‚ä¸äººæ•°ï¼Œæ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸæ ¼å¼YYYYMMDD',\n  `vgameappid` TEXT COMMENT 'è´¦å·ä½“ç³»ï¼šwx:å¾®ä¿¡ï¼Œqqï¼šæ‰‹Q',\n  `platid` BIGINT COMMENT 'ç³»ç»Ÿå¹³å°ï¼š0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT 'ç©å®¶ID',\n  `mode` BIGINT COMMENT 'æ¨¡å¼ID',\n  `modename` TEXT COMMENT 'æ¨¡å¼åç§°',\n  `submode` BIGINT COMMENT 'å­æ¨¡å¼ID',\n  `submodename` TEXT COMMENT 'å­æ¨¡å¼åç§°',\n  `map` BIGINT COMMENT 'åœ°å›¾ID',\n  `mapname` TEXT COMMENT 'åœ°å›¾åç§°',\n  `seasonid` BIGINT COMMENT 'èµ›å­£ID',\n  `seasonname` TEXT COMMENT 'èµ›å­£åç§°',\n  `roundcnt` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ•°',\n  `roundtime` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ—¶é•¿(ç§’)',\n  `survivaltime` BIGINT COMMENT 'å½“æ—¥å­˜æ´»æ—¶é•¿(ç§’)',\n  `firstroundtime` TEXT COMMENT 'å½“æ—¥é¦–æ¬¡å¯¹å±€æ—¶é—´',\n  `device_type` BIGINT COMMENT 'è®¾å¤‡ç±»å‹'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\n\n\n",
  "chosen": "SELECT \n    dtstatdate AS æ—¥æœŸ,\n    COUNT(DISTINCT vplayerid) AS å‚ä¸äººæ•°,\n    SUM(roundtime)/60 AS æ—¶é•¿_åˆ†é’Ÿ\nFROM dws_jordass_mode_roundrecord_di\nWHERE \n    (dtstatdate BETWEEN 20230114 AND 20230128) OR\n    (dtstatdate BETWEEN 20240202 AND 20240216) OR\n    (dtstatdate BETWEEN 20250121 AND 20250204)\nGROUP BY dtstatdate\nORDER BY dtstatdate",
  "rejected": "SELECT\n  dtstatdate,\n  COUNT(DISTINCT vplayerid) AS player_count,\n  SUM(roundtime) / 60 AS total_duration_minutes\nFROM dws_jordass_mode_roundrecord_di\nWHERE\n  (dtstatdate BETWEEN '20230114' AND '20230128')\n  OR (dtstatdate BETWEEN '20240202' AND '20240216')\n  OR (dtstatdate BETWEEN '20250121' AND '20250204')\nGROUP BY\n  dtstatdate"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2023/1/14-2023/1/28\n2024/2/2-2024/2/16\n2025/1/21-2025/2/4\næ¯å¤©æ‰€æœ‰ç©æ³•çš„å‚ä¸äººæ•°ï¼Œæ€»æ—¶é•¿\nè¾“å‡ºï¼šæ—¥æœŸï¼ˆ20230101ã€20230102ã€...ã€20230128ã€20240202ã€...ã€20250204ï¼‰ï¼Œå‚ä¸äººæ•°ï¼Œæ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸæ ¼å¼YYYYMMDD',\n  `vgameappid` TEXT COMMENT 'è´¦å·ä½“ç³»ï¼šwx:å¾®ä¿¡ï¼Œqqï¼šæ‰‹Q',\n  `platid` BIGINT COMMENT 'ç³»ç»Ÿå¹³å°ï¼š0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT 'ç©å®¶ID',\n  `mode` BIGINT COMMENT 'æ¨¡å¼ID',\n  `modename` TEXT COMMENT 'æ¨¡å¼åç§°',\n  `submode` BIGINT COMMENT 'å­æ¨¡å¼ID',\n  `submodename` TEXT COMMENT 'å­æ¨¡å¼åç§°',\n  `map` BIGINT COMMENT 'åœ°å›¾ID',\n  `mapname` TEXT COMMENT 'åœ°å›¾åç§°',\n  `seasonid` BIGINT COMMENT 'èµ›å­£ID',\n  `seasonname` TEXT COMMENT 'èµ›å­£åç§°',\n  `roundcnt` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ•°',\n  `roundtime` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ—¶é•¿(ç§’)',\n  `survivaltime` BIGINT COMMENT 'å½“æ—¥å­˜æ´»æ—¶é•¿(ç§’)',\n  `firstroundtime` TEXT COMMENT 'å½“æ—¥é¦–æ¬¡å¯¹å±€æ—¶é—´',\n  `device_type` BIGINT COMMENT 'è®¾å¤‡ç±»å‹'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\n\n\n",
  "chosen": "SELECT \n    dtstatdate AS æ—¥æœŸ,\n    COUNT(DISTINCT vplayerid) AS å‚ä¸äººæ•°,\n    SUM(roundtime)/60 AS æ—¶é•¿_åˆ†é’Ÿ\nFROM dws_jordass_mode_roundrecord_di\nWHERE \n    (dtstatdate BETWEEN 20230114 AND 20230128) OR\n    (dtstatdate BETWEEN 20240202 AND 20240216) OR\n    (dtstatdate BETWEEN 20250121 AND 20250204)\nGROUP BY dtstatdate\nORDER BY dtstatdate",
  "rejected": "SELECT\n  dtstatdate,\n  COUNT(DISTINCT vplayerid) AS participate_user_cnt,\n  SUM(roundtime) / 60 AS duration_min\nFROM dws_jordass_mode_roundrecord_di\nWHERE\n  (dtstatdate BETWEEN '20230114' AND '20230128')\n  OR (dtstatdate BETWEEN '20240202' AND '20240216')\n  OR (dtstatdate BETWEEN '20250121' AND '20250204')\nGROUP BY\n  dtstatdate"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2023/1/14-2023/1/28\n2024/2/2-2024/2/16\n2025/1/21-2025/2/4\næ¯å¤©æ‰€æœ‰ç©æ³•çš„å‚ä¸äººæ•°ï¼Œæ€»æ—¶é•¿\nè¾“å‡ºï¼šæ—¥æœŸï¼ˆ20230101ã€20230102ã€...ã€20230128ã€20240202ã€...ã€20250204ï¼‰ï¼Œå‚ä¸äººæ•°ï¼Œæ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸæ ¼å¼YYYYMMDD',\n  `vgameappid` TEXT COMMENT 'è´¦å·ä½“ç³»ï¼šwx:å¾®ä¿¡ï¼Œqqï¼šæ‰‹Q',\n  `platid` BIGINT COMMENT 'ç³»ç»Ÿå¹³å°ï¼š0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT 'ç©å®¶ID',\n  `mode` BIGINT COMMENT 'æ¨¡å¼ID',\n  `modename` TEXT COMMENT 'æ¨¡å¼åç§°',\n  `submode` BIGINT COMMENT 'å­æ¨¡å¼ID',\n  `submodename` TEXT COMMENT 'å­æ¨¡å¼åç§°',\n  `map` BIGINT COMMENT 'åœ°å›¾ID',\n  `mapname` TEXT COMMENT 'åœ°å›¾åç§°',\n  `seasonid` BIGINT COMMENT 'èµ›å­£ID',\n  `seasonname` TEXT COMMENT 'èµ›å­£åç§°',\n  `roundcnt` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ•°',\n  `roundtime` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ—¶é•¿(ç§’)',\n  `survivaltime` BIGINT COMMENT 'å½“æ—¥å­˜æ´»æ—¶é•¿(ç§’)',\n  `firstroundtime` TEXT COMMENT 'å½“æ—¥é¦–æ¬¡å¯¹å±€æ—¶é—´',\n  `device_type` BIGINT COMMENT 'è®¾å¤‡ç±»å‹'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\n\n\n",
  "chosen": "SELECT \n    dtstatdate AS æ—¥æœŸ,\n    COUNT(DISTINCT vplayerid) AS å‚ä¸äººæ•°,\n    SUM(roundtime)/60 AS æ—¶é•¿_åˆ†é’Ÿ\nFROM dws_jordass_mode_roundrecord_di\nWHERE \n    (dtstatdate BETWEEN 20230114 AND 20230128) OR\n    (dtstatdate BETWEEN 20240202 AND 20240216) OR\n    (dtstatdate BETWEEN 20250121 AND 20250204)\nGROUP BY dtstatdate\nORDER BY dtstatdate",
  "rejected": "SELECT\n  dtstatdate,\n  COUNT(DISTINCT vplayerid) AS participate_user_count,\n  SUM(roundtime) / 60 AS total_duration_minutes\nFROM dws_jordass_mode_roundrecord_di\nWHERE\n  (dtstatdate BETWEEN '20230114' AND '20230128')\n  OR (dtstatdate BETWEEN '20240202' AND '20240216')\n  OR (dtstatdate BETWEEN '20250121' AND '20250204')\nGROUP BY\n  dtstatdate"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2023/1/14-2023/1/28\n2024/2/2-2024/2/16\n2025/1/21-2025/2/4\næ¯å¤©æ‰€æœ‰ç©æ³•çš„å‚ä¸äººæ•°ï¼Œæ€»æ—¶é•¿\nè¾“å‡ºï¼šæ—¥æœŸï¼ˆ20230101ã€20230102ã€...ã€20230128ã€20240202ã€...ã€20250204ï¼‰ï¼Œå‚ä¸äººæ•°ï¼Œæ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸæ ¼å¼YYYYMMDD',\n  `vgameappid` TEXT COMMENT 'è´¦å·ä½“ç³»ï¼šwx:å¾®ä¿¡ï¼Œqqï¼šæ‰‹Q',\n  `platid` BIGINT COMMENT 'ç³»ç»Ÿå¹³å°ï¼š0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT 'ç©å®¶ID',\n  `mode` BIGINT COMMENT 'æ¨¡å¼ID',\n  `modename` TEXT COMMENT 'æ¨¡å¼åç§°',\n  `submode` BIGINT COMMENT 'å­æ¨¡å¼ID',\n  `submodename` TEXT COMMENT 'å­æ¨¡å¼åç§°',\n  `map` BIGINT COMMENT 'åœ°å›¾ID',\n  `mapname` TEXT COMMENT 'åœ°å›¾åç§°',\n  `seasonid` BIGINT COMMENT 'èµ›å­£ID',\n  `seasonname` TEXT COMMENT 'èµ›å­£åç§°',\n  `roundcnt` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ•°',\n  `roundtime` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ—¶é•¿(ç§’)',\n  `survivaltime` BIGINT COMMENT 'å½“æ—¥å­˜æ´»æ—¶é•¿(ç§’)',\n  `firstroundtime` TEXT COMMENT 'å½“æ—¥é¦–æ¬¡å¯¹å±€æ—¶é—´',\n  `device_type` BIGINT COMMENT 'è®¾å¤‡ç±»å‹'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\n\n\n",
  "chosen": "SELECT \n    dtstatdate AS æ—¥æœŸ,\n    COUNT(DISTINCT vplayerid) AS å‚ä¸äººæ•°,\n    SUM(roundtime)/60 AS æ—¶é•¿_åˆ†é’Ÿ\nFROM dws_jordass_mode_roundrecord_di\nWHERE \n    (dtstatdate BETWEEN 20230114 AND 20230128) OR\n    (dtstatdate BETWEEN 20240202 AND 20240216) OR\n    (dtstatdate BETWEEN 20250121 AND 20250204)\nGROUP BY dtstatdate\nORDER BY dtstatdate",
  "rejected": "SELECT\n  dtstatdate,\n  COUNT(DISTINCT vplayerid) AS player_num,\n  SUM(roundtime) / 60 AS duration\nFROM dws_jordass_mode_roundrecord_di\nWHERE\n  (dtstatdate BETWEEN '20230114' AND '20230128')\n  OR (dtstatdate BETWEEN '20240202' AND '20240216')\n  OR (dtstatdate BETWEEN '20250121' AND '20250204')\nGROUP BY\n  dtstatdate"
},
{
  "instruction": "è¯·ä½ æ¥ä¸‹æ¥ä¸€æ­¥æ­¥æ€è€ƒï¼Œå†™å‡ºæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚",
  "input": "ä½ æ˜¯ä¸€åMySQLä¸“å®¶ï¼Œç°åœ¨éœ€è¦é˜…è¯»å¹¶ç†è§£ä¸‹é¢çš„ã€æ•°æ®åº“schemaã€‘æè¿°ï¼Œä»¥åŠå¯èƒ½ç”¨åˆ°çš„ã€å‚è€ƒä¿¡æ¯ã€‘ï¼Œå¹¶è¿ç”¨MySQLçŸ¥è¯†ç”Ÿæˆsqlè¯­å¥å›ç­”ã€ç”¨æˆ·é—®é¢˜ã€‘ã€‚\nã€ç”¨æˆ·é—®é¢˜ã€‘\nç»Ÿè®¡2023/1/14-2023/1/28\n2024/2/2-2024/2/16\n2025/1/21-2025/2/4\næ¯å¤©æ‰€æœ‰ç©æ³•çš„å‚ä¸äººæ•°ï¼Œæ€»æ—¶é•¿\nè¾“å‡ºï¼šæ—¥æœŸï¼ˆ20230101ã€20230102ã€...ã€20230128ã€20240202ã€...ã€20250204ï¼‰ï¼Œå‚ä¸äººæ•°ï¼Œæ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰\n\nã€æ•°æ®åº“schemaã€‘\nCREATE TABLE `dws_jordass_mode_roundrecord_di` (\n  `dtstatdate` TEXT COMMENT 'ç»Ÿè®¡æ—¥æœŸæ ¼å¼YYYYMMDD',\n  `vgameappid` TEXT COMMENT 'è´¦å·ä½“ç³»ï¼šwx:å¾®ä¿¡ï¼Œqqï¼šæ‰‹Q',\n  `platid` BIGINT COMMENT 'ç³»ç»Ÿå¹³å°ï¼š0:IOS,1:Android',\n  `vplayerid` TEXT COMMENT 'ç©å®¶ID',\n  `mode` BIGINT COMMENT 'æ¨¡å¼ID',\n  `modename` TEXT COMMENT 'æ¨¡å¼åç§°',\n  `submode` BIGINT COMMENT 'å­æ¨¡å¼ID',\n  `submodename` TEXT COMMENT 'å­æ¨¡å¼åç§°',\n  `map` BIGINT COMMENT 'åœ°å›¾ID',\n  `mapname` TEXT COMMENT 'åœ°å›¾åç§°',\n  `seasonid` BIGINT COMMENT 'èµ›å­£ID',\n  `seasonname` TEXT COMMENT 'èµ›å­£åç§°',\n  `roundcnt` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ•°',\n  `roundtime` BIGINT COMMENT 'å½“æ—¥å¯¹å±€æ—¶é•¿(ç§’)',\n  `survivaltime` BIGINT COMMENT 'å½“æ—¥å­˜æ´»æ—¶é•¿(ç§’)',\n  `firstroundtime` TEXT COMMENT 'å½“æ—¥é¦–æ¬¡å¯¹å±€æ—¶é—´',\n  `device_type` BIGINT COMMENT 'è®¾å¤‡ç±»å‹'\n);\n\nã€å‚è€ƒä¿¡æ¯ã€‘\n\n\n",
  "chosen": "SELECT \n    dtstatdate AS æ—¥æœŸ,\n    COUNT(DISTINCT vplayerid) AS å‚ä¸äººæ•°,\n    SUM(roundtime)/60 AS æ—¶é•¿_åˆ†é’Ÿ\nFROM dws_jordass_mode_roundrecord_di\nWHERE \n    (dtstatdate BETWEEN 20230114 AND 20230128) OR\n    (dtstatdate BETWEEN 20240202 AND 20240216) OR\n    (dtstatdate BETWEEN 20250121 AND 20250204)\nGROUP BY dtstatdate\nORDER BY dtstatdate",
  "rejected": "### ç¬¬ä¸€æ­¥ï¼šç†è§£éœ€æ±‚\n\næˆ‘ä»¬è¦ç»Ÿè®¡åœ¨ä»¥ä¸‹ä¸‰ä¸ªæ—¶é—´æ®µå†…æ¯å¤©æ‰€æœ‰ç©æ³•çš„å‚ä¸äººæ•°å’Œæ€»æ—¶é•¿ï¼š\n\n1. **2023å¹´1æœˆ14æ—¥ - 2023å¹´1æœˆ28æ—¥**\n2. **2024å¹´2æœˆ2æ—¥ - 2024å¹´2æœˆ16æ—¥**\n3. **2025å¹´1æœˆ21æ—¥ - 2025å¹´2æœˆ4æ—¥**\n\n#### è¾“å‡ºå­—æ®µè¦æ±‚ï¼š\n- **æ—¥æœŸ**ï¼šæ ¼å¼ä¸º `YYYYMMDD`ï¼ˆå¦‚ 20230101ï¼‰\n- **å‚ä¸äººæ•°**ï¼šæ¯ä¸ªæ—¥æœŸä¸‹ï¼Œä¸åŒç©æ³•çš„ç‹¬ç«‹ç©å®¶æ•°é‡\n- **æ€»æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰**ï¼šæ¯ä¸ªæ—¥æœŸä¸‹ï¼Œæ‰€æœ‰ç©å®¶çš„å¯¹å±€æ—¶é•¿ä¹‹å’Œï¼ˆå•ä½è½¬ä¸ºåˆ†é’Ÿï¼‰\n\n---\n\n### ç¬¬äºŒæ­¥ï¼šåˆ†æè¡¨ç»“æ„ä¸å­—æ®µå«ä¹‰\n\næˆ‘ä»¬ä½¿ç”¨çš„è¡¨æ˜¯ï¼š\n\n```sql\ndws_jordass_mode_roundrecord_di\n```\n\n#### å…³é”®å­—æ®µè¯´æ˜ï¼š\n\n| å­—æ®µå         | å«ä¹‰                     |\n|----------------|--------------------------|\n| `dtstatdate`   | ç»Ÿè®¡æ—¥æœŸï¼ˆæ ¼å¼ä¸º YYYYMMDDï¼‰ |\n| `vplayerid`    | ç©å®¶ ID                  |\n| `roundtime`    | æ¯å¤©çš„å¯¹å±€æ—¶é•¿ï¼ˆå•ä½ï¼šç§’ï¼‰ |\n| `modename`     | æ¨¡å¼åç§°                 |\n\n---\n\n### ç¬¬ä¸‰æ­¥ï¼šç¡®å®šè¿‡æ»¤æ¡ä»¶\n\næˆ‘ä»¬éœ€è¦ç­›é€‰å‡ºæ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ—¶é—´æ®µçš„æ•°æ®ï¼š\n\n1. `dtstatdate >= '20230114' AND dtstatdate <= '20230128'`\n2. `dtstatdate >= '20240202' AND dtstatdate <= '20240216'`\n3. `dtstatdate >= '20250121' AND dtstatdate <= '20250204'`\n\nå¯ä»¥ä½¿ç”¨ `OR` è¿æ¥è¿™ä¸‰ä¸ªèŒƒå›´ã€‚\n\n---\n\n### ç¬¬å››æ­¥ï¼šèšåˆé€»è¾‘è®¾è®¡\n\nå¯¹äºæ¯ä¸€å¤©ï¼Œæˆ‘ä»¬è¦åšå¦‚ä¸‹æ“ä½œï¼š\n\n1. **å»é‡ç»Ÿè®¡å‚ä¸äººæ•°**ï¼šå³æŒ‰ `dtstatdate` å’Œ `vplayerid` å»é‡åçš„ç©å®¶æ•°é‡ã€‚\n2. **æ±‚å’Œæ€»æ—¶é•¿**ï¼šå°† `roundtime`ï¼ˆå•ä½ä¸ºç§’ï¼‰ç´¯åŠ åé™¤ä»¥ 60 å¾—åˆ°åˆ†é’Ÿæ•°ã€‚\n\næ³¨æ„ï¼šé¢˜ç›®ä¸­æåˆ°â€œæ¯å¤©æ‰€æœ‰ç©æ³•â€ï¼Œå› æ­¤ä¸éœ€è¦æŒ‰ `modename` åˆ†ç»„ï¼Œè€Œæ˜¯å¯¹æ•´ä¸ªè¡¨è¿›è¡Œèšåˆã€‚\n\n---\n\n### ç¬¬äº”æ­¥ï¼šç¼–å†™ SQL æŸ¥è¯¢è¯­å¥\n\n```sql\nSELECT\n  dtstatdate AS date,\n  COUNT(DISTINCT vplayerid) AS player_count,\n  SUM(roundtime) / 60 AS total_duration_minutes\nFROM dws_jordass_mode_roundrecord_di\nWHERE\n  (dtstatdate >= '20230114' AND dtstatdate <= '20230128') OR\n  (dtstatdate >= '20240202' AND dtstatdate <= '20240216') OR\n  (dtstatdate >= '20250121' AND dtstatdate <= '20250204')\nGROUP BY dtstatdate\nORDER BY dtstatdate;\n```\n\n---\n\n### ç¬¬å…­æ­¥ï¼šè§£é‡Š SQL ç»“æ„\n\n#### SELECT å­å¥ï¼š\n- `dtstatdate`: å½“å‰æ—¥æœŸï¼ˆæ ¼å¼ä¸º YYYYMMDDï¼‰\n- `COUNT(DISTINCT vplayerid)`: æ¯å¤©çš„ç‹¬ç«‹ç©å®¶æ•°\n- `SUM(roundtime) / 60`: æ‰€æœ‰ç©å®¶å½“å¤©çš„å¯¹å±€æ—¶é•¿æ€»å’Œï¼ˆè½¬æ¢æˆåˆ†é’Ÿï¼‰\n\n#### FROM å­å¥ï¼š\n- æ¥æºè¡¨ä¸º `dws_jordass_mode_roundrecord_di`\n\n#### WHERE å­å¥ï¼š\n- ç­›é€‰æŒ‡å®šçš„ä¸‰ä¸ªæ—¶é—´æ®µ\n\n#### GROUP BY å­å¥ï¼š\n- æŒ‰ç…§ `dtstatdate` å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œç¡®ä¿æ¯å¤©çš„ç»“æœæ˜¯ç‹¬ç«‹çš„\n\n#### ORDER BY å­å¥ï¼š\n- æœ€ç»ˆç»“æœæŒ‰ç…§æ—¥æœŸå‡åºæ’åˆ—\n\n---\n\n### âœ… æœ€ç»ˆç­”æ¡ˆï¼ˆå®Œæ•´ SQLï¼‰ï¼š\n\n```sql\nSELECT\n  dtstatdate AS date,\n  COUNT(DISTINCT vplayerid) AS player_count,\n  SUM(roundtime) / 60 AS total_duration_minutes\nFROM dws_jordass_mode_roundrecord_di\nWHERE\n  (dtstatdate >= '20230114' AND dtstatdate <= '20230128') OR\n  (dtstatdate >= '20240202' AND dtstatdate <= '20240216') OR\n  (dtstatdate >= '20250121' AND dtstatdate <= '20250204')\nGROUP BY dtstatdate\nORDER BY dtstatdate;\n```"
}